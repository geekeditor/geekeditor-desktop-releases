(this.webpackJsonpmain=this.webpackJsonpmain||[]).push([[2],{1075:function(e,t,n){var i={"./locale":733,"./locale.js":733};function o(e){var t=a(e);return n(t)}function a(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}o.keys=function(){return Object.keys(i)},o.resolve=a,e.exports=o,o.id=1075},1077:function(e,t,n){var i=n(93)(!1);i.push([e.i,".beui-diagram-editor {\n  text-align: center;\n  width: 500px;\n  margin: auto;\n  border: 1px solid var(--editor-border-color);\n  border-radius: 2px;\n  position: absolute;\n  bottom: 50px;\n  top: 100px;\n  left: 50%;\n  transform: translateX(-50%);\n}\n.beui-diagram-editor .beui-diagram-editor__toolbar {\n  display: block;\n  padding: 4px 12px;\n  background: var(--editor-toolbar-bgcolor);\n  border-bottom: 1px solid var(--editor-border-color);\n  user-select: none;\n  height: 35px;\n  box-sizing: border-box;\n  text-align: left;\n}\n.beui-diagram-editor .beui-diagram-editor__toolbar .beui-diagram-editor__button {\n  height: 28px;\n  padding: 2px 4px;\n  box-sizing: border-box;\n  border: 1px solid transparent;\n  vertical-align: middle;\n  background-color: transparent;\n  border-radius: 0;\n  color: var(--color);\n  cursor: pointer;\n}\n.beui-diagram-editor .beui-diagram-editor__toolbar .beui-diagram-editor__button:hover {\n  border-color: var(--editor-border-color);\n}\n.beui-diagram-editor .beui-diagram-editor__input {\n  resize: none;\n  width: 100%;\n  background-color: var(--content-background-color);\n  border: none;\n  padding: 6px 12px;\n  height: 200px;\n  box-sizing: border-box;\n  line-height: 1.5em;\n  display: block;\n}\n.beui-diagram-editor .beui-diagram-editor__preview {\n  padding: 20px 10px;\n  text-align: center;\n  border-top: 1px solid var(--editor-border-color);\n  max-height: calc(100% - 200px);\n  overflow: auto;\n  box-sizing: border-box;\n}\n.beui-diagram-editor__panel {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  margin: -4px;\n  padding: 16px;\n  max-width: 384px;\n}\n.beui-block--stretched .be-diagram__preview {\n  display: none;\n}\n.beui-block--stretched .be-diagram__input {\n  margin-top: 100px;\n}\n",""]),e.exports=i},1078:function(e,t,n){var i=n(93)(!1);i.push([e.i,"",""]),e.exports=i},1079:function(e,t,n){var i=n(93)(!1);i.push([e.i,".be-diagram__preview {\n  padding: 20px 10px;\n  text-align: center;\n}\n",""]),e.exports=i},1080:function(e,t,n){},1081:function(e,t,n){var i=n(93)(!1);i.push([e.i,".beui-block--stretched .be-drawio__preview {\n  display: none;\n}\n.beui-block--stretched .be-drawio__input {\n  margin-top: 100px;\n}\n",""]),e.exports=i},1082:function(e,t,n){var i=n(93)(!1);i.push([e.i,"",""]),e.exports=i},1083:function(e,t,n){var i=n(93)(!1);i.push([e.i,".be-drawio__preview {\n  padding: 20px 10px;\n  text-align: center;\n}\n",""]),e.exports=i},1084:function(e,t,n){},1085:function(e,t,n){var i=n(93)(!1);i.push([e.i,'.be-image {\n  --bg-color: #cdd1e0;\n  --front-color: #388ae5;\n  --border-color: #e8e8eb;\n  /**\n     * Tunes\n     * ----------------\n     */\n}\n.be-image .beui-image__loader {\n  border-radius: 3px;\n  overflow: hidden;\n  margin-bottom: 10px;\n  width: 100%;\n  box-sizing: border-box;\n}\n.be-image .beui-block__button {\n  width: 60px;\n  margin: auto;\n  box-sizing: content-box;\n}\n.be-image__container {\n  width: 100%;\n}\n.be-image__img {\n  max-width: 100%;\n  display: block;\n}\n.be-image [contentEditable="true"][placeholder]::before {\n  content: attr(placeholder);\n  color: #70768433;\n  font-weight: normal;\n  display: none;\n}\n.be-image [contentEditable="true"][placeholder]:empty::before {\n  display: inline;\n}\n.be-image [contentEditable="true"][placeholder]:empty:focus::before {\n  display: none;\n}\n.be-image--empty .beui-image__loader {\n  display: none;\n}\n.be-image--empty .beui-image__container {\n  display: none;\n}\n.be-image--empty .be-image__caption,\n.be-image--loading .be-image__caption {\n  display: none;\n}\n.be-image--empty .beui-image__container,\n.be-image--loading .beui-image__container {\n  display: none;\n}\n.be-image--filled .beui-block__button {\n  display: none;\n}\n.be-image--filled .beui-image__loader {\n  display: none;\n}\n.be-image--loading .beui-image__loader {\n  min-height: 200px;\n  display: flex;\n  border: 1px solid var(--border-color);\n  background-color: #fff;\n}\n.be-image--loading .beui-block__button {\n  display: none;\n}\n.be-image--withBorder .beui-image__loader {\n  border: 1px solid var(--border-color);\n}\n.be-image--withBackground .beui-image__loader {\n  padding: 15px;\n  background: var(--bg-color);\n}\n.be-image--withBackground .be-image__img {\n  max-width: 60%;\n  margin: 0 auto;\n}\n.be-image--stretched .be-image__img {\n  width: 100%;\n}\n.beui-image__preloader {\n  width: 50px;\n  height: 50px;\n  border-radius: 50%;\n  background-size: cover;\n  margin: auto;\n  position: relative;\n  background-color: var(--bg-color);\n  background-position: center center;\n}\n.beui-image__preloader::after {\n  content: "";\n  position: absolute;\n  z-index: 3;\n  width: 60px;\n  height: 60px;\n  border-radius: 50%;\n  border: 2px solid var(--bg-color);\n  border-top-color: var(--front-color);\n  left: 50%;\n  top: 50%;\n  margin-top: -30px;\n  margin-left: -30px;\n  animation: image-preloader-spin 2s infinite linear;\n  box-sizing: border-box;\n}\n@keyframes image-preloader-spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n.beui-block--stretched .be-image__container {\n  display: none;\n}\n.beui-block--stretched .be-image__caption {\n  display: none;\n}\n.beui-block--stretched .be-image__editor {\n  position: relative;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n}\n',""]),e.exports=i},1086:function(e,t,n){var i=n(93)(!1);i.push([e.i,".be-image__caption {\n  text-align: center;\n}\n",""]),e.exports=i},1087:function(e,t,n){var i=n(93)(!1);i.push([e.i,'.be-list__item-list {\n  position: relative;\n}\n.be-list__item-list::before {\n  content: "";\n  width: 5px;\n  height: 5px;\n  border: solid #999;\n  border-width: 0 2px 2px 0;\n  transform: rotate(45deg);\n  position: absolute;\n  left: -30px;\n  top: 7px;\n  transition: transform 0.1s ease-in-out;\n  cursor: pointer;\n}\n.be-list__item-list--closed::before {\n  transform: rotate(-45deg);\n  top: 9px;\n}\n.be-list__item-list--closed .be-list__item-children {\n  display: none;\n}\n',""]),e.exports=i},1088:function(e,t,n){var i=n(93)(!1);i.push([e.i,"",""]),e.exports=i},1089:function(e,t,n){},1090:function(e,t,n){},1092:function(e,t,n){var i=n(93)(!1);i.push([e.i,".beui-math-editor {\n  text-align: center;\n  max-width: 500px;\n  margin: auto;\n  border: 1px solid var(--editor-border-color);\n  border-radius: 2px;\n}\n.beui-math-editor .beui-math-editor__toolbar {\n  display: block;\n  padding: 4px 12px;\n  background: var(--editor-toolbar-bgcolor);\n  border-bottom: 1px solid var(--editor-border-color);\n  user-select: none;\n  height: 35px;\n  box-sizing: border-box;\n  text-align: left;\n}\n.beui-math-editor .beui-math-editor__toolbar .beui-math-editor__button {\n  height: 28px;\n  padding: 2px 4px;\n  box-sizing: border-box;\n  border: 1px solid transparent;\n  vertical-align: middle;\n  background-color: transparent;\n  border-radius: 0;\n  color: var(--color);\n  cursor: pointer;\n}\n.beui-math-editor .beui-math-editor__toolbar .beui-math-editor__button:hover {\n  border-color: var(--editor-border-color);\n}\n.beui-math-editor .beui-math-editor__input {\n  resize: none;\n  width: 100%;\n  background-color: var(--content-background-color);\n  padding: 6px 12px;\n  min-height: 100px;\n  box-sizing: border-box;\n  line-height: 1.5em;\n  display: block;\n  outline: none;\n  border: none;\n}\n.beui-math-editor .beui-math-editor__preview {\n  padding: 20px 10px;\n  text-align: center;\n  border-top: 1px solid var(--editor-border-color);\n}\n.beui-math-editor__panel {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  margin: -4px;\n  padding: 16px;\n  max-width: 384px;\n}\n.beui-block--stretched .be-math__preview {\n  display: none;\n}\n.beui-block--stretched .be-math__input {\n  margin-top: 200px;\n}\n",""]),e.exports=i},1093:function(e,t,n){var i=n(93)(!1);i.push([e.i,"",""]),e.exports=i},1094:function(e,t,n){var i=n(93)(!1);i.push([e.i,".be-math__preview {\n  padding: 20px 10px;\n  text-align: center;\n}\n",""]),e.exports=i},1095:function(e,t,n){var i=n(93)(!1);i.push([e.i,".beui-table-editor {\n  padding: 10px;\n  position: relative;\n  width: 100%;\n  box-sizing: border-box;\n}\n.beui-table-toolbar {\n  background: #368be6;\n}\n.beui-table-toolbar--hidden {\n  visibility: hidden;\n}\n.beui-table-toolbar--hor {\n  width: 100%;\n  height: 21px;\n  display: flex;\n  align-items: center;\n  flex-direction: row;\n  position: absolute;\n  left: 0;\n  top: 1px;\n  z-index: 100;\n}\n.beui-table-toolbar--ver {\n  height: 100%;\n  width: 21px;\n  display: flex;\n  align-items: center;\n  flex-direction: column;\n  position: absolute;\n  top: 0;\n  left: -1px;\n  z-index: 100;\n}\n.beui-table-toolbar__plus {\n  height: 21px;\n  width: 21px;\n  margin-top: 0;\n  cursor: pointer;\n}\n.beui-table-toolbar__plus--hor {\n  margin-left: -10px;\n}\n.beui-table-toolbar__plus--ver {\n  margin-top: -10px;\n}\n.beui-table-toolbar__minus {\n  height: 21px;\n  width: 21px;\n  margin-top: 0;\n  cursor: pointer;\n}\n.beui-table-toolbar__minus--hor {\n  margin-right: -10px;\n}\n.beui-table-toolbar__minus--ver {\n  margin-bottom: -10px;\n}\n.beui-table-toolbar__shine-line--hor {\n  min-height: 1px;\n  width: 100%;\n}\n.beui-table-toolbar__shine-line--ver {\n  min-width: 1px;\n  height: 100%;\n}\n",""]),e.exports=i},1096:function(e,t,n){var i=n(93)(!1);i.push([e.i,".beui-table-editor {\n  padding: 10px;\n}\n.be-table {\n  border-collapse: collapse;\n  width: 100%;\n  table-layout: fixed;\n}\n",""]),e.exports=i},1097:function(e,t,n){var i=n(93)(!1);i.push([e.i,"",""]),e.exports=i},1098:function(e,t,n){var i=n(93)(!1);i.push([e.i,"",""]),e.exports=i},1099:function(e,t,n){var i=n(93)(!1);i.push([e.i,".be-todolist__item--checked .be-todolist__item-checkbox {\n  background: #388ae5;\n  border-color: #388ae5;\n}\n",""]),e.exports=i},1100:function(e,t,n){var i=n(93)(!1);i.push([e.i,".be-todolist__item {\n  display: flex;\n  padding: 0 10px;\n  box-sizing: content-box;\n  align-items: center;\n}\n.be-todolist__item-text {\n  outline: none;\n  flex-grow: 1;\n  padding: 10px 0;\n}\n.be-todolist__item-checkbox {\n  display: inline-flex;\n  flex-shrink: 0;\n  position: relative;\n  width: 20px;\n  height: 20px;\n  margin: 10px 10px 10px 0;\n  border: 1px solid #d0d0d0;\n  background: #fff;\n  cursor: pointer;\n  -webkit-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  border-radius: 10%;\n  align-items: center;\n  justify-content: center;\n}\n.be-todolist__item-checkbox:hover {\n  border-color: #b5b5b5;\n}\n.be-todolist__item-checkbox::after {\n  width: 8px;\n  height: 5px;\n  border: 2px solid #fcfff4;\n  border-top: none;\n  border-right: none;\n  background: transparent;\n  content: '';\n  opacity: 0;\n  transform: rotate(-45deg);\n  margin-bottom: 3px;\n}\n.be-todolist__item--checked .be-todolist__item-checkbox {\n  background: #388ae5;\n  border-color: #388ae5;\n}\n.be-todolist__item--checked .be-todolist__item-checkbox::after {\n  opacity: 1;\n}\n",""]),e.exports=i},1101:function(e,t,n){},1102:function(e,t,n){var i=n(1103);e.exports="string"===typeof i?i:i.toString()},1103:function(e,t,n){var i=n(93)(!1);i.push([e.i,'@custom-media --mobile (width <= 650px);\n@custom-media --not-mobile (width >= 651px);\n/**\n   * Selection color\n   */\n/**\n    * Toolbar buttons\n    */\n/**\n    * All gray texts: placeholders, settings\n    */\n/**\n    * Gray icons hover\n    */\n/**\n    * Blue icons\n    */\n/**\n    * Gray border, loaders\n    */\n/**\n    * Block content width\n    * Should be set in a constant at the modules/ui.js\n    */\n/**\n    * In narrow mode, we increase right zone contained Block Actions button\n    */\n/**\n    * Toolbar buttons height and width\n    */\n/**\n    * Toolbar Plus Button and Toolbox buttons height and width\n    */\n/**\n    * Confirm deletion bg\n    */\n.overlay-pane {\n  position: absolute;\n  background-color: var(--editor-toolbar-bgcolor);\n  border: 1px solid var(--editor-toolbar-bdcolor);\n  box-shadow: 0 3px 15px -3px rgba(13, 20, 33, 0.13);\n  border-radius: 4px;\n  z-index: 2;\n}\n.overlay-pane--left-oriented::before {\n  left: 15px;\n  margin-left: 0;\n}\n.overlay-pane--right-oriented::before {\n  left: auto;\n  right: 15px;\n  margin-left: 0;\n}\n/**\n    * Styles for Toolbox Buttons and Plus Button\n    */\n.toolbox-button {\n  color: #707684;\n  cursor: pointer;\n  width: 30px;\n  height: 30px;\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n}\n.toolbox-button:hover,\n.toolbox-button--active {\n  color: #388ae5;\n}\n.toolbox-button--active {\n  animation: bounceIn 0.75s 1;\n  animation-fill-mode: forwards;\n}\n/**\n    * Styles for Settings Button in Toolbar\n    */\n.toolbar-button {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  width: 30px;\n  height: 30px;\n  line-height: 30px;\n  padding: 0 !important;\n  text-align: center;\n  border-radius: 3px;\n  cursor: pointer;\n  border: 0;\n  outline: none;\n  background-color: transparent;\n  vertical-align: bottom;\n  color: var(--editor-toolbar-btncolor);\n  margin: 0;\n}\n.toolbar-button:hover {\n  background-color: var(--editor-toolbar-hover-color);\n}\n.toolbar-button--active {\n  color: #388ae5 !important;\n}\n.toolbar-button--focused {\n  box-shadow: inset 0 0 0px 1px rgba(7, 161, 227, 0.08);\n  background: rgba(34, 186, 255, 0.08) !important;\n}\n.toolbar-button--focused-animated {\n  animation-name: buttonClicked;\n  animation-duration: 250ms;\n}\n.beui-block {\n  position: relative;\n}\n.beui-block:first-of-type {\n  margin-top: 0;\n}\n.beui-block [placeholder]:empty:focus::before {\n  content: attr(placeholder);\n  color: #70768433;\n  font-weight: normal;\n}\n.beui-block--stretched {\n  position: fixed;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  top: 0;\n  background-color: var(--mask-background-color);\n  overflow: auto;\n  z-index: 1000;\n}\n.beui-block--stretched::before {\n  content: \'\u6309ESC\u952e\u4fdd\u5b58\u5e76\u9000\u51fa\';\n  position: absolute;\n  display: block;\n  top: 5px;\n  left: 50%;\n  transform: translateX(-50%);\n  color: var(--color);\n}\n.beui-block--selected .beui-block__content {\n  background-color: var(--block-selected-bgcolor);\n  /**\n     * Workaround Safari case when user can select inline-fragment with cross-block-selection\n     */\n}\n.beui-block--selected .beui-block__content [contenteditable] {\n  -webkit-user-select: none;\n  user-select: none;\n}\n.beui-block--selected .beui-block__content img,\n.beui-block--selected .beui-block__content .be-stub {\n  opacity: 0.55;\n}\n.beui-block--stretched .beui-block__content {\n  max-width: none;\n}\n.beui-block__content {\n  margin: 0 auto;\n  transition: background-color 150ms ease;\n}\n.beui-block--drop-target .beui-block__content:before {\n  content: "";\n  position: absolute;\n  top: 100%;\n  left: -20px;\n  margin-top: -1px;\n  height: 8px;\n  width: 8px;\n  border: solid #388ae5;\n  border-width: 1px 1px 0 0;\n  transform-origin: right;\n  transform: rotate(45deg);\n}\n.beui-block--drop-target .beui-block__content:after {\n  content: "";\n  position: absolute;\n  top: 100%;\n  height: 1px;\n  width: 100%;\n  color: #388ae5;\n  background: repeating-linear-gradient(90deg, #388ae5, #388ae5 1px, #fff 1px, #fff 6px);\n}\n.beui-block a {\n  cursor: pointer;\n  text-decoration: underline;\n}\n.beui-block b {\n  font-weight: bold;\n}\n.beui-block i {\n  font-style: italic;\n}\n.beui-block svg {\n  fill: currentColor;\n  max-width: 100%;\n}\n.beui-block__button {\n  padding: 13px;\n  border-radius: 3px;\n  border: 1px solid rgba(201, 201, 204, 0.48);\n  font-size: 14.9px;\n  background: #fff;\n  -webkit-box-shadow: 0 2px 2px 0 rgba(18, 30, 57, 0.04);\n  box-shadow: 0 2px 2px 0 rgba(18, 30, 57, 0.04);\n  color: #9e9e9e;\n  text-align: center;\n  cursor: pointer;\n}\n.beui-block__input {\n  border: 1px solid rgba(201, 201, 204, 0.48);\n  -webkit-box-shadow: inset 0 1px 2px 0 rgba(35, 44, 72, 0.06);\n  box-shadow: inset 0 1px 2px 0 rgba(35, 44, 72, 0.06);\n  border-radius: 3px;\n  padding: 10px 12px;\n  outline: none;\n  width: 100%;\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n}\n.beui-block__fakeinput {\n  user-select: all;\n  position: relative;\n}\n.beui-block__input--selected {\n  background-color: var(--block-selected-bgcolor);\n}\n.beui-block__fakeinput.beui-block__input--focused {\n  outline: 1px solid rgba(56, 138, 229, 0.3);\n}\n@media (--not-mobile) {\n  .beui-editor--card .beui-block--focused {\n    margin-right: calc(50px * -1);\n    padding-right: 50px;\n  }\n}\n/**\n * Block Tool wrapper\n */\n/*\n .be-block {\n    padding: 0.4em 0;\n  }\n  */\n/**\n   * Input\n   */\n.beui-input {\n  border: 1px solid rgba(201, 201, 204, 0.48);\n  box-shadow: inset 0 1px 2px 0 rgba(35, 44, 72, 0.06);\n  border-radius: 3px;\n  padding: 10px 12px;\n  outline: none;\n  width: 100%;\n  box-sizing: border-box;\n  /**\n     * Workaround Firefox bug with cursor position on empty content editable elements with ::before pseudo\n     * https://bugzilla.mozilla.org/show_bug.cgi?id=904846\n     */\n}\n.beui-input[placeholder]::before {\n  position: static !important;\n  display: inline-block;\n  width: 0;\n  white-space: nowrap;\n  pointer-events: none;\n}\n.be-stub {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  padding: 3.5em 0;\n  margin: 17px 0;\n  border-radius: 3px;\n  background: #fcf7f7;\n  color: #b46262;\n}\n.be-stub__info {\n  margin-left: 20px;\n}\n.be-stub__title {\n  margin-bottom: 3px;\n  font-weight: 600;\n  font-size: 18px;\n  text-transform: capitalize;\n}\n.be-stub__subtitle {\n  font-size: 16px;\n}\n::-webkit-scrollbar {\n  width: 3px;\n  height: 10px;\n  background-color: var(--scrollbar-background-color);\n}\n::-webkit-scrollbar-thumb {\n  -webkit-box-shadow: inset 0 0 16px var(--scrollbar-thumb-color);\n}\n.beui-editor__content {\n  display: inline-block !important;\n  width: 100%;\n}\n.beui-editor__content.dark-mode *:not([class^="be-code__"]) {\n  color: var(--dark-color) !important;\n}\n.beui-editor__content.dark-mode *:not([class^="be-code__"]) #__ge_graph_render .node rect,\n.beui-editor__content.dark-mode *:not([class^="be-code__"]) #__ge_graph_render .node circle,\n.beui-editor__content.dark-mode *:not([class^="be-code__"]) #__ge_graph_render .node ellipse,\n.beui-editor__content.dark-mode *:not([class^="be-code__"]) #__ge_graph_render .node polygon,\n.beui-editor__content.dark-mode *:not([class^="be-code__"]) #__ge_graph_render .node path {\n  fill: #333;\n}\n.beui-editor__content.dark-mode code:not(.be-code__line),\n.beui-editor__content.dark-mode blockquote {\n  background-color: var(--background-color);\n}\n.beui-editor__content.dark-mode .be-code__line,\n.beui-editor__content.dark-mode .be-code__line::before {\n  color: var(--color);\n}\n.beui-editor__content.dark-mode pre {\n  background-color: var(--background-color);\n}\n[contenteditable] {\n  outline: none;\n  -webkit-user-select: auto;\n  -ms-user-select: auto;\n  user-select: auto;\n}\n[contenteditable]:empty:after {\n  content: "\\feff ";\n}\n[contenteditable][placeholder]:empty::before {\n  content: attr(placeholder);\n  color: var(--placeholder-color);\n  font-weight: normal;\n  display: none;\n  cursor: text;\n  display: inline-block;\n  position: static;\n}\n[contenteditable][placeholder]:empty:focus::before {\n  display: none;\n}\n[contenteditable][placeholder]:empty::after {\n  display: none;\n}\n.beui-block__fakeinput[empty]:empty:before {\n  font-size: 14px;\n  content: attr(empty);\n  display: block;\n  text-align: center;\n  color: var(--placeholder-color);\n  line-height: 2em;\n}\n.beui-block__fakeinput.beui-block__input--focused[placeholder]:empty:before {\n  font-size: 14px;\n  content: attr(placeholder);\n  display: block;\n  text-align: center;\n  color: var(--placeholder-color);\n  line-height: 2em;\n}\n',""]),e.exports=i},1105:function(e,t,n){"use strict";n.r(t);var i,o=n(1),a=n(7),s=n(6),r=n(10),l=n(9),c=n(0),u=(n(772),n(1119)),d=n(1120),h=n(33),p=n(43),f=(n(773),n(774),n(498)),v=(n(775),n(115));!function(e){e[e.ECatalogDataTypeSubItem=0]="ECatalogDataTypeSubItem",e[e.ECatalogDataTypeNextItem=1]="ECatalogDataTypeNextItem"}(i||(i={}));var b=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).onJump=function(e){var t=o.props;(0,t.onJump)(t.node),e.stopPropagation()},o.onCreateNode=function(e,t){o.setState({addCatalogEditing:!0,addCatalogType:e,addLevel:t})},o.onAddCatalogEditing=function(e){if(e.length){var t=o.props,n=t.onCreate,a=t.node,s=o.state,r=s.addCatalogType,l=s.addLevel;n({title:e,level:r===i.ECatalogDataTypeNextItem?a.level:l||a.level+1},a)}o.setState({addCatalogEditing:!1})},o.onTitleEditing=function(e){},o.state={addCatalogEditing:!1,titleEditing:!1,addCatalogType:i.ECatalogDataTypeSubItem,addLevel:void 0},o}return Object(s.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this,t=this.props,n=t.node,a=t.activeNode,s=this.state,r=s.addCatalogType,l=s.addCatalogEditing,c=s.titleEditing,u=n.title,d=n.level,p=d<6,b=0!==d,m=n.el===(null===a||void 0===a?void 0:a.el)?"active":"",g=r===i.ECatalogDataTypeSubItem;return Object(o.jsxs)("div",{className:["catalog-node","level".concat(d),m].join(" "),onContextMenu:function(e){e.preventDefault(),e.stopPropagation()},children:[!c&&Object(o.jsxs)("div",{className:"catalog-node__nav",onClick:this.onJump,children:[Object(o.jsx)("div",{className:"catalog-node__info","data-header":0!==d?"H".concat(d):"",children:Object(o.jsx)("span",{className:"catalog-node__name",children:u})}),0!==d?Object(o.jsxs)("div",{className:"catalog-node__ops",children:[p&&Object(o.jsx)(h.a,{onClick:function(){e.onCreateNode(i.ECatalogDataTypeSubItem)},icon:Object(o.jsx)(f.a,{}),tip:"\u6dfb\u52a0\u4e0b\u7ea7\u6807\u9898",placement:"top"}),b&&Object(o.jsx)(h.a,{onClick:function(){e.onCreateNode(i.ECatalogDataTypeNextItem)},icon:Object(o.jsx)("i",{className:"bei-copy-add",style:{fontSize:"18px"}}),tip:"\u5411\u540e\u6dfb\u52a0\u540c\u7ea7\u6807\u9898",placement:"top"})]}):Object(o.jsxs)("div",{className:"catalog-node__ops catalog-node__level0",children:[Object(o.jsx)(h.a,{onClick:function(){e.onCreateNode(i.ECatalogDataTypeSubItem,1)},icon:Object(o.jsx)(f.a,{}),tip:"\u6dfb\u52a0\u4e00\u7ea7\u6807\u9898",label:"H1",placement:"top"}),Object(o.jsx)(h.a,{onClick:function(){e.onCreateNode(i.ECatalogDataTypeSubItem,2)},icon:Object(o.jsx)(f.a,{}),tip:"\u6dfb\u52a0\u4e8c\u7ea7\u6807\u9898",label:"H2",placement:"top"})]})]}),c&&Object(o.jsx)("div",{className:"catalog-node__title-editing",children:Object(o.jsx)(v.a,{text:u,onFinishing:this.onTitleEditing})}),Object(o.jsx)("div",{className:["catalog-node__content",g?" padding":""].join(""),style:{display:l?"block":"none"},children:l&&Object(o.jsx)("div",{children:Object(o.jsx)(v.a,{text:"",onFinishing:this.onAddCatalogEditing})})})]})}}]),n}(c.Component),m=n(68),g=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(e){return Object(a.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.nodes,n=e.activeNode,i=e.loading,a=e.onCreate,s=e.onJump,r=this.props.wrapClassName||"",l=t.map((function(e,t){var i;return Object(o.jsx)(b,{node:e,activeNode:n,onCreate:a,onJump:s},(null===(i=e.el)||void 0===i?void 0:i.dataset.id)||t)}));return Object(o.jsxs)("div",{className:["catalog-bar",r].join(" "),children:[i&&Object(o.jsx)(m.a,{}),l]})}}]),n}(c.Component),k=n(106),y=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).onToggleVisible=function(){var e=i.state.visible,t=i.props.editable;e?t&&t.off("contentchange",i.onUpdateCatalog):t&&(i.setState({loading:!0}),t.catalog.getCatalogDatas().then((function(e){i.setState({nodes:e,loading:!1})})),t.on("contentchange",i.onUpdateCatalog)),i.setState({visible:!e}),(0,i.props.onShowingCatalog)(!e)},i.onUpdateCatalog=function(){var e=i.props.editable;e&&e.catalog.getCatalogDatas().then((function(e){i.setState({nodes:e})}))},i.onCreate=function(e,t){var n,o=i.props.editable;if(o){var a=i.state.nodes,s=a.findIndex((function(e){return e.el===t.el}));if(e.level>t.level){var r=o.catalog.insertAfter(e,t);s<a.length-1?a.splice(s+1,0,r):a.push(r),n=r}else{for(var l=s+1;l<a.length&&!(a[l].level<=e.level);l++);if(l<a.length){var c=o.catalog.insertBefore(e,a[l]);a.splice(l,0,c),n=c}else{var u=o.catalog.append(e);a.push(u),n=u}}i.setState({nodes:Object(p.a)(a)}),n&&i.onJump(n)}},i.onJump=function(e){var t=i.props.editable;t&&(t.catalog.jumpTo(e),i.setState({activeNode:e}))},i.state={nodes:[],activeNode:null,loading:!1,visible:!1},i}return Object(s.a)(n,[{key:"render",value:function(){var e=this.state,t=e.nodes,n=e.activeNode,i=e.loading,a=e.visible,s=Object(o.jsxs)("div",{className:"catalog-container",children:[Object(o.jsxs)("div",{className:"catalog-header",children:[Object(o.jsx)("div",{className:"catalog-header__title",children:"\u76ee\u5f55"}),Object(o.jsx)(h.a,{icon:Object(o.jsx)(k.a,{}),onClick:this.onToggleVisible})]}),Object(o.jsx)(g,{loading:i,nodes:t,activeNode:n,onCreate:this.onCreate,onJump:this.onJump})]});return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(h.a,{selected:a,wrapClassName:"editor-side-bar-item app-guide-catalog",icon:Object(o.jsx)("i",{className:"bei-catalog"}),onClick:this.onToggleVisible}),a&&s]})}}]),n}(c.Component),_=(n(637),n(482)),C=n(1106),x=n(67),E=n(1107),O=n(494),S=n(1108),w=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).onUpdateScreen=function(){var e=i.props.editable;if(e){var t=e.queryCommandValue("layout");i.setState({layout:t})}},i.onChangeScreen=function(e){var t=i.props.editable;t&&(t.execCommand("layout",e.target.value),i.setState({layout:e.target.value}))},i.state={layout:"web"},i}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.editable;e&&e.on("selectionchange",this.onUpdateScreen),this.onUpdateScreen()}},{key:"componentWillUnmount",value:function(){var e=this.props.editable;e&&e.off("selectionchange",this.onUpdateScreen)}},{key:"render",value:function(){var e=this.state.layout;return Object(o.jsxs)(C.a.Group,{value:e,buttonStyle:"solid",className:"layout__group",onChange:this.onChangeScreen,children:[Object(o.jsx)(x.a,{title:"Web \u7248\u5f0f",placement:"bottom",children:Object(o.jsx)(C.a.Button,{className:"layout__button",value:"web",children:Object(o.jsx)(E.a,{className:"layout__radio"})})}),Object(o.jsx)(x.a,{title:"\u9875\u9762\u7248\u5f0f",placement:"bottom",children:Object(o.jsx)(C.a.Button,{className:"layout__button",value:"print",children:Object(o.jsx)(O.a,{className:"layout__radio"})})}),Object(o.jsx)(x.a,{title:"\u624b\u673a\u7248\u5f0f",placement:"bottom",children:Object(o.jsx)(C.a.Button,{className:"layout__button",value:"mobile",children:Object(o.jsx)(S.a,{className:"layout__radio"})})})]})}}]),n}(c.Component),T=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){var e=this.props.editable,t=Object(o.jsx)("div",{children:e&&Object(o.jsx)(w,{editable:e})});return Object(o.jsx)(_.a,{placement:"leftTop",title:null,content:t,trigger:"click",children:Object(o.jsx)(h.a,{wrapClassName:"editor-side-bar-item app-guide-layout",disabled:!e,icon:Object(o.jsx)("i",{className:"bei-screen"})})})}}]),n}(c.Component),j=(n(776),n(487)),B=n(52),N=n(90),L=n(252),I=n(1109),A=n(1110),R=n(61),M=j.a.Group,D=B.a.Group,H=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).onSearchDebounce=void 0,i.onReplaceTrigger=function(){i.setState({isReplace:!i.state.isReplace})},i.onChangeSearchKey=function(e){var t;i.setState({searchKey:null===(t=e.target)||void 0===t?void 0:t.value}),i.onSearchDebounce()},i.onChangeReplaceKey=function(e){var t;i.setState({replaceKey:null===(t=e.target)||void 0===t?void 0:t.value})},i.onReplaceCurrent=function(){var e=i.props.editable;if(e){var t=e.search.replace({searchKey:i.state.searchKey,replaceKey:i.state.replaceKey,all:!1,dir:1});i.onUpdateResult(t)}},i.onReplaceAll=function(){var e=i.props.editable;if(e){var t=e.search.replace({searchKey:i.state.searchKey,replaceKey:i.state.replaceKey,all:!0,dir:1});i.onUpdateResult(t)}},i.onSearch=function(){var e=i.props.editable;if(e)if(i.state.searchKey){var t=e.search.search({searchKey:i.state.searchKey,all:!0,dir:1});i.onUpdateResult(t)}else{var n=e.search.clear();i.onUpdateResult(n)}},i.onPrev=function(){var e=i.props.editable;if(e){var t=e.search.jumpPrev();i.onUpdateResult(t)}},i.onNext=function(){var e=i.props.editable;if(e){var t=e.search.jumpNext();i.onUpdateResult(t)}},i.onSearchTrigger=function(e){e?i.onSearch():i.onClear(),i.setState({visible:e})},i.onClear=function(){var e=i.props.editable;if(e){var t=e.search.clear();i.onUpdateResult(t)}},i.onUpdateResult=function(e){e?i.setState({result:e}):i.setState({result:{list:[],index:0}})},i.state={mode:"search",searchKey:"",replaceKey:"",isReplace:!1,result:{list:[],index:0},visible:!1},i.onSearchDebounce=Object(R.a)(i.onSearch,200),i}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){var t=e.props.editable;t&&t.on("search",(function(){var n=t.selection.getRangeAt(0).cloneContents(),i=document.createElement("div");n&&i.appendChild(n);var o=i.textContent;o&&e.setState({searchKey:o}),e.setState({visible:!0}),e.onSearch()}))}),100)}},{key:"render",value:function(){var e=this.state,t=e.isReplace,n=e.searchKey,i=e.replaceKey,a=e.result,s=e.visible,r=Object(o.jsxs)("div",{className:"search-replace",children:[Object(o.jsx)("div",{className:"search-replace__trigger",onClick:this.onReplaceTrigger,children:t?Object(o.jsx)(L.a,{}):Object(o.jsx)(N.a,{})}),Object(o.jsxs)("div",{className:"search-replace__main",children:[Object(o.jsxs)("div",{className:"search-block",children:[Object(o.jsx)(M,{className:"search-input-box",children:Object(o.jsx)(j.a,{type:"text",className:"search-input",value:n,onChange:this.onChangeSearchKey,placeholder:"\u67e5\u627e\u5185\u5bb9",onPressEnter:this.onSearch,suffix:Object(o.jsx)("span",{className:"search-result",children:!!a.list.length&&Object(o.jsxs)("span",{children:[a.index+1,"/",a.list.length]})})})}),Object(o.jsxs)(D,{className:"search-arrow",children:[Object(o.jsx)(B.a,{size:"small",type:"text",className:"search-arrow-btn",disabled:0==a.list.length,onClick:this.onPrev,icon:Object(o.jsx)(I.a,{})}),Object(o.jsx)(B.a,{size:"small",type:"text",icon:Object(o.jsx)(A.a,{}),className:"search-arrow-btn",disabled:0==a.list.length,onClick:this.onNext})]})]}),t&&Object(o.jsxs)("div",{className:"replace-block",children:[Object(o.jsx)(j.a,{type:"text",className:"replace-input",value:i,onChange:this.onChangeReplaceKey,placeholder:"\u66ff\u6362\u4e3a"}),Object(o.jsx)("div",{className:"operation-btns",children:Object(o.jsxs)(M,{children:[Object(o.jsx)(B.a,{size:"small",type:"text",onClick:this.onReplaceCurrent,disabled:0==a.list.length,icon:Object(o.jsx)("i",{className:"bei-replace"})}),Object(o.jsx)(B.a,{size:"small",type:"text",disabled:0==a.list.length,onClick:this.onReplaceAll,icon:Object(o.jsx)("i",{className:"bei-replace-all"})})]})})]})]})]});return Object(o.jsx)(_.a,{placement:"leftTop",title:null,content:r,visible:s,trigger:"click",onVisibleChange:this.onSearchTrigger,children:Object(o.jsx)(h.a,{wrapClassName:"editor-side-bar-item app-guide-searchreplace",icon:Object(o.jsx)("i",{className:"bei-search"})})})}}]),n}(c.Component),P=(n(777),n(1112)),F=(n(778),n(1111)),q=n(481),z=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).onDelete=function(t){var n=e.props.onDelete;n&&n(),t&&t.stopPropagation()},e.onCopyAdd=function(){var t=e.props.onCopyAdd;t&&t()},e.onEdit=function(){var t=e.props.onEdit;t&&t()},e.onClick=function(){var t=e.props.onClick;t&&t()},e}return Object(s.a)(n,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.copyable,i=e.editable,a=e.markable,s=e.deletable;return Object(o.jsxs)("div",{className:"beui-typeset-item",onClick:this.onClick,children:[a&&Object(o.jsx)("span",{className:"beui-typeset-item__mark",children:Object(o.jsx)(h.a,{icon:Object(o.jsx)("i",{className:"bei-check"})})}),Object(o.jsx)("span",{className:"beui-typeset-item__name",children:t}),Object(o.jsxs)("div",{className:"beui-typeset-item__ops",children:[s&&Object(o.jsx)(q.a,{title:"\u786e\u8ba4\u5220\u9664\u8be5\u4e3b\u9898\uff1f",placement:"bottom",onConfirm:this.onDelete,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:Object(o.jsx)(h.a,{icon:Object(o.jsx)(F.a,{style:{fontSize:"16px"}}),tip:"\u5220\u9664",placement:"top"})}),n&&Object(o.jsx)(h.a,{icon:Object(o.jsx)("i",{className:"bei-copy-add"}),tip:"\u590d\u5236 + \u65b0\u589e",placement:"top",onClick:this.onCopyAdd}),i&&Object(o.jsx)(h.a,{icon:Object(o.jsx)("i",{className:"bei-edit"}),tip:"\u4fee\u6539",placement:"top",onClick:this.onEdit})]})]})}}]),n}(c.Component),V=n(11),U=(n(779),n(780)),W=n.n(U);n(785),n(786),n(787),n(788);n(546),n(638),n(789),n(790);var K=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).startX=void 0,i.startY=void 0,i.startTop=void 0,i.startRight=void 0,i.mirror=void 0,i.onCodeChange=function(e){var t=i.props,n=t.data,o=t.onUpdate;n.content=e,o(n)},i.onCodeComplete=function(){var e=i.props,t=e.data,n=e.onComplete;t.title=i.state.title,n(t)},i.onChangeTitle=function(e){i.props.data;i.setState({title:e.target.value})},i.onKeyDown=function(e){if(i.mirror){var t=i.mirror.getCodeMirror();"Enter"===e.key||"ArrowLeft"===e.key||"ArrowRight"===e.key||"Tab"===e.key?t.closeHint():"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&t.showHint()}e.stopPropagation()},i.state={title:"",content:""},i}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.data;this.setState(Object(V.a)({},e))}},{key:"render",value:function(){var e=this,t=this.props,n=t.data,i=t.onClose,a=this.state,s=a.title;a.content;return Object(o.jsxs)("div",{className:["typeset-editor"].join(""),children:[Object(o.jsxs)("div",{className:"typeset-editor__header",children:[Object(o.jsx)(h.a,{icon:Object(o.jsx)(k.a,{}),onClick:i}),Object(o.jsx)("div",{children:n.id?"\u4fee\u6539\u81ea\u5b9a\u4e49\u4e3b\u9898":"\u6dfb\u52a0\u81ea\u5b9a\u4e49\u4e3b\u9898"})]}),Object(o.jsx)("div",{className:"typeset-editor__body",onKeyDown:this.onKeyDown,onKeyPressCapture:function(e){e.stopPropagation()},children:Object(o.jsx)(W.a,{value:n.content,ref:function(t){e.mirror=t},options:{tabSize:2,lineNumbers:!0,line:!1,indentWithTabs:!0,smartIndent:!0,autofocus:!0,mode:"css",theme:"idea",height:"100%",hintOptions:{completeSingle:!0}},onChange:this.onCodeChange})}),Object(o.jsxs)("div",{className:"typeset-editor__bar",children:[Object(o.jsx)(j.a,{className:"typeset-editor__title",value:s,onChange:this.onChangeTitle,placeholder:"\u8bf7\u586b\u5199\u81ea\u5b9a\u4e49\u4e3b\u9898\u6807\u9898"}),Object(o.jsx)(B.a,{type:"primary",disabled:!s,onClick:this.onCodeComplete,children:"\u4fdd\u5b58"})]})]})}}]),n}(c.Component),$=n(181),X=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).unsubscrible=void 0,i.onCloseEditor=function(){i.setState({openEditor:!1}),i.onUpdateCurrentTypeset(),(0,i.props.onTypesetEditing)(!1)},i.onAddTypeset=function(e){var t={title:"".concat((null===e||void 0===e?void 0:e.title)||"\u9ed8\u8ba4","-\u81ea\u5b9a\u4e49"),content:e?e.content:$.a.builtinDefaultTypeset};i.onEditTypeset(t)},i.onEditTypeset=function(e){i.setState({openEditor:!0,editTypeset:e}),i.onUpdateTypeset(e),i.setState({visible:!1}),(0,i.props.onTypesetEditing)(!0)},i.onDeleteTypeset=function(e){$.a.deleteCustomTypeset(e),i.onUpdateCurrentTypeset()},i.onCompleteTypeset=function(e){$.a.saveCustomTypeset(e),i.onUpdateTypeset(e),i.setState({openEditor:!1}),(0,i.props.onTypesetEditing)(!1)},i.onUpdateTypeset=function(e){var t=i.props.editable;t&&t.execCommand("typeset",e)},i.onUpdateCurrentTypeset=function(){var e=i.props.editable;e&&e.execCommand("typeset",i.state.currentTypesetId)},i.onSelectTypeset=function(e){var t=i.props.editable;t&&(t.execCommand("typeset",e),i.setState({currentTypesetId:e.id||"default"}))},i.onVisibleChange=function(e){var t=i.props.editable;if(e&&t){var n=t.queryCommandValue("typeset");i.setState({currentTypesetId:n||""})}i.setState({visible:e})},i.state={openEditor:!1,builtinTypesets:$.a.builtinTypesets,customTypesets:$.a.customTypesets,currentTypesetId:"",visible:!1,editTypeset:{title:"",content:""}},i}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.unsubscrible=$.a.subscribeChanged((function(){e.setState({customTypesets:$.a.customTypesets})}))}},{key:"componentWillUnmount",value:function(){this.unsubscrible&&this.unsubscrible()}},{key:"render",value:function(){var e=this,t=this.props.editable,n=this.state,i=n.openEditor,a=n.editTypeset,s=n.builtinTypesets,r=n.customTypesets,l=n.currentTypesetId,c=n.visible,u=Object(o.jsx)("span",{children:"\u4e3b\u9898\u6392\u7248"}),d=s.map((function(t,n){return Object(o.jsx)(z,{name:t.title,copyable:!0,markable:l===t.id,onCopyAdd:function(){e.onAddTypeset(t)},onClick:function(){e.onSelectTypeset(t)}},t.id||n)})),p=r.map((function(t,n){return Object(o.jsx)(z,{name:t.title,copyable:!0,editable:!0,deletable:!0,markable:l===t.id,onCopyAdd:function(){e.onAddTypeset(t)},onEdit:function(){e.onEditTypeset(t)},onDelete:function(){e.onDeleteTypeset(t)},onClick:function(){e.onSelectTypeset(t)}},t.id||n)})),v=Object(o.jsxs)("div",{children:[Object(o.jsxs)("div",{className:"typeset-category",children:[Object(o.jsxs)("div",{className:"typeset-category__header",children:[Object(o.jsx)("span",{className:"typeset-category__title",children:"\u5185\u7f6e\u4e3b\u9898"}),Object(o.jsx)("span",{className:"typeset-category__add",children:Object(o.jsx)("a",{href:"https://github.com/xitu/juejin-markdown-themes",target:"_blank",children:Object(o.jsx)(h.a,{icon:Object(o.jsx)(P.a,{}),tip:"\u5185\u7f6e\u4e3b\u9898\u53c2\u8003\u6765\u6e90",placement:"top"})})})]}),Object(o.jsx)("div",{className:"typeset-category__list",children:d})]}),Object(o.jsxs)("div",{className:"typeset-category",children:[Object(o.jsxs)("div",{className:"typeset-category__header",children:[Object(o.jsx)("span",{className:"typeset-category__title",children:"\u81ea\u5b9a\u4e49\u4e3b\u9898"}),Object(o.jsx)("span",{className:"typeset-category__add",children:Object(o.jsx)(h.a,{onClick:function(){e.onAddTypeset()},icon:Object(o.jsx)(f.a,{}),tip:"\u65b0\u589e\u81ea\u5b9a\u4e49\u4e3b\u9898",placement:"top"})})]}),Object(o.jsx)("div",{className:"typeset-category__list",children:p})]})]});return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(_.a,{placement:"leftTop",title:u,content:v,trigger:"click",onVisibleChange:this.onVisibleChange,visible:c,children:Object(o.jsx)(h.a,{disabled:i||!t,wrapClassName:"editor-side-bar-item app-guide-typeset",icon:Object(o.jsx)("i",{className:"bei-typography"})})}),i&&Object(o.jsx)(K,{data:a,onClose:this.onCloseEditor,onComplete:this.onCompleteTypeset,onUpdate:this.onUpdateTypeset})]})}}]),n}(c.Component),G=(n(791),n(245)),Y=n(480),Z=(n(792),function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){var e=this.props,t=e.icon,n=e.name,i=e.onClick;return Object(o.jsxs)("div",{className:"beui-menu-item",onClick:i,children:[Object(o.jsx)("span",{className:"beui-menu-item__icon",children:t}),Object(o.jsx)("span",{className:"beui-menu-item__name",children:n})]})}}]),n}(c.Component)),J=n(1113),Q=n(1114),ee=n(1115),te=n(1116),ne=n(1117),ie=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).onCopyContent=function(t,n){var i=e.props.editable;if(i){var o=i.execCommand("export",t);o&&o.then((function(){G.b.success(n||"\u5df2\u590d\u5236")}))}},e}return Object(s.a)(n,[{key:"render",value:function(){var e=this,t=Object(o.jsxs)("div",{children:[Object(o.jsx)(Z,{name:"\u590d\u5236\u5230\u516c\u4f17\u53f7 (\u5bcc\u6587\u672c)",icon:Object(o.jsx)("i",{className:"bei-official-account",style:{color:"currentColor",fontSize:"12px"}}),onClick:function(){e.onCopyContent("wechat","\u5df2\u590d\u5236\uff0c\u8bf7\u5230\u5fae\u4fe1\u516c\u4f17\u53f7\u7c98\u8d34\u5185\u5bb9")}}),Object(o.jsx)(Z,{name:"\u590d\u5236\u5230\u77e5\u4e4e (\u5bcc\u6587\u672c)",icon:Object(o.jsx)(J.a,{style:{color:"#1389e9"}}),onClick:function(){e.onCopyContent("zhihu","\u5df2\u590d\u5236\uff0c\u8bf7\u5230\u77e5\u4e4e\u7c98\u8d34\u5185\u5bb9")}}),Object(o.jsx)(Z,{name:"\u590d\u5236\u5230\u6398\u91d1 (Markdown)",icon:Object(o.jsx)("i",{className:"bei-juejin",style:{color:"currentColor",fontSize:"12px"}}),onClick:function(){e.onCopyContent("juejin","\u5df2\u590d\u5236\uff0c\u8bf7\u5230\u6398\u91d1\u7c98\u8d34\u5185\u5bb9")}}),Object(o.jsx)(Y.a,{plain:!0,className:"beui-menu-divider"}),Object(o.jsx)(Z,{name:"\u590d\u5236\u4e3a HTM\bL (\u5bcc\u6587\u672c)",icon:Object(o.jsx)(Q.a,{}),onClick:function(){e.onCopyContent("html","\u5df2\u590d\u5236\u4e3a HTML")}}),Object(o.jsx)(Z,{name:"\u590d\u5236\u4e3a Markdown",icon:Object(o.jsx)(ee.a,{}),onClick:function(){e.onCopyContent("markdown","\u5df2\u590d\u5236\u4e3a Markdown")}}),Object(o.jsx)(Z,{name:"\u590d\u5236\u4e3a\u7eaf\u6587\u672c",icon:Object(o.jsx)(te.a,{}),onClick:function(){e.onCopyContent("plain","\u5df2\u590d\u5236\u4e3a\u7eaf\u6587\u672c")}})]});return Object(o.jsx)(_.a,{placement:"leftTop",title:null,content:t,trigger:"click",children:Object(o.jsx)(h.a,{wrapClassName:"editor-side-bar-item app-guide-export",icon:Object(o.jsx)(ne.a,{})})})}}]),n}(c.Component),oe=(n(793),n(1118)),ae=n(555),se=n(111),re=j.a.TextArea,le=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e))._imageEditor=void 0,i.onToggleVisible=function(){var e=i.state.visible;if(i.setState({visible:!e}),!e){var t=i.props.editable;if(t){var n=t.queryCommandValue("basic");i.setState({title:n.title,cover:n.cover,summary:n.summary})}}(0,i.props.onProfileEditing)(!e)},i.onChangeTitle=function(e){i.setState({title:e.target.value})},i.onChangeSummary=function(e){i.setState({summary:e.target.value})},i.onSave=function(){var e=i.state,t=e.title,n=e.summary,o=e.cover,a=i.props.editable;a&&a.execCommand("basic",{title:t,cover:o,summary:n})},i.onSync=function(){i.onSave();var e=window.syncManager;if(e){var t=i.props.editable;if(t){var n=t.getContent(!0),a=Object(se.e)(n);a?e.sync([a]):G.b.error("\u540c\u6b65\u89e3\u6790\u5185\u5bb9\u5931\u8d25")}}else G.b.info(Object(o.jsxs)(o.Fragment,{children:["\u4ec5\u5728\u684c\u9762\u8f6f\u4ef6\u652f\u6301\u540c\u6b65\u529f\u80fd\uff0c\u7acb\u5373",Object(o.jsx)("a",{href:"https://github.com/geekeditor/geekeditor-releases/releases",target:"_blank",children:"\u4e0b\u8f7d\u684c\u9762\u8f6f\u4ef6"})]}))},i.onEditCover=function(){if(i.props.editable){i._imageEditor||(i._imageEditor=new ae.default({editable:i.props.editable}));var e=i.state.cover;i._imageEditor.edit(e,(function(e){e&&i.setState({cover:e})}))}},i.state={visible:!1,title:"",cover:"",summary:""},i}return Object(s.a)(n,[{key:"render",value:function(){var e=this.state,t=e.visible,n=e.title,i=e.cover,a=e.summary,s=Object(o.jsxs)("div",{className:"profile-container",children:[Object(o.jsxs)("div",{className:"profile-header",children:[Object(o.jsx)(j.a,{className:"profile-header__title",placeholder:"\u8f93\u5165\u6587\u7ae0\u6807\u9898(\u4e0d\u8d85\u8fc764\u4e2a\u5b57)",spellCheck:!1,value:n,onChange:this.onChangeTitle}),Object(o.jsx)(h.a,{icon:Object(o.jsx)(k.a,{}),onClick:this.onToggleVisible})]}),Object(o.jsxs)("div",{className:["profile-bar"].join(" "),children:[Object(o.jsx)("div",{className:"profile-cover",onClick:this.onEditCover,children:i?Object(o.jsx)("img",{src:i}):Object(o.jsxs)("div",{children:[Object(o.jsx)(f.a,{}),Object(o.jsx)("span",{style:{marginLeft:"10px"},children:"\u5c01\u9762\u56fe"})]})}),Object(o.jsx)(re,{placeholder:"\u8f93\u5165\u6458\u8981(\u4e0d\u8d85\u8fc7120\u4e2a\u5b57)",showCount:!0,rows:3,value:a,maxLength:120,onChange:this.onChangeSummary,spellCheck:!1}),Object(o.jsxs)("div",{className:"profile-buttons",children:[Object(o.jsx)(B.a,{className:"profile-button",disabled:!n&&!i&&!a,onClick:this.onSave,children:"\u4fdd\u5b58"}),Object(o.jsx)(B.a,{type:"primary",className:"profile-button",disabled:!n,onClick:this.onSync,children:"\u540c\u6b65"})]})]})]});return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(h.a,{selected:t,wrapClassName:"editor-side-bar-item app-guide-profile",icon:Object(o.jsx)(oe.a,{}),onClick:this.onToggleVisible}),t&&s]})}}]),n}(c.Component),ce=(n(794),function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).onUpdateState=function(){var e=i.props,t=e.editable,n=e.cmdName;if(t){var o=t.queryCommandState(n);i.setState({disabled:-1===o,selected:1===o})}},i.onExeCommand=function(){var e=i.props,t=e.editable,n=e.cmdName;t&&t.execCommand(n)},i.state={disabled:!0,selected:!1},i}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.editable;e&&e.on("selectionchange",this.onUpdateState)}},{key:"componentWillUnmount",value:function(){var e=this.props.editable;e&&e.off("selectionchange",this.onUpdateState)}},{key:"render",value:function(){var e=this.props,t=e.icon,n=e.wrapClassName,i=this.state,a=i.disabled,s=i.selected,r=n?"".concat(n," geui-state-item"):"geui-state-item";return Object(o.jsx)(o.Fragment,{children:Object(o.jsx)(h.a,{wrapClassName:r,disabled:a,selected:s,icon:t,onClick:this.onExeCommand})})}}]),n}(c.Component));function ue(e,t,n){return function(i){Object(r.a)(u,i);var c=Object(l.a)(u);function u(){return Object(a.a)(this,u),c.apply(this,arguments)}return Object(s.a)(u,[{key:"render",value:function(){var i=this.props.editable;return Object(o.jsx)(o.Fragment,{children:!!i&&Object(o.jsx)(ce,{wrapClassName:n,icon:e,cmdName:t,editable:i})})}}]),u}(c.Component)}var de,he=ue(Object(o.jsx)("i",{className:"bei-redo"}),"redo","app-guide-redo"),pe=ue(Object(o.jsx)("i",{className:"bei-undo"}),"undo","app-guide-undo"),fe=(n(795),function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return Object(o.jsx)("div",{className:"beui-seperator"})}}]),n}(c.Component)),ve=n(53),be=n(125),me=n(22),ge=n.n(me),ke=n(38),ye=n(127),_e=n(71),Ce=n(21),xe=n(20);!function(e){e[e.RangeContentsActionClone=0]="RangeContentsActionClone",e[e.RangeContentsActionDelete=1]="RangeContentsActionDelete",e[e.RangeContentsActionExtract=2]="RangeContentsActionExtract"}(de||(de={}));var Ee,Oe=0,Se=function(e,t){var n,i,o=e.startContainer,a=e.endContainer,s=e.startOffset,r=e.endOffset,l=e.document(),c=l.createDocumentFragment();if(o&&1===o.nodeType&&(o=o.childNodes[s]||(n=o.appendChild(l.createTextNode("")))),a&&1===a.nodeType&&(a=a.childNodes[r]||(i=a.appendChild(l.createTextNode("")))),o===a&&o&&3===o.nodeType)return c.appendChild(l.createTextNode(o.substringData(s,r-s))),t&&(o.deleteData(s,r-s),e.collapse(!0)),c;for(var u,d,h=c,p=_e.a.findParents(o,!0),f=_e.a.findParents(a,!0),v=0;p[v]===f[v];)v++;for(var b,m=v;b=p[m];m++){for(u=b.nextSibling,b===o&&o?n||(e.startContainer&&3===e.startContainer.nodeType&&o.nodeValue?(h.appendChild(l.createTextNode(o.nodeValue.slice(s))),t&&o.deleteData(s,o.nodeValue.length-s)):h.appendChild(t?o:o.cloneNode(!0))):(d=b.cloneNode(!1),h.appendChild(d));u&&u!==a&&u!==f[m];)b=u.nextSibling,h.appendChild(t?u:u.cloneNode(!0)),u=b;h=d}h=c,p[v]||(h.appendChild(p[v-1].cloneNode(!1)),h=h.firstChild);for(var g,k=v;g=f[k];k++){if(u=g.previousSibling,g===a?!i&&e.endContainer&&3===e.endContainer.nodeType&&(h.appendChild(l.createTextNode(a.substringData(0,r))),t&&a.deleteData(0,r)):(d=g.cloneNode(!1),h.appendChild(d)),k!==v||!p[v])for(;u&&u!==o;)g=u.previousSibling,h.insertBefore(t?u:u.cloneNode(!0),h.firstChild),u=g;h=d}return t&&e.setStartBefore(f[v]?p[v]?f[v]:p[v-1]:f[v-1]).collapse(!0),n&&_e.a.remove(n),i&&_e.a.remove(i),c},we=function(e,t,n,i){var o=function(e){return e?e.tagName:""}(t);return t&&1===t.nodeType&&(xe.a.$empty[o]||xe.a.$nonChild[o])&&(n=_e.a.getNodeIndex(t)+(e?0:1),t=t.parentNode),e?(i.startContainer=t,i.startOffset=n,i.endContainer||i.collapse(!0)):(i.endContainer=t,i.endOffset=n,i.startContainer||i.collapse(!1)),Te(i),i},Te=function(e){e.collapsed=!!e.startContainer&&!!e.endContainer&&e.startContainer===e.endContainer&&e.startOffset===e.endOffset},je=function(e){return!e.collapsed&&!!e.startContainer&&1===e.startContainer.nodeType&&e.startContainer===e.endContainer&&e.endOffset-e.startOffset===1},Be=function(e,t){try{if(Ee&&_e.a.inDoc(Ee,e))if(Ee.nodeValue&&!Ee.nodeValue.replace(_e.a.fillCharReg,"").length){var n=Ee.parentNode;for(_e.a.remove(Ee);n&&(_e.a.isEmptyInlineElement(n)&&Ce.a.safari?!(_e.a.getPosition(n,t)&_e.a.POSITION_CONTAINS):!n.contains(t));)Ee=n.parentNode,_e.a.remove(n),n=Ee}else Ee.nodeValue&&(Ee.nodeValue=Ee.nodeValue.replace(_e.a.fillCharReg,""))}catch(i){console.log(i)}},Ne=function(e,t){var n;for(e=e[t];e&&_e.a.isFillChar(e);)n=e[t],_e.a.remove(e),e=n},Le=function(){function e(t,n,i){Object(a.a)(this,e),this._document=void 0,this._root=void 0,this._selection=void 0,this.collapsed=void 0,this.startContainer=void 0,this.endContainer=void 0,this.startOffset=void 0,this.endOffset=void 0,this._document=t,this._root=n,this._selection=i,this.collapsed=!0,this.startContainer=this.endContainer=null,this.startOffset=this.endOffset=0}return Object(s.a)(e,[{key:"document",value:function(){return this._document}},{key:"cloneRange",value:function(){return new e(this._document,this._root,this._selection).setStart(this.startContainer,this.startOffset).setEnd(this.endContainer,this.endOffset)}},{key:"cloneContents",value:function(){return this.collapsed?null:Se(this,de.RangeContentsActionClone)}},{key:"deleteContents",value:function(){if(this.collapsed||Se(this,de.RangeContentsActionDelete),Ce.a.webkit){var e=this.startContainer;e&&3===e.nodeType&&!e.nodeValue&&(this.setStartBefore(e).collapse(!0),_e.a.remove(e))}return this}},{key:"extractContents",value:function(){return this.collapsed?null:Se(this,de.RangeContentsActionExtract)}},{key:"setStart",value:function(e,t){return we(!0,e,t,this)}},{key:"setEnd",value:function(e,t){return we(!1,e,t,this)}},{key:"setStartAfter",value:function(e){return e.parentNode?this.setStart(e.parentNode,_e.a.getNodeIndex(e)+1):this}},{key:"setStartBefore",value:function(e){return e.parentNode?this.setStart(e.parentNode,_e.a.getNodeIndex(e)):this}},{key:"setEndAfter",value:function(e){return e.parentNode?this.setEnd(e.parentNode,_e.a.getNodeIndex(e)+1):this}},{key:"setEndBefore",value:function(e){return e.parentNode?this.setEnd(e.parentNode,_e.a.getNodeIndex(e)):this}},{key:"setStartAtFirst",value:function(e){return e.parentNode?this.setStart(e,0):this}},{key:"setStartAtLast",value:function(e){return this.setStart(e,3===e.nodeType?e.nodeValue?e.nodeValue.length:0:e.childNodes.length)}},{key:"setEndAtFirst",value:function(e){return this.setEnd(e,0)}},{key:"setEndAtLast",value:function(e){return this.setEnd(e,3===e.nodeType?e.nodeValue?e.nodeValue.length:0:e.childNodes.length)}},{key:"selectNode",value:function(e){return this.setStartBefore(e).setEndAfter(e)}},{key:"selectNodeContents",value:function(e){return this.setStartAtFirst(e).setEndAtLast(e)}},{key:"getCommonAncestor",value:function(e,t){var n=this.startContainer,i=this.endContainer;return n&&n===i?e&&je(this)&&1===(n=n.childNodes[this.startOffset]).nodeType?n:t&&3===n.nodeType?n.parentNode:n:n&&i?_e.a.getCommonAncestor(n,i):null}},{key:"shrinkBoundaryMinimality",value:function(e){var t,n=this.collapsed;function i(e){return 1===e.nodeType&&!_e.a.isBookmarkNode(e)&&!xe.a.$empty[e.tagName]&&!xe.a.$nonChild[e.tagName]}for(;this.startContainer&&1===this.startContainer.nodeType&&(t=this.startContainer.childNodes[this.startOffset])&&i(t);)this.setStart(t,0);if(n)return this.collapse(!0);if(!e)for(;this.endContainer&&1===this.endContainer.nodeType&&this.endOffset>0&&(t=this.endContainer.childNodes[this.endOffset-1])&&i(t);)this.setEnd(t,t.childNodes.length);return this}},{key:"shrinkBoundarySuitably",value:function(){if(!this.collapsed){for(;this.startContainer&&this.startOffset&&!_e.a.isRoot(this.startContainer)&&this.startOffset===(3===this.startContainer.nodeType?null===(e=this.startContainer.nodeValue)||void 0===e?void 0:e.length:this.startContainer.childNodes.length);){var e;this.setStartAfter(this.startContainer)}for(;!this.endOffset&&this.endContainer&&!_e.a.isRoot(this.endContainer)&&(3===this.endContainer.nodeType?null===(t=this.endContainer.nodeValue)||void 0===t?void 0:t.length:this.endContainer.childNodes.length);){var t;this.setEndBefore(this.endContainer)}}return this}},{key:"txtToElmBoundary",value:function(e){function t(e,t){var n="start"===t,i=n?e.startContainer:e.endContainer,o=n?e.startOffset:e.endOffset,a=n?e.setStartBefore.bind(e):e.setEndBefore.bind(e),s=n?e.setStartAfter.bind(e):e.setEndAfter.bind(e);i&&3===i.nodeType&&(o?i.nodeValue&&o>=i.nodeValue.length&&s(i):a(i))}!e&&this.collapsed||(t(this,"start"),t(this,"end"))}},{key:"trimBoundary",value:function(e){this.txtToElmBoundary();var t=this.startContainer,n=this.startOffset,i=this.collapsed,o=this.endContainer;if(t&&3===t.nodeType){if(0===n)this.setStartBefore(t);else if(t.nodeValue&&n>=t.nodeValue.length)this.setStartAfter(t);else{var a=_e.a.split(t,n);t===o&&a?this.setEnd(a,this.endOffset-n):t.parentNode===o&&(this.endOffset+=1),a&&this.setStartBefore(a)}if(i)return this.collapse(!0)}return e||(n=this.endOffset,(o=this.endContainer)&&3===o.nodeType&&(0===n?this.setEndBefore(o):(o.nodeValue&&n<o.nodeValue.length&&_e.a.split(o,n),this.setEndAfter(o)))),this}},{key:"enlargeBoundary",value:function(e,t){var n,i,o=this._document.createTextNode("");if(e&&this.startContainer){for(1===(i=this.startContainer).nodeType?i.childNodes[this.startOffset]?n=i=i.childNodes[this.startOffset]:(i.appendChild(o),n=i=o):n=i;i;){if(_e.a.isBlockElm(i)){for(i=n;(n=i.previousSibling)&&!_e.a.isBlockElm(n);)i=n;this.setStartBefore(i);break}n=i,i=i.parentNode}for((i=this.endContainer)&&1===i.nodeType?((n=i.childNodes[this.endOffset])?i.insertBefore(o,n):i.appendChild(o),n=i=o):n=i;i;){if(_e.a.isBlockElm(i)){for(i=n;i&&(n=i.nextSibling)&&!_e.a.isBlockElm(n);)i=n;i&&this.setEndAfter(i);break}n=i,i=i.parentNode}o.parentNode===this.endContainer&&this.endOffset--,_e.a.remove(o)}if(!this.collapsed){for(;0===this.startOffset&&this.startContainer&&(!t||!t(this.startContainer))&&!_e.a.isRoot(this.startContainer);)this.setStartBefore(this.startContainer);for(;this.endContainer&&this.endOffset===(3===this.endContainer.nodeType?null===(a=this.endContainer.nodeValue)||void 0===a?void 0:a.length:this.endContainer.childNodes.length);){var a;if(t&&t(this.endContainer))break;if(_e.a.isRoot(this.endContainer))break;this.setEndAfter(this.endContainer)}}return this}},{key:"enlargeToBlockElm",value:function(e){for(;this.startContainer&&!_e.a.isBlockElm(this.startContainer);)this.setStartBefore(this.startContainer);if(!e)for(;this.endContainer&&!_e.a.isBlockElm(this.endContainer);)this.setEndAfter(this.endContainer);return this}},{key:"insertNode",value:function(e){var t=e,n=1;11===e.nodeType&&e.firstChild&&(t=e.firstChild,n=e.childNodes.length),this.trimBoundary(!0);var i=this.startContainer,o=this.startOffset;if(i){var a=i.childNodes[o];a?i.insertBefore(e,a):i.appendChild(e)}return t.parentNode===this.endContainer&&(this.endOffset=this.endOffset+n),this.setStartBefore(t)}},{key:"applyInlineStyle",value:function(e,t,n){if(this.collapsed)return this;this.trimBoundary().enlargeBoundary(!1,(function(e){return 1===e.nodeType&&_e.a.isBlockElm(e)})).shrinkBoundarySuitably();for(var i,o,a,s=this.createBookmark(),r=s.end,l=function(e){return 1===e.nodeType?"br"!==e.tagName.toLowerCase():!_e.a.isWhitespace(e)},c=_e.a.getNextDomNode(s.start,!1,l),u=this.cloneRange();c&&_e.a.getPosition(c,r)&_e.a.POSITION_PRECEDING;)if(3===c.nodeType||xe.a[e][c.tagName]){for(u.setStartBefore(c),i=c;i&&(3===i.nodeType||xe.a[e][i.tagName])&&i!==r;)o=i,i=_e.a.getNextDomNode(i,1===i.nodeType,null,(function(t){return xe.a[e][t.tagName]}));var d=u.setEndAfter(o).extractContents(),h=void 0;if(n&&n.length>0){var p=void 0;a=p=n[0].cloneNode(!1);for(var f,v=1;f=n[v++];)p&&(p.appendChild(f.cloneNode(!1)),p=p.firstChild);h=p}else h=u._document.createElement(e);if(t&&_e.a.setAttributes(h,t),h)if(h.appendChild(d),"SPAN"===h.tagName&&t&&t.style)h.querySelectorAll("span").forEach((function(e){e.style.cssText=e.style.cssText+";"+t.style}));(n&&a||h)&&u.insertNode(n?a:h);var b=void 0;if("span"===e&&t.style&&/text-decoration/.test(t.start)&&(b=_e.a.findParentByTagName(h,"a",!0))?(_e.a.setAttributes(b,t),_e.a.remove(h,!0),h=b):(_e.a.mergeSibling(h),_e.a.clearEmptySibling(h)),_e.a.mergeChild(h,t),_e.a.mergeToParent(h),i===r)break;c=_e.a.getNextDomNode(h,!1,l)}else c=_e.a.getNextDomNode(c,!0,l);return this.moveToBookmark(s)}},{key:"removeInlineStyle",value:function(e){if(this.collapsed)return this;e=Array.isArray(e)?e:[e],this.shrinkBoundaryMinimality().shrinkBoundarySuitably();for(var t=this.startContainer,n=this.endContainer;t;){if(1===t.nodeType)if("break"===function(){var n=t.tagName.toLowerCase();return e.findIndex((function(e){return e.toLowerCase()===n}))>-1?"break":_e.a.isRoot(t)?(t=null,"break"):void 0}())break;t=t.parentNode}for(;n;){if(1===n.nodeType)if("break"===function(){var t=n.tagName.toLowerCase();return e.findIndex((function(e){return e.toLowerCase()===t}))>-1?"break":_e.a.isRoot(n)?(n=null,"break"):void 0}())break;n=n.parentNode}var i,o,a=this.createBookmark();t&&(i=(o=this.cloneRange().setEndBefore(a.start).setStartBefore(t)).extractContents(),o.insertNode(i),_e.a.clearEmptySibling(t,!0),t.parentNode&&t.parentNode.insertBefore(a.start,t)),n&&a.end&&(i=(o=this.cloneRange().setStartAfter(a.end).setEndAfter(n)).extractContents(),o.insertNode(i),_e.a.clearEmptySibling(n,!1,!0),n.parentNode&&n.parentNode.insertBefore(a.end,n.nextSibling));for(var s,r=_e.a.getNextDomNode(a.start,!1,(function(e){return 1===e.nodeType}));r&&r!==a.end;)s=_e.a.getNextDomNode(r,!0,(function(e){return 1===e.nodeType})),e.findIndex((function(e){return e.toLowerCase()===r.tagName.toLowerCase()}))>-1&&_e.a.remove(r,!0),r=s;return this.moveToBookmark(a)}},{key:"applyParagraphStyle",value:function(e,t,n){var i,o=this;if(this.collapsed&&(i=this._document.createTextNode("p"),this.insertNode(i),Ce.a.ie)){var a=i.previousSibling;a&&_e.a.isWhitespace(a)&&_e.a.remove(a),(a=i.nextSibling)&&_e.a.isWhitespace(a)&&_e.a.remove(a)}var s=["TD","LI","PRE"],r=this.createBookmark(),l=function(e){return 1===e.nodeType?"br"!==e.tagName.toLowerCase()&&!_e.a.isBookmarkNode(e):!_e.a.isWhitespace(e)};this.enlargeBoundary(!0);for(var c,u,d=this.createBookmark(),h=_e.a.getNextDomNode(d.start,!1,l),p=this.cloneRange();h&&!(_e.a.getPosition(h,d.end)&_e.a.POSITION_FOLLOWING);)3!==h.nodeType&&_e.a.isBlockElm(h)?h=_e.a.getNextDomNode(h,!0,l):function(){for(p.setStartBefore(h);h&&h!==d.end&&!_e.a.isBlockElm(h);)u=h,h=_e.a.getNextDomNode(h,!1,null,(function(e){return!_e.a.isBlockElm(e)}));p.setEndAfter(u),c=o._document.createElement(e),t&&(_e.a.setAttributes(c,t),n&&t.style&&(c.style.cssText=t.style));var i=p.extractContents();i&&c.appendChild(i),_e.a.isEmptyNode(c)&&_e.a.fillNode(o._document,c),p.insertNode(c);var a=c.parentNode;a&&_e.a.isBlockElm(a)&&!_e.a.isRoot(a)&&-1===s.findIndex((function(e){return e.toLowerCase()===a.tagName}))&&(n||(a.getAttribute("dir")&&c.setAttribute("dir",a.getAttribute("dir")||""),a.style.cssText&&(c.style.cssText=a.style.cssText+";"+c.style.cssText),a.style.textAlign&&!c.style.textAlign&&(c.style.textAlign=a.style.textAlign),a.style.textIndent&&!c.style.textIndent&&(c.style.textIndent=a.style.textIndent),a.style.padding&&!c.style.padding&&(c.style.padding=a.style.padding)),t&&/h\d/i.test(a.tagName)&&!/h\d/i.test(c.tagName)?(_e.a.setAttributes(a,t),t.style&&n&&(a.style.cssText=t.style),_e.a.remove(c,!0),c=a):c.parentNode&&_e.a.remove(c.parentNode,!0)),h=-1!==s.findIndex((function(e){return e.toLowerCase()===a.tagName}))?a:c,h=_e.a.getNextDomNode(h,!1,l)}();if(this.moveToBookmark(d).moveToBookmark(r),i){this.setStartBefore(i).collapse(!0);var f=i.parentNode;_e.a.remove(i),f&&_e.a.isBlockElm(f)&&_e.a.isEmptyNode(f)&&_e.a.fillNode(this._document,f)}if(Ce.a.gecko&&this.collapsed&&this.startContainer&&1===this.startContainer.nodeType){var v=this.startContainer.childNodes[this.startOffset];v&&1===v.nodeType&&v.tagName.toLowerCase()===e.toLowerCase()&&this.setStart(v,0).collapse(!0)}return this}},{key:"applyJustify",value:function(e){var t;this.collapsed&&(t=this._document.createTextNode("p"),this.insertNode(t));var n=this.createBookmark(),i=function(e){return 1===e.nodeType?"br"!==e.tagName.toLowerCase()&&!_e.a.isBookmarkNode(e):!_e.a.isWhitespace(e)};this.enlargeBoundary(!0);for(var o,a=this.createBookmark(),s=_e.a.getNextDomNode(a.start,!1,i),r=this.cloneRange();s&&!(_e.a.getPosition(s,a.end)&_e.a.POSITION_FOLLOWING);)if(3!==s.nodeType&&_e.a.isBlockElm(s))s=_e.a.getNextDomNode(s,!0,i);else{for(r.setStartBefore(s);s&&s!==a.end&&!_e.a.isBlockElm(s);)o=s,s=_e.a.getNextDomNode(s,!1,null,(function(e){return!_e.a.isBlockElm(e)}));r.setEndAfter(o);var l=r.getCommonAncestor();if(l&&!_e.a.isRoot(l)&&_e.a.isBlockElm(l))_e.a.setStyles(l,"string"===typeof e?{"text-align":e}:e),s=l;else{var c=this._document.createElement("p");_e.a.setStyles(c,"string"===typeof e?{"text-align":e}:e);var u=r.extractContents();c.appendChild(u),r.insertNode(c),s=c}s=_e.a.getNextDomNode(s,!1,i)}return this.moveToBookmark(a).moveToBookmark(n),t&&(this.setStartBefore(t).collapse(!0),_e.a.remove(t)),this}},{key:"collapse",value:function(e){return e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset):(this.startContainer=this.endContainer,this.startOffset=this.endOffset),this.collapsed=!0,this}},{key:"getClosedNode",value:function(){var e;if(!this.collapsed){var t=this.cloneRange().shrinkBoundarySuitably().shrinkBoundaryMinimality();if(je(t)&&t.startContainer){var n=t.startContainer.childNodes[t.startOffset];n&&1===n.nodeType&&(xe.a.$empty[n.tagName]||xe.a.$nonChild[n.tagName])&&(e=n)}}return e}},{key:"scrollToView",value:function(e,t){e=e||_e.a.getWindow(this._document);var n=this._document.createElement("span");return n.innerHTML="&nbsp;",this.cloneRange().insertNode(n),_e.a.scrollToView(n,e,t),_e.a.remove(n),this}},{key:"inFillChar",value:function(){var e=this.startContainer;return this.collapsed&&e&&3===e.nodeType&&e.nodeValue&&e.nodeValue.replace(new RegExp("^"+_e.a.fillChar),"").length+1===e.nodeValue.length}},{key:"createBookmark",value:function(e,t){var n=null,i=this._document.createElement("span");return i.style.cssText="display:none;line-height:0px;",i.appendChild(this._document.createTextNode("\u200d")),i.id="_ge_bookmark_start_"+(t?"":Oe++),this.collapsed||((n=i.cloneNode(!0)).id="_ge_bookmark_end_"+(t?"":Oe++)),this.insertNode(i),n&&this.collapse(!1).insertNode(n).setEndBefore(n),this.setStartAfter(i),{start:e?i.id:i,end:n?e?n.id:n:null,id:e}}},{key:"moveToBookmark",value:function(e){var t=this._root.getRootNode(),n=e.id?t.getElementById(e.start):e.start,i=e.end&&e.id?t.getElementById(e.end):e.end;return n&&(this.setStartBefore(n),_e.a.remove(n)),i?(this.setEndBefore(i),_e.a.remove(i)):this.collapse(!0),this}},{key:"createAddress",value:function(e,t){var n=this,i={collapsed:!!this.collapsed,startAddress:[]},o=function(e){for(var i,o=e?n.startContainer:n.endContainer,a=_e.a.findParents(o,!0,(function(e){return!_e.a.isRoot(e)})),s=[],r=0;i=a[r++];)s.push(_e.a.getNodeIndex(i,t));var l=0;if(t&&o){if(3===o.nodeType){for(var c=o.previousSibling;c&&3===c.nodeType;)l+=c.nodeValue?c.nodeValue.replace(_e.a.fillCharReg,"").length:0,c=c.previousSibling;l+=e?n.startOffset:n.endOffset}else if(o=o.childNodes[e?n.startOffset:n.endOffset])l=_e.a.getNodeIndex(o,t);else if(o=e?n.startContainer:n.endContainer)for(var u=o.firstChild;u;)if(_e.a.isFillChar(u))u=u.nextSibling;else if(l++,3===u.nodeType)for(;u&&3===u.nodeType;)u=u.nextSibling;else u=u.nextSibling}else l=e?o&&_e.a.isFillChar(o)?0:n.startOffset:n.endOffset;return l<0&&(l=0),s.push(l),s};return i.startAddress=o(!0),e||(i.endAddress=this.collapsed?Array.from(i.startAddress):o()),i}},{key:"moveToAddress",value:function(e,t){var n=this,i=function(e,t){for(var i,o,a=n._root,s=0,r=0;r<e.length;r++)if(i=a,o=e[r],!(a=a.childNodes[o])){s=o;break}t?a?n.setStartBefore(a):n.setStart(i,s):a?n.setEndAfter(a):n.setEnd(i,s)};return i(e.startAddress,!0),!t&&e.endAddress&&i(e.endAddress),this}},{key:"equals",value:function(e){return this.startContainer===e.startContainer&&this.startOffset===e.startOffset&&this.endContainer===e.endContainer&&this.endOffset===e.endOffset}},{key:"traversal",value:function(e,t){if(this.collapsed)return this;for(var n=this.createBookmark(),i=n.end,o=_e.a.getNextDomNode(n.start,!1,t);o&&i&&o!==i&&_e.a.getPosition(o,i)&_e.a.POSITION_PRECEDING;){var a=_e.a.getNextDomNode(o,!1,t);e(o),o=a}return this.moveToBookmark(n)}},{key:"setCursor",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.collapse(!e).select(t)}},{key:"select",value:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=function(e){var t=function(t,n,i){3===t.nodeType&&t.nodeValue&&t.nodeValue.length<n&&("start"===i?e.startOffset=t.nodeValue.length:e.endOffset=t.nodeValue.length)};e.startContainer&&t(e.startContainer,e.startOffset,"start"),e.endContainer&&t(e.endContainer,e.endOffset,"end")},i=_e.a.getWindow(this._document),o=this._selection;if(Ce.a.gecko?this._document.body.focus():i.focus(),o){if(o.removeAllRanges(),this.collapsed&&!t){var a=this.startContainer,s=a;a&&1===a.nodeType&&(s=a.childNodes[this.startOffset]),!a||3===a.nodeType&&this.startOffset||(s?s.previousSibling&&3===s.previousSibling.nodeType:a.lastChild&&3===a.lastChild.nodeType)||(e=this._document.createTextNode(_e.a.fillChar),this.insertNode(e),Be(this._document,e),Ne(e,"previousSibling"),Ne(e,"nextSibling"),Ee=e,this.setStart(e,Ce.a.webkit?1:0).collapse(!0))}if(this.collapsed&&Ce.a.opera&&this.startContainer&&1===this.startContainer.nodeType){var r=this.startContainer.childNodes[this.startOffset];if(r){for(;r&&_e.a.isBlockElm(r)&&1===r.nodeType&&r.childNodes[0];)r=r.childNodes[0];this.setStartBefore(r).collapse(!0)}else(r=this.startContainer.lastChild)&&_e.a.isBr(r)&&this.setStartBefore(r).collapse(!0)}n(this),o.addRange(this)}return this}},{key:"getBoundingClientRect",value:function(){var e=document.createRange();return e.setStart(this.startContainer,this.startOffset),e.setEnd(this.endContainer,this.endOffset),e.getBoundingClientRect()}}]),e}(),Ie=function(){function e(t,n,i){Object(a.a)(this,e),this._document=void 0,this._root=void 0,this._nativeSelection=void 0,this._ranges=void 0,this._cachedRange=void 0,this._cachedStartElement=void 0,this._cachedStartElementPath=void 0,this._bakRange=void 0,this.commandBackground="backColor",this.commandRemoveFormat="removeFormat",this._isFakeBackgroundEnabled=void 0,this._document=t,this._root=n,this._nativeSelection=i||t.getSelection(),this._ranges=[],this._cachedRange=null}return Object(s.a)(e,[{key:"getCacheNativeRange",value:function(){if(this._cachedRange)return this._cachedRange;var e=this.getNativeRange();return this._bakRange=this._ranges[0]=e}},{key:"getNativeRange",value:function(){var e=this,t=function(t){for(var n=e._root.firstChild,i=t.collapsed;n&&n.firstChild;)t.setStart(n,0),n=n.firstChild;t.startContainer||t.setStart(e._root,0),i&&t.collapse(!0)},n=new Le(this._document,this._root,this);if(Ce.a.ie9below);else{var i=this._nativeSelection;if(i&&i.rangeCount){var o=i.getRangeAt(0),a=i.getRangeAt(i.rangeCount-1);n.setStart(o.startContainer,o.startOffset).setEnd(a.endContainer,a.endOffset),n.collapsed&&n.startContainer&&_e.a.isRoot(n.startContainer)&&!n.startOffset&&t(n)}else{if(this._bakRange&&this._bakRange.startContainer&&_e.a.inDoc(this._bakRange.startContainer,this._root))return this._bakRange;t(n)}}return n}},{key:"cache",value:function(){this.clearCache(),this._cachedRange=this.getNativeRange(),this._cachedStartElement=this.getStart(),this._cachedStartElementPath=this.getStartElementPath()}},{key:"restore",value:function(){this._cachedRange&&this._cachedRange.select(!0)}},{key:"clearCache",value:function(){this._cachedRange=this._cachedStartElement=this._cachedStartElementPath=null}},{key:"cachedRange",value:function(){return this._cachedRange}},{key:"cachedStartElement",value:function(){return this._cachedStartElement}},{key:"getStart",value:function(){if(this._cachedStartElement)return this._cachedStartElement;var e=this.getNativeRange();e.shrinkBoundaryMinimality();var t=e.startContainer;return t&&1===t.nodeType&&t.hasChildNodes()&&(t=t.childNodes[Math.min(t.childNodes.length-1,e.startOffset)]),t&&3===t.nodeType?t.parentNode:t}},{key:"getStartElementPath",value:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var e=this.getStart();return e?_e.a.findParents(e,!0,null,!0):[]}},{key:"getRangeAt",value:function(e){return this.getCacheNativeRange()}},{key:"addRange",value:function(e){var t,n=this._document.createRange();e.startContainer&&n.setStart(e.startContainer,e.startOffset),e.endContainer&&n.setEnd(e.endContainer,e.endOffset),null===(t=this._nativeSelection)||void 0===t||t.addRange(n)}},{key:"removeAllRanges",value:function(){this.clearCache(),this._nativeSelection&&this._nativeSelection.removeAllRanges(),this._ranges=[]}},{key:"setCursor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.getRangeAt(0);if(_e.a.isNativeInput(e)){if(!_e.a.canSetCursor(e))return;return e.focus(),e.selectionStart=e.selectionEnd=t,e.getBoundingClientRect()}return n.setStart(e,t).collapse(!0),n.setCursor(!0,!0),n.getBoundingClientRect()}},{key:"select",value:function(e){var t=this.getRangeAt(0);return t.selectNode(e).select(!0),t.getBoundingClientRect()}},{key:"isCollapsed",get:function(){return this.getRangeAt(0).collapsed}},{key:"rangeCount",get:function(){var e;return null===(e=this._nativeSelection)||void 0===e?void 0:e.rangeCount}},{key:"exists",get:function(){var e=this._nativeSelection;return!!e&&!!e.anchorNode}},{key:"anchorNode",get:function(){var e;return null===(e=this._nativeSelection)||void 0===e?void 0:e.anchorNode}},{key:"focusNode",get:function(){var e;return null===(e=this._nativeSelection)||void 0===e?void 0:e.focusNode}},{key:"anchorElement",get:function(){var e=this.anchorNode;return e?1!==e.nodeType?e.parentElement:e:null}},{key:"focusOffset",get:function(){var e;return null===(e=this._nativeSelection)||void 0===e?void 0:e.focusOffset}},{key:"rangeRect",get:function(){var e,t=this._nativeSelection,n={x:0,y:0,width:0,height:0};if(void 0===this.rangeCount)return n;if(0===t.rangeCount)return n;if((e=this.getRangeAt(0).cloneRange()).getBoundingClientRect&&(n=e.getBoundingClientRect()),0===n.x&&0===n.y){var i=document.createElement("span");if(i.getBoundingClientRect){i.appendChild(document.createTextNode("\u200b")),e.insertNode(i),n=i.getBoundingClientRect();var o=i.parentNode;o&&(o.removeChild(i),o.normalize())}}return n}},{key:"textContent",get:function(){var e;return(null===(e=this._nativeSelection)||void 0===e?void 0:e.toString())||""}}]),e}(),Ae={table:1,tbody:1,tr:1,ol:1,ul:1};function Re(e){return e?((3===e.nodeType?e.nodeValue:e.textContent)||"").replace(_e.a.fillCharReg,""):""}function Me(e,t,n){var i=t.searchKey,o=new RegExp(i,"g"+(t.caseSensitive?"":"i"));if(-1===t.dir){e=(e=e.substr(0,n)).split("").reverse().join(""),i=i.split("").reverse().join("");var a=o.exec(e);if(a)return n-a.index-i.length}else{e=e.substr(n);var s=o.exec(e);if(s)return s.index+n}return-1}function De(e,t,n){for(var i,o=0,a=e.firstChild,s=0;a;){if(3==a.nodeType){if((o+=s=Re(a).replace(/(^[\t\r\n]+)|([\t\r\n]+$)/,"").length)>=t)return{node:a,index:s-(o-t)}}else if(!xe.a.$empty[a.nodeName]&&(o+=s=Re(a).replace(/(^[\t\r\n]+)|([\t\r\n]+$)/,"").length)>=t&&(i=De(a,s-(o-t),n)))return i;a=_e.a.getNextDomNode(a)}}function He(e,t,n){n=n||e.selection.getRangeAt(0).cloneRange();var i,o=t.searchKey,a=e.document.createElement("span");a.innerHTML="$$searchreplace_key$$",n.shrinkBoundaryMinimality(!0),n.insertNode(a),n.enlargeToBlockElm(!0);var s=Re(i=n.startContainer).indexOf("$$searchreplace_key$$");n.setStartBefore(a),_e.a.remove(a);var r=i&&function(e,t,n){var i,o=n.all||1==n.dir?_e.a.getNextDomNode:_e.a.getPreDomNode;for(_e.a.isRoot(e)&&(e=e.firstChild);e;){if(-1!=(i=Me(Re(e),n,t)))return{node:e,index:i};for(e=o(e);e&&Ae[e.nodeName.toLowerCase()];)e=o(e,!0);e&&(t=-1==n.dir?Re(e).length:0)}}(i,s,t);if(r){var l=De(r.node,r.index,o),c=De(r.node,r.index+o.length,o);return l&&n.setStart(l.node,l.index),c&&n.setEnd(c.node,c.index),void 0!==t.replaceKey&&t.replace&&Pe(e,n,t.replaceKey),!0}}function Pe(e,t,n){var i=e.document.createTextNode(n);t.deleteContents().insertNode(i)}var Fe=function(){function e(t){var n=this,i=t.editor;Object(a.a)(this,e),this._resultList=[],this._currentIndex=0,this._editor=void 0,this._canvas=void 0,this._holder=void 0,this._editor=i,this._editor.ready((function(){n.makeHighlightCanvas()}))}return Object(s.a)(e,[{key:"search",value:function(e){return this._editor.trigger("beforesearch"),this._resultList=this.doSearch(e),this._editor.trigger("aftersearch"),this._currentIndex=0,this.update()}},{key:"replace",value:function(e){if(e.replaceKey&&this._resultList.length)if(e.all)e.replace=!0,this.doReplace(e),this._resultList=[],this._currentIndex=0;else{this._currentIndex=this._currentIndex%this._resultList.length;var t=this._resultList[this._currentIndex];Pe(this._editor,t,e.replaceKey),e.all=!0,this._resultList=this.doSearch(e),this._currentIndex=this._currentIndex%this._resultList.length}return this.update()}},{key:"jumpNext",value:function(){var e=this._currentIndex%this._resultList.length;return this._currentIndex=++this._currentIndex%this._resultList.length,this.update(e)}},{key:"jumpPrev",value:function(){var e=this._currentIndex%this._resultList.length;return this._currentIndex=(--this._currentIndex+this._resultList.length)%this._resultList.length,this.update(e)}},{key:"jumpIndex",value:function(e){if(e<0||e>=this._resultList.length)return{index:this._currentIndex,list:this._resultList};var t=this._currentIndex%this._resultList.length;return this._currentIndex=e,this.update(t)}},{key:"clear",value:function(){return this._resultList=[],this._currentIndex=0,this.update()}},{key:"update",value:function(e){var t=this._editor.holder.getBoundingClientRect(),n=t.top,i=t.left;function o(e,t,o,a){e.fillStyle=o;for(var s,r=0;s=t[r];r++){var l=s.left-i,c=s.top-n;a&&e.clearRect(l,c,s.width,s.height),e.fillRect(l,c,s.width,s.height)}}var a=this._editor.document.createRange(),s=this._canvas.getContext("2d");if(s){if(e){var r=this._resultList[e];a.setStart(r.startContainer,r.startOffset),a.setEnd(r.endContainer,r.endOffset);var l=a.getClientRects();o(s,l,"rgba(244,206,94,0.3)",!0),r=this._resultList[this._currentIndex],a.setStart(r.startContainer,r.startOffset),a.setEnd(r.endContainer,r.endOffset),o(s,l=a.getClientRects(),"rgba(166,210,252,0.3)",!0)}else{this._canvas.height=this._holder.offsetHeight,this._canvas.width=this._holder.offsetWidth,s.clearRect(0,0,this._canvas.width,this._canvas.height);for(var c,u=0;c=this._resultList[u];u++){a.setStart(c.startContainer,c.startOffset),a.setEnd(c.endContainer,c.endOffset),o(s,a.getClientRects(),u===this._currentIndex?"rgba(166,210,252,0.3)":"rgba(244,206,94,0.3)")}}if(this._resultList.length){var d=this._resultList[this._currentIndex],h=_e.a.findParent(d.startContainer,(function(e){return 1==e.nodeType}),!0);h&&h.scrollIntoView({block:"center",behavior:"smooth"})}return{list:this._resultList,index:this._currentIndex}}}},{key:"doSearch",value:function(e){return e.replace=!1,this.searchReplace(e)}},{key:"doReplace",value:function(e){return e.replace=!0,this.searchReplace(e)}},{key:"searchReplace",value:function(e){var t=this._editor.selection.getRangeAt(0).cloneRange(),n=this._editor.holder.firstChild;n&&1==n.nodeType?(t.setStart(n,0),t.shrinkBoundaryMinimality(!0)):n&&3==n.nodeType&&t.setStartBefore(n),t.collapse(!0);for(var i=[];He(this._editor,e,t)&&(i.push(t.cloneRange()),e.all);)t.collapse(!1);return i}},{key:"makeHighlightCanvas",value:function(){var e=this._editor.holder.parentNode;if(e){var t=this._editor.document.createElement("div");t.setAttribute("id","search-highlight"),t.setAttribute("class","search-highlight"),t.style.cssText="position: absolute;pointer-events: none;top: 0;bottom: 0;right: 0;left: 0",e.appendChild(t),this._holder=t;var n=this._editor.document.createElement("canvas");n.style.maxWidth="100%",t.appendChild(n),this._canvas=n}}}]),e}(),qe=n(128),ze=function(){function e(){Object(a.a)(this,e),this.listeners=void 0}return Object(s.a)(e,[{key:"getListener",value:function(e){return this.listeners=this.listeners||{},this.listeners[e]||(this.listeners[e]=[])}},{key:"on",value:function(e,t){"string"===typeof e&&(e=e.trim().split(/\s+/));var n,i=Object(qe.a)(e);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=this.getListener(o);-1===a.findIndex((function(e){return e===t}))&&a.push(t)}}catch(s){i.e(s)}finally{i.f()}}},{key:"off",value:function(e,t){"string"===typeof e&&(e=e.trim().split(/\s+/));var n,i=Object(qe.a)(e);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=this.getListener(o),s=a.findIndex((function(e){return e===t}));-1!==s&&a.splice(s,1)}}catch(r){i.e(r)}finally{i.f()}}},{key:"trigger",value:function(e){var t=this;"string"===typeof e&&(e=e.trim().split(/\s+/));for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];var a,s=Object(qe.a)(e);try{var r=function(){var e=a.value,n=t.getListener(e),o=[e].concat(i);n.forEach((function(e){e.apply(t,o)}))};for(s.s();!(a=s.n()).done;)r()}catch(l){s.e(l)}finally{s.f()}}}]),e}();var Ve,Ue=function(){function e(){Object(a.a)(this,e),this.commands=void 0}return Object(s.a)(e,[{key:"registerCommand",value:function(e){var t=this;return"function"===typeof e&&(e=e.apply(this)),!!e&&(this.commands=this.commands||{},Array.isArray(e)||(e=[e]),e.forEach((function(e){t.commands[e.cmdName.toLowerCase()]=e,e.defaultOptions})),!0)}},{key:"command",value:function(e){return this.commands[e]}},{key:"execCommand",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(e)return this.callCmdFn("execCommand",arguments)}},{key:"queryCommandValue",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return this.callCmdFn("queryCommandValue",arguments)}},{key:"queryCommandState",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return this.callCmdFn("queryCommandState",arguments)}},{key:"queryCommandEnabled",value:function(e){return this.callCmdFn("queryCommandEnabled",arguments)}},{key:"queryCommandSupported",value:function(e){return!!this.commands[e]}},{key:"callCmdFn",value:function(e,t){var n=t[0].toLowerCase(),i=this.commands[n],o=i&&i[e];return t[0]=n,!!(i&&o||"queryCommandState"!==e)&&(o?o.apply(this,t):void 0)}}]),e}(),We=function(){function e(){Object(a.a)(this,e),this.commands=void 0,this.listeners=void 0}return Object(s.a)(e,[{key:"registerCommand",value:function(e){return!1}},{key:"command",value:function(e){}},{key:"execCommand",value:function(e){return!1}},{key:"queryCommandValue",value:function(e){}},{key:"queryCommandState",value:function(e){return 0}},{key:"queryCommandEnabled",value:function(e){return!1}},{key:"queryCommandSupported",value:function(e){return!1}},{key:"callCmdFn",value:function(e,t){}},{key:"getListener",value:function(e){return[]}},{key:"on",value:function(e,t){}},{key:"off",value:function(e,t){}},{key:"trigger",value:function(e){}}]),e}();Ve=We,[Ue,ze].forEach((function(e){Object.getOwnPropertyNames(e.prototype).forEach((function(t){Ve.prototype[t]=e.prototype[t]}))}));var Ke={Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Alt:18,CapsLock:20,Esc:27,Spacebar:32,PageUp:33,PageDown:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Insert:45,Del:46,NumLock:144,Cmd:91,"=":187,"-":189,".":190,",":188,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90},$e=["b","s","i","mark","u","code","sup","sub","mark"],Xe=function(e,t,n){return{cmdName:e,execCommand:function(e){var n=this,i=n.selection.getRangeAt(0),o=n.$dom.filterNodeList(n.selection.getStartElementPath(),t);if(i.collapsed){if(o){var a=i.document().createTextNode("");i.insertNode(a).removeInlineStyle(t),i.setStartBefore(a),n.$dom.remove(a)}else{if("sup"===e||"sub"===e){var s=n.document.createTextNode("");i.insertNode(s).removeInlineStyle($e).setStartBefore(s).collapse(!0)}var r=i.document().createElement(t[0]);i.insertNode(r).setStart(r,0)}i.collapse(!0)}else"sup"!==e&&"sub"!==e||o&&o.tagName.toLowerCase()===e||i.removeInlineStyle(["sub","sup"]),o?i.removeInlineStyle(t):i.applyInlineStyle(t[0]);i.select(!1)},queryCommandState:function(){return this.$dom.filterNodeList(this.selection.getStartElementPath(),t)?1:0},shortcutKeys:n}},Ge=Xe("bold",["strong","b"],{"Ctrl+B":{}}),Ye=Xe("italic",["em","i"],{"Ctrl+I":{}}),Ze=Xe("subscript",["sub"],{"Ctrl+Shift+,":{}}),Je=Xe("superscript",["sup"],{"Ctrl+Shift+.":{}}),Qe=Xe("underline",["u"],{"Ctrl+U":{}}),et=Xe("strikethrough",["del","s","strike"],{"Ctrl+S":{}}),tt=Xe("mark",["mark"],{"Ctrl+M":{}}),nt=Xe("inlinecode",["code"],{"Ctrl+E":{}}),it={cmdName:"indent",execCommand:function(e){var t=this.queryCommandState(e)?"0em":"2em";return this.selection.getRangeAt(0).applyParagraphStyle("p",{style:"text-indent:"+t}).select(),!0},queryCommandState:function(){var e=this.$dom.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return e&&e.style.textIndent&&parseInt(e.style.textIndent)?1:0}},ot={cmdName:"lineheight",execCommand:function(e,t){return this.selection.getRangeAt(0).applyParagraphStyle("p",{style:"line-height:"+("1"===t?"normal":t+"em")}).select(),!0},queryCommandValue:function(){var e=this,t=this,n=t.$dom.filterNodeList(t.selection.getStartElementPath(),(function(t){return e.$dom.isBlockElm(t)}));if(n){var i=t.$dom.getComputedStyle(n,"line-height");return i="normal"===i?"1":i.indexOf("px")>=0&&n.parentNode?Math.round(parseFloat(i.replace(/[^\d.]*/gi,""))/parseFloat(this.$dom.getComputedStyle(n.parentNode,"font-size"))*10)/10+"":i.replace(/[^\d.]*/gi,"")}}},at={cmdName:"rowspacing",execCommand:function(e,t,n){return this.selection.getRangeAt(0).applyParagraphStyle("p",{style:"margin-"+n+":"+t+"px"}).select(),!0},queryCommandValue:function(e,t){var n=this,i=this,o=i.$dom.filterNodeList(i.selection.getStartElementPath(),(function(e){return n.$dom.isBlockElm(e)}));if(o){var a=i.$dom.getComputedStyle(o,"margin-"+t).replace(/[^\d]/g,"");return a?parseFloat(a):0}return 0}},st={left:1,right:1,center:1,justify:1},rt={cmdName:"justify",execCommand:function(e,t){return this.selection.getRangeAt(0).applyJustify(t).select(),!0},queryCommandValue:function(){var e=this.selection.getStart(),t=this.$dom.getComputedStyle(e,"text-align");return st[t]?t:"left"},queryCommandState:function(){return 0}},lt=_e.a,ct={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",fontborder:"border"},ut={fontborder:1},dt={forecolor:1,backcolor:1,fontsize:1,fontfamily:1},ht={fontborder:"1px solid #000"},pt=function(e,t,n){var i,o=e.createBookmark();if(e.collapsed)for(i=o.start.parentNode;i&&xe.a.$inline[i.tagName];)i=i.parentNode;else i=lt.getCommonAncestor(o.start,o.end);lt.getElementsByTagName(i,"span").forEach((function(e){if(e.parentNode&&!lt.isBookmarkNode(e))if(/\s*border\s*:\s*none;?\s*/i.test(e.style.cssText))/^\s*border\s*:\s*none;?\s*$/.test(e.style.cssText)?lt.remove(e,!0):lt.removeStyle(e,"border");else{if(/border/i.test(e.style.cssText)&&"SPAN"===e.parentNode.tagName&&/border/i.test(e.parentNode.style.cssText)&&(e.style.cssText=e.style.cssText.replace(/border[^:]*:[^;]+;?/gi,"")),"fontborder"!==t||"none"!==n)for(var i=e.nextSibling;i&&1===i.nodeType&&"SPAN"===i.tagName;)if(lt.isBookmarkNode(i)&&"fontborder"===t)e.appendChild(i),i=e.nextSibling;else{if(i.style.cssText===e.style.cssText&&(lt.moveChild(i,e),lt.remove(i)),e.nextSibling===i)break;i=e.nextSibling}if(function(e){for(var t;(t=e.parentNode)&&"SPAN"===t.tagName&&1===lt.getChildCount(t,(function(e){return!lt.isBookmarkNode(e)&&!lt.isBr(e)}));)t.style.cssText+=e.style.cssText,lt.remove(e,!0),e=t}(e),Ce.a.ie&&Ce.a.version>8){var o=lt.findParent(e,(function(e){return"SPAN"===e.tagName&&/background-color/.test(e.style.cssText)}));o&&!/background-color/.test(e.style.cssText)&&(e.style.backgroundColor=o.style.backgroundColor)}}})),e.moveToBookmark(o),function(e,t,n){if(dt[t]&&(e.shrinkBoundarySuitably(),!e.collapsed&&e.startContainer&&1===e.startContainer.nodeType)){var i=e.startContainer.childNodes[e.startOffset];if(i&&lt.isTagNode(i,"span")){var o=e.createBookmark();lt.getElementsByTagName(i,"span").forEach((function(e){e.parentNode&&!lt.isBookmarkNode(e)&&("backcolor"===t&&lt.getComputedStyle(e,"background-color").toLowerCase()===n||(lt.removeStyle(e,ct[t]),0===e.style.cssText.replace(/^\s+$/,"").length&&lt.remove(e,!0)))})),e.moveToBookmark(o)}}}(e,t,n)},ft=function(e){var t=ct[e];return{cmdName:e,execCommand:function(e,n){var i,o=this,a=o.selection.getRangeAt(0);if("default"===(n=n||(o.queryCommandState(e)?"none":ht[e])))a.collapsed&&(i=o.document.createTextNode("font"),a.insertNode(i).select()),o.execCommand("removeformat","span a",t),i&&(a.setStartBefore(i).collapse(!0),lt.remove(i)),a.select();else if(a.collapsed){var s=lt.findParentByTagName(a.startContainer,"span",!0);if(i=o.document.createTextNode("font"),!s||s.children.length||(s[Ce.a.ie?"innerText":"textContent"]||"").replace(lt.fillCharReg,"").length){if(a.insertNode(i),a.selectNode(i).select(),s=o.document.createElement("span"),dt[e]){if(lt.findParentByTagName(i,"a",!0))return a.setStartBefore(i).setCursor(),void lt.remove(i);o.execCommand("removeformat","span a",t)}if(s.style.cssText=t+":"+n,i.parentNode&&i.parentNode.insertBefore(s,i),!Ce.a.ie||Ce.a.ie&&9===Ce.a.version)for(var r=s.parentNode;r&&!lt.isBlockElm(r);)"SPAN"===r.tagName&&(s.style.cssText=r.style.cssText+";"+s.style.cssText),r=r.parentNode;Ce.a.opera?setTimeout((function(){a.setStart(s,0).collapse(!0),pt(a,e,n),a.select()})):(a.setStart(s,0).collapse(!0),pt(a,e,n),a.select())}else a.insertNode(i),ut[e]&&(a.selectNode(i).select(),o.execCommand("removeformat","span a",t),s=lt.findParentByTagName(i,"span",!0),a.setStartBefore(i)),s&&(s.style.cssText+=";"+t+":"+n),a.collapse(!0).select();lt.remove(i)}else ut[e]&&o.queryCommandValue(e)&&o.execCommand("removeformat","span a",t),(a=o.selection.getRangeAt(0)).applyInlineStyle("span",{style:t+":"+n}),pt(a,e,n),a.select();return!0},queryCommandValue:function(e){var n=this.selection.getStart();if("fontborder"===e)for(var i,o=n;o&&xe.a.$inline[o.tagName];){if((i=lt.getComputedStyle(o,"border"))&&/1px/.test(i)&&/solid/.test(i))return i;o=o.parentNode}else if("fontsize"===e){var a=lt.getComputedStyle(n,t),s=/^([\d\.]+)(\w+)$/.exec(a);return s?Math.floor(parseFloat(s[1]))+s[2]:a}return lt.getComputedStyle(n,t)},queryCommandState:function(e){if(!dt[e])return 0;var t=this.queryCommandValue(e);return"fontborder"===e&&/1px/.test(t)&&/solid/.test(t)?1:0}}},vt={bold:Ge,italic:Ye,subscript:Ze,supscript:Je,underline:Qe,strikethrough:et,mark:tt,code:nt,indent:it,letterspacing:{cmdName:"letterspacing",execCommand:function(e,t){return this.selection.getRangeAt(0).applyParagraphStyle("p",{style:"letter-spacing:"+t+"px"}).select(),!0},queryCommandValue:function(){var e=this,t=e.$dom.filterNodeList(e.selection.getStartElementPath(),(function(t){return e.$dom.isBlockElm(t)}));if(t)return e.$dom.getComputedStyle(t,"letter-spacing").replace(/[^\d.]*/gi,"")}},lineheight:ot,rowspacing:at,justify:rt,fontcolor:ft("fontcolor"),backcolor:ft("backcolor"),fontsize:ft("fontsize"),fontfamily:ft("fontfamily"),fontborder:ft("fontborder")};function bt(e,t){if(e===t)return!0;if(!e||!t)return!1;if(e.length!==t.length)return!0;for(var n=0,i=e.length;n<i;n++)if(e[n]!==t[n])return!1;return!0}var mt={16:1,17:1,18:1,37:1,38:1,39:1,40:1},gt=function(){function e(t){var n=this;Object(a.a)(this,e),this._list=void 0,this._index=void 0,this._canUndo=void 0,this._canRedo=void 0,this._editable=void 0,this._maxStackCount=void 0,this._maxInputCount=void 0,this._keyCount=void 0,this._compositing=void 0,this._isCollapsed=void 0,this._saveFn=void 0,this._mutationObserver=void 0,this._editable=t.editable,this._maxStackCount=t.maxStackCount||20,this._maxInputCount=t.maxInputCount||20,this._keyCount=0,this._compositing=!1,this._isCollapsed=!0,this._saveFn=Object(R.a)(this.save,200),this._mutationObserver=new MutationObserver((function(){n._saveFn(!0)})),this.reset(),this.bindEvents()}return Object(s.a)(e,[{key:"bindEvents",value:function(){var e=this,t=this._editable;t.on("compositionstart",(function(){e._compositing=!0})),t.on("compositionend",(function(){e._compositing=!1,e._saveFn(!1)})),t.on("keydown",(function(n,i){var o=i.keyCode||i.which;if(!mt[o]&&!i.ctrlKey&&!i.metaKey&&!i.shiftKey&&!i.altKey){if(e._compositing)return;if(!t.selection.getRangeAt(0).collapsed)return e._saveFn(!0),void(e._isCollapsed=!1);0===e._list.length&&e.save(!0),e._saveFn(!0),e._keyCount++,e._keyCount>=e._maxInputCount&&e.save(!0)}})),t.on("keyup",(function(t,n){var i=n.keyCode||n.which;if(!mt[i]&&!n.ctrlKey&&!n.metaKey&&!n.shiftKey&&!n.altKey){if(e._compositing)return;e._isCollapsed||(e.save(!0),e._isCollapsed=!0)}})),t.on("mouseup",(function(t,n){e.save(!0)})),t.on("beforeexeccommand",(function(t,n){e.saveForCmd(n)})),t.on("afterexeccommand",(function(t,n){e.saveForCmd(n)})),t.on("saveScence",(function(t){e.save(!0)})),t.ready((function(){e._mutationObserver.observe(t.holder,{childList:!0,subtree:!0,characterData:!0,attributes:!0})}))}},{key:"saveForCmd",value:function(e){var t=this._editable.command(e);t&&!t.notNeedUndo&&this.save(!0)}},{key:"undo",value:function(){if(this._canUndo){if(!this._list[this._index-1]&&1==this._list.length)return void this.reset();for(;this._list[this._index].content===this._list[this._index-1].content;)if(this._index--,0===this._index)return this.restore(0);this.restore(--this._index)}}},{key:"redo",value:function(){if(this._canRedo){for(;this._list[this._index].content===this._list[this._index+1].content;)if(this._index++,this._index===this._list.length-1)return this.restore(this._index);this.restore(++this._index)}}},{key:"restore",value:function(e){var t=this._editable,n=this._list[e];t.setScene(n.content);try{var i=new Le(t.document,t.holder,t.selection).moveToAddress(n.address);i.select(!!i.startContainer)}catch(o){}this.update(),this.clearKey()}},{key:"getScene",value:function(){var e=this._editable;return{address:e.selection.getRangeAt(0).createAddress(!1,!0),content:e.getScene()}}},{key:"save",value:function(e){var t,n,i=this._editable,o=this.getScene(),a=this._list[this._index];(a&&a.content!==o.content&&i.trigger("contentchange"),!a||a.content!==o.content||e&&(t=a.address,n=o.address,t.collapsed!==n.collapsed||!bt(t.startAddress,n.startAddress)||!bt(t.endAddress,n.endAddress)))&&(this._list=this._list.slice(0,this._index+1),this._list.push(o),this._list.length>this._maxStackCount&&this._list.shift(),this._index=this._list.length-1,this.update(),this.clearKey())}},{key:"update",value:function(){this._canRedo=!!this._list[this._index+1],this._canUndo=!!this._list[this._index-1]}},{key:"reset",value:function(){this._list=[],this._index=0,this._canRedo=!1,this._canUndo=!1}},{key:"clearKey",value:function(){this._keyCount=0}},{key:"canUndo",value:function(){return this._canUndo}},{key:"canRedo",value:function(){return this._canRedo}}]),e}();var kt={stack:function(){var e=new gt({editable:this,maxStackCount:20}),t=[];return t.push({cmdName:"undo",notNeedUndo:!0,execCommand:function(t){e.undo()},queryCommandState:function(){return e.canUndo()?0:-1},shortcutKeys:{"Ctrl+Z":{}}}),t.push({cmdName:"redo",notNeedUndo:!0,execCommand:function(t){e.redo()},queryCommandState:function(){return e.canRedo()?0:-1},shortcutKeys:{"Ctrl+Shift+Z":{}}}),t}},yt=n(114);var _t={link:function(){var e=this,t=e.$dom;function n(e){var n=e.startContainer,i=e.endContainer;(n=t.findParentByTagName(n,"a",!0))&&e.setStartBefore(n),(i=t.findParentByTagName(i,"a",!0))&&e.setEndAfter(i)}function i(i,o){var a=i.cloneRange(),s=e.queryCommandValue("link");n.call(this,i=i.shrinkBoundarySuitably());var r=i.startContainer;if(r&&1===r.nodeType&&s&&(r=r.childNodes[i.startOffset])&&1===r.nodeType&&"A"===r.tagName&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(r.textContent||"")&&(r.textContent=Object(yt.b)(o.textValue||o.href)),a.collapsed&&!s||(i.removeInlineStyle("a"),a=i.cloneRange()),a.collapsed){var l,c=i.document().createElement("a");o.textValue?(l=Object(yt.b)(o.textValue),delete o.textValue):l=Object(yt.b)(o.href),t.setAttributes(c,o),(r=t.findParentByTagName(a.startContainer,"a",!0))&&t.isInNodeEndBoundary(a,r)&&i.setStartAfter(r).collapse(!0),c.textContent=l,i.insertNode(c).selectNode(c)}else i.applyInlineStyle("a",o)}return e.$env,[{cmdName:"link",execCommand:function(e,t){this.$util;var n=this.selection.getRangeAt(0);t.href&&(t.href=Object(yt.c)(t.href,/[<">]/g)),t.textValue&&(t.textValue=Object(yt.c)(t.textValue,/[<">]/g)),i.call(this,n,t),n.collapse().select(!0)},queryCommandValue:function(){var e=this.$dom,t=this.selection.getRangeAt(0);if(!t.collapsed){t.shrinkBoundaryMinimality();var n=3!==t.startContainer.nodeType&&t.startContainer.childNodes[t.startOffset]?t.startContainer[t.startOffset]:t.startContainer,i=3===t.endContainer.nodeType||0===t.endOffset?t.endContainer:t.endContainer.childNodes[t.endOffset-1],o=t.getCommonAncestor(),a=e.findParentByTagName(o,"a",!0);if(!a&&1===o.nodeType)for(var s,r,l,c=o.getElementsByTagName("a"),u=0;l=c[u++];)if(s=e.getPosition(l,n),r=e.getPosition(l,i),(s&e.POSITION_FOLLOWING||s&e.POSITION_CONTAINS)&&(r&e.POSITION_PRECEDING||r&e.POSITION_CONTAINS)){a=l;break}return a}var d=t.startContainer;if((d=1===d.nodeType?d:d.parentNode)&&(d=e.findParentByTagName(d,"a",!0))&&!e.isInNodeEndBoundary(t,d))return d},queryCommandState:function(){return 0},shortcutKeys:{"Ctrl+K":{}}},{cmdName:"unlink",execCommand:function(){var e=this.selection.getRangeAt(0),t=this.$dom;if(!e.collapsed||t.findParentByTagName(e.startContainer,"a",!0)){var i=e.createBookmark();n.call(this,e),e.removeInlineStyle("a").moveToBookmark(i).select()}},queryCommandState:function(){return this.queryCommandValue("link")?0:-1}}]}},Ct=function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];e.registerCommand(i)}};var xt=function(){function e(t){var n=t.editor;Object(a.a)(this,e),this._editor=void 0,this._catalogID=void 0,this._editor=n,this._catalogID=Date.now()}return Object(s.a)(e,[{key:"getCatalogDatas",value:function(){var e=Object(ke.a)(ge.a.mark((function e(){var t,n,i=this;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._editor.holder.querySelectorAll("h1,h2,h3,h4,h5,h6"),n=Array.from(t).map((function(e){var t=e.textContent||"",n=parseInt(e.tagName.replace(/[^\d]*/,"")),o=e;return o.dataset.id||(o.dataset.id="".concat(i._catalogID++)),{title:t,level:n,el:o}})),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"jumpTo",value:function(e){e.el&&e.el.scrollIntoView()}},{key:"insertAfter",value:function(e,t){if(t.el){var n=e.el||this._editor.document.createElement("h".concat(e.level));n.dataset.id||(n.dataset.id="".concat(this._catalogID++)),n.innerText=e.title,t.el.insertAdjacentElement("afterend",n),e.el=n}return e}},{key:"insertBefore",value:function(e,t){if(t.el){var n=e.el||this._editor.document.createElement("h".concat(e.level));n.dataset.id||(n.dataset.id="".concat(this._catalogID++)),n.innerText=e.title,t.el.insertAdjacentElement("beforebegin",n),e.el=n}return e}},{key:"append",value:function(e){var t=e.el||this._editor.document.createElement("h".concat(e.level));return t.dataset.id||(t.dataset.id="".concat(this._catalogID++)),t.innerText=e.title,this._editor.holder.appendChild(t),e.el=t,e}}]),e}(),Et=0,Ot=[],St=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(e){var i,o;return Object(a.a)(this,n),(i=t.call(this))._holder=void 0,i._rootDocNode=void 0,i._head=void 0,i._id=void 0,i._isReady=void 0,i._options=void 0,i._hasEnterExecCommand=void 0,i._actived=void 0,i._darkmode=void 0,i.$dom=_e.a,i.$dtd=xe.a,i.$env=Ce.a,i.$keymap=Ke,i.selection=void 0,i.search=void 0,i.catalog=void 0,i.document=void 0,i.window=void 0,o=Object(ye.a)(i),Ct(o,vt),Ct(o,kt),Ct(o,_t),i._options=Object(V.a)({},e),Ot.forEach((function(e){e.install(Object(ye.a)(i))})),i.search=new Fe({editor:Object(ye.a)(i)}),i.catalog=new xt({editor:Object(ye.a)(i)}),i._darkmode=!!(null===e||void 0===e?void 0:e.darkmode),i}return Object(s.a)(n,null,[{key:"use",value:function(e){Ot.push(e)}}]),Object(s.a)(n,[{key:"initDomEvents",value:function(){var e=this;this.proxyDomEvent=this.proxyDomEvent.bind(this),this.selectionChange=Object(R.a)(this.selectionChange,20),this.$dom.on(this._holder,["click","contextmenu","keydown","keyup","keypress","mousedown","mouseup","mouseover","mouseout","selectstart","focus","blur","compositionstart","compositionend"],this.proxyDomEvent),this.$dom.on(this._holder,"drop",(function(t){e.$env.gecko&&t.stopPropagation&&t.stopPropagation(),e.trigger("contentchange")}));var t=function(t){e._actived&&2!==t.button&&e.selectionChange(t)};this.$dom.on(this._holder,["mouseup","keydown"],t),this.$dom.on(this.document,["mouseup"],t),this.$dom.on(this._rootDocNode,["selectionchange"],t)}},{key:"proxyDomEvent",value:function(e){var t=e.type.replace(/^on/,"").toLowerCase();this.trigger(t,e)}},{key:"selectionChange",value:function(e){var t=!!e;this.selection.cache(),this.selection.cachedRange()&&this.selection.cachedStartElement()&&(this.trigger("beforeselectionchange"),this.trigger("selectionchange",t),this.trigger("afterselectionchange"),this.selection.clearCache())}},{key:"bindShortcutKeys",value:function(){var e=this;this.$dom.on(this.document,"keydown",(function(t){if(e._actived){var n=t.keyCode||t.which;if(n)for(var i in e.commands)if(e.commands.hasOwnProperty(i)){var o=e.commands[i].shortcutKeys;if(o)for(var a in o)if(o.hasOwnProperty(a)){var s=o[a];(/^(ctrl)(\+shift)?\+(.+)$/.test(a.toLowerCase())||/^(\w+)$/.test(a.toLowerCase()))&&("ctrl"===RegExp.$1&&(t.ctrlKey||t.metaKey)&&(""!==RegExp.$2?t.shiftKey:!t.shiftKey)&&n===e.$keymap[RegExp.$3]||n===e.$keymap[RegExp.$1])&&(s.handler?s.handler.apply(e,[t,s.data]):(-1!==e.queryCommandState(i,s.data)&&e.execCommand(i,s.data),e.$dom.preventDefault(t)))}}}}))}},{key:"mount",value:function(e,t){if(this._rootDocNode=e.getRootNode(),1!==e.nodeType||!e.ownerDocument||!this._rootDocNode||9!==this._rootDocNode.nodeType&&11!==this._rootDocNode.nodeType)throw"el is invalid!";this._holder=e,this._holder.setAttribute("contenteditable","true"),this._holder.setAttribute("spellcheck","false"),this._holder.style.cursor="text",this._holder.classList.toggle("dark-mode",this._darkmode),this.document=e.ownerDocument,this.window=this.document.defaultView,11===this._rootDocNode.nodeType?(this._head=this._rootDocNode.querySelector("head")||this.document.createElement("head"),this._head.parentNode||this._rootDocNode.insertBefore(this._head,this._holder)):(this._head=this.document.head||this.document.createElement("head"),this._head.parentNode||this.document.appendChild(this._head));var n=this._rootDocNode;return t=t||(n.getSelection?n.getSelection():this.document.getSelection()),this.selection=new Ie(e.ownerDocument,this._holder,t),this.initDomEvents(),this.bindShortcutKeys(),this._id=Et++,this._isReady=!0,this._actived=!0,this.trigger("ready",this),this.trigger("contentchange"),this}},{key:"destory",value:function(){}},{key:"setOpt",value:function(e,t){var n={};"string"===typeof e&&t?n[e]=t:"object"===typeof e&&(n=e),Object.assign(this._options,n)}},{key:"getOpt",value:function(e){return e&&this._options[e]}},{key:"ready",value:function(e){this._isReady?e.apply(this):this.on("ready",e)}},{key:"appendCSS",value:function(e,t){var n=document.createElement("style");for(var i in n.textContent="\n".concat(e),t=t||{},Object.assign(t,{type:"text/css"}),t)if(t.hasOwnProperty(i)){var o=t[i];n.setAttribute(i,o)}return this._head.appendChild(n),n}},{key:"removeCSS",value:function(e){this._head.querySelectorAll(e).forEach((function(e){e.remove()}))}},{key:"hasCSS",value:function(e){return this._head.querySelectorAll(e).length>0}},{key:"getCSS",value:function(e){return this._head.querySelector(e)}},{key:"execCommand",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(!e)return!1;var o;e=e.toLowerCase();var a=this.commands[e];return!!a&&(this._hasEnterExecCommand?o=this.callCmdFn("execCommand",arguments):(this._hasEnterExecCommand=!0,-1!==this.queryCommandState.apply(this,[e].concat(n))&&(this.trigger.apply(this,["beforeexeccommand",e].concat(n)),o=this.callCmdFn("execCommand",arguments),this.trigger.apply(this,["afterexeccommand",e].concat(n))),this._hasEnterExecCommand=!1),!this._hasEnterExecCommand&&!a.ignoreContentChange&&this.trigger("contentchange"),!this._hasEnterExecCommand&&!a.ignoreContentChange&&this.selectionChange(),o)}},{key:"getContent",value:function(){return this._holder.innerHTML}},{key:"setContent",value:function(e){}},{key:"getScene",value:function(){return this._holder.innerHTML}},{key:"setScene",value:function(e){}},{key:"clear",value:function(){this._holder.innerHTML="<p><br></p>"}},{key:"getSelection",value:function(){return this.selection}},{key:"actived",get:function(){return this._actived},set:function(e){this._actived=e,e?this.trigger("actived"):this.trigger("deactived")}},{key:"darkmode",get:function(){return this._actived},set:function(e){this._darkmode=e,this._holder&&this._holder.classList.toggle("dark-mode",e)}},{key:"holder",get:function(){return this._holder}},{key:"rootNode",get:function(){return this._rootDocNode}},{key:"id",get:function(){return this._id}},{key:"isReady",get:function(){return this._isReady}}]),n}(We),wt=n(516),Tt=function(){function e(){Object(a.a)(this,e),this.allListeners=[]}return Object(s.a)(e,[{key:"on",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=Object(wt.f)("l"),a={id:o,element:e,eventType:t,handler:n,options:i},s=this.findOne(e,t,n);return s?"":(this.allListeners.push(a),e.addEventListener(t,n,i),o)}},{key:"off",value:function(e,t,n,i){var o=this,a=this.findAll(e,t,n);a.forEach((function(e,t){var n=o.allListeners.indexOf(a[t]);n>-1&&(o.allListeners.splice(n,1),e.element.removeEventListener(e.eventType,e.handler,e.options))}))}},{key:"offById",value:function(e){var t=this.findById(e);t&&t.element.removeEventListener(t.eventType,t.handler,t.options)}},{key:"findOne",value:function(e,t,n){var i=this.findAll(e,t,n);return i.length>0?i[0]:null}},{key:"findAll",value:function(e,t,n){var i=e?this.findByEventTarget(e):[];return e&&t&&n?i.filter((function(e){return e.eventType===t&&e.handler===n})):e&&t?i.filter((function(e){return e.eventType===t})):i}},{key:"removeAll",value:function(){this.allListeners.map((function(e){e.element.removeEventListener(e.eventType,e.handler,e.options)})),this.allListeners=[]}},{key:"destroy",value:function(){this.removeAll()}},{key:"findByEventTarget",value:function(e){return this.allListeners.filter((function(t){if(t.element===e)return t}))}},{key:"findByType",value:function(e){return this.allListeners.filter((function(t){if(t.eventType===e)return t}))}},{key:"findByHandler",value:function(e){return this.allListeners.filter((function(t){if(t.handler===e)return t}))}},{key:"findById",value:function(e){return this.allListeners.find((function(t){return t.id===e}))}}]),e}(),jt=function(){function e(t){var n=this,i=t.blockEditable;if(Object(a.a)(this,e),this.nodes={},this.listeners=new Tt,this.readOnlyMutableListeners={on:function(e,t,i){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n._mutableListenerIds.push(n.listeners.on(e,t,(function(e){n.blockEditable.editable.actived&&i(e)}),o))},clearAll:function(){var e,t=Object(qe.a)(n._mutableListenerIds);try{for(t.s();!(e=t.n()).done;){var i=e.value;n.listeners.offById(i)}}catch(o){t.e(o)}finally{t.f()}n._mutableListenerIds=[]}},this.blockEditable=void 0,this._mutableListenerIds=[],(this instanceof e?this.constructor:void 0)===e)throw new TypeError("Constructors for abstract class Module are not allowed.");this.blockEditable=i}return Object(s.a)(e,[{key:"removeAllNodes",value:function(){for(var e in this.nodes){var t=this.nodes[e];t instanceof HTMLElement&&t.remove()}}},{key:"state",get:function(){return this.blockEditable.state}},{key:"isRtl",get:function(){return!1}}]),e}(),Bt=n(515),Nt=n(518),Lt=n(796),It=n(798).default,At=function(){function e(t){Object(a.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._nodes={},this._title=void 0,this._subtitle=void 0,this._blockEditable=t.blockEditable,this._title="Error",this._subtitle="The block can not be displayed correctly.",this._data=t.data||{key:"",data:{}}}return Object(s.a)(e,null,[{key:"validData",value:function(e){return e}},{key:"toHtml",value:function(e){return""}},{key:"toData",value:function(e){var t=document.createElement("div");return t.innerHTML=e,{content:t.textContent||""}}},{key:"Class",get:function(){return{target:"be-stub",icon:"be-stub__icon",info:"be-stub__info",title:"be-stub__title",subtitle:"be-stub__subtitle"}}},{key:"toolbox",get:function(){return{icon:It,title:"Stub"}}},{key:"acceptConversionComps",get:function(){return!1}},{key:"inlineTools",get:function(){return!1}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{content:""}}},{key:"builtinTypesets",get:function(){return{default:""}}},{key:"CSS",get:function(){return Lt}},{key:"pasteConfig",get:function(){return{tags:["P"]}}}]),Object(s.a)(e,[{key:"renderBlock",value:function(e){this._data;return this._nodes.target=this.make(),this._nodes.target}},{key:"renderSettings",value:function(e){return null}},{key:"save",value:function(){return this._data.data}},{key:"destroy",value:function(){}},{key:"make",value:function(){var t=Object(Nt.make)("div",e.Class.target),n=Object(Nt.make)("i",e.Class.icon);n.innerHTML=It;var i=Object(Nt.make)("div",e.Class.info),o=Object(Nt.make)("div",e.Class.title,{});o.textContent=this._title;var a=Object(Nt.make)("div",e.Class.subtitle,{});return a.textContent=this._subtitle,t.appendChild(n),i.appendChild(o),i.appendChild(a),t.appendChild(i),t}},{key:"key",get:function(){return this._data.key}}]),e}();At.key="";var Rt=n(23),Mt=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(e,i){var o;return Object(a.a)(this,n),(o=t.call(this,{blockEditable:i}))._firstSelectedInput=void 0,o._lastSelectedInput=void 0,o._block=void 0,o._anyInputSelectedCache=null,o._multiInputsSelectedCache=null,o.onMouseUp=function(){o.state.ui;var e=o.blockEditable.editable.document;o.listeners.off(o._block.content,"mousemove",o.onMouseMove),o.listeners.off(e,"mouseup",o.onMouseUp);var t=o.inputs;o.selectedInputs.length===t.length&&t.length>0&&(o._block.selected=!0)},o.onMouseMove=function(e){var t=o.state,n=(t.content,t.blockSelection,t.ui,o.getInput(e.target));n&&o._firstSelectedInput&&(o.state.inlineToolbar.close(),o.resetInputsSelectedState(o._firstSelectedInput||n,n),o._lastSelectedInput=n,n===o._firstSelectedInput?o.toggleInputSelectedBy(n,!1):o.blockEditable.selection.removeAllRanges())},o._block=e,o}return Object(s.a)(n,[{key:"bindEvents",value:function(){var e=this;this.listeners.on(this._block.content,"mousedown",(function(t){e.enableCrossInputSelection(t)}))}},{key:"watchSelection",value:function(e){if(e.button===wt.r.LEFT){this._block.currentInput=e.target;var t=this.blockEditable.editable.document;this._firstSelectedInput=this._block.currentInput,this._lastSelectedInput=this._firstSelectedInput,this.listeners.on(this._block.content,"mousemove",this.onMouseMove),this.listeners.on(t,"mouseup",this.onMouseUp)}}},{key:"toggleInputSelectedState",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.state;t.content,t.blockSelection;if(this._lastSelectedInput||(this._lastSelectedInput=this._firstSelectedInput=this._block.currentInput),this._lastSelectedInput&&this._firstSelectedInput){this._firstSelectedInput===this._lastSelectedInput&&(this.toggleInputSelectedBy(this._firstSelectedInput,!0),this.blockEditable.selection.removeAllRanges());var n=this.indexOfInput(this._lastSelectedInput)+(e?1:-1),i=this.inputs[n];i&&(this.inputSelected(this._lastSelectedInput)!==this.inputSelected(i)?this.toggleInputSelectedBy(i,!0):this.toggleInputSelectedBy(this._lastSelectedInput,!1),this._lastSelectedInput=i,this.state.inlineToolbar.close(),i.scrollIntoView({block:"nearest"}))}}},{key:"clear",value:function(e){var t=this.state.cursor,n=this._firstSelectedInput?this.indexOfInput(this._firstSelectedInput):-1,i=this._lastSelectedInput?this.indexOfInput(this._lastSelectedInput):-1;if(this.anyInputSelected&&n>-1&&i>-1)if(e&&e instanceof KeyboardEvent)switch(e.keyCode){case wt.q.DOWN:case wt.q.RIGHT:t.setToInput(this.inputs[Math.max(n,i)],t.positions.END);break;case wt.q.UP:case wt.q.LEFT:t.setToInput(this.inputs[Math.min(n,i)],t.positions.START);break;default:t.setToInput(this.inputs[Math.max(n,i)],t.positions.END)}else t.setToInput(this.inputs[Math.max(n,i)],t.positions.END);this._firstSelectedInput=this._lastSelectedInput=void 0}},{key:"enableCrossInputSelection",value:function(e){this.blockEditable.selection.isCollapsed||this.clearInputsSelection(),this._block.content.contains(e.target)?this.watchSelection(e):this.clearInputsSelection()}},{key:"toggleInputSelectedByIndex",value:function(e,t){var n=this.inputs[e];n&&n.classList.toggle(Ht.Class.inputSelected,t),this.clearSelectionCache()}},{key:"toggleInputSelectedBy",value:function(e,t){if(e){var n=e.closest('[contenteditable="true"]')||e.closest(".".concat(Ht.Class.fakeInput));n&&n.classList.toggle(Ht.Class.inputSelected,t),this.clearSelectionCache()}}},{key:"inputSelected",value:function(e){return e.closest(".".concat(Ht.Class.inputSelected))}},{key:"getInput",value:function(e){if(!e)return null;var t=1===e.nodeType?e:e.parentNode;return t.closest('[contenteditable="true"]')||t.closest(".".concat(Ht.Class.fakeInput))}},{key:"indexOfInput",value:function(e){return e?this.inputs.findIndex((function(t){return t===e||t.contains(e)})):-1}},{key:"clearInputsSelection",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.state.cursor,i=this.blockEditable.selection;t&&this.blockEditable.selection.cache();var o=e&&e instanceof KeyboardEvent,a=o&&wt.n(e.keyCode);this.anyInputSelected&&o&&a&&!i.exists&&(n.setToBlock(this._block),wt.e((function(){var t=e.key;n.insertContentAtCursorPosition(t.length>1?"":t)}),20)()),this.clear(e),t&&this.blockEditable.selection.restore(),this.allInputsSelected=!1}},{key:"copySelectedInputs",value:function(e){e.preventDefault();var t=this.inputs,n=this.selectedInputs.map((function(e){return t[e]})).filter(Boolean),i=this._block.componentInstance.extractInputs?this._block.componentInstance.extractInputs(n):{},o=[{key:this._block.component.key,data:i}],a={clearEmpty:Rt.c,inlineContent:Rt.f,type:"html"},s=this._block.component,r=s.toHtml(i,a),l=this.blockEditable.utils.makeMarkdown,c=s.toMarkdown?s.toMarkdown(i,l):l(r);e.clipboardData&&(e.clipboardData.setData("text/plain",c),e.clipboardData.setData("text/html",r),e.clipboardData.setData(this.state.paste.MIME_TYPE,JSON.stringify(o)))}},{key:"removeSelectedInputs",value:function(){var e=this.inputs,t=this.selectedInputs.map((function(t){return e[t]})).filter(Boolean);if(this._block.componentInstance.removeInputs){this.allInputsSelected=!1;var n=this._block.componentInstance.removeInputs(t);n&&(this._block.currentInput=n)}}},{key:"clearSelectionCache",value:function(){this._anyInputSelectedCache=null,this._multiInputsSelectedCache=null}},{key:"resetInputsSelectedState",value:function(e,t){var n=this,i=this.indexOfInput(e),o=this.indexOfInput(t);this.selectedInputs.forEach((function(e){n.toggleInputSelectedByIndex(e,!1)}));for(var a=Math.min(i,o);a<=Math.max(i,o);a++)this.toggleInputSelectedByIndex(a,!0)}},{key:"inputs",get:function(){return this._block.inputs}},{key:"isCrossInputSelectionStarted",get:function(){return!!this._firstSelectedInput&&!!this._lastSelectedInput}},{key:"allInputsSelected",set:function(e){var t=this;this.inputs.forEach((function(n,i){t.toggleInputSelectedByIndex(i,e)}))}},{key:"anyInputSelected",get:function(){if(null===this._anyInputSelectedCache){var e=this.inputs;this._anyInputSelectedCache=e.some((function(e){return e.classList.contains(Ht.Class.inputSelected)}))}return this._anyInputSelectedCache}},{key:"multiInputsSelected",get:function(){if(null===this._multiInputsSelectedCache){var e=this.inputs;this._multiInputsSelectedCache=e.filter((function(e){return e.classList.contains(Ht.Class.inputSelected)})).length>1}return this._multiInputsSelectedCache}},{key:"selectedInputs",get:function(){var e=this.inputs,t=[];return e.forEach((function(e,n){e.classList.contains(Ht.Class.inputSelected)&&t.push(n)})),t}}]),n}(jt);var Dt=Date.now(),Ht=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(e){var i;Object(a.a)(this,n),(i=t.call(this,{blockEditable:e.blockEditable}))._componentKey=void 0,i._componentInstance=void 0,i._holder=void 0,i._content=void 0,i._common=void 0,i._isStretching=void 0,i._inputSelection=void 0,i._cachedInputs=[],i._cachedAllInputs=[],i._inputIndex=0,i._mutationObserver=void 0,i._modificationDebounceTimer=450,i._didMutated=wt.d((function(){i._cachedInputs=[],i._cachedAllInputs=[],i.updateCurrentInput(),i.onUpdated()}),i._modificationDebounceTimer),i.handleFocus=function(){i._cachedInputs=[],i._cachedAllInputs=[],setTimeout((function(){i.updateCurrentInput()}),100)},i._componentKey=e.data.key;var o=i.component;return i._componentInstance=o?new o({blockEditable:e.blockEditable,data:e.data.data}):new At({blockEditable:e.blockEditable,data:e.data}),i._common=e.data.common||{},i._mutationObserver=new MutationObserver(i._didMutated),i._inputSelection=new Mt(Object(ye.a)(i),e.blockEditable),i.compose(),i}return Object(s.a)(n,null,[{key:"isFakeInput",value:function(e){if(e){var t=e.nodeType===Node.ELEMENT_NODE?e:e.parentElement;if(t&&t.closest(".".concat(n.Class.fakeInput)))return!0}return!1}},{key:"isLinesInput",value:function(e){if(e){var t=e.nodeType===Node.ELEMENT_NODE?e:e.parentElement;if(t&&t.closest(".".concat(n.Class.linesInput)))return!0}return!1}},{key:"getFakeInput",value:function(e){if(e){var t=e.nodeType===Node.ELEMENT_NODE?e:e.parentElement;return t&&t.closest(".".concat(n.Class.fakeInput))}}},{key:"Class",get:function(){return{block:"beui-block",blockStretched:"beui-block--stretched",content:"beui-block__content",contentStretched:"beui-block__content--stretched",prefix:"beui-block__prefix",subfix:"beui-block__subfix",focused:"beui-block--focused",inputFocused:"beui-block__input--focused",inputSelected:"beui-block__input--selected",selected:"beui-block--selected",dropTarget:"beui-block--drop-target",button:"beui-block__button",input:"beui-block__input",loader:"beui-block__loader",fakeInput:"beui-block__fakeinput",linesInput:"beui-block__lineinput"}}}]),Object(s.a)(n,[{key:"leafInputsAndReturnIndex",value:function(e){if(0===this.inputs.length)return this._inputIndex;var t=this._inputIndex,i=null;return-1===t?t=e===n.directions.RIGHT||e===n.directions.DOWN||e===n.directions.NEXT?-1:0:i=this.inputs[t],e!==n.directions.NEXT&&(i||e!==n.directions.RIGHT&&e!==n.directions.DOWN)?e!==n.directions.PREVIOUS&&(i||e!==n.directions.LEFT&&e!==n.directions.UP)?i&&(t=this.findNextIndex(t,e)):t-=1:t+=1,t}},{key:"findNextIndex",value:function(e,t){var i=this.inputs.map((function(e,t){var n=e.getBoundingClientRect();return{index:t,x:Math.floor(n.x),y:Math.floor(n.y)}})),o=i[e],a=function(e){var t,n=Number.POSITIVE_INFINITY;return i.forEach((function(i){if(e(i)){var a=(r=o,((s=i).x-r.x)*(s.x-r.x)+(s.y-r.y)*(s.y-r.y));a<n&&(t=i,n=a)}var s,r})),t},s=0;if(t===n.directions.RIGHT){var r=a((function(e){return e.x>o.x}));s=r?r.index:o.index+1}else if(t===n.directions.DOWN){var l=a((function(e){return e.y>o.y}));s=l?l.index:o.index+1}else if(t===n.directions.LEFT){var c=a((function(e){return e.x<o.x}));s=c?c.index:o.index-1}else{var u=a((function(e){return e.y<o.y}));s=u?u.index:o.index-1}return s}},{key:"updateCurrentInput",value:function(){var e=this.blockEditable.editable,t=e.document,n=e.selection;this.currentInput=Bt.a.isNativeInput(t.activeElement)||!n.anchorNode?t.activeElement:n.anchorNode}},{key:"willSelect",value:function(){this.holder&&this._mutationObserver.observe(this.holder,{childList:!0,subtree:!0,characterData:!0,attributes:!0}),this.addInputEvents()}},{key:"willUnselect",value:function(){this._mutationObserver.disconnect(),this.removeInputEvents(),this._cachedInputs=[],this._cachedAllInputs=[]}},{key:"renderSettings",value:function(e){if(wt.k(this._componentInstance.renderSettings))return this._componentInstance.renderSettings(e)}},{key:"destroy",value:function(){wt.k(this._componentInstance.destroy)&&this._componentInstance.destroy()}},{key:"mergeWith",value:function(){var e=Object(ke.a)(ge.a.mark((function e(t){return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._componentInstance.merge||!this.mergeable){e.next=3;break}return e.next=3,this._componentInstance.merge(t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=this._componentInstance.save();return{key:this.component.key||this._componentInstance.key||"",data:e,common:this._common}}},{key:"canBackspaceRemove",value:function(){return this.selected||(this.isEmpty||this._componentInstance.backspaceRemovable)&&this.currentInput===this.firstInput}},{key:"onRendered",value:function(){this._componentInstance.onRendered&&this._componentInstance.onRendered()}},{key:"onRemoved",value:function(){this._componentInstance.onRemoved&&this._componentInstance.onRemoved()}},{key:"onUpdated",value:function(){this._componentInstance.onUpdated&&this._componentInstance.onUpdated()}},{key:"onMoved",value:function(){this._componentInstance.onMoved&&this._componentInstance.onMoved()}},{key:"onAdded",value:function(){this._componentInstance.onAdded&&this._componentInstance.onAdded()}},{key:"onPaste",value:function(e){this._componentInstance.onPaste&&this._componentInstance.onPaste(e)}},{key:"onEditFakeInput",value:function(e){return!!this._componentInstance.onEditFakeInput&&(this._componentInstance.onEditFakeInput(e),!0)}},{key:"compose",value:function(){var e=Bt.a.make("div",[n.Class.block,"beui-block--".concat(this.component.key)]),t=Bt.a.make("span",[n.Class.prefix]),i=Bt.a.make("div",[n.Class.content]),o=Bt.a.make("span",[n.Class.subfix]);if(e.appendChild(t),e.appendChild(i),e.appendChild(o),this._componentInstance){var a=this._componentInstance.renderBlock(n.Class);if(e.dataset.id||(e.dataset.id="".concat(Dt++)),this._componentInstance.key&&(e.dataset.key=this._componentInstance.key),this._common.quote){var s=this.blockEditable.editable.document.createElement("blockquote");s.appendChild(a),i.appendChild(s)}else i.appendChild(a)}this._holder=e,this._content=i,this._inputSelection.bindEvents()}},{key:"addInputEvents",value:function(){var e=this;this.inputs.forEach((function(t){t.addEventListener("focus",e.handleFocus)}))}},{key:"removeInputEvents",value:function(){var e=this;this.inputs.forEach((function(t){t.removeEventListener("focus",e.handleFocus)}))}},{key:"enableEventsStopPropagation",value:function(){var e=this;this.readOnlyMutableListeners.on(this._content,"click",(function(e){e.stopPropagation()}),!1),this.readOnlyMutableListeners.on(this._content,"mousedown",(function(e){e.stopPropagation()}),!0),this.readOnlyMutableListeners.on(this._content,"mouseup",(function(e){e.stopPropagation()}),!0),this.readOnlyMutableListeners.on(this._content,"touchstart",(function(e){e.stopPropagation()}),!0),this.readOnlyMutableListeners.on(this._content,"keydown",(function(e){e.stopPropagation()}),!0),this.readOnlyMutableListeners.on(this._content,"keydown",(function(t){switch(t.stopPropagation(),t.keyCode){case wt.q.ESC:e.stretched=!1}}),!1),this.readOnlyMutableListeners.on(this._content,"click",(function(e){e.stopPropagation()}),!0)}},{key:"disableEventsStopPropagation",value:function(){this.readOnlyMutableListeners.clearAll()}},{key:"inputSelection",get:function(){return this._inputSelection}},{key:"inputs",get:function(){if(0!==this._cachedInputs.length)return this._cachedInputs;var e=Bt.a.findVisibleInputs(this.holder,[".".concat(n.Class.fakeInput)]);return this._inputIndex>e.length-1&&(this._inputIndex=e.length-1),this._cachedInputs=e,e}},{key:"allInputs",get:function(){if(0!==this._cachedAllInputs.length)return this._cachedAllInputs;var e=Bt.a.findAllInputs(this.holder,[".".concat(n.Class.fakeInput)]);return this._cachedAllInputs=e,e}},{key:"currentInput",get:function(){return this.inputs[this._inputIndex]},set:function(e){var t=this;if(e){var i=this.inputs.findIndex((function(t){return t===e||t.contains(e)}));if(-1!==i){this._inputIndex=i;var o=this.holder.classList.contains(n.Class.focused);this.inputs.forEach((function(e,i){e.classList.toggle(n.Class.inputFocused,t._inputIndex===i&&o)}))}}}},{key:"currentInputFocused",get:function(){var e=this.currentInput;return!!e&&e.classList.contains(n.Class.inputFocused)}},{key:"firstInput",get:function(){return this.inputs[0]}},{key:"lastInput",get:function(){var e=this.inputs;return e[e.length-1]}},{key:"nextInput",get:function(){return this.inputs[this.leafInputsAndReturnIndex(n.directions.NEXT)]}},{key:"previousInput",get:function(){return this.inputs[this.leafInputsAndReturnIndex(n.directions.PREVIOUS)]}},{key:"upInput",get:function(){return this.inputs[this.leafInputsAndReturnIndex(n.directions.UP)]}},{key:"downInput",get:function(){return this.inputs[this.leafInputsAndReturnIndex(n.directions.DOWN)]}},{key:"leftInput",get:function(){return this.inputs[this.leafInputsAndReturnIndex(n.directions.LEFT)]}},{key:"rightInput",get:function(){return this.inputs[this.leafInputsAndReturnIndex(n.directions.RIGHT)]}},{key:"component",get:function(){return se.a.component(this._componentKey)||At}},{key:"componentInstance",get:function(){return this._componentInstance}},{key:"componentContent",get:function(){var e=this.holder.querySelector(".".concat(n.Class.content));if(e&&e.childNodes.length)for(var t=e.childNodes.length-1;t>=0;t--){var i=e.childNodes[t];if(!Bt.a.isExtensionNode(i))return i}return null}},{key:"textContent",get:function(){return this._holder.textContent}},{key:"data",get:function(){return this._componentInstance.save()}},{key:"isDefault",get:function(){return this.blockEditable.defaultBlockComp.key===this.component.key}},{key:"isEmpty",get:function(){if(this._componentInstance.isEmptyContent)return!0;var e=!this.componentContent||Bt.a.isEmpty(this.componentContent),t=!this.hasMedia;return e&&t}},{key:"hasMedia",get:function(){return!!this.holder.querySelector(["img","iframe","video","audio","source","input","textarea","twitterwidget"].join(","))}},{key:"holder",get:function(){return this._holder}},{key:"content",get:function(){return this._content}},{key:"focused",set:function(e){var t=this;this.holder.classList.toggle(n.Class.focused,e),this.inputs.forEach((function(i,o){i.classList.toggle(n.Class.inputFocused,t._inputIndex===o&&e)}))},get:function(){return this.holder.classList.contains(n.Class.focused)}},{key:"selected",set:function(e){e?this.holder.classList.add(n.Class.selected):this.holder.classList.remove(n.Class.selected),this._inputSelection.allInputsSelected=!1},get:function(){return this.holder.classList.contains(n.Class.selected)}},{key:"stretched",set:function(e){var t=this;this._isStretching||(this._isStretching=!0,this._componentInstance.onWillChangeStreched?this._componentInstance.onWillChangeStreched(e).then((function(){t._isStretching=!1,t.holder.classList.toggle(n.Class.blockStretched,e),Promise.resolve().then((function(){e?t.enableEventsStopPropagation():t.disableEventsStopPropagation()}))})):(this.holder.classList.toggle(n.Class.blockStretched,e),Promise.resolve().then((function(){e?t.enableEventsStopPropagation():t.disableEventsStopPropagation()})),this._isStretching=!1))},get:function(){return this.holder.classList.contains(n.Class.blockStretched)}},{key:"quoted",set:function(e){var t=this.holder.querySelector("blockquote");if(e!==!!t){var n=this.blockEditable.editable,i=n.document,o=n.$dom;n.selection;if(e){for(var a=this._content,s=i.createElement("blockquote");a&&a.firstChild;)s.appendChild(a.firstChild);a&&a.appendChild(s)}else t&&o.remove(t,!0);this._common.quote=e}},get:function(){return!!this._common.quote}},{key:"dropTarget",set:function(e){this.holder.classList.toggle(n.Class.dropTarget,e)},get:function(){return this.holder.classList.contains(n.Class.dropTarget)}},{key:"mergeable",get:function(){return wt.k(this._componentInstance.merge)}}]),n}(jt);Ht.directions={PREVIOUS:"previous",NEXT:"next",RIGHT:"right",LEFT:"left",UP:"up",DOWN:"down"};var Pt=function(){function e(t,n,i){Object(a.a)(this,e),this.focusedCssClass=void 0,this.defaultFocusedClass=void 0,this.cursor=-1,this.items=[],this.items=t||[],this.focusedCssClass=n,this.defaultFocusedClass=i}return Object(s.a)(e,[{key:"setItems",value:function(e){this.items=e}},{key:"next",value:function(){this.cursor=this.leafNodesAndReturnIndex(e.directions.NEXT)}},{key:"previous",value:function(){this.cursor=this.leafNodesAndReturnIndex(e.directions.PREVIOUS)}},{key:"left",value:function(){this.cursor=this.leafNodesAndReturnIndex(e.directions.LEFT)}},{key:"up",value:function(){this.cursor=this.leafNodesAndReturnIndex(e.directions.UP)}},{key:"right",value:function(){this.cursor=this.leafNodesAndReturnIndex(e.directions.RIGHT)}},{key:"down",value:function(){this.cursor=this.leafNodesAndReturnIndex(e.directions.DOWN)}},{key:"dropCursor",value:function(){-1!==this.cursor&&(this.items[this.cursor].classList.remove(this.focusedCssClass),this.cursor=-1)}},{key:"focus",value:function(){var e=this;if(this.dropCursor(),this.defaultFocusedClass){var t=this.items.findIndex((function(t){return t.classList.contains(e.defaultFocusedClass||"")}));-1!==t&&(this.items[t].classList.add(this.focusedCssClass),this.cursor=t)}}},{key:"leafNodesAndReturnIndex",value:function(t){if(0===this.items.length)return this.cursor;var n=this.cursor,i=null;return-1===n?n=t===e.directions.RIGHT||t===e.directions.DOWN||t===e.directions.NEXT?-1:0:i=this.items[n],i&&i.classList.remove(this.focusedCssClass),t!==e.directions.NEXT&&(i||t!==e.directions.RIGHT&&t!==e.directions.DOWN)?t!==e.directions.PREVIOUS&&(i||t!==e.directions.LEFT&&t!==e.directions.UP)?i&&(n=this.findNextIndex(n,t)):n=(this.items.length+n-1)%this.items.length:n=(n+1)%this.items.length,Bt.a.canSetCursor(this.items[n]),this.items[n].classList.add(this.focusedCssClass),n}},{key:"findNextIndex",value:function(t,n){var i=this.items.map((function(e,t){var n=e.getBoundingClientRect();return{index:t,x:Math.floor(n.x),y:Math.floor(n.y)}})),o=i[t],a=function(e){var t,n=Number.POSITIVE_INFINITY;return i.forEach((function(i){if(e(i)){var a=(r=o,((s=i).x-r.x)*(s.x-r.x)+(s.y-r.y)*(s.y-r.y));a<n&&(t=i,n=a)}var s,r})),t},s=0;if(n===e.directions.RIGHT){var r=a((function(e){return e.x>o.x}));s=r?r.index:o.index+1}else if(n===e.directions.DOWN){var l=a((function(e){return e.y>o.y}));s=l?l.index:o.index+1}else if(n===e.directions.LEFT){var c=a((function(e){return e.x<o.x}));s=c?c.index:o.index-1}else{var u=a((function(e){return e.y<o.y}));s=u?u.index:o.index-1}return s=(s+i.length)%i.length}},{key:"currentItem",get:function(){return-1===this.cursor?null:this.items[this.cursor]}}]),e}();Pt.directions={PREVIOUS:"previous",NEXT:"next",RIGHT:"right",LEFT:"left",UP:"up",DOWN:"down"};var Ft=function(){function e(t){var n=this;Object(a.a)(this,e),this._iterator=void 0,this.activated=!1,this.allowArrows=!0,this.allowShiftArrows=!0,this.activateCallback=void 0,this.keydownHanlder=void 0,this.onKeyDown=function(t){if(n.isEventReadyForHandling(t)&&!(n.keydownHanlder&&n.keydownHanlder(t)))switch(e.usedKeys.includes(t.keyCode)&&t.preventDefault(),t.keyCode){case wt.q.TAB:n.handleTabPress(t);break;case wt.q.LEFT:n.flipLeft();break;case wt.q.UP:n.flipUp();break;case wt.q.RIGHT:n.flipRight();break;case wt.q.DOWN:n.flipDown();break;case wt.q.ENTER:n.handleEnterPress(t)}},this.allowArrows=!wt.i(t.allowArrows)||t.allowArrows,this.allowShiftArrows=!wt.i(t.allowShiftArrows)||t.allowShiftArrows,this._iterator=new Pt(t.items||[],t.focusedItemClass||"",t.defaultFocusedItemClass),this.activateCallback=t.activateCallback,this.keydownHanlder=t.keydownHanlder}return Object(s.a)(e,[{key:"activate",value:function(e){this.activated=!0,e&&this._iterator.setItems(e),document.addEventListener("keydown",this.onKeyDown)}},{key:"deactivate",value:function(){this.activated=!1,this.dropCursor(),document.removeEventListener("keydown",this.onKeyDown)}},{key:"focusFirst",value:function(){this.dropCursor(),this.flipRight()}},{key:"focus",value:function(){this._iterator.focus()}},{key:"flipLeft",value:function(){this._iterator.previous()}},{key:"flipRight",value:function(){this._iterator.next()}},{key:"flipUp",value:function(){this._iterator.up()}},{key:"flipDown",value:function(){this._iterator.down()}},{key:"dropCursor",value:function(){this._iterator.dropCursor()}},{key:"isEventReadyForHandling",value:function(e){var t=[wt.q.TAB,wt.q.ENTER],n=this._iterator.currentItem==document.activeElement;return this.allowArrows&&!n&&(!this.allowShiftArrows&&e.shiftKey||t.push(wt.q.LEFT,wt.q.RIGHT,wt.q.UP,wt.q.DOWN)),this.activated&&-1!==t.indexOf(e.keyCode)}},{key:"handleTabPress",value:function(e){switch(e.shiftKey?Pt.directions.LEFT:Pt.directions.RIGHT){case Pt.directions.RIGHT:this.flipRight();break;case Pt.directions.LEFT:this.flipLeft()}}},{key:"handleEnterPress",value:function(e){this.activated&&(this._iterator.currentItem&&this._iterator.currentItem.click(),wt.k(this.activateCallback)&&this._iterator.currentItem&&this.activateCallback(this._iterator.currentItem),e.preventDefault(),e.stopPropagation())}},{key:"currentItem",get:function(){return this._iterator.currentItem}}],[{key:"usedKeys",get:function(){return[wt.q.TAB,wt.q.LEFT,wt.q.RIGHT,wt.q.ENTER,wt.q.UP,wt.q.DOWN]}}]),e}(),qt=(n(799),n(800),function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).opened=!1,e._toolbarVerticalMargin=5,e._toolsInstances=void 0,e._buttonsList=null,e._width=0,e._flipper=null,e}return Object(s.a)(n,[{key:"toggleReadOnly",value:function(e){e?this.destroy():this.make()}},{key:"tryToShow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.allowedToShow()?(this.move(),this.open(),this.state.toolbar.close()):e&&this.close()}},{key:"move",value:function(){var e=this.blockEditable.selection.rangeRect,t=this.state.ui.nodes.wrapper.getBoundingClientRect(),n=this.state.ui.nodes.holder.getBoundingClientRect(),i={x:e.x-t.left,y:e.y+e.height-t.top+this._toolbarVerticalMargin};e.width&&(i.x+=Math.floor(e.width/2)),this.nodes.wrapper.style.left=Math.floor(i.x)+"px",this.nodes.wrapper.style.top=Math.floor(i.y)+"px";var o=e.x+Math.floor(e.width/2),a=o-this._width/2,s=o+this._width/2,r=-50;a<n.left?r-=100*(a-n.left)/this._width:s>n.right&&(r-=100*(s-n.right)/this._width),this.nodes.wrapper.style.transform="translateX(".concat(r,"%)")}},{key:"close",value:function(){if(this.opened){this.nodes.wrapper.classList.remove(n.Class.inlineToolbarShowed),Array.from(this._toolsInstances.entries()).forEach((function(e){var t=Object(be.a)(e,2),n=(t[0],t[1]);n.shortcut;wt.k(n.destroy)&&n.destroy()})),this.opened=!1,this._flipper&&this._flipper.deactivate();var e=this.blockEditable.selection;e.isCollapsed||e.removeAllRanges()}}},{key:"open",value:function(){if(!this.opened){this.addToolsFiltered(),this.nodes.wrapper.classList.add(n.Class.inlineToolbarShowed),this._buttonsList=this.nodes.buttons.querySelectorAll(".".concat(n.Class.inlineToolButton)),this.opened=!0;var e=Array.from(this._buttonsList);e=e.filter((function(e){return!e.hidden})),this._flipper&&(this._flipper.activate(e),this._flipper.focus())}}},{key:"containsNode",value:function(e){return this.nodes.wrapper.contains(e)}},{key:"destroy",value:function(){this._flipper&&(this._flipper.deactivate(),this._flipper=null),this.removeAllNodes()}},{key:"getInlineToolbarSettings",value:function(e){var t=e.enabledInlineTools;return!0===t||Array.isArray(t)?Array.isArray(t)?t:se.b.indexes:[]}},{key:"make",value:function(){var e=this;this.nodes.wrapper=Bt.a.make("div",[n.Class.inlineToolbar].concat(Object(p.a)(this.isRtl?[Ut.Class.editorRtlFix]:[]))),this.nodes.togglerAndButtonsWrapper=Bt.a.make("div",n.Class.togglerAndButtonsWrapper),this.nodes.buttons=Bt.a.make("div",n.Class.buttonsWrapper),this.nodes.actions=Bt.a.make("div",n.Class.actionsWrapper),this.listeners.on(this.nodes.wrapper,"mousedown",(function(e){e.target.closest(".".concat(n.Class.actionsWrapper))||e.preventDefault()})),Bt.a.append(this.nodes.wrapper,[this.nodes.togglerAndButtonsWrapper,this.nodes.actions]),Bt.a.append(this.state.ui.nodes.wrapper,this.nodes.wrapper),Bt.a.append(this.nodes.togglerAndButtonsWrapper,this.nodes.buttons),this.recalculateWidth(),this.enableFlipper(),this.blockEditable.editable.on("selectionchange",(function(){e.checkToolsState()}))}},{key:"allowedToShow",value:function(){var e=this.blockEditable.selection,t=e.textContent;if(!e||!e.anchorNode)return!1;if(e.isCollapsed||t.length<1)return!1;var n=Bt.a.isElement(e.anchorNode)?e.anchorNode:e.anchorNode.parentElement;if(!n)return!1;if(e&&["IMG","INPUT"].includes(n.tagName))return!1;if(null===n.closest('[contenteditable="true"]'))return!1;var i=this.state.content.getBlock(e.anchorNode);return!!i&&this.getInlineToolbarSettings(i.component).length>0}},{key:"recalculateWidth",value:function(){this._width=this.nodes.wrapper.offsetWidth}},{key:"addToolsFiltered",value:function(){var e=this,t=this.blockEditable.selection,n=this.state.content.getBlock(t.anchorNode);n&&(this.nodes.buttons.innerHTML="",this.nodes.actions.innerHTML="",this._toolsInstances=new Map,this.getInlineToolbarSettings(null===n||void 0===n?void 0:n.component).forEach((function(t){e.addTool(se.b.tool(t))})),this.recalculateWidth())}},{key:"addTool",value:function(e){var t=this,i=this.state.tooltip,o=new e({blockEditable:this.blockEditable}),a=o.render();if(a){if(a.dataset.key=e.key,this.nodes.buttons.appendChild(a),this._toolsInstances.set(e.key,o),wt.k(o.renderActions)){var s=o.renderActions();this.nodes.actions.appendChild(s)}this.listeners.on(a,"click",(function(e){t.toolClicked(o),e.preventDefault()}));var r=o.shortcut,l=Bt.a.make("div"),c=this.blockEditable.getLang("toolbar.inline.".concat(e.key));l.appendChild(Bt.a.text(c)),r&&l.appendChild(Bt.a.make("div",n.Class.inlineToolbarShortcut,{textContent:wt.b(r)})),i.onHover(a,l,{placement:"top",hidingDelay:100}),o.selectionChange(this.blockEditable.selection,this.blockEditable.editable)}}},{key:"toolClicked",value:function(e){e.surround(this.blockEditable.selection.getRangeAt(0),this.blockEditable.editable)}},{key:"checkToolsState",value:function(){var e=this;this._toolsInstances&&this._toolsInstances.forEach((function(t){t.selectionChange(e.blockEditable.selection,e.blockEditable.editable)}))}},{key:"enableFlipper",value:function(){var e=this;this._flipper=new Ft({focusedItemClass:n.Class.focusedButton,defaultFocusedItemClass:n.Class.activeButton,allowArrows:!0,allowShiftArrows:!1,keydownHanlder:function(t){var n=t.keyCode;return!(t.altKey||t.ctrlKey||t.metaKey||t.shiftKey||n!==wt.q.DOWN&&n!==wt.q.UP)&&(Promise.resolve().then((function(){var t=e.blockEditable.selection.getRangeAt(0);e.close(),t.setCursor(n===wt.q.DOWN,!0)})),t.preventDefault(),!0)}})}},{key:"flipper",get:function(){return this._flipper}}]),n}(jt));qt.Class={inlineToolbar:"beui-inline-toolbar",inlineToolbarShowed:"beui-inline-toolbar--showed",inlineToolbarLeftOriented:"beui-inline-toolbar--left-oriented",inlineToolbarRightOriented:"beui-inline-toolbar--right-oriented",inlineToolbarShortcut:"beui-inline-toolbar__shortcut",buttonsWrapper:"beui-inline-toolbar__buttons",actionsWrapper:"beui-inline-toolbar__actions",inlineToolButton:"beui-inline-tool",focusedButton:"beui-inline-tool--focused",activeButton:"beui-inline-tool--active",dropdown:"beui-inline-toolbar__dropdown",dropdownHidden:"beui-inline-toolbar__dropdown--hidden",dropdownContent:"beui-inline-toolbar__dropdown-content",togglerAndButtonsWrapper:"beui-inline-toolbar__toggler-and-button-wrapper"};var zt=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"toggleReadOnly",value:function(e){e?(this.destroy(),this.state.toolbox.destroy(),this.state.blockSettings.destroy(),this.disableModuleBindings()):(this.drawUI(),this.enableModuleBindings())}},{key:"move",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&(this.state.toolbox.close(),this.state.blockSettings.close());var t=this.state.content.activeBlock;if(t){var n=t.holder,i=(this.state.ui.isMobile,n.offsetHeight),o=n.offsetTop,a=Math.floor(i/2);this.nodes.plusButton.style.transform="translate3d(0, calc(".concat(a,"px - 50%), 0)"),this.adjustToolbox(),this.nodes.wrapper.style.transform="translate3D(0, ".concat(Math.floor(o),"px, 0)")}}},{key:"adjustToolbox",value:function(){var e=this.state.content.activeBlock;if(e){var t=e.holder,n=t.offsetHeight,i=Math.floor(n/2),o=this.blockEditable.selection;o.cache();var a=o.getRangeAt(0).getBoundingClientRect(),s=t.getBoundingClientRect();this.state.toolbox.nodes.toolbox.style.transform="translate3d(".concat(Math.max(a.x-s.x+10,0),"px, calc(").concat(i,"px - 50%), 0)")}}},{key:"open",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];wt.e((function(){e.move(i),e.nodes.wrapper.classList.add(n.Class.toolbarOpened),t?e.blockActions.show():e.blockActions.hide()}),50)()}},{key:"close",value:function(){this.nodes.wrapper.classList.remove(n.Class.toolbarOpened),this.blockActions.hide(),this.state.toolbox.close(),this.state.blockSettings.close()}},{key:"make",value:function(){var e=this;this.nodes.wrapper=Bt.a.make("div",n.Class.toolbar),this.nodes.content=Bt.a.make("div",n.Class.content),this.nodes.actions=Bt.a.make("div",n.Class.actions),Bt.a.append(this.nodes.wrapper,this.nodes.content),Bt.a.append(this.nodes.content,this.nodes.actions),this.nodes.plusButton=Bt.a.make("div",n.Class.plusButton),Bt.a.append(this.nodes.plusButton,Bt.a.icon("plus",14,14)),Bt.a.append(this.nodes.content,this.nodes.plusButton),this.readOnlyMutableListeners.on(this.nodes.plusButton,"click",(function(){e.plusButtonClicked()}),!1);var t=Bt.a.make("div");t.appendChild(document.createTextNode(this.blockEditable.getLang("toolbar.toolbox.insert"))),t.appendChild(Bt.a.make("div",n.Class.plusButtonShortcut,{textContent:"\u21e5 Tab"})),this.state.tooltip.onHover(this.nodes.plusButton,t),this.nodes.blockActionsButtons=Bt.a.make("div",n.Class.blockActionsButtons),this.nodes.settingsToggler=Bt.a.make("span",n.Class.settingsToggler);var i=Bt.a.icon("dots",8,8);Bt.a.append(this.nodes.settingsToggler,i),Bt.a.append(this.nodes.blockActionsButtons,this.nodes.settingsToggler),Bt.a.append(this.nodes.actions,this.nodes.blockActionsButtons),this.state.tooltip.onHover(this.nodes.settingsToggler,this.blockEditable.getLang("toolbar.settings.toggler"),{placement:"top"}),Bt.a.append(this.nodes.content,this.state.toolbox.nodes.toolbox),Bt.a.append(this.nodes.actions,this.state.blockSettings.nodes.wrapper),Bt.a.append(this.state.ui.nodes.wrapper,this.nodes.wrapper)}},{key:"plusButtonClicked",value:function(){this.state.toolbox.toggle()}},{key:"enableModuleBindings",value:function(){var e=this;this.readOnlyMutableListeners.on(this.nodes.settingsToggler,"click",(function(){e.settingsTogglerClicked()}))}},{key:"disableModuleBindings",value:function(){this.readOnlyMutableListeners.clearAll()}},{key:"settingsTogglerClicked",value:function(){this.state.blockSettings.opened?this.state.blockSettings.close():this.state.blockSettings.open()}},{key:"drawUI",value:function(){this.state.blockSettings.make(),this.state.toolbox.make(),this.make()}},{key:"destroy",value:function(){this.removeAllNodes()}},{key:"opened",get:function(){return this.nodes.wrapper.classList.contains(n.Class.toolbarOpened)}},{key:"plusButton",get:function(){var e=this;return{hide:function(){e.nodes.plusButton.classList.add(n.Class.plusButtonHidden)},show:function(){e.state.toolbox.isEmpty||e.nodes.plusButton.classList.remove(n.Class.plusButtonHidden)}}}},{key:"blockActions",get:function(){var e=this;return{hide:function(){e.nodes.actions.classList.remove(n.Class.actionsOpened)},show:function(){e.nodes.actions.classList.add(n.Class.actionsOpened)}}}}],[{key:"Class",get:function(){return{toolbar:"beui-toolbar",content:"beui-toolbar__content",actions:"beui-toolbar__actions",actionsOpened:"beui-toolbar__actions--opened",toolbarOpened:"beui-toolbar--opened",plusButton:"beui-toolbar__plus",plusButtonShortcut:"beui-toolbar__plus-shortcut",plusButtonHidden:"beui-toolbar__plus--hidden",blockActionsButtons:"beui-toolbar__actions-buttons",settingsToggler:"beui-toolbar__settings-btn"}}}]),n}(jt),Vt=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).opened=!1,e._toolbarVerticalMargin=5,e._toolsInstances=void 0,e._buttonsList=null,e._actionsList=null,e._width=0,e._flipper=null,e._cacheRange=null,e}return Object(s.a)(n,[{key:"toggleReadOnly",value:function(e){e?this.destroy():this.make()}},{key:"tryToShow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.allowedToShow()?(this.move(),this.open(),this.state.toolbar.close()):e&&this.close()}},{key:"move",value:function(){var e=this.blockEditable.selection.rangeRect,t=this.state.ui.nodes.wrapper.getBoundingClientRect(),n=this.state.ui.nodes.holder.getBoundingClientRect(),i={x:e.x-t.left,y:e.y+e.height-t.top+this._toolbarVerticalMargin};e.width&&(i.x+=Math.floor(e.width/2)),this.nodes.wrapper.style.left=Math.floor(i.x)+"px",this.nodes.wrapper.style.top=Math.floor(i.y)+"px";var o=e.x+Math.floor(e.width/2),a=o-this._width/2,s=o+this._width/2,r=-50;a<n.left?r-=100*(a-n.left)/this._width:s>n.right&&(r-=100*(s-n.right)/this._width),this.nodes.wrapper.style.transform="translateX(".concat(r,"%)")}},{key:"close",value:function(){if(this.opened){this.nodes.wrapper.classList.remove(n.Class.insertToolbarShowed),Array.from(this._toolsInstances.entries()).forEach((function(e){var t=Object(be.a)(e,2),n=(t[0],t[1]);wt.k(n.destroy)&&n.destroy()})),this.opened=!1,this._flipper&&this._flipper.deactivate();var e=this.blockEditable.selection;e.isCollapsed||e.removeAllRanges(),this._cacheRange=null,this.nodes.wrapper.style.top="0px"}}},{key:"open",value:function(){if(!this.opened){this.addToolsFiltered(),this.nodes.wrapper.classList.add(n.Class.insertToolbarShowed),this._buttonsList=this.nodes.buttons.querySelectorAll(".".concat(n.Class.button)),this._actionsList=this.nodes.actions.querySelectorAll(".".concat(n.Class.actions)),this._buttonsList.length&&this.activeTool(this._buttonsList[0].dataset.key),this.opened=!0;var e=Array.from(this._buttonsList);e=e.filter((function(e){return!e.hidden})),this._flipper&&(this._flipper.activate(e),this._flipper.focus());var t=this.blockEditable.selection;this._cacheRange=t.getRangeAt(0).cloneRange()}}},{key:"containsNode",value:function(e){return this.nodes.wrapper.contains(e)}},{key:"destroy",value:function(){this._flipper&&(this._flipper.deactivate(),this._flipper=null),this.removeAllNodes()}},{key:"make",value:function(){var e=this;this.nodes.wrapper=Bt.a.make("div",[n.Class.insertToolbar].concat(Object(p.a)(this.isRtl?[Ut.Class.editorRtlFix]:[]))),this.nodes.togglerAndButtonsWrapper=Bt.a.make("div",n.Class.togglerAndButtonsWrapper),this.nodes.close=Bt.a.make("div",[n.Class.close,"bei-cross"]),this.nodes.buttons=Bt.a.make("div",n.Class.buttonsWrapper),this.nodes.actions=Bt.a.make("div",n.Class.actionsWrapper),Bt.a.append(this.nodes.wrapper,[this.nodes.togglerAndButtonsWrapper,this.nodes.actions]),Bt.a.append(this.state.ui.nodes.wrapper,this.nodes.wrapper),Bt.a.append(this.nodes.togglerAndButtonsWrapper,[this.nodes.close,this.nodes.buttons]),this.recalculateWidth(),this.enableFlipper(),this.nodes.close.addEventListener("click",(function(){e.close()}))}},{key:"allowedToShow",value:function(){var e=this.blockEditable.selection,t=e.textContent;if(!e||!e.anchorNode)return!1;if(!e.isCollapsed||t.length>0)return!1;var n=Bt.a.isElement(e.anchorNode)?e.anchorNode:e.anchorNode.parentElement;return!!n&&((!e||!["IMG","INPUT"].includes(n.tagName))&&(null!==n.closest('[contenteditable="true"]')&&!!this.state.content.getBlock(e.anchorNode)))}},{key:"recalculateWidth",value:function(){this._width=this.nodes.wrapper.offsetWidth}},{key:"addToolsFiltered",value:function(){var e=this,t=this.blockEditable.selection;this.state.content.getBlock(t.anchorNode)&&(this.nodes.buttons.innerHTML="",this.nodes.actions.innerHTML="",this._toolsInstances=new Map,se.c.indexes.forEach((function(t){e.addTool(se.c.tool(t))})),this.recalculateWidth())}},{key:"addTool",value:function(e){var t=this,i=(this.state.tooltip,new e({blockEditable:this.blockEditable,insertHTML:function(e){t.insertHTML(e)}})),o=this.blockEditable.getLang("toolbar.insert.".concat(e.key)),a=Bt.a.make("div",[n.Class.button]);if(a.innerHTML=o,a){a.dataset.key=e.key,this.nodes.buttons.appendChild(a);var s=i.renderActions();s.classList.add(n.Class.actions),s.dataset.key=e.key,this.nodes.actions.appendChild(s),this._toolsInstances.set(e.key,i),this.listeners.on(a,"click",(function(n){t.activeTool(e.key),t.toolClicked(i),n.preventDefault()}))}}},{key:"activeTool",value:function(e){this._buttonsList&&this._buttonsList.forEach((function(t){t.classList.toggle(n.Class.activeButton,t.dataset.key===e)})),this._actionsList&&this._actionsList.forEach((function(t){t.classList.toggle(n.Class.activeActions,t.dataset.key===e)}))}},{key:"insertHTML",value:function(e){var t=this,n=this.blockEditable,i=n.editable,o=n.selection;this.restoreCursor()&&(i.document.execCommand("insertHTML",!1,e),setTimeout((function(){t._cacheRange=o.getRangeAt(0).cloneRange()}),250))}},{key:"restoreCursor",value:function(){var e=this.blockEditable.selection,t=e.anchorElement;return t&&t.closest('input,textarea,[contenteditable="true"]')||this._cacheRange&&this._cacheRange.setCursor(!0,!0),(t=e.anchorElement)&&t.closest('input,textarea,[contenteditable="true"]')}},{key:"toolClicked",value:function(e){}},{key:"enableFlipper",value:function(){var e=this;this._flipper=new Ft({focusedItemClass:n.Class.focusedButton,defaultFocusedItemClass:n.Class.activeButton,allowArrows:!0,allowShiftArrows:!1,keydownHanlder:function(t){var n=t.keyCode;return!(t.altKey||t.ctrlKey||t.metaKey||t.shiftKey||n!==wt.q.DOWN&&n!==wt.q.UP)&&(Promise.resolve().then((function(){var t=e.blockEditable.selection.getRangeAt(0);e.close(),t.setCursor(n===wt.q.DOWN,!0)})),t.preventDefault(),!0)}})}},{key:"flipper",get:function(){return this._flipper}}]),n}(jt);Vt.Class={insertToolbar:"beui-insert-toolbar",insertToolbarShowed:"beui-insert-toolbar--showed",close:"beui-insert-toolbar__close",actionsWrapper:"beui-insert-toolbar__actions",buttonsWrapper:"beui-insert-toolbar__buttons",button:"beui-insert-tool",focusedButton:"beui-insert-tool--focused",activeButton:"beui-insert-tool--active",actions:"beui-insert-tool__actions",activeActions:"beui-insert-tool__actions--active",togglerAndButtonsWrapper:"beui-insert-toolbar__toggler-and-button-wrapper"};var Ut=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).isMobile=!1,e._contentRectCache=void 0,e.resizeDebouncer=wt.d((function(){e.windowResize()}),200),e}return Object(s.a)(n,[{key:"addLoader",value:function(){this.nodes.loader=Bt.a.make("div",n.Class.editorLoader),this.nodes.wrapper.prepend(this.nodes.loader),this.nodes.redactor.classList.add(n.Class.editorZoneHidden)}},{key:"removeLoader",value:function(){this.nodes.loader.remove(),this.nodes.redactor.classList.remove(n.Class.editorZoneHidden)}},{key:"prepare",value:function(){var e=Object(ke.a)(ge.a.mark((function e(){return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.checkIsMobile(),this.make(),this.addLoader(),this.appendSVGSprite();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toggleReadOnly",value:function(e){e?this.disableModuleBindings():this.enableModuleBindings()}},{key:"checkEmptiness",value:function(){var e=this.state.content;this.nodes.wrapper.classList.toggle(n.Class.editorEmpty,e.isEmpty)}},{key:"destroy",value:function(){this.nodes.holder.innerHTML=""}},{key:"closeAllToolbars",value:function(){var e=this.state,t=e.toolbox,n=e.blockSettings,i=e.inlineToolbar,o=e.conversionToolbar;n.close(),i.close(),o.close(),t.close()}},{key:"elementFromPoint",value:function(e,t){return this.nodes.refactorDocumentOrShadowRoot?this.nodes.refactorDocumentOrShadowRoot.elementFromPoint(e,t):document.elementFromPoint(e,t)}},{key:"checkIsMobile",value:function(){this.isMobile=window.innerWidth<650}},{key:"make",value:function(){if(this.nodes.holder=this.blockEditable.holder,this.nodes.scroller=this.nodes.holder.closest(".editor-canvas"),this.nodes.wrapper=Bt.a.make("div",[n.Class.editorWrapper]),this.nodes.redactor=Bt.a.make("div",n.Class.editorZone),this.nodes.wrapper.appendChild(this.nodes.redactor),this.nodes.holder.appendChild(this.nodes.wrapper),this.nodes.content=Bt.a.make("div",[n.Class.editorZoneContent,n.Class.editorContent]),Ce.a.chrome){var e=this.nodes.redactor.attachShadow({mode:"open"});e.appendChild(this.nodes.content),this.nodes.refactorDocumentOrShadowRoot=e,this.blockEditable.editable.mount(this.nodes.content,e.getSelection?e.getSelection():document.getSelection())}else this.nodes.redactor.appendChild(this.nodes.content),this.blockEditable.editable.mount(this.nodes.content,document.getSelection())}},{key:"loadStyles",value:function(){}},{key:"enableModuleBindings",value:function(){var e=this;this.blockEditable.editable;this.readOnlyMutableListeners.on(this.nodes.content,"click",(function(t){e.contentClicked(t)}),!1),this.readOnlyMutableListeners.on(this.nodes.wrapper,"mousedown",(function(t){e.documentTouched(t)}),!0),this.readOnlyMutableListeners.on(this.nodes.wrapper,"mouseup",(function(t){e.documentMouseUp(t)}),!0),this.readOnlyMutableListeners.on(this.nodes.wrapper,"touchstart",(function(t){e.documentTouched(t)}),!0),this.readOnlyMutableListeners.on(document,"keydown",(function(t){e.documentKeydown(t)}),!0),this.readOnlyMutableListeners.on(document,"click",(function(t){e.documentClicked(t)}),!0),this.blockEditable.editable.on("selectionchange",(function(){e.selectionChanged()})),this.readOnlyMutableListeners.on(window,"resize",(function(){e.resizeDebouncer()}),{passive:!0})}},{key:"disableModuleBindings",value:function(){this.readOnlyMutableListeners.clearAll()}},{key:"windowResize",value:function(){this._contentRectCache=null,this.checkIsMobile()}},{key:"documentKeydown",value:function(e){switch(e.keyCode){case wt.q.ENTER:this.enterPressed(e);break;case wt.q.BACKSPACE:this.backspacePressed(e);break;case wt.q.ESC:this.escapePressed(e);break;case wt.q.INSERT:this.insertPressed(e);break;default:this.defaultBehaviour(e)}}},{key:"defaultBehaviour",value:function(e){var t=this.state.content.activeBlock,i=e.target.closest(".".concat(n.Class.editorWrapper)),o=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;void 0===t||null!==i?i||t&&o&&!wt.n(e.keyCode)||(this.state.content.dropPointer(),this.state.toolbar.close()):this.state.events.keydown(e)}},{key:"backspacePressed",value:function(e){var t=this.state,n=t.content,i=t.blockSelection,o=t.cursor,a=this.blockEditable.selection,s=n.activeBlock;if((i.anyBlockSelected||s&&s.inputSelection.anyInputSelected)&&!a.anchorNode){if(i.anyBlockSelected){var r=n.removeSelectedBlocks();o.setToBlock(n.insertDefaultBlockAtIndex(r||n.activeBlockIndex,!0),o.positions.START)}else s.inputSelection.removeSelectedInputs(),o.setToBlock(s);i.clearSelection(e),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()}else this.defaultBehaviour(e)}},{key:"escapePressed",value:function(e){var t=this.state,n=t.toolbox,i=t.blockSettings,o=t.inlineToolbar,a=t.toolbar,s=t.conversionToolbar,r=t.blockSelection,l=t.content,c=t.insertToolbar,u=this.blockEditable.selection.getRangeAt(0);r.clearSelection(e),n.opened?n.close():s.opened?s.close():i.opened?i.close():o.opened?(o.close(),u.setCursor(!0,!0)):l.activeBlock&&l.activeBlock.stretched?l.activeBlock.stretched=!1:(a.close(),c.close())}},{key:"enterPressed",value:function(e){var t=this.state,n=t.content,i=t.blockSelection,o=t.cursor,a=t.toolbar,s=this.blockEditable.selection,r=n.activeBlockIndex>=0;if(i.anyBlockSelected&&!s.anchorNode)return i.clearSelection(e),e.preventDefault(),e.stopImmediatePropagation(),void e.stopPropagation();if(!this.someToolbarOpened&&r&&"BODY"===e.target.tagName)if(n.activeBlock)this.state.events.keydown(e);else{var l=n.insert();o.setToBlock(l),n.highlightCurrentNode(),a.move(),a.plusButton.show()}i.clearSelection(e)}},{key:"insertPressed",value:function(e){var t=this.state,n=t.blockSelection,i=t.insertToolbar;n.clearSelection(e),this.blockEditable.selection.getRangeAt(0).setCursor(!0,!0),i.tryToShow()}},{key:"documentClicked",value:function(e){var t=this.state,i=t.content,o=t.blockSelection,a=t.conversionToolbar,s=t.crossSelection,r=t.toolbar,l=t.inlineToolbar;this.blockEditable.selection;if(e.isTrusted){var c=e.target;c&&1===c.nodeType&&c.closest(".".concat(n.Class.editorWrapper))||!!c.parentElement&&!!c.parentElement.closest(".".concat(n.Class.editorWrapper))||(i.dropPointer(),l.close(),r.close(),a.close());var u=e.metaKey||e.ctrlKey;s.isCrossBlockSelectionStarted||u||o.clearSelection(e)}}},{key:"documentMouseUp",value:function(e){var t=e.target;(t.closest(".".concat(qt.Class.inlineToolbar))||t.closest(".".concat(zt.Class.toolbar)))&&e.stopPropagation()}},{key:"documentTouched",value:function(e){var t=e.target;if(t.closest(".".concat(qt.Class.inlineToolbar))||t.closest(".".concat(zt.Class.toolbar))||t.closest(".".concat(Vt.Class.insertToolbar)))return e.stopPropagation(),void(t.closest('input,textarea,[contenteditable="true"]')||e.preventDefault());if(t===this.nodes.redactor||t===this.nodes.wrapper){var n=this.nodes.content.getBoundingClientRect(),i=n.x+n.width/2,o=e instanceof MouseEvent?e.clientY:e.touches[0].clientY;t=this.elementFromPoint(i,o)}if(t&&t!==this.nodes.redactor&&t!==this.nodes.wrapper)try{this.state.content.setActiveBlockBy(t)||this.state.cursor.setToBlock(this.state.content.activeBlock,this.state.cursor.positions.END),this.state.content.highlightCurrentNode()}catch(a){this.state.rectangleSelection.isRectActivated()||(this.state.cursor.setToTheLastBlock(),e.preventDefault(),e.stopPropagation())}else this.state.rectangleSelection.isRectActivated()||(this.state.cursor.setToTheLastBlock(),e.preventDefault(),e.stopPropagation());this.state.toolbar.open(),this.state.toolbar.plusButton.hide()}},{key:"contentClicked",value:function(e){if(this.blockEditable.selection.isCollapsed){var t=function(){e.stopImmediatePropagation(),e.stopPropagation()},n=e.target,i=e.metaKey||e.ctrlKey;if(Bt.a.isAnchor(n)&&i){t();var o=n.getAttribute("href")||"",a=wt.h(o);wt.s(a)}else{var s=this.state,r=s.content,l=s.blockSelection;if(!r.activeBlock){if(r.blocks.length)return;t(),r.insert()}if(i&&(r.activeBlock.selected=!0,l.clearCache()),r.activeBlock.isDefault)t(),r.activeBlock.isEmpty&&this.state.toolbar.plusButton.show()}}}},{key:"selectionChanged",value:function(e){var t=this.state,n=t.crossSelection,i=t.blockSelection,o=t.inlineToolbar,a=t.content,s=this.blockEditable.selection,r=s.anchorElement;n.isCrossBlockSelectionStarted&&i.anyBlockSelected&&s.removeAllRanges(),r&&r.closest(".".concat(Ht.Class.content))?(a.activeBlock||a.setActiveBlockBy(r),o.tryToShow(!0)):o.containsNode(r)||o.close()}},{key:"appendSVGSprite",value:function(){var e=Bt.a.make("div");e.hidden=!0,e.style.display="none",Bt.a.append(this.nodes.wrapper,e)}},{key:"contentRect",get:function(){if(this._contentRectCache)return this._contentRectCache;var e=this.nodes.wrapper.querySelector(".".concat(Ht.Class.content));return e?(this._contentRectCache=e.getBoundingClientRect(),this._contentRectCache):{width:650,left:0,right:0}}},{key:"layout",set:function(e){"print"===e?(this.nodes.wrapper.classList.toggle(n.Class.editorWrapperMobile,!1),this.nodes.wrapper.classList.toggle(n.Class.editorWrapperPrint,!0)):"mobile"===e?(this.nodes.wrapper.classList.toggle(n.Class.editorWrapperMobile,!0),this.nodes.wrapper.classList.toggle(n.Class.editorWrapperPrint,!1)):(this.nodes.wrapper.classList.toggle(n.Class.editorWrapperMobile,!1),this.nodes.wrapper.classList.toggle(n.Class.editorWrapperPrint,!1)),this._contentRectCache=null},get:function(){var e=this.nodes.wrapper.classList.contains(n.Class.editorWrapperMobile),t=this.nodes.wrapper.classList.contains(n.Class.editorWrapperPrint);return e?"mobile":t?"print":"web"}},{key:"someToolbarOpened",get:function(){var e=this.state,t=e.toolbox,n=e.blockSettings,i=e.inlineToolbar,o=e.conversionToolbar;return n.opened||i.opened||o.opened||t.opened}},{key:"someFlipperButtonFocused",get:function(){return Object.entries(this.state).filter((function(e){var t=Object(be.a)(e,2);t[0];return t[1].flipper instanceof Ft})).some((function(e){var t=Object(be.a)(e,2);t[0];return t[1].flipper.currentItem}))}},{key:"isAtEditor",get:function(){var e=this.blockEditable.selection,t=e.anchorNode||e.focusNode;t&&t.nodeType===Node.TEXT_NODE&&(t=t.parentNode);var i=null;return t&&(i=t.closest(".".concat(n.Class.editorZoneContent))),i&&i.nodeType===Node.ELEMENT_NODE}}],[{key:"Class",get:function(){return{editorWrapper:"beui-editor",editorWrapperWeb:"beui-editor--web",editorWrapperPrint:"beui-editor--print",editorWrapperMobile:"beui-editor--mobile",editorZone:"beui-editor__redactor",editorZoneHidden:"beui-editor__redactor--hidden",editorZoneContent:"beui-editor__content",editorContent:"be-content",editorLoader:"beui-editor__loader",editorEmpty:"beui-editor--empty",editorRtlFix:"beui-editor--rtl"}}}]),n}(jt),Wt=n(801),Kt=n.n(Wt),$t=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).lib=new Kt.a,e}return Object(s.a)(n,[{key:"show",value:function(e,t,n){this.lib.show(e,t,n)}},{key:"hide",value:function(){this.lib.hide()}},{key:"onHover",value:function(e,t,n){this.lib.onHover(e,t,n)}}]),n}(jt),Xt={img:{src:!0,alt:!0},taskinput:{type:!0,checked:!0}},Gt=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).MIME_TYPE="application/block-editable",e.componentsTags={},e.tagsByPlugin={},e.typesByPlugin={},e.componentsPatterns=[],e.componentsFiles={},e.exceptionList=[],e.processPlugin=function(t){try{var n=new t({blockEditable:e.blockEditable});if(!t.pasteConfig)return void e.exceptionList.push(t.name);if(!wt.k(n.onPaste))return;e.getTypesConfig(t),e.getTagsConfig(t),e.getFilesConfig(t),e.getPatternsConfig(t)}catch(i){}},e.handlePasteEvent=function(){var t=Object(ke.a)(ge.a.mark((function t(n){var i,o,a,s,r;return ge.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n,o=e.state,a=o.content,s=o.toolbar,a.removeSelectedBlocks(),i.target&&i.clipboardData){t.next=5;break}return t.abrupt("return");case 5:if((r=a.activeBlock)&&(!e.isNativeBehaviour(i.target)||i.clipboardData.types.includes("Files"))){t.next=8;break}return t.abrupt("return");case 8:if(!r||!e.exceptionList.includes(a.activeBlock.component.key)){t.next=10;break}return t.abrupt("return");case 10:if(!r||!r.stretched){t.next=12;break}return t.abrupt("return");case 12:n.preventDefault(),e.processDataTransfer(i.clipboardData),a.clearFocused(),s.close();case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(s.a)(n,[{key:"prepare",value:function(){var e=Object(ke.a)(ge.a.mark((function e(){return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.processPlugins();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toggleReadOnly",value:function(e){e?this.unsetCallback():this.setCallback()}},{key:"processDataTransfer",value:function(){var e=Object(ke.a)(ge.a.mark((function e(t){var n,i,o,a,s,r,l,c,u,d,h,p,f,v,b=arguments;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=b.length>1&&void 0!==b[1]&&b[1],i=this.state.sanitizer,t){e.next=4;break}return e.abrupt("return");case 4:o=t.types,a="",s=0;case 7:if(!(s<o.length)){e.next=24;break}r=o[s].toLowerCase(),e.t0=ge.a.keys(this.typesByPlugin);case 10:if((e.t1=e.t0()).done){e.next=19;break}if(l=e.t1.value,!Object.prototype.hasOwnProperty.call(this.typesByPlugin,l)){e.next=17;break}if(!this.typesByPlugin[l].includes(r)){e.next=17;break}return a=l,e.abrupt("break",19);case 17:e.next=10;break;case 19:if(!a){e.next=21;break}return e.abrupt("break",24);case 21:s++,e.next=7;break;case 24:if(!a){e.next=29;break}return c={component:a,isBlock:!0,event:this.composePasteEvent("type",{data:t}),common:{quote:!1}},e.next=28,this.processData(c);case 28:return e.abrupt("return");case 29:if(!(o.includes?o.includes("Files"):o.contains("Files"))){e.next=34;break}return e.next=33,this.processFiles(t.files);case 33:return e.abrupt("return");case 34:if(u=t.getData(this.MIME_TYPE),d=t.getData("text/plain"),h=t.getData("text/html"),!u){e.next=45;break}return e.prev=38,this.insertEditorJSData(JSON.parse(u)),e.abrupt("return");case 43:e.prev=43,e.t2=e.catch(38);case 45:if(n&&d.trim()&&h.trim()&&(h="<p>"+(h.trim()?h:d)+"</p>"),!h.trim()&&d.trim()&&(h=this.blockEditable.utils.makeHtml(d)),p=Object.keys(this.componentsTags).reduce((function(e,t){return e[t.toLowerCase()]=!0,e}),{}),f=Object.assign({},p,i.getAllInlineToolsConfig(),{br:{},blockquote:!0}),(v=i.clean(h,f)).trim()&&v.trim()!==d&&Bt.a.isHTMLString(v)){e.next=55;break}return e.next=53,this.processText(d);case 53:e.next=57;break;case 55:return e.next=57,this.processText(v,!0);case 57:case"end":return e.stop()}}),e,this,[[38,43]])})));return function(t){return e.apply(this,arguments)}}()},{key:"processText",value:function(){var e=Object(ke.a)(ge.a.mark((function e(t){var n,i,o,a,s,r,l,c=this,u=arguments;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u.length>1&&void 0!==u[1]&&u[1],i=this.state,o=i.cursor,a=i.content,(s=n?this.processHTML(t):this.processPlain(t)).length){e.next=5;break}return e.abrupt("return");case 5:if(1!==s.length){e.next=8;break}return s[0].isBlock?this.processSingleBlock(s.pop()):this.processInlinePaste(s.pop()),e.abrupt("return");case 8:r=a.activeBlock&&a.activeBlock.isDefault,l=r&&a.activeBlock.isEmpty,s.map(function(){var e=Object(ke.a)(ge.a.mark((function e(t,n){return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.insertBlock(t,0===n&&l));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),a.activeBlock&&o.setToBlock(a.activeBlock,o.positions.END);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setCallback",value:function(){this.readOnlyMutableListeners.on(document,"paste",this.handlePasteEvent)}},{key:"unsetCallback",value:function(){this.readOnlyMutableListeners.clearAll()}},{key:"processPlugins",value:function(){var e=se.a.components;Array.from(Object.values(e)).forEach(this.processPlugin)}},{key:"getTypesConfig",value:function(e){var t,n=(null===(t=e.pasteConfig)||void 0===t?void 0:t.types)||[];this.typesByPlugin[e.key]=n.map((function(e){return e.toLowerCase()}))}},{key:"getTagsConfig",value:function(e){var t,n=this,i=(null===(t=e.pasteConfig)||void 0===t?void 0:t.tags)||[];i.forEach((function(t){Object.prototype.hasOwnProperty.call(n.componentsTags,t)||(n.componentsTags[t.toUpperCase()]={component:e})})),this.tagsByPlugin[e.key]=i.map((function(e){return e.toUpperCase()}))}},{key:"getFilesConfig",value:function(e){var t=(e.pasteConfig||{}).files,n=void 0===t?{}:t,i=n.extensions,o=n.mimeTypes;(i||o)&&(i&&!Array.isArray(i)&&(i=[]),o&&!Array.isArray(o)&&(o=[]),o&&(o=o.filter((function(e){return!!wt.p(e)}))),this.componentsFiles[e.key]={extensions:i||[],mimeTypes:o||[]})}},{key:"getPatternsConfig",value:function(e){var t=this;e.pasteConfig&&e.pasteConfig.patterns&&!wt.j(e.pasteConfig.patterns)&&Object.entries(e.pasteConfig.patterns).forEach((function(n){var i=Object(be.a)(n,2),o=i[0],a=i[1];RegExp,t.componentsPatterns.push({key:o,pattern:a,component:e})}))}},{key:"isNativeBehaviour",value:function(e){return Bt.a.isNativeInput(e)}},{key:"processData",value:function(){var e=Object(ke.a)(ge.a.mark((function e(t){var n,i,o;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.state.content,i=n.activeBlock&&n.activeBlock.isDefault,o=i&&n.activeBlock.isEmpty,this.insertBlock(t,o);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processFiles",value:function(){var e=Object(ke.a)(ge.a.mark((function e(t){var n,i,o,a,s,r=this;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.state.content,e.next=3,Promise.all(Array.from(t).map((function(e){return r.processFile(e)})));case 3:o=e.sent,o=null===(n=o)||void 0===n?void 0:n.filter((function(e){return!!e})),a=i.activeBlock.isDefault,s=a&&i.activeBlock.isEmpty,o.forEach((function(e,t){e&&i.paste(e.type,e.event,{},0===t&&s)}));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processFile",value:function(){var e=Object(ke.a)(ge.a.mark((function e(t){var n,i,o,a,s;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=wt.g(t),i=Object.entries(this.componentsFiles).find((function(e){var i=Object(be.a)(e,2),o=(i[0],i[1]),a=o.mimeTypes,s=o.extensions,r=t.type.split("/"),l=Object(be.a)(r,2),c=l[0],u=l[1],d=s.find((function(e){return e.toLowerCase()===n.toLowerCase()})),h=a.find((function(e){var t=e.split("/"),n=Object(be.a)(t,2),i=n[0],o=n[1];return i===c&&(o===u||"*"===o)}));return!!d||!!h}))){e.next=4;break}return e.abrupt("return");case 4:return o=Object(be.a)(i,1),a=o[0],s=this.composePasteEvent("file",{file:t}),e.abrupt("return",{event:s,type:a});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processHTML",value:function(e){var t=this,n=this.state.sanitizer,i=Bt.a.make("DIV");i.innerHTML=e;var o=this.getNodes(i);return o.forEach((function(e){Bt.a.removeNodeStyle(e)})),o.map((function(e){var i,o,a,s=t.blockEditable.defaultBlockComp,r=!1;switch(e.nodeType){case Node.DOCUMENT_FRAGMENT_NODE:(a=Bt.a.make("div")).appendChild(e);break;case Node.ELEMENT_NODE:a=e,r=!0,t.componentsTags[a.tagName]&&(s=t.componentsTags[a.tagName].component)}var l=((null===(i=s.pasteConfig)||void 0===i?void 0:i.tags)||[]).reduce((function(e,t){return e[t.toLowerCase()]=Xt[t.toLowerCase()]||{},e}),{}),c=Object.assign({},l,n.getInlineToolsConfig(s));a&&(a.closest("table")||(a.innerHTML=n.clean(a.innerHTML,c)));var u=t.composePasteEvent("tag",{data:a});return{content:a,isBlock:r,component:s.key,event:u,common:{quote:!!(null===(o=a)||void 0===o?void 0:o.closest("blockquote"))}}})).filter((function(e){return!Bt.a.isNodeEmpty(e.content)||Bt.a.isSingleTag(e.content)}))}},{key:"processPlain",value:function(e){var t=this;if(!e)return[];var n=this.blockEditable.defaultBlockComp;return e.split(/\r?\n/).filter((function(e){return e.trim()})).map((function(e){var i=Bt.a.make("div");i.textContent=e;var o=t.composePasteEvent("tag",{data:i});return{content:i,component:n.key,isBlock:!1,event:o,common:{quote:!1}}}))}},{key:"processSingleBlock",value:function(){var e=Object(ke.a)(ge.a.mark((function e(t){var n,i,o,a,s,r;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.state,a=o.cursor,s=o.content,(r=s.activeBlock)&&t.component===r.component.key&&Bt.a.containsOnlyInlineElements((null===(n=t.content)||void 0===n?void 0:n.innerHTML)||"")){e.next=5;break}return this.insertBlock(t,(null===r||void 0===r?void 0:r.isDefault)&&r.isEmpty),e.abrupt("return");case 5:a.insertContentAtCursorPosition((null===(i=t.content)||void 0===i?void 0:i.innerHTML)||"");case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processInlinePaste",value:function(){var e=Object(ke.a)(ge.a.mark((function e(t){var i,o,a,s,r,l,c,u,d,h;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.state,o=i.content,a=i.cursor,s=i.sanitizer,r=t.content){e.next=4;break}return e.abrupt("return");case 4:if(l=this.blockEditable.editable,!(o.activeBlock&&o.activeBlock.isDefault&&r.textContent&&r.textContent.length<n.PATTERN_PROCESSING_MAX_LENGTH)){e.next=15;break}return e.next=9,this.processPattern(r.textContent);case 9:if(!(c=e.sent)){e.next=15;break}return u=o.activeBlock&&o.activeBlock.isDefault&&o.activeBlock.isEmpty,d=o.paste(c.component,c.event,{},u),a.setToBlock(d,a.positions.END),e.abrupt("return");case 15:o.activeBlock&&o.activeBlock.currentInput?(h=s.getInlineToolsConfig(o.activeBlock.component),l.document.execCommand("insertHTML",!1,s.clean(r.innerHTML,h))):this.insertBlock(t);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processPattern",value:function(){var e=Object(ke.a)(ge.a.mark((function e(t){var n,i;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.componentsPatterns.find((function(e){var n=e.pattern.exec(t);return!!n&&t===n.shift()}))){e.next=3;break}return e.abrupt("return");case 3:return i=this.composePasteEvent("pattern",{key:n.key,data:t}),e.abrupt("return",{event:i,component:n.component.key});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"insertBlock",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.state,o=i.content,a=i.cursor,s=o.activeBlock;n&&s&&s.isEmpty?(t=o.paste(e.component,e.event,e.common,!0))&&a.setToBlock(t,a.positions.END):(t=o.paste(e.component,e.event,e.common))&&a.setToBlock(t,a.positions.END)}},{key:"insertEditorJSData",value:function(e){var t=this.state,n=t.content,i=t.cursor;t.sanitizer.sanitizeBlocks(e).forEach((function(e,t){var o=e.key,a=e.data,s=e.common,r=!1;0===t&&(r=n.activeBlock&&n.activeBlock.isDefault&&n.activeBlock.isEmpty);var l=n.insert({data:{key:o,data:a,common:s},replace:r});i.setToBlock(l,i.positions.END)}))}},{key:"processElementNode",value:function(e,t,n){var i=Object.keys(this.componentsTags),o=e,a=(this.componentsTags[o.tagName]||{}).component,s=this.tagsByPlugin[null===a||void 0===a?void 0:a.key]||[],r=i.includes(o.tagName),l=Bt.a.blockElements.includes(o.tagName.toLowerCase()),c=Array.from(o.children).some((function(e){var t=e.tagName;return i.includes(t)&&!s.includes(t)})),u=Array.from(o.children).some((function(e){var t=e.tagName;return Bt.a.blockElements.includes(t.toLowerCase())}));return l||r||c?r&&!c||l&&!u&&!c?[].concat(Object(p.a)(t),[n,o]):void 0:(n.appendChild(o),[].concat(Object(p.a)(t),[n]))}},{key:"getNodes",value:function(e){var t,n=this;return Array.from(e.childNodes).reduce((function e(i,o){if(Bt.a.isEmpty(o)&&!Bt.a.isSingleTag(o))return i;var a=i[i.length-1],s=new DocumentFragment;switch(a&&Bt.a.isFragment(a)&&(s=i.pop()),o.nodeType){case Node.ELEMENT_NODE:if(t=n.processElementNode(o,i,s))return t;break;case Node.TEXT_NODE:return s.appendChild(o),[].concat(Object(p.a)(i),[s]);default:return[].concat(Object(p.a)(i),[s])}return[].concat(Object(p.a)(i),Object(p.a)(Array.from(o.childNodes).reduce(e,[])))}),[])}},{key:"composePasteEvent",value:function(e,t){return new CustomEvent(e,{detail:t})}}]),n}(jt);Gt.PATTERN_PROCESSING_MAX_LENGTH=450;var Yt=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"prepare",value:function(){var e=Object(ke.a)(ge.a.mark((function e(){var t=this;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.blockEditable.editable.ready((function(){t.readOnlyMutableListeners.on(document,"copy",(function(e){t.handleCopyEvent(e)})),t.readOnlyMutableListeners.on(document,"cut",(function(e){t.handleCutEvent(e)}))}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleCopyEvent",value:function(){var e=Object(ke.a)(ge.a.mark((function e(t){var n,i,o,a,s,r,l,c;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t,i=this.state,o=i.blockSelection,a=i.content,s=this.blockEditable.selection,!(r=a.activeBlock)||!r.stretched){e.next=6;break}return e.abrupt("return");case 6:if(!o.anyBlockSelected){e.next=10;break}return e.abrupt("return",o.copySelectedBlocks(n));case 10:if(!a.activeBlock||!a.activeBlock.inputSelection.anyInputSelected){e.next=14;break}return e.abrupt("return",a.activeBlock.inputSelection.copySelectedInputs(n));case 14:(l=s.anchorNode||s.focusNode)&&((c=1===l.nodeType?l:l.parentElement)&&c.closest("[contenteditable]")||t.preventDefault());case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleCutEvent",value:function(){var e=Object(ke.a)(ge.a.mark((function e(t){var n,i,o,a,s,r,l,c,u,d;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t,i=this.state,o=i.blockSelection,a=i.content,s=i.cursor,r=this.blockEditable.selection,!(l=a.activeBlock)||!l.stretched){e.next=6;break}return e.abrupt("return");case 6:if(!o.anyBlockSelected){e.next=14;break}return e.next=9,o.copySelectedBlocks(n);case 9:void 0!==(c=a.removeSelectedBlocks())&&s.setToBlock(a.insertDefaultBlockAtIndex(c,!0),s.positions.START),o.clearSelection(t),e.next=23;break;case 14:if(!a.activeBlock||!a.activeBlock.inputSelection.anyInputSelected){e.next=20;break}a.activeBlock.inputSelection.copySelectedInputs(n),a.activeBlock.inputSelection.removeSelectedInputs(),s.setToBlock(a.activeBlock),e.next=23;break;case 20:return(u=r.anchorNode||r.focusNode)&&((d=1===u.nodeType?u:u.parentElement)&&d.closest("[contenteditable]")||t.preventDefault()),e.abrupt("return");case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(jt),Zt=n(805),Jt=n.n(Zt),Qt=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"show",value:function(e){Jt.a.show(e)}}]),n}(jt),en=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"dblclick",value:function(e){var t=this.state.content,n=Ht.getFakeInput(e.target),i=t.activeBlock;n&&i&&i.currentInput===n&&i.currentInputFocused&&i.onEditFakeInput(n)}},{key:"mousedown",value:function(e){var t=this.state.content,n=this.blockEditable.selection,i=Ht.getFakeInput(e.target),o=t.activeBlock;i&&o&&(o.currentInput=i,n.select(i),e.preventDefault())}},{key:"keydown",value:function(e){this.beforeKeydownProcessing(e);var t=Ke.Enter,n=Ke.Backspace,i=Ke.Down,o=Ke.Right,a=Ke.Up,s=Ke.Left,r=Ke.Tab,l=Ke.Alt;switch(e.keyCode){case t:this.enter(e);break;case n:this.backspace(e);break;case i:case o:this.arrowRightAndDown(e,e.keyCode===i);break;case a:case s:this.arrowLeftAndUp(e,e.keyCode===a);break;case l:if(e.ctrlKey||e.shiftKey||e.metaKey||wt.n(e.keyCode))return;this.convertMarkdown(e);break;case r:this.tabPressed(e)}}},{key:"beforeKeydownProcessing",value:function(e){if(this.needToolbarClosing(e)){var t=this.state,n=t.toolbar,i=t.conversionToolbar,o=t.insertToolbar,a=t.content,s=t.blockSelection;if(wt.n(e.keyCode))e.ctrlKey||e.metaKey||e.altKey||e.shiftKey||(n.close(),i.close(),o.close(),a.clearFocused(),s.clearSelection(e))}}},{key:"keyup",value:function(e){e.shiftKey||this.state.ui.checkEmptiness()}},{key:"tabPressed",value:function(e){this.state.blockSelection.clearSelection(e);var t=this.state,n=t.content,i=t.inlineToolbar,o=t.conversionToolbar,a=(t.toolbox,this.blockEditable.selection),s=n.activeBlock;if(s){var r=s.isDefault&&s.isEmpty,l=!s.isEmpty&&o.opened,c=!s.isEmpty&&!a.isCollapsed&&i.opened;r?this.activateToolbox():l||c||this.activateBlockSettings()}}},{key:"convertMarkdown",value:function(e){var t=this;this.state.blockSelection.clearSelection(e);var n=this.state,i=n.content,o=n.toolbox,a=n.toolbar,s=i.activeBlock;if(!s||!s.isDefault)return 0;var r=(s.save().data.content||"").replace(/<[^>]+>.*?<\/?[^>]+>/g,(function(e){return t.blockEditable.utils.makeMarkdown(e).trim()})).trim(),l=o.matchCommand(r);return l?(a.close(),a.plusButton.hide(),this.activateToolbox(l),e.stopPropagation(),e.preventDefault(),Object.keys(l).length):0}},{key:"dragOver",value:function(e){var t=this.state.content.getBlock(e.target);t&&(t.dropTarget=!0)}},{key:"dragLeave",value:function(e){var t=this.state.content.getBlock(e.target);t&&(t.dropTarget=!1)}},{key:"handleCommandC",value:function(){var e=Object(ke.a)(ge.a.mark((function e(t){var n;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=this.state.blockSelection).anyBlockSelected){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",n.copySelectedBlocks(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleCommandX",value:function(){var e=Object(ke.a)(ge.a.mark((function e(t){var n,i,o,a,s;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.state,i=n.blockSelection,o=n.content,a=n.cursor,i.anyBlockSelected){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,i.copySelectedBlocks(t);case 5:void 0!==(s=o.removeSelectedBlocks())&&a.setToBlock(o.insertDefaultBlockAtIndex(s,!0),a.positions.START),i.clearSelection(t);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"enter",value:function(e){var t=this.state,n=t.content,i=t.ui,o=t.cursor,a=n.activeBlock;if(a&&(!i.someToolbarOpened||!i.someFlipperButtonFocused)&&!e.shiftKey){if(e.ctrlKey||e.metaKey){var s=a.currentInput;if(s&&Ht.isFakeInput(s)&&s instanceof HTMLElement&&a.onEditFakeInput(s))return e.stopPropagation(),void e.preventDefault()}if(!a.component.isLineBreaksEnabled){if(o.isAtEnd){var r=this.convertMarkdown(e);if(r>0&&(!(a=n.activeBlock)||r>1||!a.isDefault&&a.isEmpty||a.component.isLineBreaksEnabled||Ht.isFakeInput(a.currentInput)))return}var l=a;if(!o.isAtStart||!Ht.isFakeInput(a.currentInput)&&a.hasMedia)l=n.split();else{var c=n.activeBlockIndex,u=c+(o.isAtEnd?1:0);l=n.insertDefaultBlockAtIndex(u),c===u&&(l=a)}l&&(o.setToBlock(l),l.isDefault&&l.isEmpty&&(this.state.toolbar.open(!1),this.state.toolbar.plusButton.show()),e.preventDefault())}}}},{key:"backspace",value:function(e){var t=this.state,n=t.content,i=t.blockSelection,o=t.cursor,a=this.blockEditable.selection,s=n.activeBlock,r=s.component;if(s.canBackspaceRemove()){e.preventDefault();var l=n.activeBlockIndex;return n.previousBlock&&0===n.previousBlock.inputs.length?n.removeBlock(l-1):n.removeBlock(),o.setToBlock(n.activeBlock,l?o.positions.END:o.positions.START),this.state.toolbar.close(),void i.clearSelection(e)}if(!r.isLineBreaksEnabled||o.isAtStart){var c=0===n.activeBlockIndex;o.isAtStart&&a.isCollapsed&&s.currentInput===s.firstInput&&!c&&(e.preventDefault(),this.mergeBlocks())}}},{key:"mergeBlocks",value:function(){var e=this.state,t=e.content,n=e.cursor,i=e.toolbar,o=t.previousBlock,a=t.activeBlock;if(o)return a.component.key===o.component.key&&o.mergeable?void(o.lastInput&&(n.createShadow(o.lastInput),t.mergeBlocks(o,a).then((function(){o.componentContent&&(n.restoreCursor(o.componentContent),o.componentContent.normalize()),i.close()})))):0===o.inputs.length||o.isEmpty?(t.removeBlock(t.activeBlockIndex-1),n.setToBlock(t.activeBlock),void i.close()):void(n.navigatePrevious()&&i.close())}},{key:"arrowRightAndDown",value:function(e,t){var n=this.state,i=n.content,o=n.cursor,a=n.toolbar,s=n.ui,r=n.blockSelection,l=n.crossSelection,c=Ft.usedKeys.includes(e.keyCode)&&(!e.shiftKey||e.keyCode===wt.q.TAB);if(!s.someToolbarOpened||!c){i.clearFocused(),a.close();var u=t&&o.isAtEnd||o.isAtBottom||r.anyBlockSelected;if(e.shiftKey&&e.keyCode===wt.q.DOWN&&u)l.toggleBlockSelectedState();else(e.keyCode===wt.q.DOWN||e.keyCode===wt.q.RIGHT&&!this.isRtl?o.navigateNext(e.keyCode===wt.q.DOWN):o.navigatePrevious())?e.preventDefault():wt.e((function(){i.activeBlock?(i.activeBlock.updateCurrentInput(),i.highlightCurrentNode()):o.setToTheLastBlock()}),20)(),r.clearSelection(e)}}},{key:"arrowLeftAndUp",value:function(e,t){var n=this.state,i=n.content,o=n.cursor,a=n.toolbar,s=n.ui,r=n.blockSelection,l=n.crossSelection,c=(n.inlineToolbar,t&&o.isAtTop||o.isAtStart||r.anyBlockSelected);if(s.someToolbarOpened){if(Ft.usedKeys.includes(e.keyCode)&&(!e.shiftKey||e.keyCode===wt.q.TAB))return;if(!c&&e.shiftKey&&e.keyCode>=wt.q.LEFT&&e.keyCode<=wt.q.DOWN)return;s.closeAllToolbars()}(i.clearFocused(),a.close(),e.shiftKey&&e.keyCode===wt.q.UP&&c)?l.toggleBlockSelectedState(!1):((e.keyCode===wt.q.UP||e.keyCode===wt.q.LEFT&&!this.isRtl?o.navigatePrevious(e.keyCode===wt.q.UP):o.navigateNext())?e.preventDefault():wt.e((function(){i.activeBlock?(i.activeBlock.updateCurrentInput(),i.highlightCurrentNode()):o.setToTheLastBlock()}),20)(),r.clearSelection(e))}},{key:"needToolbarClosing",value:function(e){var t=e.keyCode===wt.q.ENTER&&this.state.toolbox.opened,n=e.keyCode===wt.q.ENTER&&this.state.blockSettings.opened,i=e.keyCode===wt.q.ENTER&&this.state.inlineToolbar.opened,o=e.keyCode===wt.q.ENTER&&this.state.conversionToolbar.opened,a=e.keyCode===wt.q.TAB;return!(e.shiftKey&&!wt.n(e.keyCode)||a||t||n||i||o)}},{key:"activateToolbox",value:function(e){this.state.toolbar.opened||(this.state.toolbar.open(!1,!1),!e&&this.state.toolbar.plusButton.show()),this.state.toolbar.adjustToolbox(),this.state.toolbox.open(e)}},{key:"activateBlockSettings",value:function(){this.state.toolbar.opened||(this.state.content.activeBlock.focused=!0,this.state.toolbar.open(!0,!1),this.state.toolbar.plusButton.hide()),this.state.blockSettings.opened||this.state.blockSettings.open()}}]),n}(jt),tn=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).isStartedAtEditor=!1,e}return Object(s.a)(n,[{key:"toggleReadOnly",value:function(e){e?this.disableModuleBindings():this.enableModuleBindings()}},{key:"enableModuleBindings",value:function(){var e=this,t=this.state.ui;this.readOnlyMutableListeners.on(t.nodes.wrapper,"drop",function(){var t=Object(ke.a)(ge.a.mark((function t(n){return ge.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.processDrop(n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),!0),this.readOnlyMutableListeners.on(t.nodes.wrapper,"dragstart",(function(){e.processDragStart()})),this.readOnlyMutableListeners.on(t.nodes.wrapper,"dragover",(function(t){e.processDragOver(t)}),!0)}},{key:"disableModuleBindings",value:function(){this.readOnlyMutableListeners.clearAll()}},{key:"processDrop",value:function(){var e=Object(ke.a)(ge.a.mark((function e(t){var n,i,o,a,s,r,l,c;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.state,i=n.content,o=n.cursor,a=n.paste,s=n.ui,r=this.blockEditable.selection,t.preventDefault(),l=i.dropTargetBlock,i.blocks.forEach((function(e){e.dropTarget=!1})),s.isAtEditor&&!r.isCollapsed&&this.isStartedAtEditor&&document.execCommand("delete"),this.isStartedAtEditor=!1,l?o.setToBlock(l,o.positions.END):(c=i.setActiveBlockBy(i.lastBlock.holder))&&o.setToBlock(c,o.positions.END),e.next=10,a.processDataTransfer(t.dataTransfer,!0);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processDragStart",value:function(){var e=this.blockEditable.selection;this.state.ui.isAtEditor&&!e.isCollapsed&&(this.isStartedAtEditor=!0),this.state.inlineToolbar.close()}},{key:"processDragOver",value:function(e){e.preventDefault()}}]),n}(jt),nn=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"setToBlock",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.positions.DEFAULT,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(e){var i,o=this.state.content;switch(t){case this.positions.START:i=e.firstInput;break;case this.positions.END:i=e.lastInput;break;default:i=e.currentInput}if(i){var a=Bt.a.getDeepestNode(i,t===this.positions.END||-1===n),s=Bt.a.getContentLength(a);switch(!0){case t===this.positions.START:-1===n&&(n=s);break;case t===this.positions.END:case-1===n:case n>s:n=s}this.set(a,n),o.setActiveBlockBy(e.holder),o.activeBlock.currentInput=i}}}},{key:"setToInput",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.positions.DEFAULT,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this.state.content.activeBlock,o=Bt.a.getDeepestNode(e);switch(t){case this.positions.START:this.set(o,0);break;case this.positions.END:this.set(o,Bt.a.getContentLength(o));break;default:n&&this.set(o,n)}i.currentInput=e,this.state.content.highlightCurrentNode()}},{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.blockEditable.editable.selection,i=Ht.getFakeInput(e);i?n.select(i):n.setCursor(e,t),this.scrollToView()}},{key:"scrollToView",value:function(){var e=this.blockEditable.editable.selection,t=this.state.ui,n=e.rangeRect;if(n&&t.nodes.scroller){var i=t.nodes.scroller.getBoundingClientRect(),o=n.top,a=n.bottom;0===o&&0===a||(o<i.top&&t.nodes.scroller.scrollBy(0,o-i.top),a>i.bottom&&t.nodes.scroller.scrollBy(0,a-i.bottom+20))}}},{key:"setToTheLastBlock",value:function(){var e=this.state.content.lastBlock;if(e)if(e.isDefault&&e.isEmpty)this.setToBlock(e);else{var t=this.state.content.insertAtEnd();t&&this.setToBlock(t)}}},{key:"extractFragmentFromCursorPosition",value:function(){var e=this.blockEditable.editable,t=e.selection,n=e.document;if(t.rangeCount){var i=t.getRangeAt(0),o=this.state.content.activeBlock.currentInput;if(i.deleteContents(),o){if(Bt.a.isNativeInput(o)){var a=o,s=n.createDocumentFragment(),r=a.value.substring(0,a.selectionStart||0),l=a.value.substring(a.selectionStart||0);return s.textContent=l,a.value=r,s}var c=i.cloneRange();return c.selectNodeContents(o),c.setStart(i.endContainer,i.endOffset),c.extractContents()}}}},{key:"navigateNext",value:function(e){var t=this.state.content,n=t.activeBlock,i=t.nextContentfulBlock;if(!n)return!1;var o=e?n.downInput:n.rightInput,a=this.isAtEnd,s=i;if(!s&&!o){if(n.isDefault||!a)return!1;if(s=t.insertAtEnd())return this.setToBlock(s,this.positions.START),!0}return!!(e?this.isAtBottom:this.isAtEnd)&&(o?this.setToInput(o,this.positions.START):s&&this.setToBlock(s,this.positions.START),!0)}},{key:"navigatePrevious",value:function(e){var t=this.state.content,n=t.activeBlock,i=t.previousContentfulBlock;if(!n)return!1;var o=e?n.upInput:n.leftInput;return!(!i&&!o)&&(!!(e?this.isAtTop:this.isAtStart)&&(o?this.setToInput(o,this.positions.END):i&&this.setToBlock(i,this.positions.END),!0))}},{key:"createShadow",value:function(e){var t=document.createElement("span");t.classList.add(n.Class.shadowCursor),e.insertAdjacentElement("beforeend",t)}},{key:"restoreCursor",value:function(e){var t=e.querySelector(".".concat(n.Class.shadowCursor));if(t){var i=this.blockEditable.selection;setTimeout((function(){i.getRangeAt(0).setStartAfter(t).setCursor(!1,!0),t.remove()}),50)}}},{key:"insertContentAtCursorPosition",value:function(e){var t,n=this.blockEditable.editable,i=n.selection,o=n.document,a=o.createDocumentFragment(),s=o.createElement("div"),r=i.getRangeAt(0);s.innerHTML=e,Array.from(s.childNodes).forEach((function(e){return a.appendChild(e)})),0===a.childNodes.length&&a.appendChild(new Text(""));var l=a.lastChild;r.deleteContents(),r.insertNode(a),r.setStart(l,(null===l||void 0===l||null===(t=l.textContent)||void 0===t?void 0:t.length)||0).collapse(!0).setCursor()}},{key:"getHigherLevelSiblings",value:function(e,t){for(var n=e,i=[];n.parentNode&&"true"!==n.parentNode.contentEditable;)n=n.parentNode;for(var o="left"===t?"previousSibling":"nextSibling";n[o];)n=n[o],i.push(n);return i}},{key:"positions",get:function(){return{START:"start",END:"end",DEFAULT:"default"}}},{key:"isAtStart",get:function(){var e=this.blockEditable.editable.selection,t=this.state.content.activeBlock&&this.state.content.activeBlock.currentInput?Bt.a.getDeepestNode(this.state.content.activeBlock.currentInput):null,n=e.focusNode;if(Ht.isFakeInput(t))return!0;if(Bt.a.isNativeInput(t))return 0===t.selectionEnd;if(!e.anchorNode)return!1;var i=n&&n.textContent?n.textContent.search(/\S/):0;-1===i&&(i=0);var o=e.focusOffset||0;if((n&&n.nodeType!==Node.TEXT_NODE&&n.childNodes.length&&(n.childNodes[o]?(n=n.childNodes[o],o=0):o=(n=n.childNodes[o-1]).textContent?n.textContent.length:0),t&&(Bt.a.isLineBreakTag(t)||Bt.a.isEmpty(t)))&&(this.getHigherLevelSiblings(n,"left").every((function(e){var t=Bt.a.isLineBreakTag(e),n=e.children&&1===e.children.length&&Bt.a.isLineBreakTag(e.children[0]),i=t||n;return Bt.a.isEmpty(e)&&!i}))&&o===i))return!0;return null===t||n===t&&o<=i}},{key:"isAtEnd",get:function(){var e=this.blockEditable.editable.selection,t=e.focusNode,n=this.state.content.activeBlock&&this.state.content.activeBlock.currentInput?Bt.a.getDeepestNode(this.state.content.activeBlock.currentInput,!0):null;if(Ht.isFakeInput(n))return!0;if(Bt.a.isNativeInput(n))return n.selectionEnd===n.value.length;if(!e.focusNode)return!1;var i=e.focusOffset||0;if(t&&t.nodeType!==Node.TEXT_NODE&&t.childNodes.length&&(t.childNodes[i-1]?i=(t=t.childNodes[i-1]).textContent?t.textContent.length:0:(t=t.childNodes[0],i=0)),n&&(Bt.a.isLineBreakTag(n)||Bt.a.isEmpty(n))){var o=this.getHigherLevelSiblings(t,"right");if(o.every((function(e,t){return t===o.length-1&&Bt.a.isLineBreakTag(e)||Bt.a.isEmpty(e)&&!Bt.a.isLineBreakTag(e)}))&&i===(t&&t.textContent?t.textContent.length:0))return!0}var a=n&&n.textContent?n.textContent.replace(/\s+$/,""):"";return t===n&&i>=a.length}},{key:"isAtTop",get:function(){var e=this.blockEditable.editable.selection,t=this.state.content.activeBlock&&this.state.content.activeBlock.currentInput;if(!t)return!1;if(Ht.isFakeInput(t))return!0;var n,i=e.rangeRect,o=i.top+i.height/2;if(Ht.isLinesInput(t))return t.children.length<=1||o<(null===(n=t.firstChild)||void 0===n?void 0:n.nextSibling).getBoundingClientRect().y;var a=t.getBoundingClientRect(),s=window.getComputedStyle(t),r=parseFloat(s.paddingTop)||0,l=parseFloat(s.lineHeight)||0,c=o-a.top-r;return Math.ceil(c/l)<=1}},{key:"isAtBottom",get:function(){var e=this.blockEditable.editable.selection,t=this.state.content.activeBlock&&this.state.content.activeBlock.currentInput;if(!t)return!1;if(Ht.isFakeInput(t))return!0;var n=e.rangeRect,i=n.top+n.height/2;if(Ht.isLinesInput(t))return t.children.length<=1||i>t.lastChild.getBoundingClientRect().y;var o=t.getBoundingClientRect(),a=window.getComputedStyle(t),s=parseFloat(a.paddingTop)||0,r=parseFloat(a.paddingBottom)||0,l=parseFloat(a.lineHeight)||0,c=Math.round((o.height-s-r)/l),u=i-o.top-s;return Math.ceil(u/l)>=c}}],[{key:"Class",get:function(){return{shadowCursor:"beui-shadow-cursor"}}}]),n}(jt),on=n(547),an=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,{blockEditable:e.blockEditable}))._datas=void 0,i._blocks=[],i._activeBlockIndex=-1,i._basic={title:"",cover:"",summary:""},i._datas=e.datas?e.datas.filter((function(e){return!!e.key})):[e.blockEditable.defaultBlockCompInitData],i.hookEditable(),0===i._datas.length&&i._datas.push(i.blockEditable.defaultBlockCompInitData),i}return Object(s.a)(n,[{key:"getBlockByIndex",value:function(e){if(e>=0&&e<this._blocks.length)return this._blocks[e]}},{key:"getBlock",value:function(e){if(e){Bt.a.isElement(e)||(e=e.parentNode);var t=e.closest(".".concat(Ht.Class.block));return this._blocks.find((function(e){return e.holder===t}))}}},{key:"setActiveBlockBy",value:function(e){if(e){Bt.a.isElement(e)||(e=e.parentNode);var t=e.closest(".".concat(Ht.Class.block));if(t){var n=t.closest(".".concat(Ut.Class.editorZoneContent));if(null===n||void 0===n?void 0:n.isEqualNode(this.state.ui.nodes.content))return this.activeBlockIndex=this.blockNodes.indexOf(t),this.activeBlock.updateCurrentInput(),this.highlightCurrentNode(),this.activeBlock}}}},{key:"compose",value:function(){var e=this,t=this.holder;if(t){t.removeAttribute("contenteditable");var n=[],i=document.createDocumentFragment();this._datas.forEach((function(t){var o=e.composeBlock(t);n.push(o),i.appendChild(o.holder)})),t.innerHTML="",t.appendChild(i),this._blocks=n,n.forEach((function(e){e.onRendered()}))}}},{key:"insert",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,n=void 0===t?this.blockEditable.defaultBlockCompInitData:t,i=e.index,o=e.needToFocus,a=void 0===o||o,s=e.replace,r=void 0!==s&&s;if(!this.holder)return null;var l=i;void 0===l&&(l=this.activeBlockIndex+(r?0:1)),l>this._blocks.length&&(l=this._blocks.length);var c=this.composeBlock(n);if(!this._blocks.length||l>=this._blocks.length)this._blocks.push(c),this.insertToDOM(c);else{if(r){var u=this._blocks[l];u.holder.remove(),u.onRemoved(),this._blocks.splice(l,1,c)}else this._blocks.splice(l,0,c);if(l>0){var d=this._blocks[l-1];this.insertToDOM(c,"afterend",d)}else{var h=this._blocks[l+1];h?this.insertToDOM(c,"beforebegin",h):this.insertToDOM(c)}}return a?this.activeBlockIndex=l:l<=this._activeBlockIndex&&this.activeBlockIndex++,c}},{key:"insertDefaultBlockAtIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.insert({index:e,needToFocus:t});return n}},{key:"replace",value:function(e){var t=e.data,n=void 0===t?this.blockEditable.defaultBlockCompInitData:t;return this.insert({data:n,index:this.activeBlockIndex,replace:!0})}},{key:"paste",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.insert({data:{key:e,data:se.a.component(e).defaultData,common:n},replace:i});try{o&&o.onPaste(t)}catch(a){}return o}},{key:"insertAtEnd",value:function(){return this.activeBlockIndex=this.blocks.length-1,this.insert()}},{key:"removeSelectedBlocks",value:function(){for(var e,t=this._blocks.length-1;t>=0;t--)this._blocks[t].selected&&(this.removeBlock(t),e=t);var n=this.state,i=n.toolbar,o=n.conversionToolbar;return i.close(),o.close(),e}},{key:"removeBlock",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeBlockIndex;if(!this.validateIndex(e))throw new Error("Can't find a Block to remove");this._blocks[e].holder.remove(),this._blocks[e].onRemoved(),this._blocks.splice(e,1),this._activeBlockIndex>=e&&this._activeBlockIndex--,this._blocks.length?0===e&&(this.activeBlockIndex=0):(this.activeBlockIndex=-1,this.insert())}},{key:"clearFocused",value:function(){this._blocks.forEach((function(e){e.focused=!1}))}},{key:"move",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeBlockIndex;if(!isNaN(e)&&!isNaN(t)&&this.validateIndex(e)&&this.validateIndex(t)){var n=this._blocks.splice(t,1)[0],i=e-1,o=Math.max(0,i),a=this._blocks[o];e>0?this.insertToDOM(n,"afterend",a):this.insertToDOM(n,"beforebegin",a),this._blocks.splice(e,0,n),n.onMoved(),this.activeBlockIndex=e}}},{key:"delete",value:function(e){try{this.removeBlock(e)}catch(t){return}0===this._blocks.length&&this.insert(),this.activeBlock&&this.state.cursor.setToBlock(this.activeBlock,this.state.cursor.positions.END),this.state.toolbar.close()}},{key:"split",value:function(){var e=this.state.cursor.extractFragmentFromCursorPosition(),t=Bt.a.make("div");e&&t.appendChild(e);var n=this.blockEditable.defaultBlockComp.toData(Bt.a.isEmpty(t)?"":t.innerHTML);return this.insert({data:{key:this.blockEditable.defaultBlockComp.key,data:n}})}},{key:"highlightCurrentNode",value:function(){this.clearFocused(),this.activeBlock&&(this.activeBlock.focused=!0)}},{key:"mergeBlocks",value:function(){var e=Object(ke.a)(ge.a.mark((function e(t,n){var i,o;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this._blocks.indexOf(n),!n.isEmpty){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,n.data;case 5:if(o=e.sent,wt.j(o)){e.next=9;break}return e.next=9,t.mergeWith(o);case 9:this.removeBlock(i),this.activeBlockIndex=this._blocks.indexOf(t);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"dropPointer",value:function(){this.activeBlockIndex=-1,this.clearFocused()}},{key:"stretchBlock",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getBlockByIndex(e);n&&(this.clearFocused(),n.stretched=t)}},{key:"getContentHTML",value:function(e,t){var n=this.state.blockSelection,i={clearEmpty:Rt.c,inlineContent:Rt.f,type:e},o=(t?n.selectedBlocks:this.blocks).reduce((function(e,t){var n=t.save(),o=t.component.toHtml(n.data,i);return t.quoted&&(o="<blockquote>".concat(o,"</blockquote>")),e+'<section class="'.concat(Ht.Class.block," ").concat(Ht.Class.block,"--").concat(t.component.key,'" data-editor="\u6781\u5ba2\u7f16\u8f91\u5668" data-key="').concat(t.componentInstance.key||"",'"><span class="').concat(Ht.Class.prefix,'"></span><section class="').concat(Ht.Class.content,'">').concat(o,'</section><span class="').concat(Ht.Class.subfix,'"></span></section>')}),"");Object.entries(se.c.tools).forEach((function(e){var t=Object(be.a)(e,2)[1];t.checkHTML&&(o=t.checkHTML(o,i))}));var a=this.blockEditable.editable.$dom;return o=o.replace(a.fillCharReg,""),'<section class="'.concat(Ut.Class.editorContent,'" data-editor="\u6781\u5ba2\u7f16\u8f91\u5668">').concat(o,"</section>")}},{key:"getContentMarkdown",value:function(e){var t=this.state.blockSelection,n=e?t.selectedBlocks:this.blocks,i=this.blockEditable.utils.makeMarkdown,o=n.reduce((function(e,t){var n,o=t.save().data;return e+(t.component.toMarkdown?function(e){return/\\n\\n$/.test(e)?e:/\\n$/.test(e)?"".concat(e,"\n"):"".concat(e,"\n\n")}((n=t.component.toMarkdown(o,i),t.quoted?n.split("\n").map((function(e){return"> "+e})).join("\n"):n)):i(function(e,t){return t?"<blockquote>".concat(e,"</blockquote>"):e}(t.component.toHtml(o,{clearEmpty:Rt.c,inlineContent:Rt.f}),t.quoted)))}),"");Object.entries(se.c.tools).forEach((function(e){var t=Object(be.a)(e,2)[1];t.checkMarkdown&&(o=t.checkMarkdown(o))}));var a=this.blockEditable.editable.$dom;return o=(o=o.replace(a.fillCharReg,"")).replace(/<!--\s-->\n/g,"")}},{key:"getContentText",value:function(e){var t=this.blockEditable.editable,n=t.$dom,i=t.document,o=this.getContentHTML(void 0,e),a=i.createElement("div");return a.innerHTML=o,(a.textContent||a.innerText).replace(n.fillCharReg,"").replace(/\u00a0/g," ")}},{key:"getWordCount",value:function(e){var t=this.getContentText(e).match(/[a-zA-Z0-9_\u0392-\u03c9]+|[\u4E00-\u9FFF\u3400-\u4dbf\uf900-\ufaff\u3040-\u309f\uac00-\ud7af]+/g),n=0;if(null==t)return n;for(var i=0;i<t.length;i++)t[i].charCodeAt(0)>=19968?n+=t[i].length:n+=1;return n}},{key:"hookEditable",value:function(){var e=this,t=this.blockEditable.editable;this.updateActiveBlock=this.updateActiveBlock.bind(this),t.getContent=function(n){var i=e.blocks;try{var o=i.map((function(e){return e.save()})),a=o;if(n)a=e.state.sanitizer.sanitizeBlocks(o);return JSON.stringify({content:a,typeset:t.queryCommandValue("typeset")||"default",layout:t.queryCommandValue("layout")||"web",basic:e._basic})}catch(s){}return""},t.setContent=function(n,i){var o=e.state.ui,a=o.nodes.scroller.scrollTop;t.on("selectionchange",e.updateActiveBlock);try{var s=JSON.parse(n),r=s.content||[];if(i)r=e.state.sanitizer.sanitizeBlocks(r);var l=r,c=s.typeset||"default",u=s.layout||"web",d=s.basic||{};e._basic.title=d.title||"",e._basic.cover=d.cover||"",e._basic.summary=d.summary||"",e.blockEditable.setTypeset(c),e.state.ui.layout=u,e.datas=l}catch(h){e.blockEditable.setTypeset("default"),e.state.ui.layout="web",e.datas=e._datas}e.setDefaultCursor(),setTimeout((function(){t.off("selectionchange",e.updateActiveBlock)}),100),t.trigger("aftersetcontent"),o.nodes.scroller.scrollTop=a},t.getScene=function(t){var n=e.blocks;try{var i=n.map((function(e){return e.save()})),o=i;if(t)o=e.state.sanitizer.sanitizeBlocks(i);return JSON.stringify({content:o})}catch(a){}return""},t.setScene=function(n,i){var o=e.state.ui,a=o.nodes.scroller.scrollTop;t.on("selectionchange",e.updateActiveBlock);try{var s=JSON.parse(n).content||[];if(i)s=e.state.sanitizer.sanitizeBlocks(s);var r=s;e.datas=r}catch(l){e.datas=e._datas}e.setDefaultCursor(),setTimeout((function(){t.off("selectionchange",e.updateActiveBlock)}),100),o.nodes.scroller.scrollTop=a},t.clear=function(){e.datas=[]},t.catalog.insertAfter=function(t,n){var i=t.el||e.blockEditable.editable.document.createElement("h".concat(t.level));i.innerText=t.title;var o=on.default.toData(i.outerHTML);if(n.el){var a=e._blocks.findIndex((function(e){var t;return e.componentContent&&e.componentContent.dataset.id===(null===(t=n.el)||void 0===t?void 0:t.dataset.id)}));if(-1!==a){var s=e.insert({data:{key:on.default.key,data:o},index:a+1});s&&s.componentContent&&(t.el=s.componentContent)}}else{var r=e.insert({data:{key:on.default.key,data:o},index:0});r&&r.componentContent&&(t.el=r.componentContent)}return t},t.catalog.insertBefore=function(t,n){if(n.el){var i=e._blocks.findIndex((function(e){var t;return e.componentContent&&e.componentContent.dataset.id===(null===(t=n.el)||void 0===t?void 0:t.dataset.id)}));if(-1!==i){var o=t.el||e.blockEditable.editable.document.createElement("h".concat(t.level));o.innerText=t.title;var a=on.default.toData(o.outerHTML),s=e.insert({data:{key:on.default.key,data:a},index:i});s&&s.componentContent&&(t.el=s.componentContent)}}return t},t.catalog.append=function(t){var n=t.el||e.blockEditable.editable.document.createElement("h".concat(t.level));n.innerText=t.title;var i=on.default.toData(n.outerHTML),o=e.insert({data:{key:on.default.key,data:i},index:e._blocks.length});return o&&o.componentContent&&(t.el=o.componentContent),t},t.on("actived",(function(){e.updateActiveBlock()}))}},{key:"updateActiveBlock",value:function(){var e=this.blockEditable.selection,t=(this.state.cursor,e.focusNode||e.anchorNode);t&&(this.setActiveBlockBy(t),this.state.toolbar.move())}},{key:"bindBlockEvents",value:function(e){var t=this.state.events;this.readOnlyMutableListeners.on(e.holder,"keydown",(function(e){t.keydown(e)})),this.readOnlyMutableListeners.on(e.holder,"keyup",(function(e){t.keyup(e)})),this.readOnlyMutableListeners.on(e.holder,"dragover",(function(e){t.dragOver(e)})),this.readOnlyMutableListeners.on(e.holder,"dragleave",(function(e){t.dragLeave(e)})),this.readOnlyMutableListeners.on(e.holder,"mousedown",(function(e){t.mousedown(e)})),this.readOnlyMutableListeners.on(e.holder,"dblclick",(function(e){t.dblclick(e)}))}},{key:"validateIndex",value:function(e){return!(e<0||e>=this._blocks.length)}},{key:"composeBlock",value:function(e){var t=new Ht({data:e,blockEditable:this.blockEditable});return this.bindBlockEvents(t),t}},{key:"insertToDOM",value:function(e,t,n){t&&n?n.holder.insertAdjacentElement(t,e.holder):this.holder.appendChild(e.holder),e.onRendered()}},{key:"setDefaultCursor",value:function(){var e=this.state.cursor;this._blocks.length&&(e.setToBlock(this._blocks[0],e.positions.START),this.highlightCurrentNode())}},{key:"basic",get:function(){return this._basic},set:function(e){this._basic.title=e.title,this._basic.cover=e.cover,this._basic.summary=e.summary}},{key:"blocks",get:function(){return this._blocks}},{key:"blockNodes",get:function(){return wt.a(this.holder.children)}},{key:"activeBlock",get:function(){return this._blocks[this._activeBlockIndex]}},{key:"activeBlockIndex",get:function(){return this._activeBlockIndex},set:function(e){this._blocks[this._activeBlockIndex]&&this._blocks[this._activeBlockIndex].willUnselect(),this._blocks[e]&&this._blocks[e].willSelect(),this._activeBlockIndex=e}},{key:"isEmpty",get:function(){return 0===this._blocks.length}},{key:"holder",get:function(){return this.blockEditable.editable.holder}},{key:"firstBlock",get:function(){return this._blocks[0]}},{key:"lastBlock",get:function(){return this._blocks[this._blocks.length-1]}},{key:"nextBlock",get:function(){if(!(this._activeBlockIndex===this._blocks.length-1))return this._blocks[this._activeBlockIndex+1]}},{key:"nextContentfulBlock",get:function(){return this.blocks.slice(this._activeBlockIndex+1).find((function(e){return!!e.inputs.length}))}},{key:"previousContentfulBlock",get:function(){return this.blocks.slice(0,this._activeBlockIndex).reverse().find((function(e){return!!e.inputs.length}))}},{key:"previousBlock",get:function(){if(!(0===this._activeBlockIndex))return this._blocks[this._activeBlockIndex-1]}},{key:"dropTargetBlock",get:function(){return this.blocks.find((function(e){return e.dropTarget}))}},{key:"datas",set:function(e){e&&0!==e.length||(e=[this.blockEditable.defaultBlockCompInitData]),this._datas=e.map((function(e){var t=se.a.component(e.key);if(!t)return e;var n=!t.validData||t.validData(e.data);return n?"boolean"===typeof n?e:Object(V.a)(Object(V.a)({},e),{},{data:n}):{key:"",data:{}}})).filter((function(e){return!!e.key})),this.compose()}}]),n}(jt),sn=n(176),rn=n(19),ln=n.n(rn),cn=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).opened=!1,e._displayedToolsCount=0,e._flipper=void 0,e._cacheTools={},e}return Object(s.a)(n,[{key:"make",value:function(){this.nodes.toolbox=Bt.a.make("div",n.Class.toolbox),this.addPluginToolboxes(),this.enableFlipper()}},{key:"destroy",value:function(){this._flipper&&(this._flipper.deactivate(),this._flipper=null),this.removeAllNodes(),this.removeAllShortcuts()}},{key:"toolButtonActivate",value:function(e,t){this.insertNewBlock(t)}},{key:"matchCommand",value:function(e){var t=this,n=se.a.components,i={},o=new ln.a.Converter,a=o.makeHtml.bind(o);if(Array.from(Object.values(n)).forEach((function(n){if(n.key!==t.blockEditable.defaultBlockComp.key){var o=(n.toolbox.commands||[]).find((function(t){return t.regex.test(e)}));o&&(i[n.key]=o.data?o.data(e,a):void 0)}})),0===Object.keys(i).length){var s=this.blockEditable.defaultBlockComp,r=(s.toolbox.commands||[]).find((function(t){return t.regex.test(e)}));r&&(i[s.key]=r.data?r.data(e,a):void 0)}return Object.keys(i).length?i:void 0}},{key:"open",value:function(e){if(!this.isEmpty&&!this.opened){this.state.ui.nodes.wrapper.classList.add(n.Class.openedToolbarHolderModifier),this._cacheTools=e||{};var t=Object.keys(this._cacheTools);if(t.length&&e){if(1===t.length)return void this.insertNewBlock(t[0]);this.nodes.buttons.forEach((function(t){var n=se.a.component(t.dataset.key||"");if(t.dataset.key&&e.hasOwnProperty(t.dataset.key)){t.style.display="";var i=e[t.dataset.key],o=(null===i||void 0===i?void 0:i.icon)||n.toolbox.icon;o&&(t.innerHTML=o)}else t.style.display="none"}))}else this.nodes.buttons.forEach((function(e){e.style.display="";var t=se.a.component(e.dataset.key||"");t&&(e.innerHTML=t.toolbox.icon)}));this.nodes.toolbox.classList.add(n.Class.toolboxOpened),this.opened=!0,this.activeFlipper()}}},{key:"close",value:function(){this.nodes.toolbox.classList.remove(n.Class.toolboxOpened),this.state.ui.nodes.wrapper.classList.remove(n.Class.openedToolbarHolderModifier),this.opened=!1,this.deactiveFlipper()}},{key:"toggle",value:function(){this.opened?this.close():this.open()}},{key:"addPluginToolboxes",value:function(){var e=this,t=this.blockEditable.defaultBlockComp.key;se.a.indexes.forEach((function(n){if(t!==n){var i=se.a.component(n);e.addPluginToolbox(i)}}))}},{key:"addPluginToolbox",value:function(e){var t=this,i=e.toolbox;if(i&&(!i||i.icon)){var o=Bt.a.make("li",[n.Class.toolboxButton]);o.dataset.key=e.key,o.innerHTML=i.icon,Bt.a.append(this.nodes.toolbox,o),this.nodes.toolbox.appendChild(o),this.nodes.buttons||(this.nodes.buttons=[]),this.nodes.buttons.push(o),this.listeners.on(o,"click",(function(n){t.toolButtonActivate(n,e.key)}));var a=this.drawTooltip(e);this.state.tooltip.onHover(o,a,{placement:"bottom",hidingDelay:200});var s=e.shortcut;s&&this.enableShortcut(e.key,s),this._displayedToolsCount++}}},{key:"drawTooltip",value:function(e){e.toolbox;var t=this.blockEditable.getLang("components.".concat(e.key)),i=e.shortcut,o=Bt.a.make("div",n.Class.buttonTooltip),a=document.createTextNode(wt.c(t));return o.appendChild(a),i&&(i=wt.b(i),o.appendChild(Bt.a.make("div",n.Class.buttonShortcut,{textContent:i}))),o}},{key:"enableShortcut",value:function(e,t){var n=this;sn.a.add({name:t,handler:function(t){t.preventDefault(),n.insertNewBlock(e)},on:this.state.ui.nodes.redactor})}},{key:"removeAllShortcuts",value:function(){var e=this,t=se.a.components;Array.from(Object.values(t)).forEach((function(t){var n=t.shortcut;n&&sn.a.remove(e.state.ui.nodes.redactor,n)}))}},{key:"enableFlipper",value:function(){var e=this,t=Array.from(this.nodes.toolbox.childNodes).filter((function(e){return"none"!==e.style.display}));this._flipper=new Ft({items:t,focusedItemClass:n.Class.toolboxButtonActive,keydownHanlder:function(t){var n=t.keyCode;return(n===wt.q.DOWN||n===wt.q.UP)&&(Promise.resolve().then((function(){e.close()})),t.preventDefault(),!0)}})}},{key:"activeFlipper",value:function(){var e=this;if(this._flipper){var t=Array.from(this.nodes.toolbox.childNodes).filter((function(e){return"none"!==e.style.display}));this._flipper.activate(t),setTimeout((function(){e._flipper&&e._flipper.focusFirst()}))}}},{key:"deactiveFlipper",value:function(){this._flipper&&this._flipper.deactivate()}},{key:"insertNewBlock",value:function(e){var t,n=this.state,i=n.content,o=n.cursor,a=this._cacheTools[e],s=i.insert({data:{key:e,data:(null===a||void 0===a?void 0:a.data)||se.a.component(e).defaultData,common:null===(t=i.activeBlock)||void 0===t?void 0:t.save().common},replace:!0});s&&(s.onAdded(),o.setToBlock(s,"start",-1),0===s.inputs.length&&(s===i.lastBlock?(i.insertAtEnd(),o.setToBlock(i.lastBlock)):o.setToBlock(i.nextBlock)),this.state.toolbar.close())}},{key:"isEmpty",get:function(){return 0===this._displayedToolsCount}},{key:"flipper",get:function(){return this._flipper}}],[{key:"Class",get:function(){return{toolbox:"beui-toolbox",toolboxButton:"beui-toolbox__button",toolboxButtonActive:"beui-toolbox__button--active",toolboxOpened:"beui-toolbox--opened",openedToolbarHolderModifier:"beui-editor--toolbox-opened",buttonTooltip:"beui-toolbox-button-tooltip",buttonShortcut:"beui-toolbox-button-tooltip__shortcut"}}}]),n}(jt),un=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).opened=!1,e._tools={},e._flipper=void 0,e.togglingCallback=void 0,e}return Object(s.a)(n,[{key:"make",value:function(){this.nodes.wrapper=Bt.a.make("div",[n.Class.conversionToolbarWrapper].concat(Object(p.a)(this.isRtl?[Ut.Class.editorRtlFix]:[]))),this.nodes.tools=Bt.a.make("div",n.Class.conversionToolbarTools);var e=Bt.a.make("div",n.Class.conversionToolbarLabel,{textContent:this.blockEditable.getLang("toolbar.converter.convertTo")});return this.addPluginToolboxs(),this.enableFlipper(),Bt.a.append(this.nodes.wrapper,e),Bt.a.append(this.nodes.wrapper,this.nodes.tools),this.nodes.wrapper}},{key:"destroy",value:function(){this._flipper&&(this._flipper.deactivate(),this._flipper=null),this.removeAllNodes()}},{key:"toggle",value:function(e){this.opened?this.close():this.open(),wt.k(e)&&(this.togglingCallback=e)}},{key:"open",value:function(){var e=this;this.filterTools(),this.opened=!0,this.nodes.wrapper.classList.add(n.Class.conversionToolbarShowed),setTimeout((function(){e._flipper&&(e._flipper.activate(Object.values(e._tools).filter((function(e){return!e.classList.contains(n.Class.conversionToolHidden)}))),e._flipper.focusFirst()),wt.k(e.togglingCallback)&&e.togglingCallback(!0)}),50)}},{key:"close",value:function(){this.opened=!1,this._flipper&&this._flipper.deactivate(),this.nodes.wrapper.classList.remove(n.Class.conversionToolbarShowed),wt.k(this.togglingCallback)&&this.togglingCallback(!1)}},{key:"hasTools",value:function(){var e=Object.keys(this._tools);return!(1===e.length&&e.shift()===this.blockEditable.defaultBlockComp.key)}},{key:"replaceWithBlock",value:function(){var e=Object(ke.a)(ge.a.mark((function e(t){var n,i,o,a,s,r,l,c,u,d,h=this;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.state,i=n.content,o=n.cursor,a=this.state.content.activeBlock){e.next=4;break}return e.abrupt("return");case 4:s=a.component,r=s.key,l=a.data,r===t.key&&(t=this.blockEditable.defaultBlockComp),c=this.state.sanitizer,u=c.clean.bind(c),d={key:r,data:l},i.setActiveBlockBy(a.holder),(t.convertData&&t.convertData(d,u)||[t.toData(c.clean(s.toHtml(l,{clearEmpty:Rt.c,inlineContent:Rt.f}),t.sanitize))]).forEach((function(e,n){var a=i.insert({data:{key:t.key,data:e},replace:0===n});a&&o.setToBlock(a,o.positions.END)})),this.state.blockSelection.clearSelection(),this.close(),this.state.blockSettings.close(),wt.e((function(){h.state.cursor.setToBlock(h.state.content.activeBlock,"end")}),10)();case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addPluginToolboxs",value:function(){var e=this,t=se.a.components;se.a.indexes.forEach((function(n){var i=t[n],o=i.toolbox;!wt.j(o)&&o.icon&&i.acceptConversionComps&&e.addPluginToolbox(i,o.icon,o.title)}))}},{key:"addPluginToolbox",value:function(e,t,i){var o=this,a=Bt.a.make("div",[n.Class.conversionTool]),s=Bt.a.make("div",[n.Class.conversionToolIcon]);a.dataset.key=e.key,s.innerHTML=t,Bt.a.append(a,s),Bt.a.append(a,Bt.a.text(this.blockEditable.getLang("components.".concat(e.key)))),Bt.a.append(this.nodes.tools,a),this._tools[e.key]=a,this.listeners.on(a,"click",Object(ke.a)(ge.a.mark((function t(){return ge.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.replaceWithBlock(e);case 2:case"end":return t.stop()}}),t)}))))}},{key:"filterTools",value:function(){var e=this.state.content.activeBlock;if(e){var t=e.component.key,i=se.a.components;Object.entries(this._tools).forEach((function(e){var o=Object(be.a)(e,2),a=o[0],s=o[1],r=i[a].acceptConversionComps;s.hidden=!1,s.classList.toggle(n.Class.conversionToolHidden,a===t||!r||Array.isArray(r)&&!r.includes(t))}))}}},{key:"enableFlipper",value:function(){this._flipper=new Ft({focusedItemClass:n.Class.conversionToolFocused})}},{key:"flipper",get:function(){return this._flipper}}],[{key:"Class",get:function(){return{conversionToolbarWrapper:"beui-conversion-toolbar",conversionToolbarShowed:"beui-conversion-toolbar--showed",conversionToolbarTools:"beui-conversion-toolbar__tools",conversionToolbarLabel:"beui-conversion-toolbar__label",conversionTool:"beui-conversion-tool",conversionToolHidden:"beui-conversion-tool--hidden",conversionToolIcon:"beui-conversion-tool__icon",conversionToolFocused:"beui-conversion-tool--focused",conversionToolActive:"beui-conversion-tool--active"}}}]),n}(jt),dn=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o)))._buttons=[],e._flipper=null,e._tunes=void 0,e}return Object(s.a)(n,[{key:"make",value:function(){this.nodes.wrapper=Bt.a.make("div",n.Class.wrapper),this.nodes.componentSettings=Bt.a.make("div",n.Class.componentSettings),this.nodes.defaultSettings=Bt.a.make("div",n.Class.defaultSettings),Bt.a.append(this.nodes.wrapper,[this.nodes.componentSettings,this.nodes.defaultSettings]),this._tunes=this.makeTunes(),this.prepareConversionToolbar(),this.enableFlipper()}},{key:"destroy",value:function(){this._flipper&&(this._flipper.deactivate(),this._flipper=null),this.removeAllNodes()}},{key:"open",value:function(){this.nodes.wrapper.classList.add(n.Class.wrapperOpened),this.blockEditable.selection.cache(),this.state.content.activeBlock.selected=!0,this.state.blockSelection.clearCache(),this.addToolSettings(),this.addDefaultSettings(),this.blockEditable.eventsDispatcher.emit(this.events.opened),this._flipper&&this._flipper.activate(this.blockTunesButtons)}},{key:"close",value:function(){this.nodes.wrapper.classList.remove(n.Class.wrapperOpened);var e=this.blockEditable.selection;this.state.ui.isAtEditor||e.restore(),e.clearCache(),!this.state.crossSelection.isCrossBlockSelectionStarted&&this.state.content.activeBlock&&(this.state.content.activeBlock.selected=!1),this.nodes.componentSettings.innerHTML="",this.nodes.defaultSettings.innerHTML="",this.blockEditable.eventsDispatcher.emit(this.events.closed),this._buttons=[],this._flipper&&this._flipper.deactivate(),this.state.conversionToolbar.close()}},{key:"addToolSettings",value:function(){var e=this.state.content.activeBlock.renderSettings(n.Class);e&&Bt.a.append(this.nodes.componentSettings,e)}},{key:"addDefaultSettings",value:function(){Bt.a.append(this.nodes.defaultSettings,this.renderTunes())}},{key:"renderConversion",value:function(){var e=this,t=Bt.a.icon("toggler-down");return this.nodes.conversion=Bt.a.make("div",[n.Class.button,n.Class.buttonConversion],{}),this.nodes.conversionContent=Bt.a.make("div",n.Class.buttonContent),this.nodes.conversion.appendChild(this.nodes.conversionContent),this.nodes.conversion.appendChild(t),this.nodes.conversion.dataset.forbidSetCursor="true",this.state.conversionToolbar.hasTools()?this.setConversionContent():this.nodes.conversion.hidden=!0,this.listeners.on(this.nodes.conversion,"click",(function(){e.state.conversionToolbar.toggle((function(t){var n=!t&&e.opened;e._flipper&&(n?e._flipper.activate():e.opened&&e._flipper.deactivate())}))})),this.state.tooltip.onHover(this.nodes.conversion,this.blockEditable.getLang("toolbar.converter.conversion")),this.nodes.conversion}},{key:"setConversionContent",value:function(){var e=this.state.content.activeBlock,t=e.component.key,i=se.a.components,o=Object.entries(i).some((function(e){var n=Object(be.a)(e,2),i=(n[0],n[1].acceptConversionComps);return i&&(!Array.isArray(i)||i.includes(t))}));this.nodes.conversion.hidden=!o,this.nodes.conversion.classList.toggle(n.Class.buttonHidden,!o);var a=e.component.toolbox||{};this.nodes.conversionContent.innerHTML=a.icon||a.title||wt.c(t)}},{key:"renderTunes",value:function(){var e=document.createDocumentFragment();return this._tunes.forEach((function(t){Bt.a.append(e,t.render(n.Class))})),Bt.a.append(e,this.renderConversion()),e}},{key:"makeTunes",value:function(){var e=this;return se.d.indexes.map((function(e){return se.d.tunes[e]})).map((function(t){return new t({blockEditable:e.blockEditable})}))}},{key:"prepareConversionToolbar",value:function(){var e=this.state.conversionToolbar.make();Bt.a.append(this.nodes.wrapper,e)}},{key:"enableFlipper",value:function(){var e=this;this._flipper=new Ft({focusedItemClass:n.Class.focusedButton,activateCallback:function(t){t&&Bt.a.canSetCursor(t)?e.close():t.dataset.forbidSetCursor||wt.e((function(){e.state.cursor.setToBlock(e.state.content.activeBlock)}),50)()}})}},{key:"events",get:function(){return{opened:"block-settings-opened",closed:"block-settings-closed"}}},{key:"flipper",get:function(){return this._flipper}},{key:"opened",get:function(){return this.nodes.wrapper.classList.contains(n.Class.wrapperOpened)}},{key:"blockTunesButtons",get:function(){var e=this;if(0!==this._buttons.length)return this._buttons;var t=this.nodes.componentSettings.querySelectorAll(".".concat(n.Class.settingsButton,", ").concat(Bt.a.allInputsSelector)),i=this.nodes.defaultSettings.querySelectorAll(".".concat(n.Class.button));return t.forEach((function(t){!t.hidden&&e._buttons.push(t)})),i.forEach((function(t){!t.hidden&&e._buttons.push(t)})),this._buttons}}],[{key:"Class",get:function(){return{wrapper:"beui-settings",wrapperOpened:"beui-settings--opened",componentSettings:"beui-settings__component-zone",defaultSettings:"beui-settings__default-zone",button:"beui-settings__button",buttonConversion:"beui-settings__button--conversion",buttonHidden:"beui-settings__button--hidden",buttonContent:"beui-settings__button---content",focusedButton:"beui-settings__button--focused",focusedButtonAnimated:"beui-settings__button--focused-animated",settingsButton:"beui-settings-button",settingsButtonActive:"beui-settings-button--active"}}}]),n}(jt),hn=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).anyBlockSelectedCache=null,e.multiBlocksSelectedCache=null,e.needToSelectAll=!1,e.nativeInputSelected=!1,e.readyToBlockSelection=!1,e}return Object(s.a)(n,[{key:"prepare",value:function(){}},{key:"toggleReadOnly",value:function(e){this.blockEditable.selection.removeAllRanges(),this.allBlocksSelected=!1}},{key:"unSelectBlockByIndex",value:function(e){var t,n=this.state.content;void 0===e||isNaN(e)?t=n.activeBlock:void 0!==e&&(t=n.getBlockByIndex(e)),t&&(t.selected=!1),this.clearCache()}},{key:"clearSelection",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.state,i=n.content,o=n.cursor,a=n.crossSelection,s=n.rectangleSelection,r=this.blockEditable.selection;t&&this.blockEditable.selection.cache(),i.activeBlock&&i.activeBlock.inputSelection.clearInputsSelection(e),this.needToSelectAll=!1,this.nativeInputSelected=!1,this.readyToBlockSelection=!1;var l=e&&e instanceof KeyboardEvent,c=l&&wt.n(e.keyCode);if(this.anyBlockSelected&&l&&c&&!r.exists){var u=i.removeSelectedBlocks();i.insertDefaultBlockAtIndex(u||0,!0),o.setToBlock(i.activeBlock),wt.e((function(){var t=e.key;o.insertContentAtCursorPosition(t.length>1?"":t)}),20)()}a.clear(e),this.anyBlockSelected&&!s.isRectActivated()?(t&&this.blockEditable.selection.restore(),this.allBlocksSelected=!1):s.clearSelection()}},{key:"copySelectedBlocks",value:function(e){e.preventDefault();var t=this.state.exporter,n=this.selectedBlocks.map((function(e){return e.save()})),i=t.export("html",!0),o=t.export("markdown",!0);e.clipboardData&&(e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",i),e.clipboardData.setData(this.state.paste.MIME_TYPE,JSON.stringify(n)))}},{key:"selectBlockByIndex",value:function(e){var t,n=this.state,i=n.content,o=n.inlineToolbar;i.clearFocused(),t=void 0===e?i.activeBlock:i.getBlockByIndex(e),this.blockEditable.selection.cache(),this.blockEditable.selection.removeAllRanges(),t&&(t.selected=!0),this.clearCache(),o.close()}},{key:"clearCache",value:function(){this.anyBlockSelectedCache=null,this.multiBlocksSelectedCache=null}},{key:"destroy",value:function(){}},{key:"handleCommandA",value:function(e){if(this.state.rectangleSelection.clearSelection(),e){if(Bt.a.isNativeInput(e.target)&&!this.readyToBlockSelection)return void(this.readyToBlockSelection=!0);var t=this.state.content.getBlock(e.target);if(t){var n=t.inputs;if(n.length>1&&!this.readyToBlockSelection)return void(this.readyToBlockSelection=!0);if(1===n.length&&!this.needToSelectAll)return void(this.needToSelectAll=!0)}}else this.needToSelectAll=!0;this.needToSelectAll?(null===e||void 0===e||e.preventDefault(),this.selectAllBlocks(),this.needToSelectAll=!1,this.readyToBlockSelection=!1,this.state.conversionToolbar.close()):this.readyToBlockSelection&&(null===e||void 0===e||e.preventDefault(),this.selectBlockByIndex(),this.needToSelectAll=!0)}},{key:"selectAllBlocks",value:function(){this.blockEditable.selection.cache(),this.blockEditable.selection.removeAllRanges(),this.allBlocksSelected=!0,this.state.inlineToolbar.close()}},{key:"allBlocksSelected",get:function(){return this.state.content.blocks.every((function(e){return!0===e.selected}))},set:function(e){this.state.content.blocks.forEach((function(t){t.selected=e})),this.clearCache()}},{key:"anyBlockSelected",get:function(){var e=this.state.content;return null===this.anyBlockSelectedCache&&(this.anyBlockSelectedCache=e.blocks.some((function(e){return!0===e.selected}))),this.anyBlockSelectedCache}},{key:"multiBlocksSelected",get:function(){var e=this.state.content;return null===this.multiBlocksSelectedCache&&(this.multiBlocksSelectedCache=e.blocks.filter((function(e){return e.selected})).length>1),this.multiBlocksSelectedCache}},{key:"selectedBlocks",get:function(){return this.state.content.blocks.filter((function(e){return e.selected}))}}]),n}(jt),pn=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).firstSelectedBlock=void 0,e.lastSelectedBlock=void 0,e.onMouseUp=function(){var t=e.state.ui,n=e.blockEditable.editable.document;e.listeners.off(t.nodes.content,"mouseover",e.onMouseOver),e.listeners.off(n,"mouseup",e.onMouseUp)},e.onMouseOver=function(t){var n=e.state,i=n.content,o=n.blockSelection,a=i.getBlock(t.relatedTarget)||e.lastSelectedBlock,s=i.getBlock(t.target);if(a&&s&&s!==a){if(a===e.firstSelectedBlock)return e.blockEditable.selection.removeAllRanges(),a.selected=!0,s.selected=!0,o.clearCache(),void(e.lastSelectedBlock=s);if(s===e.firstSelectedBlock)return a.selected=!1,s.selected=!1,void o.clearCache();e.state.inlineToolbar.close(),e.resetBlocksSelectedState(e.firstSelectedBlock||s,s),e.lastSelectedBlock=s}},e}return Object(s.a)(n,[{key:"prepare",value:function(){var e=Object(ke.a)(ge.a.mark((function e(){var t,n=this;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.state.ui,this.listeners.on(t.nodes.content,"mousedown",(function(e){n.enableCrossBlockSelection(e)}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"watchSelection",value:function(e){if(e.button===wt.r.LEFT){var t=this.state,n=t.content,i=t.ui,o=this.blockEditable.editable.document;this.firstSelectedBlock=n.getBlock(e.target),this.lastSelectedBlock=this.firstSelectedBlock,this.listeners.on(i.nodes.content,"mouseover",this.onMouseOver),this.listeners.on(o,"mouseup",this.onMouseUp)}}},{key:"toggleBlockSelectedState",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.state,n=t.content,i=t.blockSelection;this.lastSelectedBlock||(this.lastSelectedBlock=this.firstSelectedBlock=n.activeBlock),this.firstSelectedBlock===this.lastSelectedBlock&&(this.firstSelectedBlock.selected=!0,i.clearCache(),this.blockEditable.selection.removeAllRanges());var o=n.blocks.indexOf(this.lastSelectedBlock)+(e?1:-1),a=n.blocks[o];a&&(this.lastSelectedBlock.selected!==a.selected?(a.selected=!0,i.clearCache()):(this.lastSelectedBlock.selected=!1,i.clearCache()),this.lastSelectedBlock=a,this.state.inlineToolbar.close(),a.holder.scrollIntoView({block:"nearest"}))}},{key:"clear",value:function(e){var t=this.state,n=t.content,i=t.blockSelection,o=t.cursor,a=this.firstSelectedBlock?n.blocks.indexOf(this.firstSelectedBlock):-1,s=this.lastSelectedBlock?n.blocks.indexOf(this.lastSelectedBlock):-1;if(i.anyBlockSelected&&a>-1&&s>-1)if(e&&e instanceof KeyboardEvent)switch(e.keyCode){case wt.q.DOWN:case wt.q.RIGHT:o.setToBlock(n.blocks[Math.max(a,s)],o.positions.END);break;case wt.q.UP:case wt.q.LEFT:o.setToBlock(n.blocks[Math.min(a,s)],o.positions.START);break;default:o.setToBlock(n.blocks[Math.max(a,s)],o.positions.END)}else o.setToBlock(n.blocks[Math.max(a,s)],o.positions.END);this.firstSelectedBlock=this.lastSelectedBlock=void 0}},{key:"enableCrossBlockSelection",value:function(e){var t=this.state.ui;this.blockEditable.selection.isCollapsed||this.state.blockSelection.clearSelection(e),t.nodes.content.contains(e.target)?this.watchSelection(e):this.state.blockSelection.clearSelection(e)}},{key:"toggleBlocksSelectedState",value:function(e,t){for(var n=this.state,i=n.content,o=n.blockSelection,a=i.blocks.indexOf(e),s=i.blocks.indexOf(t),r=e.selected!==t.selected,l=Math.min(a,s);l<=Math.max(a,s);l++){var c=i.blocks[l];c!==this.firstSelectedBlock&&c!==(r?e:t)&&(i.blocks[l].selected=!i.blocks[l].selected,o.clearCache())}}},{key:"resetBlocksSelectedState",value:function(e,t){var n=this.state,i=n.content,o=n.blockSelection,a=i.blocks.indexOf(e),s=i.blocks.indexOf(t);o.selectedBlocks.forEach((function(e){e.selected=!1}));for(var r=Math.min(a,s);r<=Math.max(a,s);r++){i.blocks[r].selected=!0}o.clearCache()}},{key:"isCrossBlockSelectionStarted",get:function(){return!!this.firstSelectedBlock&&!!this.lastSelectedBlock}}]),n}(jt),fn=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).isRectSelectionActivated=!1,e.SCROLL_SPEED=3,e.HEIGHT_OF_SCROLL_ZONE=40,e.BOTTOM_SCROLL_ZONE=1,e.TOP_SCROLL_ZONE=2,e.MAIN_MOUSE_BUTTON=0,e.mousedown=!1,e.isScrolling=!1,e.inScrollZone=null,e.startX=0,e.startY=0,e.mouseX=0,e.mouseY=0,e.stackOfSelected=[],e.rectCrossesBlocks=void 0,e.overlayRectangle=void 0,e.listenerIds=[],e}return Object(s.a)(n,[{key:"prepare",value:function(){var e=Object(ke.a)(ge.a.mark((function e(){return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.enableModuleBindings();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"startSelection",value:function(e,t){var n=this.state.ui.elementFromPoint(e-window.pageXOffset,t-window.pageYOffset);if(n){n.closest(".".concat(zt.Class.toolbar))||(this.state.blockSelection.allBlocksSelected=!1,this.clearSelection(),this.stackOfSelected=[]);var i=[".".concat(Ht.Class.content),".".concat(zt.Class.toolbar),".".concat(qt.Class.inlineToolbar)],o=n.closest("."+Ut.Class.editorZoneContent),a=i.some((function(e){return!!n.closest(e)}));if(!o||a)return}this.mousedown=!0,this.startX=e,this.startY=t}},{key:"endSelection",value:function(){this.mousedown=!1,this.startX=0,this.startY=0,this.overlayRectangle.style.display="none"}},{key:"isRectActivated",value:function(){return this.isRectSelectionActivated}},{key:"clearSelection",value:function(){this.isRectSelectionActivated=!1}},{key:"enableModuleBindings",value:function(){var e=this,t=this.genHTML().content,n=this.blockEditable.editable,i=n.document,o=n.window;this.listeners.on(t,"mousedown",(function(t){e.processMouseDown(t)}),!1),this.listeners.on(i.body,"mousemove",(function(t){e.processMouseMove(t)}),!1),this.listeners.on(i.body,"mouseleave",(function(){e.processMouseLeave()})),this.listeners.on(o,"scroll",(function(t){e.processScroll(t)}),!1),this.listeners.on(i.body,"mouseup",(function(){e.processMouseUp()}),!1)}},{key:"processMouseDown",value:function(e){e.button===this.MAIN_MOUSE_BUTTON&&(e.metaKey||e.ctrlKey||this.startSelection(e.pageX,e.pageY))}},{key:"processMouseMove",value:function(e){this.changingRectangle(e),this.scrollByZones(e.clientY)}},{key:"processMouseLeave",value:function(){this.clearSelection(),this.endSelection()}},{key:"processScroll",value:function(e){this.changingRectangle(e)}},{key:"processMouseUp",value:function(){this.endSelection()}},{key:"scrollByZones",value:function(e){var t=this.blockEditable.editable.document;this.inScrollZone=null,e<=this.HEIGHT_OF_SCROLL_ZONE&&(this.inScrollZone=this.TOP_SCROLL_ZONE),t.documentElement.clientHeight-e<=this.HEIGHT_OF_SCROLL_ZONE&&(this.inScrollZone=this.BOTTOM_SCROLL_ZONE),this.inScrollZone?this.isScrolling||(this.scrollVertical(this.inScrollZone===this.TOP_SCROLL_ZONE?-this.SCROLL_SPEED:this.SCROLL_SPEED),this.isScrolling=!0):this.isScrolling=!1}},{key:"genHTML",value:function(){var e=this.state.ui,t=e.nodes.holder.querySelector("."+Ut.Class.editorWrapper),i=e.nodes.content,o=Bt.a.make("div",n.Class.overlay,{}),a=Bt.a.make("div",n.Class.overlayContainer,{}),s=Bt.a.make("div",n.Class.rect,{});return a.appendChild(s),o.appendChild(a),null===t||void 0===t||t.appendChild(o),this.overlayRectangle=s,{content:i,overlay:o}}},{key:"scrollVertical",value:function(e){var t=this,n=this.blockEditable.editable.window;if(this.inScrollZone&&this.mousedown){var i=n.pageYOffset;n.scrollBy(0,e),this.mouseY+=n.pageYOffset-i,setTimeout((function(){t.scrollVertical(e)}),0)}}},{key:"changingRectangle",value:function(e){if(this.mousedown){void 0!==e.pageY&&(this.mouseX=e.pageX,this.mouseY=e.pageY);var t=this.genInfoForMouseSelection(),n=t.rightPos,i=t.leftPos,o=t.index,a=this.startX>n&&this.mouseX>n,s=this.startX<i&&this.mouseX<i;this.rectCrossesBlocks=!(a||s),this.isRectSelectionActivated||(this.rectCrossesBlocks=!1,this.isRectSelectionActivated=!0,this.shrinkRectangleToPoint(),this.overlayRectangle.style.display="block"),this.updateRectangleSize(),-1!==o&&(this.trySelectNextBlock(o),this.inverseSelection(),this.blockEditable.selection.removeAllRanges(),e.preventDefault())}}},{key:"shrinkRectangleToPoint",value:function(){this.overlayRectangle.style.left="".concat(this.startX-window.pageXOffset,"px"),this.overlayRectangle.style.top="".concat(this.startY-window.pageYOffset,"px"),this.overlayRectangle.style.bottom="calc(100% - ".concat(this.startY-window.pageYOffset,"px"),this.overlayRectangle.style.right="calc(100% - ".concat(this.startX-window.pageXOffset,"px")}},{key:"inverseSelection",value:function(){var e=this.state.content.getBlockByIndex(this.stackOfSelected[0]),t=!!e&&e.selected;if(this.rectCrossesBlocks&&!t){var n,i=Object(qe.a)(this.stackOfSelected);try{for(i.s();!(n=i.n()).done;){var o=n.value;this.state.blockSelection.selectBlockByIndex(o)}}catch(l){i.e(l)}finally{i.f()}}if(!this.rectCrossesBlocks&&t){var a,s=Object(qe.a)(this.stackOfSelected);try{for(s.s();!(a=s.n()).done;){var r=a.value;this.state.blockSelection.unSelectBlockByIndex(r)}}catch(l){s.e(l)}finally{s.f()}}}},{key:"updateRectangleSize",value:function(){this.mouseY>=this.startY?(this.overlayRectangle.style.top="".concat(this.startY-window.pageYOffset,"px"),this.overlayRectangle.style.bottom="calc(100% - ".concat(this.mouseY-window.pageYOffset,"px")):(this.overlayRectangle.style.bottom="calc(100% - ".concat(this.startY-window.pageYOffset,"px"),this.overlayRectangle.style.top="".concat(this.mouseY-window.pageYOffset,"px")),this.mouseX>=this.startX?(this.overlayRectangle.style.left="".concat(this.startX-window.pageXOffset,"px"),this.overlayRectangle.style.right="calc(100% - ".concat(this.mouseX-window.pageXOffset,"px")):(this.overlayRectangle.style.right="calc(100% - ".concat(this.startX-window.pageXOffset,"px"),this.overlayRectangle.style.left="".concat(this.mouseX-window.pageXOffset,"px"))}},{key:"genInfoForMouseSelection",value:function(){var e=this.blockEditable.editable,t=e.document,n=e.window,i=t.body.offsetWidth/2,o=this.mouseY-n.pageYOffset,a=this.state.ui.elementFromPoint(i,o);if(!a)return{index:-1,leftPos:0,rightPos:0};var s=this.state.content.getBlock(a),r=-1;void 0!==s&&(r=this.state.content.blocks.findIndex((function(e){return e.holder===s.holder})));var l=this.state.content.lastBlock.holder.querySelector("."+Ht.Class.content),c=Number.parseInt(n.getComputedStyle(l).width,10)/2;return{index:r,leftPos:i-c,rightPos:i+c}}},{key:"addBlockInSelection",value:function(e){this.rectCrossesBlocks&&this.state.blockSelection.selectBlockByIndex(e),this.stackOfSelected.push(e)}},{key:"trySelectNextBlock",value:function(e){var t=this,n=this.stackOfSelected[this.stackOfSelected.length-1]===e,i=this.stackOfSelected.length;if(!n){var o=this.stackOfSelected[i-1]-this.stackOfSelected[i-2]>0,a=0;i>1&&(a=o?1:-1);var s=e>this.stackOfSelected[i-1]&&1===a,r=e<this.stackOfSelected[i-1]&&-1===a,l=!(s||r||0===a);if(l||!(e>this.stackOfSelected[i-1]||void 0===this.stackOfSelected[i-1])){if(!l&&e<this.stackOfSelected[i-1])for(var c=this.stackOfSelected[i-1]-1;c>=e;c--)this.addBlockInSelection(c);else if(l){var u,d=i-1;for(u=e>this.stackOfSelected[i-1]?function(){return e>t.stackOfSelected[d]}:function(){return e<t.stackOfSelected[d]};u();)this.rectCrossesBlocks&&this.state.blockSelection.unSelectBlockByIndex(this.stackOfSelected[d]),this.stackOfSelected.pop(),d--}}else for(var h=this.stackOfSelected[i-1]+1||e;h<=e;h++)this.addBlockInSelection(h)}}}],[{key:"Class",get:function(){return{overlay:"beui-editor-overlay",overlayContainer:"beui-editor-overlay__container",rect:"beui-editor-overlay__rectangle",topScrollZone:"beui-editor-overlay__scroll-zone--top",bottomScrollZone:"beui-editor-overlay__scroll-zone--bottom"}}}]),n}(jt),vn=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).toolsDontSupportReadOnly=[],e.readOnlyEnabled=!1,e}return Object(s.a)(n,[{key:"prepare",value:function(){var e=Object(ke.a)(ge.a.mark((function e(){return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.toggle(!1);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toggle",value:function(){var e=Object(ke.a)(ge.a.mark((function e(){var t,n,i,o=arguments;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=o.length>0&&void 0!==o[0]?o[0]:!this.readOnlyEnabled)&&this.toolsDontSupportReadOnly.length>0&&this.throwCriticalError(),n=this.readOnlyEnabled,this.readOnlyEnabled=t,e.t0=ge.a.keys(this.state);case 5:if((e.t1=e.t0()).done){e.next=12;break}if(i=e.t1.value,this.state[i].toggleReadOnly){e.next=9;break}return e.abrupt("continue",5);case 9:this.state[i].toggleReadOnly(t),e.next=5;break;case 12:if(n!==t){e.next=14;break}return e.abrupt("return",this.readOnlyEnabled);case 14:return e.abrupt("return",this.readOnlyEnabled);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"throwCriticalError",value:function(){}},{key:"isEnabled",get:function(){return this.readOnlyEnabled}}]),n}(jt),bn=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"export",value:function(e,t){return"markdown"===e?this.state.content.getContentMarkdown(t):"plain"===e?this.state.content.getContentText(t):"juejin"===e?"---\ntheme: "+this.blockEditable.getTypesetId()+"\n---\n\n"+this.state.content.getContentMarkdown(t):this.renderContentRichHTML(e,t)}},{key:"renderContentRichHTML",value:function(e,t){var n=this.state.content.getContentHTML(e,t),i=this.blockEditable.getTypesetCSSText();return Object(Rt.f)(n,i)}}]),n}(jt),mn=["web","print","mobile"],gn=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"prepare",value:function(){var e=Object(ke.a)(ge.a.mark((function e(){var t,n,i,o,a,s,r;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.blockEditable.editable,n=this.state,i=n.ui,o=n.toolbar,a=n.exporter,s=n.blockSelection,r=n.content,t.registerCommand((function(){return{cmdName:"basic",notNeedUndo:!0,execCommand:function(e,n){r.basic=n,t.trigger("contentchange")},queryCommandState:function(){return i.nodes.wrapper?0:-1},queryCommandValue:function(){return Object(V.a)({},r.basic)},shortcutKeys:{}}})),t.registerCommand((function(){return{cmdName:"layout",notNeedUndo:!0,execCommand:function(e,n){i.layout=n||mn[(mn.indexOf(i.layout)+1)%3],o.move(),t.trigger("contentchange")},queryCommandState:function(){return i.nodes.wrapper?0:-1},queryCommandValue:function(){return i.layout},shortcutKeys:{"Ctrl+L":{}}}})),t.registerCommand((function(){return{cmdName:"export",ignoreContentChange:!0,notNeedUndo:!0,execCommand:function(e,t){var n=["text/plain"];return-1!==["wechat","zhihu","html"].indexOf(t)&&n.push("text/html"),Object(Rt.d)(a.export(t),n)},queryCommandState:function(){return t.isReady?0:-1}}})),t.registerCommand((function(){return{cmdName:"content",ignoreContentChange:!0,notNeedUndo:!0,execCommand:function(e,t){return a.export(t)},queryCommandState:function(){return t.isReady?0:-1}}})),t.registerCommand((function(){return t.ready((function(){var e="Ctrl+A";t.$dom.on(t.holder,"keydown",(function(n){var i=n.keyCode||n.which;(/^(ctrl)(\+shift)?\+(\w+)$/.test(e.toLowerCase())||/^(\w+)$/.test(e.toLowerCase()))&&("ctrl"===RegExp.$1&&(n.ctrlKey||n.metaKey)&&(""===RegExp.$2||n[RegExp.$2.slice(1)+"Key"])&&i===t.$keymap[RegExp.$3]||i===t.$keymap[RegExp.$1])&&s.handleCommandA(n)}))})),{cmdName:"selectall",ignoreContentChange:!0,notNeedUndo:!0,execCommand:function(e,t){r.activeBlock&&s.handleCommandA()},queryCommandState:function(){return t.isReady?0:-1}}})),t.registerCommand({cmdName:"fullscreen",notNeedUndo:!0,ignoreContentChange:!0,execCommand:function(e){t.trigger("fullscreen")},queryCommandState:function(e){return 0},shortcutKeys:{"Ctrl+Shift+F":{}}}),t.registerCommand({cmdName:"save",notNeedUndo:!0,ignoreContentChange:!0,execCommand:function(e){t.trigger("save")},queryCommandState:function(e){return 0},shortcutKeys:{"Ctrl+S":{}}}),t.registerCommand({cmdName:"search",notNeedUndo:!0,ignoreContentChange:!0,execCommand:function(e){t.trigger("search")},queryCommandState:function(e){return 0},shortcutKeys:{"Ctrl+F":{}}}),t.registerCommand({cmdName:"tab",notNeedUndo:!0,ignoreContentChange:!0,execCommand:function(e){t.trigger("tab")},queryCommandState:function(e){return 0},shortcutKeys:{"Ctrl+T":{}}}),t.registerCommand({cmdName:"wordcount",notNeedUndo:!0,ignoreContentChange:!0,execCommand:function(e){return r.getWordCount()},queryCommandState:function(e){return 0},shortcutKeys:{}});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(jt),kn=n(808),yn=n.n(kn),_n={ui:Ut,tooltip:$t,paste:Gt,copy:Yt,notifier:Qt,events:en,dragdrop:tn,cursor:nn,content:an,toolbox:cn,toolbar:zt,conversionToolbar:un,inlineToolbar:qt,insertToolbar:Vt,blockSettings:dn,blockSelection:hn,crossSelection:pn,rectangleSelection:fn,readOnly:vn,exporter:bn,commands:gn,sanitizer:function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).configCache={},e.inlineToolsConfigCache=null,e.insertToolsConfigCache=null,e}return Object(s.a)(n,[{key:"sanitizeBlocks",value:function(e){var t=this;return e.map((function(e){var n=t.composeComponentConfig(e.key);return wt.j(n)||(e.data=t.deepSanitize(e.data,n)),e}))}},{key:"deepSanitize",value:function(e,t){return Array.isArray(e)?this.cleanArray(e,t):wt.m(e)?this.cleanObject(e,t):wt.o(e)?this.cleanOneItem(e,t):e}},{key:"clean",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={tags:t},i=this.createHTMLJanitorInstance(n);return i.clean(e)}},{key:"composeComponentConfig",value:function(e){if(this.configCache[e])return this.configCache[e];var t=se.a.component(e),n=Object.assign({},this.getInlineToolsConfig(t),this.getAllInsertToolsConfig());if(!t.sanitize||t.sanitize&&wt.j(t.sanitize))return n;var i=t.sanitize,o={};for(var a in i)if(Object.prototype.hasOwnProperty.call(i,a)){var s=i[a];wt.m(s)?o[a]=Object.assign({},n,s):o[a]=s}return this.configCache[e]=o,o}},{key:"getInlineToolsConfig",value:function(e){var t=e.enabledInlineTools||[],n={};return wt.i(t)&&t?n=this.getAllInlineToolsConfig():t.map((function(e){n=Object.assign(n,se.b.tool(e).sanitize)})),n.br=!0,n.wbr=!0,n}},{key:"getAllInlineToolsConfig",value:function(){if(this.inlineToolsConfigCache)return this.inlineToolsConfigCache;var e={};return Object.entries(se.b.tools).forEach((function(t){var n=Object(be.a)(t,2)[1];Object.assign(e,n.sanitize)})),this.inlineToolsConfigCache=e,this.inlineToolsConfigCache}},{key:"getAllInsertToolsConfig",value:function(){if(this.insertToolsConfigCache)return this.insertToolsConfigCache;var e={};return Object.entries(se.c.tools).forEach((function(t){var n=Object(be.a)(t,2)[1];Object.assign(e,n.sanitize)})),this.insertToolsConfigCache=e,this.insertToolsConfigCache}},{key:"cleanArray",value:function(e,t){var n=this;return e.map((function(e){return n.deepSanitize(e,t)}))}},{key:"cleanObject",value:function(e,t){var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=e[i],a=this.isRule(t[i])?t[i]:t;n[i]=this.deepSanitize(o,a)}return n}},{key:"cleanOneItem",value:function(e,t){return wt.m(t)?this.clean(e,t):!1===t?this.clean(e,{}):e}},{key:"isRule",value:function(e){return wt.m(e)||wt.i(e)||wt.k(e)}},{key:"createHTMLJanitorInstance",value:function(e){return e?new yn.a(e):null}}]),n}(jt)},Cn=n(548),xn=function(){function e(){Object(a.a)(this,e),this.subscribers={}}return Object(s.a)(e,[{key:"on",value:function(e,t){e in this.subscribers||(this.subscribers[e]=[]),this.subscribers[e].push(t)}},{key:"once",value:function(e,t){var n=this;e in this.subscribers||(this.subscribers[e]=[]);this.subscribers[e].push((function i(o){var a=t(o),s=n.subscribers[e].indexOf(i);return-1!==s&&n.subscribers[e].splice(s,1),a}))}},{key:"emit",value:function(e,t){this.subscribers[e]&&this.subscribers[e].reduce((function(e,t){return t(e)||e}),t)}},{key:"off",value:function(e,t){for(var n=0;n<this.subscribers[e].length;n++)if(this.subscribers[e][n]===t){delete this.subscribers[e][n];break}}},{key:"destroy",value:function(){this.subscribers={}}}]),e}(),En=n(123),On=n(30),Sn=n(811),wn=[];Sn.keys().forEach((function(e){e.match(/^\.\/.*\/index\.([tj])s$/)&&wn.push(Sn(e))}));var Tn=function(){function e(t){var n,i,o=this;Object(a.a)(this,e),this._editable=void 0,this._defaultBlockComp=void 0,this._state={},this._utils={clearEmpty:Rt.c,inlineContent:Rt.f,svgToBlob:Rt.n,makeMarkdown:Rt.j,makeHtml:Rt.i,Base64:On.a},this._holder=void 0,this._eventsDispatcher=void 0,this._mutationObserver=void 0,this.isReady=void 0,this._defaultBlockComp=(null===t||void 0===t?void 0:t.defaultBlockComp)||Cn.default,this._holder=t.holder,this.isReady=new Promise((function(e,t){n=e,i=t})),se.a.indexes=["header","image","list","todolist","delimiter","table","code","math","diagram","draw","drawio","paragraph"],se.d.indexes=["moveup","movedown","delete","quote"],se.b.indexes=["bold","italic","underline","strikethrough","link","mark","inlinecode","superscript","subscript"],Promise.resolve().then(Object(ke.a)(ge.a.mark((function e(){return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.init();case 2:return e.next=4,o.start();case 4:return e.next=6,o.render();case 6:o.state.ui.removeLoader(),n();case 9:case"end":return e.stop()}}),e)})))).catch((function(e){i(e)}))}return Object(s.a)(e,[{key:"mount",value:function(e){return this._holder=e,this._editable}},{key:"destroy",value:function(){}},{key:"setTypeset",value:function(e){$.a.setTypeset(this.editable,e)}},{key:"getTypesetCSSText",value:function(){return $.a.getTypesetCSSText(this.editable)}},{key:"getTypesetId",value:function(){return this.editable.queryCommandValue("typeset")||""}},{key:"getLang",value:function(e,t){return En.a.getLang(e)||t||""}},{key:"init",value:function(){var e=Object(ke.a)(ge.a.mark((function e(){var t=this;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._editable=new St({darkmode:document.documentElement.classList.contains("dark-mode")}),this._editable.ready((function(){var e=n(1102),i="beui-content";e&&!t._editable.hasCSS("#"+i)&&t._editable.appendCSS(e,{id:i});var o=n(260),a="be-common-typeset-basic";o&&!t._editable.hasCSS("#"+a)&&t._editable.appendCSS(o,{id:a});var s=se.a.components;for(var r in s){var l=s[r];t.injectPluginCSSAndCommonTypeset(l)}})),this._mutationObserver=this._mutationObserver=new MutationObserver((function(){t._editable.darkmode=document.documentElement.classList.contains("dark-mode")})),this._mutationObserver.observe(document.documentElement,{attributes:!0}),$.a.registerCommand(this._editable),this._eventsDispatcher=new xn,Object.entries(_n).forEach((function(e){var n=Object(be.a)(e,2),i=n[0],o=n[1];t._state[i]=new o({blockEditable:t})}));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"start",value:function(){var e=Object(ke.a)(ge.a.mark((function e(){var t,n=this;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=["ui","paste","copy","blockSelection","rectangleSelection","crossSelection","readOnly","commands"],e.next=3,t.reduce((function(e,t){return e.then(Object(ke.a)(ge.a.mark((function e(){var i;return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(i=n._state[t]).prepare){e.next=5;break}return e.next=5,i.prepare();case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])}))))}),Promise.resolve());case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=Object(ke.a)(ge.a.mark((function e(){return ge.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.state.ui.checkEmptiness();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"injectPluginCSSAndCommonTypeset",value:function(e){var t="beui-".concat(e.key),n=e.CSS;n&&!this._editable.hasCSS("#"+t)&&this._editable.appendCSS(n,{id:t});var i="be-common-typeset-".concat(e.key),o=e.builtinTypesets;o&&o.common&&!this._editable.hasCSS("#"+i)&&this._editable.appendCSS(o.common,{id:i})}},{key:"defaultBlockComp",get:function(){return this._defaultBlockComp}},{key:"defaultBlockCompInitData",get:function(){return{key:this.defaultBlockComp.key,data:this.defaultBlockComp.defaultData}}},{key:"editable",get:function(){return this._editable}},{key:"state",get:function(){return this._state}},{key:"utils",get:function(){return this._utils}},{key:"holder",get:function(){return this._holder}},{key:"selection",get:function(){return this._editable.selection}},{key:"eventsDispatcher",get:function(){return this._eventsDispatcher}}]),e}(),jn=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).content=void 0,i.blockEditable=void 0,i.onUpdateContent=function(){var e=i.props.onEditable;i.content&&(i.blockEditable=new Tn({holder:i.content}),i.blockEditable.isReady.then((function(){i.setState({editable:i.blockEditable.editable}),i.blockEditable.editable.on("contentchange aftersetcontent",(function(){i.onContentChange()})),e(i.blockEditable.editable),i.blockEditable.editable.on("fullscreen",(function(){i.onTriggerFullscreen()}))})))},i.onContentChange=function(){var e=i.blockEditable.editable;if(e){var t=e.execCommand("wordcount");i.setState({wordCount:t})}},i.onTriggerFullscreen=function(e){if(e){var t=e.target.parentElement;if((null===t||void 0===t?void 0:t.closest(".beui-toolbar"))||(null===t||void 0===t?void 0:t.closest(".beui-inline-toolbar")))return}i.setState({fullscreen:!i.state.fullscreen},(function(){setTimeout((function(){ve.a.trigger("onTriggerFullscreen",i.state.fullscreen)}),100)}))},i.onExitFullscreen=function(){i.setState({fullscreen:!1})},i.onTypesetEditing=function(e){i.setState({isTypesetEditing:e})},i.onProfileEditing=function(e){i.setState({isProfileEditing:e})},i.onShowingCatalog=function(e){i.setState({isCatalogShowing:e})},i.state={editable:null,fullscreen:!1,isTypesetEditing:!1,isCatalogShowing:!1,isProfileEditing:!1,wordCount:0},i.onContentChange=Object(wt.d)(i.onContentChange,500),i}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.onUpdateContent(),ve.a.on("onAppSideBarTabOpen onOpen",this.onExitFullscreen)}},{key:"componentWillUnmount",value:function(){ve.a.off("onAppSideBarTabOpen onOpen",this.onExitFullscreen)}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var e=this,t=(this.props.customToolbar,this.state),n=t.fullscreen,i=t.editable,a=t.isTypesetEditing,s=t.isCatalogShowing,r=t.isProfileEditing,l=t.wordCount;return Object(o.jsx)("div",{className:"editor",style:{top:n?"-31px":"31px"},children:Object(o.jsx)("div",{className:"editor-inner",children:Object(o.jsxs)("div",{className:"editor-main",children:[Object(o.jsxs)("div",{className:["editor-core",a||s||r?"editor-core--card":""].join(" "),children:[Object(o.jsx)("div",{className:"editor-canvas",ref:function(t){e.content=t}}),Object(o.jsx)("div",{className:"editor-status-bar",children:i&&Object(o.jsx)("div",{className:"editor-word-count",children:Object(o.jsxs)("span",{children:["\u6b63\u6587\u5b57\u6570 ",l," \u4e2a\uff0c\u9884\u8ba1\u9605\u8bfb\u9700 ",Math.ceil(l/300)," \u5206\u949f"]})})})]}),Object(o.jsx)("div",{className:"editor-side-bar",children:Object(o.jsx)("div",{className:"editor-side-bar-nav",children:Object(o.jsxs)("div",{className:"editor-side-bar-nav__top",children:[Object(o.jsx)(h.a,{wrapClassName:"editor-side-bar-item app-guide-fullscreen",onClick:this.onTriggerFullscreen,icon:n?Object(o.jsx)(u.a,{}):Object(o.jsx)(d.a,{})}),Object(o.jsx)(fe,{}),Object(o.jsx)(y,{editable:i,onShowingCatalog:this.onShowingCatalog}),Object(o.jsx)(H,{editable:i}),Object(o.jsx)(fe,{}),Object(o.jsx)(T,{editable:i}),Object(o.jsx)(fe,{}),Object(o.jsx)(pe,{editable:i}),Object(o.jsx)(he,{editable:i}),Object(o.jsx)(fe,{}),Object(o.jsx)(X,{editable:i,onTypesetEditing:this.onTypesetEditing}),Object(o.jsx)(ie,{editable:i}),Object(o.jsx)(le,{editable:i,onProfileEditing:this.onProfileEditing})]})})})]})})})}}]),n}(c.Component);t.default=jn},180:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var i=n(1),o=n(7),a=n(6),s=n(10),r=n(9),l=n(0),c=n.n(l),u=n(233),d=n.n(u),h=n(23),p=(n(258),n(264),n(265),{Apply:"\u5e94\u7528",Arrow:"\u7bad\u5934","Arrow-2":"\u7bad\u5934-2","Arrow-3":"\u7bad\u5934-3",Blend:"\u7740\u8272",Blur:"\u6a21\u7cca",Bold:"\u52a0\u7c97",Brightness:"\u66dd\u5149\u5ea6",Bubble:"\u6c14\u6ce1",Cancel:"\u53d6\u6d88",Center:"\u5c45\u4e2d",Circle:"\u5706",Color:"\u989c\u8272","Color Filter":"\u989c\u8272\u6ee4\u955c",Crop:"\u88c1\u5207",Custom:"\u81ea\u5b9a\u4e49","Custom icon":"\u81ea\u5b9a\u4e49\u56fe\u6807",Delete:"\u5220\u9664",DeleteAll:"\u5220\u9664\u5168\u90e8","Delete-all":"\u5168\u90e8\u5220\u9664",Distance:"\u5f3a\u5ea6",Download:"\u4fdd\u5b58\u5e76\u9000\u51fa",Draw:"\u753b",Emboss:"\u6d6e\u96d5",Fill:"\u586b\u5145",Filter:"\u66f4\u591a\u8bbe\u7f6e",Flip:"\u7ffb\u8f6c","Flip X":"\u6c34\u5e73\u7ffb\u8f6c","Flip Y":"\u5782\u76f4\u7ffb\u8f6c",Free:"\u66f2\u7ebf",Grayscale:"\u7070\u9636",Heart:"\u5fc3",Icon:"\u56fe\u6807",Invert:"\u53cd\u76f8",Italic:"\u659c\u4f53",Left:"\u5de6\u5bf9\u9f50",Load:"\u6253\u5f00\u56fe\u7247","Load Mask Image":"\u52a0\u8f7d\u8499\u7248\u56fe\u50cf",Location:"\u4f4d\u7f6e",Mask:"\u906e\u7f69",Multiply:"\u989c\u8272\u52a0\u6df1",Noise:"\u566a\u70b9",Pixelate:"\u50cf\u7d20\u5316",Polygon:"\u591a\u8fb9\u5f62",Range:"\u8303\u56f4",Rectangle:"\u957f\u65b9\u5f62",Redo:"\u91cd\u505a","Remove White":"\u53bb\u9664\u767d\u8272",Reset:"\u91cd\u7f6e",Right:"\u53f3\u5bf9\u9f50",Rotate:"\u65cb\u8f6c",Sepia:"\u68d5\u8910\u8272",Sepia2:"\u68d5\u8910\u82722",Shape:"\u5f62\u72b6",Sharpen:"\u9510\u5316",Square:"\u6b63\u65b9\u5f62","Star-1":"\u661f\u661f-1","Star-2":"\u661f\u661f-2",Straight:"\u76f4\u7ebf",Stroke:"\u63cf\u8fb9",Text:"\u6587\u672c","Text size":"\u5b57\u4f53\u5927\u5c0f",Threshold:"\u9608\u503c",Tint:"\u6df7\u5408\u989c\u8272",Triangle:"\u4e09\u89d2\u5f62",Underline:"\u4e0b\u5212\u7ebf",Undo:"\u64a4\u6d88",Value:"\u503c"}),f=function(e,t){window.parent&&window.parent.postMessage({event:e,data:t},"*")},v=function(e){Object(s.a)(n,e);var t=Object(r.a)(n);function n(){var e;Object(o.a)(this,n);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a)))._root=void 0,e._editor=void 0,e.onLoadImage=function(t){if(e._root){var n=(t=t||"").split("/");e._editor=new d.a(e._root,{cssMaxWidth:900,cssMaxHeight:500,selectionStyle:{cornerSize:20,rotatingPointOffset:70},includeUI:{loadImage:{path:t,name:n[n.length-1]},locale:p,initMenu:"filter",menuBarPosition:"bottom"},usageStatistics:!1}),window.saveAs=function(e,t){f("save",{blob:e})}}},e.onExit=function(){f("exit",{})},e}return Object(a.a)(n,[{key:"componentDidMount",value:function(){var e=Object(h.e)(window.location.href).url;this.onLoadImage(e)}},{key:"render",value:function(){var e=this;return Object(i.jsxs)("div",{className:"image-editor-wraper",children:[Object(i.jsx)("div",{className:"image-editor",ref:function(t){e._root=t}}),Object(i.jsx)("button",{onClick:this.onExit,className:"tui-image-editor-exit-btn",children:"\u9000\u51fa"})]})}}]),n}(c.a.Component)},257:function(e,t,n){"use strict";n.r(t);var i=n(1),o=(n(0),n(34)),a=n.n(o),s=n(180);a.a.render(Object(i.jsx)(s.default,{}),document.getElementById("root"))},258:function(e,t,n){},261:function(e,t){},262:function(e,t){},263:function(e,t){},515:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(43),o=n(7),a=n(6),s=n(516),r=function(){function e(){Object(o.a)(this,e)}return Object(a.a)(e,null,[{key:"isSingleTag",value:function(e){return!!e.tagName&&["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"].includes(e.tagName)}},{key:"isLineBreakTag",value:function(e){return!!e&&!!e.tagName&&["BR","WBR"].includes(e.tagName)}},{key:"make",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=document.createElement(e);Array.isArray(n)?(t=a.classList).add.apply(t,Object(i.a)(n)):n&&a.classList.add(n);for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&a.setAttribute(s,o[s]);return a}},{key:"text",value:function(e){return document.createTextNode(e)}},{key:"icon",value:function(e){var t=document.createElement("i");return t.classList.add("bei-".concat(e)),t.classList.add("icon--".concat(e)),t}},{key:"append",value:function(e,t){Array.isArray(t)?t.forEach((function(t){return e.appendChild(t)})):e.appendChild(t)}},{key:"prepend",value:function(e,t){Array.isArray(t)?(t=t.reverse()).forEach((function(t){return e.prepend(t)})):e.prepend(t)}},{key:"swap",value:function(e,t){var n=document.createElement("div"),i=e.parentNode;i&&(i.insertBefore(n,e),i.insertBefore(e,t),i.insertBefore(t,n),i.removeChild(n))}},{key:"find",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>1?arguments[1]:void 0;return e.querySelector(t)}},{key:"get",value:function(e){return document.getElementById(e)}},{key:"findAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>1?arguments[1]:void 0;return e.querySelectorAll(t)}},{key:"isVisible",value:function(e){for(var t=!0,n="none"!=getComputedStyle(e).display&&"hidden"!=getComputedStyle(e).visibility;t&&n;)(e=e.parentNode)&&e!==document.body&&11!==e.nodeType&&!e.classList.contains("beui-block__content")?n="none"!=getComputedStyle(e).display&&"hidden"!=getComputedStyle(e).visibility:t=!1;return n}},{key:"findAllInputs",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return s.a(t.querySelectorAll(e.allInputsSelector+","+n.join(","))).reduce((function(e,t){return[].concat(Object(i.a)(e),[t])}),[])}},{key:"findVisibleInputs",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return s.a(t.querySelectorAll(e.allInputsSelector+","+n.join(","))).reduce((function(t,n){return e.isVisible(n)?[].concat(Object(i.a)(t),[n]):Object(i.a)(t)}),[])}},{key:"getDeepestNode",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=n?"lastChild":"firstChild",o=n?"previousSibling":"nextSibling";if(t&&t.nodeType===Node.ELEMENT_NODE&&t[i]){var a=t[i];if(e.isSingleTag(a)&&!e.isNativeInput(a)&&!e.isLineBreakTag(a)){if(!a[o])return a.parentNode;a=a[o]}return this.getDeepestNode(a,n)}return t}},{key:"isElement",value:function(e){return!s.l(e)&&(e&&e.nodeType&&e.nodeType===Node.ELEMENT_NODE)}},{key:"isFragment",value:function(e){return!s.l(e)&&(e&&e.nodeType&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE)}},{key:"isContentEditable",value:function(e){return"true"===e.contentEditable}},{key:"isNativeInput",value:function(e){return!(!e||!e.tagName)&&["INPUT","TEXTAREA"].includes(e.tagName)}},{key:"canSetCursor",value:function(t){var n=!0;if(e.isNativeInput(t))switch(t.type){case"file":case"checkbox":case"radio":case"hidden":case"submit":case"button":case"image":case"reset":n=!1}else n=e.isContentEditable(t);return n}},{key:"isNodeEmpty",value:function(e){var t;return!(this.isSingleTag(e)&&!this.isLineBreakTag(e))&&(!(t=this.isElement(e)&&this.isNativeInput(e)?e.value:(t=e.textContent&&e.textContent.replace("\u200b",""))&&t.replace(/[\u200B-\u200D\uFEFF]/g,""))||0===t.trim().length)}},{key:"isLeaf",value:function(e){return!!e&&0===e.childNodes.length}},{key:"isEmpty",value:function(e){e.normalize();for(var t=[e];t.length>0;)if(e=t.shift()){if(this.isLeaf(e)&&!this.isNodeEmpty(e))return!1;e.childNodes&&t.push.apply(t,Object(i.a)(Array.from(e.childNodes)))}return!0}},{key:"isHTMLString",value:function(t){var n=e.make("div");return n.innerHTML=t,n.childElementCount>0}},{key:"getContentLength",value:function(t){return e.isNativeInput(t)?t.value.length:t.nodeType===Node.TEXT_NODE?t.length:t.textContent?t.textContent.length:0}},{key:"containsOnlyInlineElements",value:function(t){var n;s.o(t)?(n=document.createElement("div")).innerHTML=t:n=t;return Array.from(n.children).every((function t(n){return!e.blockElements.includes(n.tagName.toLowerCase())&&Array.from(n.children).every(t)}))}},{key:"getDeepestBlockElements",value:function(t){return e.containsOnlyInlineElements(t)?[t]:Array.from(t.children).reduce((function(t,n){return[].concat(Object(i.a)(t),Object(i.a)(e.getDeepestBlockElements(n)))}),[])}},{key:"getHolder",value:function(e){return s.o(e)?document.getElementById(e):e}},{key:"isExtensionNode",value:function(e){return e&&["GRAMMARLY-EXTENSION"].includes(e.nodeName)}},{key:"isAnchor",value:function(e){return"a"===e.tagName.toLowerCase()}},{key:"removeNodeStyle",value:function(t){t.nodeType===Node.ELEMENT_NODE&&(t.removeAttribute("style"),t.childNodes.forEach((function(t){e.removeNodeStyle(t)})))}},{key:"allInputsSelector",get:function(){return"[contenteditable], textarea, input:not([type]), "+["text","password","email","number","search","tel","url"].map((function(e){return'input[type="'.concat(e,'"]')})).join(", ")}},{key:"blockElements",get:function(){return["address","article","aside","blockquote","canvas","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","noscript","ol","output","p","pre","ruby","section","table","tr","tfoot","ul","video","tasklist","taskli"]}}]),e}()},516:function(e,t,n){"use strict";n.d(t,"q",(function(){return o})),n.d(t,"r",(function(){return a})),n.d(t,"k",(function(){return r})),n.d(t,"m",(function(){return l})),n.d(t,"o",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"l",(function(){return d})),n.d(t,"j",(function(){return h})),n.d(t,"n",(function(){return p})),n.d(t,"a",(function(){return f})),n.d(t,"e",(function(){return v})),n.d(t,"g",(function(){return b})),n.d(t,"p",(function(){return m})),n.d(t,"d",(function(){return g})),n.d(t,"c",(function(){return k})),n.d(t,"b",(function(){return y})),n.d(t,"h",(function(){return _})),n.d(t,"s",(function(){return C})),n.d(t,"f",(function(){return x}));var i;n(22),n(38);!function(e){e.VERBOSE="VERBOSE",e.INFO="INFO",e.WARN="WARN",e.ERROR="ERROR"}(i||(i={}));var o={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,LEFT:37,UP:38,DOWN:40,RIGHT:39,INSERT:45,DELETE:46,META:91},a={LEFT:0,WHEEL:1,RIGHT:2,BACKWARD:3,FORWARD:4};function s(e){var t=Object.prototype.toString.call(e).match(/\s([a-zA-Z]+)/);return t?t[1].toLowerCase():""}function r(e){return"function"===s(e)||"asyncfunction"===s(e)}function l(e){return"object"===s(e)}function c(e){return"string"===s(e)}function u(e){return"boolean"===s(e)}function d(e){return"number"===s(e)}function h(e){return!e||0===Object.keys(e).length&&e.constructor===Object}function p(e){return e>47&&e<58||32===e||13===e||229===e||8===e||e>64&&e<91||e>95&&e<112||e>185&&e<193||e>218&&e<223}function f(e){return Array.prototype.slice.call(e)}function v(e,t){return function(){var n=this,i=arguments;window.setTimeout((function(){return e.apply(n,i)}),t)}}function b(e){return e.name.split(".").pop()||""}function m(e){return/^[-\w]+\/([-+\w]+|\*)$/.test(e)}function g(e,t,n){var i;return function(){var o=this,a=arguments,s=function(){i=null,n||e.apply(o,a)},r=n&&!i;window.clearTimeout(i),i=window.setTimeout(s,t),r&&e.apply(o,a)}}function k(e){return e[0].toUpperCase()+e.slice(1)}document.documentElement;function y(e){var t=function(){var e={win:!1,mac:!1,x11:!1,linux:!1},t=Object.keys(e).find((function(e){return-1!==navigator.appVersion.toLowerCase().indexOf(e)}));return t?(e[t]=!0,e):e}();return e=e.replace(/shift/gi,"\u21e7").replace(/backspace/gi,"\u232b").replace(/enter/gi,"\u23ce").replace(/up/gi,"\u2191").replace(/left/gi,"\u2192").replace(/down/gi,"\u2193").replace(/right/gi,"\u2190").replace(/escape/gi,"\u238b").replace(/insert/gi,"Ins").replace(/delete/gi,"\u2421").replace(/\+/gi," + "),e=t.mac?e.replace(/ctrl|cmd/gi,"\u2318").replace(/alt/gi,"\u2325"):e.replace(/cmd/gi,"Ctrl").replace(/windows/gi,"WIN")}function _(e){try{return new URL(e).href}catch(t){}return"//"===e.substring(0,2)?window.location.protocol+e:window.location.origin+e}function C(e){window.open(e,"_blank")}function x(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"".concat(e).concat(Math.floor(1e8*Math.random()).toString(16))}},518:function(e,t,n){"use strict";n.r(t),n.d(t,"make",(function(){return o})),n.d(t,"fragmentToString",(function(){return a})),n.d(t,"moveCaretToEnd",(function(){return s})),n.d(t,"moveCaretToStart",(function(){return r})),n.d(t,"isEmpty",(function(){return l})),n.d(t,"getHigherLevelSiblings",(function(){return c})),n.d(t,"extractFragmentFromCaretPositionTillTheEnd",(function(){return u})),n.d(t,"focus",(function(){return d})),n.d(t,"isAtStart",(function(){return h})),n.d(t,"isMac",(function(){return p}));var i=n(43);function o(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=document.createElement(e);Array.isArray(n)?(t=a.classList).add.apply(t,Object(i.a)(n)):n&&a.classList.add(n);for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&a.setAttribute(s,o[s]);return a}function a(e){var t=o("div");return t.appendChild(e),l(t)?"":t.innerHTML}function s(e,t){var n=t.getRangeAt(0);e&&(n.setStartAtLast(e),n.collapse(!0).select(!0))}function r(e,t){var n=t.getRangeAt(0);e&&(n.setStartAtFirst(e),n.collapse(!0).select(!0))}function l(e){return 0===(e.textContent||"").trim().length}function c(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"left",n=e,i=[];n.parentNode&&"true"!==n.parentNode.contentEditable;)n=n.parentNode;for(var o="left"===t?"previousSibling":"nextSibling";n[o];)n=n[o],i.push(n);return i}function u(e){if(e.rangeCount){var t=e.getRangeAt(0),n=t.startContainer;n&&n.nodeType!==Node.ELEMENT_NODE&&(n=n.parentNode);var i=n&&n.closest("[contenteditable]");if(i){t.deleteContents();var o=t.cloneRange();return o.selectNodeContents(i),o.setStart(t.endContainer,t.endOffset),o.extractContents()}}}function d(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(n)e.setCursor(t,0);else{var i=e.getRangeAt(0);i.setStartAtLast(t).setCursor(!1,!0)}}function h(e){if(e.focusOffset)return!1;var t=e.focusNode;return!!t&&c(t,"left").every((function(e){return l(e)}))}var p=/macintosh|mac os x/i.test(navigator.userAgent)},528:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var i=n(7),o=n(6),a=n(515),s=function(){function e(t){Object(i.a)(this,e),this._cmdName=void 0,this._shortcut=void 0,this._title=void 0,this.blockEditable=void 0,this.nodes={button:void 0},this._cmdName=t.cmdName,this._shortcut=t.shortcut,this._title=t.title,this.blockEditable=t.blockEditable}return Object(o.a)(e,[{key:"render",value:function(){return this.nodes.button=document.createElement("button"),this.nodes.button.type="button",this.nodes.button.classList.add(this.Class.button,this.Class.buttonModifier),this.nodes.button.appendChild(a.a.icon(this._cmdName,12,14)),this.nodes.button}},{key:"surround",value:function(e,t){t.execCommand(this.cmdName)}},{key:"selectionChange",value:function(e,t){var n=1===t.queryCommandState(this.cmdName);return this.nodes.button&&this.nodes.button.classList.toggle(this.Class.buttonActive,n),n}},{key:"destroy",value:function(){}},{key:"title",get:function(){return this._title}},{key:"cmdName",get:function(){return this._cmdName}},{key:"shortcut",get:function(){return this._shortcut}},{key:"Class",get:function(){return{button:"beui-inline-tool",buttonActive:"beui-inline-tool--active",buttonModifier:"beui-inline-tool--".concat(this._cmdName)}}}]),e}()},547:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return j}));var i=n(22),o=n.n(i),a=n(38),s=n(11),r=n(7),l=n(6),c=n(43),u=n(111),d=n(71),h=n(640),p=n(641),f=n(642).default,v=n(643).default,b=n(644).default,m=n(645).default,g=n(646).default,k=n(647).default,y=n(648).default;function _(e,t,n){return{regex:e,data:function(i,o){var a=i.match(e),s="";if(a){var r=(s=o(a[1])).match(/<p>(.*)<\/p>/);r&&(s=r[1])}return{data:{level:t,content:s},icon:n}}}}var C=_(/^#\s*(([^#|$].*)|$)/,1,v),x=_(/^##\s*(([^#|$].*)|$)/,2,b),E=_(/^###\s*(([^#|$].*)|$)/,3,m),O=_(/^####\s*(([^#|$].*)|$)/,4,g),S=_(/^#####\s*(([^#|$].*)|$)/,5,k),w=_(/^######\s*(([^#|$].*)|$)/,6,y);function T(e,t){var n=[];return n.push({level:Math.min(6,t),content:e.content}),n=e.items.reduce((function(e,n){return[].concat(Object(c.a)(e),Object(c.a)(T(n,t+1)))}),n)}var j=function(){function e(t){Object(r.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._nodes={},this._settingsButtons=[],this._blockEditable=t.blockEditable,this._data=t.data||e.defaultData}return Object(l.a)(e,null,[{key:"convertData",value:function(e,t){if("list"===e.key){var n=e.data,i=1===n.items.length?1:2;return n.items.reduce((function(e,t){return[].concat(Object(c.a)(e),Object(c.a)(T(t,i)))}),[])}var o=e.data;return[Object(s.a)({level:2},o)]}},{key:"toHtml",value:function(t){return"<h".concat(t.level,' class="be-').concat(e.key,'">').concat(t.content||"","</h").concat(t.level,">")}},{key:"toData",value:function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.querySelector(["H1","H2","H3","H4","H5","H6"].join(","));return{content:d.a.removeBlockChildren(n||t).innerHTML||"",level:n?parseInt(n.tagName.replace(/[^\d]*/,"")):void 0}}},{key:"toolbox",get:function(){return{icon:f,title:"Header",commands:[C,x,E,O,S,w]}}},{key:"sanitize",get:function(){return{level:!1,content:{}}}},{key:"acceptConversionComps",get:function(){return["paragraph","list"]}},{key:"enabledInlineTools",get:function(){return!0}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{content:"",level:2}}},{key:"builtinTypesets",get:function(){return{default:p}}},{key:"pasteConfig",get:function(){return{tags:["H1","H2","H3","H4","H5","H6"]}}},{key:"CSS",get:function(){return h}}]),Object(l.a)(e,[{key:"renderBlock",value:function(e){var t=this._data;return this._nodes.target=this.make(),this._nodes.target.innerHTML=t.content||"",this._nodes.target}},{key:"renderSettings",value:function(e){var t=this,n=document.createElement("DIV");return this.levels.length<=1||this.levels.forEach((function(i){var o=document.createElement("SPAN");o.classList.add(e.settingsButton),t.currentLevel.number===i.number&&o.classList.add(e.settingsButtonActive),o.innerHTML=i.svg,o.dataset.level="".concat(i.number),o.addEventListener("click",(function(){t.setLevel(i.number,e)})),n.appendChild(o),t._settingsButtons.push(o)})),n}},{key:"save",value:function(){return this.data}},{key:"merge",value:function(){var e=Object(a.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={content:this.data.content+t.content,level:this.data.level},this.data=n;case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onPaste",value:function(e){var t=e.detail.data,n=this.defaultLevel.number;switch(t.tagName){case"H1":n=1;break;case"H2":n=2;break;case"H3":n=3;break;case"H4":n=4;break;case"H5":n=5;break;case"H6":n=6}this.data={level:n,content:t.innerHTML}}},{key:"destroy",value:function(){}},{key:"make",value:function(){var t=document.createElement(this.currentLevel.tag);return t.setAttribute("class","be-".concat(e.key)),t.setAttribute("contenteditable","true"),t.setAttribute("placeholder",this.currentLevel.tag.toUpperCase()),t}},{key:"normalizeData",value:function(e){var t={content:"",level:this.defaultLevel.number};return"object"!==typeof e&&(e={content:""}),t.content=e.content||"",t.level=parseInt(e.level)||this.defaultLevel.number,t}},{key:"setLevel",value:function(e,t){this.data={level:e,text:this.data.text},this._settingsButtons.forEach((function(n){n.classList.toggle(t.settingsButtonActive,parseInt(n.dataset.level||"1")===e)}));var n=this._blockEditable.state,i=n.content,o=n.cursor;n.toolbar.close(),i.setActiveBlockBy(this._nodes.target),o.setToBlock(i.activeBlock,o.positions.END)}},{key:"key",get:function(){return"H".concat(this._data.level)}},{key:"data",get:function(){return this._data.content=this._nodes.target.innerHTML,this._data.level=this.currentLevel.number,this._data},set:function(e){if(this._data=this.normalizeData(e),void 0!==e.level&&this._nodes.target.parentNode){var t=this.make();t.innerHTML=this._nodes.target.innerHTML,this._nodes.target.parentNode.replaceChild(t,this._nodes.target),this._nodes.target=t;var n=t.closest(".beui-block");n&&(n.dataset.key=this.key)}void 0!==e.content&&(this._nodes.target.innerHTML=this._data.content||"")}},{key:"currentLevel",get:function(){var e=this,t=this.levels.find((function(t){return t.number===e._data.level}));return t||(t=this.defaultLevel),t}},{key:"defaultLevel",get:function(){return this.levels[1]}},{key:"levels",get:function(){return[{number:1,tag:"H1",svg:v},{number:2,tag:"H2",svg:b},{number:3,tag:"H3",svg:m},{number:4,tag:"H4",svg:g},{number:5,tag:"H5",svg:k},{number:6,tag:"H6",svg:y}]}}]),e}();j.key="header",u.a.regiester(j)},548:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var i=n(22),o=n.n(i),a=n(38),s=n(7),r=n(6),l=n(43),c=n(111),u=n(71),d=n(649),h=n(650),p=n(651).default;/macintosh|mac os x/i.test(navigator.userAgent);function f(e){var t=[];return t.push({content:e.content}),t=e.items.reduce((function(e,t){return[].concat(Object(l.a)(e),Object(l.a)(f(t)))}),t)}var v=function(){function e(t){Object(s.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._nodes={},this._blockEditable=t.blockEditable,this._data=t.data||e.defaultData}return Object(r.a)(e,null,[{key:"toHtml",value:function(t){return'<p class="be-'.concat(e.key,'">').concat(t.content||"","</p>")}},{key:"toData",value:function(e){var t=document.createElement("div");return t.innerHTML=e,u.a.removeBlockChildren(t),{content:t.innerHTML||""}}},{key:"convertData",value:function(e,t){if("list"===e.key){var n=e.data;n.items.length;return n.items.reduce((function(e,t){return[].concat(Object(l.a)(e),Object(l.a)(f(t)))}),[])}if("todolist"===e.key)return e.data.items.reduce((function(e,t){return[].concat(Object(l.a)(e),[{content:t.content}])}),[])}},{key:"toolbox",get:function(){var e=/(.*)/;return{icon:p,title:"Text",commands:[{regex:e,data:function(t,n){var i=t.match(e),o="";if(i){var a=(o=n(i[1])).match(/<p>(.*)<\/p>/);a&&(o=a[1])}return{data:{content:o}}}}]}}},{key:"sanitize",get:function(){return{content:{br:!0}}}},{key:"acceptConversionComps",get:function(){return!0}},{key:"enabledInlineTools",get:function(){return!0}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{content:""}}},{key:"builtinTypesets",get:function(){return{default:h}}},{key:"CSS",get:function(){return d}},{key:"pasteConfig",get:function(){return{tags:["P"]}}}]),Object(r.a)(e,[{key:"renderBlock",value:function(e){var t=this._data;return this._nodes.target=this.make(),this._nodes.target.innerHTML=t.content||"",this._nodes.target}},{key:"renderSettings",value:function(e){return null}},{key:"save",value:function(){return this.data}},{key:"merge",value:function(){var e=Object(a.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={content:this.data.content+t.content},this.data=n;case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onPaste",value:function(e){var t=e.detail.data;this.data={content:t.innerHTML||""}}},{key:"destroy",value:function(){}},{key:"make",value:function(){var t=document.createElement("p");return t.setAttribute("class","be-".concat(e.key)),t.setAttribute("contenteditable","true"),t.setAttribute("placeholder","\u6309Tab\u952e\uff0c\u6216\u8f93\u5165Markdown\u540e\u6309Enter\u952e"),t}},{key:"normalizeData",value:function(e){var t={content:""};return"object"!==typeof e&&(e={content:""}),t.content=e.content||"",t}},{key:"data",get:function(){return this._data.content=this._nodes.target.innerHTML,this._data},set:function(e){this._data=this.normalizeData(e),void 0!==this._data.content&&(this._nodes.target.innerHTML=this._data.content)}}]),e}();v.key="paragraph",c.a.regiester(v)},554:function(e,t,n){"use strict";n.r(t),n.d(t,"create",(function(){return o})),n.d(t,"getCoords",(function(){return a})),n.d(t,"getSideByCoords",(function(){return s}));var i=n(518);function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=Object(i.make)(e,t,n);if(o)for(var s=0;s<o.length;s++)a.appendChild(o[s]);return a}function a(e){var t=e.getBoundingClientRect();return{y1:Math.floor(t.top+window.pageYOffset),x1:Math.floor(t.left+window.pageXOffset),x2:Math.floor(t.right+window.pageXOffset),y2:Math.floor(t.bottom+window.pageYOffset)}}function s(e,t,n){var i,o=Math.min(10,e.y2-e.y1);return t-e.x1>=-1&&t-e.x1<=o+1&&(i="left"),e.x2-t>=-1&&e.x2-t<=o+1&&(i="right"),n-e.y1>=-1&&n-e.y1<=o+1&&(i="top"),e.y2-n>=-1&&e.y2-n<=o+1&&(i="bottom"),i}},555:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var i=n(7),o=n(6),a=n(600),s=n(245),r=function(){function e(t){Object(i.a)(this,e),this._editable=void 0,this._imageEditor=void 0,this._editable=t.editable}return Object(o.a)(e,[{key:"edit",value:function(e,t){var n=this;if(!this._imageEditor){var i=this._editable.getOpt("uploadImage");this._imageEditor=new a.default((function(e){var o="".concat(Date.now());s.b.loading({content:"\u4fdd\u5b58\u56fe\u7247\u4e2d...",duration:0,key:o}),i(e).then((function(e){s.b.destroy(o),e?(t(e.url),n._imageEditor.stopEditing()):s.b.error("\u4fdd\u5b58\u56fe\u7247\u5931\u8d25")}))}))}var o="".concat(Date.now());s.b.loading({content:"\u52a0\u8f7d\u4e2d...",duration:3,key:o}),this._imageEditor.startEditing(e).then((function(){s.b.destroy(o)})).catch((function(){s.b.destroy(o),s.b.error("\u52a0\u8f7d\u51fa\u9519\u4e86"),n._imageEditor.stopEditing()}))}}]),e}()},556:function(e,t,n){"use strict";n.r(t),n.d(t,"getHigherLevelSiblings",(function(){return b})),n.d(t,"isAtStart",(function(){return m})),n.d(t,"extractFragmentFromCaretPositionTillTheEnd",(function(){return g})),n.d(t,"default",(function(){return k}));var i=n(22),o=n.n(i),a=n(38),s=n(7),r=n(6),l=n(111),c=n(518),u=n(603),d=n(516),h=n(652),p=n(653),f=n(654),v=n(655).default;function b(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"left",n=e,i=[];n.parentNode&&n.parentNode.classList.contains(u.Constant.text);)n=n.parentNode;for(var o="left"===t?"previousSibling":"nextSibling";n[o];)n=n[o],i.push(n);return i}function m(e){if(e.focusOffset)return!1;var t=e.focusNode;return!!t&&b(t,"left").every((function(e){return Object(d.j)(e)}))}function g(e){if(e.rangeCount){var t=e.getRangeAt(0),n=t.startContainer;n&&n.nodeType!==Node.ELEMENT_NODE&&(n=n.parentNode);var i=n&&n.closest(".".concat(u.Constant.text));if(i){t.deleteContents();var o=t.cloneRange();return o.selectNodeContents(i),o.setStart(t.endContainer,t.endOffset),o.extractContents()}}}var k=function(){function e(t){Object(s.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._nodes={},this._highlight=void 0,this._linesInput="",this._blockEditable=t.blockEditable,this._data=t.data||e.defaultData,this._highlight=new u.default(t.blockEditable)}return Object(r.a)(e,null,[{key:"toHtml",value:function(t){var n=(t.lines||[]).map((function(e){return"<".concat(u.Constant.lineTagName,' class="').concat(u.Constant.line,'"><').concat(u.Constant.lineTextTagName,' class="').concat(u.Constant.text,'">').concat(e,"</").concat(u.Constant.lineTextTagName,"></").concat(u.Constant.lineTagName,">")}));return"<".concat(u.Constant.codeBlockTagName,' class="be-').concat(e.key,'">').concat(n.join(""),"</").concat(u.Constant.codeBlockTagName,">")}},{key:"toData",value:function(e){var t=document.createElement("div");return t.innerHTML=e,{lang:"",lines:(t.textContent||"").split("\n")}}},{key:"toMarkdown",value:function(e,t){var n=(e.lines||[]).map((function(e){return e.replace(/(<([^>]+)>)/gi,"")}));return"```".concat(e.lang||"","\n").concat(n.join("\n"),"\n```")}},{key:"toolbox",get:function(){return{icon:v,title:"Code",commands:[{regex:/^```.*/,data:function(e,t){return{data:{lang:"",lines:[]}}}}]}}},{key:"sanitize",get:function(){return{lang:!0,lines:!0}}},{key:"acceptConversionComps",get:function(){return!1}},{key:"isLineBreaksEnabled",get:function(){return!0}},{key:"enabledInlineTools",get:function(){return!1}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{lang:"",lines:[]}}},{key:"builtinTypesets",get:function(){return{default:p,common:f}}},{key:"CSS",get:function(){return h}},{key:"pasteConfig",get:function(){return{tags:["PRE"],types:["vscode-editor-data"]}}}]),Object(r.a)(e,[{key:"renderBlock",value:function(e){this._data;return this._linesInput=e.linesInput,this._nodes.target=this.make(),this._nodes.lines=Array.from(this._nodes.target.querySelectorAll(".".concat(u.Constant.line))),this._nodes.target}},{key:"renderSettings",value:function(e){return null}},{key:"save",value:function(){return this.data}},{key:"onPaste",value:function(){var e=Object(a.a)(o.a.mark((function e(t){var n,i,a,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next="tag"===e.t0?3:"type"===e.t0?7:11;break;case 3:return n=t.detail.data,(i=n.textContent||"")&&(this.data=this.getData(i)),e.abrupt("break",11);case 7:return a=t.detail.data,(s=this.getText(a))&&(this.data=this.getData(s)),e.abrupt("break",11);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){}},{key:"make",value:function(){var e=this,t=Object(c.make)("pre",[u.Constant.block,this._linesInput]);if(t.setAttribute("contenteditable","true"),t.setAttribute(u.Constant.langAttr,this._data.lang||""),this._data.lines.length)this._data.lines.forEach((function(n){var i=e.createCodeLine(n);t.appendChild(i)}));else{var n=this.createCodeLine();t.appendChild(n)}return t.addEventListener("keydown",(function(t){switch(t.keyCode){case 13:e.enter(t);break;case 8:e.backspace(t);break;case 46:e.del(t);break;case 9:e.tab(t)}}),!1),t.addEventListener("keyup",(function(t){switch(t.keyCode){case 32:e.spacebar(t)}}),!1),t.addEventListener("blur",(function(t){e._highlight.blur(t)}),!1),t.addEventListener("paste",(function(t){var n=e.getText(t.clipboardData);if(n){var i=e._blockEditable.editable.selection;e._highlight.insertHighlight2Range(n,i.getRangeAt(0)),t.stopPropagation(),t.preventDefault()}})),t.addEventListener("mousedown",(function(t){var n=t.target;if(n&&"CODE"===n.tagName){var i=n.querySelector(".".concat(u.Constant.text));if(i)e._blockEditable.editable.selection.getRangeAt(0).setStartAtLast(i).collapse(!0).select(),t.preventDefault()}})),t}},{key:"createCodeLine",value:function(e){e=e||"";var t=Object(c.make)(u.Constant.lineTagName,u.Constant.line),n=Object(c.make)(u.Constant.lineTextTagName,u.Constant.text);return n.innerHTML=e,t.appendChild(n),t}},{key:"spacebar",value:function(e){var t=this._blockEditable.editable.selection,n=this._highlight.getCurrentLine();if(n){var i=t.getRangeAt(0),o=i.createBookmark();this._highlight.mergeCommentLine(n),i.moveToBookmark(o),this._highlight.highlightCurrentLine()}}},{key:"backspace",value:function(e){this._highlight.backspace(e)&&e.stopPropagation()}},{key:"enter",value:function(e){var t,n,i,o=this._blockEditable.state.ui;if(!o.someToolbarOpened||!o.someFlipperButtonFocused){e.preventDefault();var a=this._blockEditable.editable,s=a.selection,r=a.$dom,l=this._blockEditable.state,c=l.content,d=l.cursor,h=l.toolbar,p=s.anchorNode,f=p&&(1!==p.nodeType?null===(t=p.parentElement)||void 0===t?void 0:t.closest(".".concat(u.Constant.line)):p.closest(".".concat(u.Constant.line)));this._nodes.lines=Array.from(this._nodes.target.querySelectorAll(".".concat(u.Constant.line)));var v=this._nodes.lines[this._nodes.lines.length-1],b=null===v||void 0===v||null===(n=v.querySelector(".".concat(u.Constant.text)))||void 0===n?void 0:n.innerHTML.replace("<br>"," ").replace(r.fillCharReg,"").trim(),m=null===v||void 0===v?void 0:v.previousSibling,g=m&&(null===(i=m.querySelector(".".concat(u.Constant.text)))||void 0===i?void 0:i.innerHTML.replace("<br>"," ").replace(r.fillCharReg,"").trim());if(f&&f===v&&!b&&m&&!g){var k=this._nodes.lines.indexOf(f);f&&-1!==k&&(f.remove(),this._nodes.lines.splice(k,1));var y=c.insert();return y&&d.setToBlock(y),h.move(),void e.stopPropagation()}p&&p.parentNode&&this._highlight.splitCodeLine()}}},{key:"del",value:function(e){this._highlight.del(e)&&e.stopPropagation()}},{key:"tab",value:function(e){e.stopPropagation(),e.preventDefault(),this._highlight.tab(e)}},{key:"getData",value:function(e){var t=this._highlight.highlightText(e,""),n=Object(c.make)("pre",[]);n.innerHTML=t.result.value;for(var i=Array.from(n.querySelectorAll(".".concat(u.Constant.line))),o=[],a=0;a<i.length;a++){var s=i[a].querySelector(".".concat(u.Constant.text));if(s){var r=s.innerHTML;o.push(r)}}return{lang:t.result.language||"",lines:o}}},{key:"getText",value:function(e){var t=null===e||void 0===e?void 0:e.types,n="";if(t){var i={};if(t.forEach((function(t){i[t]=(null===e||void 0===e?void 0:e.getData(t))||""})),!(n=i["text/plain"])&&(n=i["text/html"])){var o=document.createElement("div");o.innerHTML=n,n=o.textContent||""}}return n}},{key:"data",get:function(){this._blockEditable.editable.$dom;this._data.lines=[],this._nodes.lines=Array.from(this._nodes.target.querySelectorAll(".".concat(u.Constant.line)));for(var e=0;e<this._nodes.lines.length;e++){var t=this._nodes.lines[e].querySelector(".".concat(u.Constant.text));if(t){var n=t.innerHTML.replace(/<br>/g,"");this._data.lines.push(n)}}return this._data.lang=this._nodes.target.getAttribute(u.Constant.langAttr)||"",this._data},set:function(e){this._data.lines=e.lines||[];var t=this._nodes.target;t&&t.parentNode&&t.parentNode.replaceChild(this.make(),t)}}]),e}();k.key="code",l.a.regiester(k)},557:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return d}));var i=n(7),o=n(6),a=n(111),s=n(518),r=n(658),l=n(659),c=n(660),u=n(661).default,d=function(){function e(t){Object(i.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._nodes={},this._blockEditable=t.blockEditable,this._data=t.data||e.defaultData}return Object(o.a)(e,null,[{key:"toHtml",value:function(t){return'<section class="be-'.concat(e.key,'"><hr/></section>')}},{key:"toData",value:function(e){return{}}},{key:"toolbox",get:function(){return{icon:u,title:"Delimiter",commands:[{regex:/^---?$/,data:function(e,t){return{data:{}}}}]}}},{key:"enabledInlineTools",get:function(){return!1}},{key:"acceptTags",get:function(){return["hr"]}},{key:"defaultData",get:function(){return{}}},{key:"builtinTypesets",get:function(){return{default:l,common:c}}},{key:"CSS",get:function(){return r}},{key:"pasteConfig",get:function(){return{tags:["hr"]}}}]),Object(o.a)(e,[{key:"renderBlock",value:function(e){this._data;return this._nodes.target=this.make(e),this._nodes.target}},{key:"renderSettings",value:function(e){return null}},{key:"save",value:function(){return this.data}},{key:"onPaste",value:function(e){this.data={}}},{key:"destroy",value:function(){}},{key:"make",value:function(t){var n=Object(s.make)("div",["be-".concat(e.key),t.fakeInput]),i=document.createElement("hr");return n.appendChild(i),n}},{key:"backspaceRemovable",get:function(){return!0}},{key:"data",get:function(){return this._data},set:function(e){this._data={}}}]),e}();d.key="delimiter",a.a.regiester(d)},558:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return b}));var i=n(22),o=n.n(i),a=n(11),s=n(38),r=n(7),l=n(6),c=n(111),u=n(518),d=n(605),h=n(734),p=n(735),f=n(736),v=n(737).default,b=function(){function e(t){Object(r.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._editData=void 0,this._nodes={},this._diagramInput=void 0,this._blockEditable=t.blockEditable,this._data=t.data||e.defaultData,this._diagramInput=new d.default(this._blockEditable)}return Object(l.a)(e,null,[{key:"toHtml",value:function(t,n){n.inlineContent;var i=n.type,o=t.html||"";return!t.url||"wechat"!==i&&"zhihu"!==i||(o='<img style="max-width: 100%" src="'.concat(t.url,'" />')),'<section class="'.concat(e.Class.target,'"><section class="').concat(e.Class.preview,'">').concat(o,"</section>")}},{key:"toMarkdown",value:function(e,t){return"```mermaid\n".concat(e.mermaid||"","\n```")}},{key:"toData",value:function(e){return{mermaid:"",html:e}}},{key:"toolbox",get:function(){var t=/^`mermaid\s*/;return{icon:v,title:"Diagram",commands:[{regex:t,data:function(n,i){n.match(t);var o=e.defaultData;return{data:o}}}]}}},{key:"Class",get:function(){return{target:"be-diagram",preview:"be-diagram__preview",input:"be-diagram__input"}}},{key:"sanitize",get:function(){return{mermaid:!0,html:!0}}},{key:"isLineBreaksEnabled",get:function(){return!1}},{key:"enabledInlineTools",get:function(){return!1}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{mermaid:"",html:""}}},{key:"builtinTypesets",get:function(){return{default:p,common:f}}},{key:"CSS",get:function(){return h}}]),Object(l.a)(e,[{key:"renderBlock",value:function(e){return this.make(e)}},{key:"renderSettings",value:function(e){return null}},{key:"save",value:function(){return this.data}},{key:"onEditFakeInput",value:function(e){if(e===this._nodes.preview){var t=this._blockEditable.state.content;t.stretchBlock(t.activeBlockIndex)}}},{key:"onAdded",value:function(){var e=this;setTimeout((function(){var t=e._blockEditable.state.content;t.stretchBlock(t.activeBlockIndex)}),200)}},{key:"onWillChangeStreched",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var n,i,s=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}this._diagramInput.mount(this._nodes.input,this._data.mermaid||"graph TD\nStart --\x3e Stop",(function(e){var t=e.mermaid,n=e.html;s._editData={mermaid:t,html:n}})),e.next=9;break;case 4:return n=this._editData.mermaid!==this._data.mermaid,e.next=7,this._diagramInput.unmount(n);case 7:i=e.sent,this.data=i?Object(a.a)(Object(a.a)({},this._editData),{},{url:i.url}):n?{mermaid:this._editData.mermaid}:Object(a.a)(Object(a.a)({},this._data),{},{mermaid:this._editData.mermaid});case 9:return e.abrupt("return",!0);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){}},{key:"make",value:function(t){var n=Object(u.make)("div",["be-".concat(e.key)]),i=Object(u.make)("div",[e.Class.preview,t.fakeInput],{placeholder:"\u6309".concat(u.isMac?"Command":"Ctrl","+Enter\u952e\u6216\u53cc\u51fb\u9f20\u6807\u8fdb\u5165\u7f16\u8f91"),empty:"Mermaid \u56fe\u8868"}),o=Object(u.make)("div",[e.Class.input]);return n.appendChild(o),n.appendChild(i),this._nodes.target=n,this._nodes.preview=i,this._nodes.input=o,this.renderDiagram(),n}},{key:"renderDiagram",value:function(){this._nodes.preview&&(this._nodes.preview.innerHTML=this._data.html||"")}},{key:"backspaceRemovable",get:function(){return!0}},{key:"data",get:function(){return this._data.html=this._nodes.preview.innerHTML,this._data},set:function(e){this._data={mermaid:e.mermaid||"",html:e.html||"",url:e.url||""},this.renderDiagram()}}]),e}();b.key="diagram",c.a.regiester(b)},579:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return h}));var i=n(7),o=n(6),a=n(111),s=n(518),r=n(629),l=n(738),c=n(739),u=n(740),d=n(741).default,h=function(){function e(t){Object(i.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._nodes={},this._drawioInput=void 0,this._blockEditable=t.blockEditable,this._data=t.data||e.defaultData,this._drawioInput=new r.default(this._blockEditable)}return Object(o.a)(e,null,[{key:"toHtml",value:function(t,n){n.inlineContent;var i=n.type,o=t.html||"";return!t.url||"wechat"!==i&&"zhihu"!==i||(o='<img style="max-width: 100%" src="'.concat(t.url,'" />')),'<section class="'.concat(e.Class.target,'"><section class="').concat(e.Class.preview,'">').concat(o,"</section>")}},{key:"toMarkdown",value:function(e,t){return"![](".concat(e.url||"",")")}},{key:"toData",value:function(e){return{html:e,url:""}}},{key:"toolbox",get:function(){var t=/^`drawio\s*/;return{icon:d,title:"Drawio",commands:[{regex:t,data:function(n,i){n.match(t);var o=e.defaultData;return{data:o}}}]}}},{key:"Class",get:function(){return{target:"be-drawio",preview:"be-drawio__preview",input:"be-drawio__input"}}},{key:"sanitize",get:function(){return{url:!0,html:!0}}},{key:"isLineBreaksEnabled",get:function(){return!1}},{key:"enabledInlineTools",get:function(){return!1}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{html:"",url:""}}},{key:"builtinTypesets",get:function(){return{default:c,common:u}}},{key:"CSS",get:function(){return l}}]),Object(o.a)(e,[{key:"renderBlock",value:function(e){return this.make(e)}},{key:"renderSettings",value:function(e){return null}},{key:"save",value:function(){return this.data}},{key:"onEditFakeInput",value:function(e){e===this._nodes.preview&&this.editDraw()}},{key:"onAdded",value:function(){this.editDraw()}},{key:"destroy",value:function(){}},{key:"editDraw",value:function(){var e=this;this._drawioInput.edit(this._data.html,(function(t){var n=t.html,i=t.url;e.data={html:n,url:i}}))}},{key:"make",value:function(t){var n=Object(s.make)("div",["be-".concat(e.key)]),i=Object(s.make)("div",[e.Class.preview,t.fakeInput],{placeholder:"\u6309".concat(s.isMac?"Command":"Ctrl","+Enter\u952e\u6216\u53cc\u51fb\u9f20\u6807\u8fdb\u5165\u7f16\u8f91"),empty:"Drawio \u5236\u56fe"}),o=Object(s.make)("div",[e.Class.input]);return n.appendChild(o),n.appendChild(i),this._nodes.target=n,this._nodes.preview=i,this._nodes.input=o,this.renderDrawio(),n}},{key:"renderDrawio",value:function(){this._nodes.preview&&(this._nodes.preview.innerHTML=this._data.html||"")}},{key:"backspaceRemovable",get:function(){return!0}},{key:"data",get:function(){return this._data},set:function(e){this._data={html:e.html||"",url:e.url||""},this.renderDrawio()}}]),e}();h.key="drawio",a.a.regiester(h)},580:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return b}));var i=n(22),o=n.n(i),a=n(38),s=n(7),r=n(6),l=n(111),c=n(631),u=n(632),d=n(633),h=n(555),p=n(747),f=n(748),v=n(749).default,b=function(){function e(t){var n=this;Object(s.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._ui=void 0,this._settings=void 0,this._uploader=void 0,this._imageEditor=void 0,this._blockEditable=t.blockEditable,this._uploader=new d.default({config:{types:"image/*",uploadImage:function(){var e=Object(a.a)(o.a.mark((function e(t){var i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=n._blockEditable.editable.getOpt("uploadImage"))){e.next=3;break}return e.abrupt("return",i(t));case 3:return e.abrupt("return",void 0);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},onUpload:function(e){return n.onUpload(e)},onError:function(){return n.uploadFailded()}}),this._imageEditor=new h.default({editable:this._blockEditable.editable}),this._ui=new c.default({blockEditable:t.blockEditable,onSelectFile:function(){n.onSelectFile()}}),this._settings=new u.default({blockEditable:t.blockEditable,onChange:function(e){return n.settingToggled(e)}}),this._data={},this.data=t.data||e.defaultData}return Object(r.a)(e,null,[{key:"toHtml",value:function(e,t){var n=t.clearEmpty,i=e.image&&e.image.url,o=e.withCaption,a=e.caption,s=document.createElement("div");return s.innerHTML=a,n(i?'<figure class="be-image">\n                        <img src="'.concat(i,'" alt="').concat(s.textContent||"",'"/>\n                    ').concat(o?'<figcaption class="be-image__caption">'.concat(a,"</figcaption>"):"","\n                </figure>"):"")}},{key:"toMarkdown",value:function(e,t){var n=e.image&&e.image.url,i=e.withCaption,o=e.caption,a=document.createElement("div");return a.innerHTML=o,n?"![".concat(i?a.textContent:"","](").concat(n,")"):""}},{key:"toData",value:function(e){return{content:e}}},{key:"toolbox",get:function(){var e=/^(!)(\[(.*)\])?(\((https?:\/\/\S+\.(gif|jpe?g|tiff|png))\))?/i;return{icon:v,title:"Image",commands:[{regex:e,data:function(t,n){var i=t.match(e),o={caption:i?i[3]:"",withCaption:!0};return i&&i[5]&&(o.image={url:i[5]}),{data:o}}}]}}},{key:"acceptConversionComps",get:function(){return!1}},{key:"enabledInlineTools",get:function(){return!1}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{caption:"",withCaption:!0}}},{key:"builtinTypesets",get:function(){return{default:f}}},{key:"CSS",get:function(){return p}},{key:"pasteConfig",get:function(){return{tags:["img","figure","figcaption"],files:{mimeTypes:["image/*"]}}}}]),Object(r.a)(e,[{key:"renderBlock",value:function(e){return this._ui.render(this._data,e)}},{key:"renderSettings",value:function(e){return this._settings.render(this._data,e)}},{key:"onAdded",value:function(){this._data.image&&this._data.image.url||this._ui.nodes.fileButton.click()}},{key:"save",value:function(){return this.data}},{key:"onPaste",value:function(){var e=Object(a.a)(o.a.mark((function e(t){var n,i,a,s,r,l,c,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next="tag"===e.t0?3:"pattern"===e.t0?20:"file"===e.t0?23:26;break;case 3:if(n=t.detail.data,a="","figure"===n.tagName.toLowerCase()?(i=n.querySelector("img"),(s=n.querySelector("figcaption"))&&(a=s.textContent||"")):i=n,!i){e.next=19;break}if(a=a||i.getAttribute("alt")||"",!/^blob:/.test(i.src)){e.next=17;break}return e.next=11,fetch(i.src);case 11:return r=e.sent,e.next=14,r.blob();case 14:return l=e.sent,this.uploadFile(l),e.abrupt("break",26);case 17:this.uploadUrl(i.src),this._ui.fillCaption(a);case 19:return e.abrupt("break",26);case 20:return c=t.detail.data,this.uploadUrl(c),e.abrupt("break",26);case 23:return u=t.detail.file,this.uploadFile(u),e.abrupt("break",26);case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onEditFakeInput",value:function(e){var t=this;e===this._ui.nodes.fileButton?this.onSelectFile():e===this._ui.nodes.imageContainer&&this._imageEditor.edit(this._data.image.url,(function(e){var n={url:e};n.url&&(t._ui.fillImage(n.url,!0),t._data.image=n)}))}},{key:"destroy",value:function(){}},{key:"settingToggled",value:function(e){this.setSetting(e,!this._data[e])}},{key:"setSetting",value:function(e,t){var n=this;this._data[e]=t,this._ui.applySetting(e,t),"stretched"===e&&Promise.resolve().then((function(){var e=n.api.content.activeBlockIndex;n.api.content.stretchBlock(e,t)})).catch((function(e){console.error(e)}))}},{key:"onSelectFile",value:function(){var e=this;this._uploader.uploadSelectedFile({onPreview:function(t){e._ui.showPreloader(t)}})}},{key:"onUpload",value:function(e){e.success&&e.file?this.image=e.file:this.uploadFailded()}},{key:"uploadFailded",value:function(){this.api.notifier.show({message:"Couldn\u2019t upload image. Please try another.",style:"error"}),this._ui.hidePreloader()}},{key:"uploadFile",value:function(e){var t=this;this._uploader.uploadByFile(e,{onPreview:function(e){t._ui.showPreloader(e)}})}},{key:"uploadUrl",value:function(e){this._ui.showPreloader(e),this._uploader.uploadByUrl(e)}},{key:"isEmptyContent",get:function(){var e=this.data.image;return!(e&&e.url)}},{key:"backspaceRemovable",get:function(){return!0}},{key:"data",get:function(){var e=this._ui.nodes.caption;return this._data.caption=e.innerHTML,this._data},set:function(e){var t=this;this.image=e.image,this._data.caption=e.caption||"",this._ui.fillCaption(this._data.caption),u.default.settings.forEach((function(n){var i=n.name,o="undefined"!==typeof e[i]&&(!0===e[i]||"true"===e[i]);t.setSetting(i,o)}))}},{key:"image",set:function(e){this._data.image=e||{},e&&e.url&&this._ui.fillImage(e.url)}},{key:"api",get:function(){return this._blockEditable.state}}]),e}();b.key="image",l.a.regiester(b)},581:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return E}));var i=n(43),o=n(22),a=n.n(o),s=n(38),r=n(7),l=n(6),c=n(11),u=n(111),d=n(518),h=n(71),p=n(750),f=n(751),v=n(752).default,b=n(753).default,m=n(754).default;function g(e){var t="ordered"===e.style?"ol":"ul",n=e.items.map((function(e){return function(e){var t=g(Object(c.a)(Object(c.a)({},e),{},{style:e.style||"unordered"}));return'<li class="'.concat(E.Class.item,'"><p class="').concat(E.Class.itemContent,'">').concat(e.content,"</p>").concat(t,"</li>")}(e)}));return n.length?"<".concat(t,' class="be-').concat(E.key).concat("ordered"===e.style?" ".concat(E.Class.targetOrdered):" ".concat(E.Class.targetUnordered),'">').concat(n.join("\n"),"</").concat(t,">"):""}function k(e){var t=e.querySelector(".".concat(E.Class.itemContent));if(t)return Object(d.isEmpty)(t)?"":t.innerHTML;var n=e.cloneNode(!0);return n.querySelectorAll("ul,ol").forEach((function(e){e.remove()})),h.a.removeBlockChildren(n),n.innerHTML}function y(e){return e?Array.from(e.querySelectorAll(":scope > li")).map((function(e){var t=e.querySelector(".".concat(E.Class.itemChildren))||e.querySelector("ul,ol"),n=k(e),i="OL"===(null===t||void 0===t?void 0:t.tagName)?"ordered":"unordered",o=t?y(t):[];return{content:n,style:i,closed:e.classList.contains(E.Class.itemListClosed),items:o}})):[]}function _(e,t,n){return{regex:e,data:function(i,o){var a=i.match(e),s="";if(a){var r=(s=o(a[1])).match(/<p>(.*)<\/p>/);r&&(s=r[1])}return{data:{style:t,items:[{content:s,items:[]}]},icon:n}}}}var C=_(/^-\s*(([^-\[\]]*)|$)/,"unordered",b),x=_(/^\d+\.\s*(.*)/,"ordered",m),E=function(){function e(t){Object(r.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._nodes={},this._defaultListStyle="unordered",this._cacheCurrentItem=null,this._blockEditable=t.blockEditable,this._data=t.data||e.defaultData}return Object(l.a)(e,null,[{key:"convertData",value:function(e,t){var n=e.data;if("paragraph"===e.key||"header"===e.key)return[{style:"unordered",items:[{content:n.content,items:[]}]}];var i=[];return n.items.forEach((function(e){i.push({content:e.content,items:[]})})),[{style:"unordered",items:i}]}},{key:"toHtml",value:function(e){return g(e)}},{key:"toMarkdown",value:function(e,t){return t(g(e))}},{key:"toData",value:function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.querySelector("ol")||t.querySelector("ul"),i=[];return i=n?y(n):Array.from(t.children).map((function(e){return{content:e.textContent||"",items:[]}})),{style:"OL"===(null===n||void 0===n?void 0:n.tagName)?"ordered":"unordered",items:i}}},{key:"Class",get:function(){return{target:"be-list",targetOrdered:"be-list--ordered",targetUnordered:"be-list--unordered",item:"be-list__item",itemList:"be-list__item-list",itemListClosed:"be-list__item-list--closed",itemContent:"be-list__item-content",itemChildren:"be-list__item-children",settingsWrapper:"beui-list-settings"}}},{key:"toolbox",get:function(){return{icon:v,title:"List",commands:[C,x]}}},{key:"acceptConversionComps",get:function(){return["paragraph","header","todolist"]}},{key:"isLineBreaksEnabled",get:function(){return!0}},{key:"enabledInlineTools",get:function(){return!0}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{style:"unordered",items:[]}}},{key:"builtinTypesets",get:function(){return{default:f}}},{key:"CSS",get:function(){return p}},{key:"pasteConfig",get:function(){return{tags:["OL","UL","LI"]}}},{key:"settings",get:function(){return[{name:"unordered",icon:b,title:"Unordered",default:!0},{name:"ordered",icon:m,title:"Ordered",default:!1}]}}]),Object(l.a)(e,[{key:"renderBlock",value:function(e){return this.make()}},{key:"renderSettings",value:function(t){var n=this,i=Object(d.make)("div",[e.Class.settingsWrapper],{}),o=this.listStyle;return e.settings.forEach((function(e){var a=Object(d.make)("div",t.settingsButton,{});a.innerHTML=e.icon,a.dataset.forbidSetCursor="true",a.addEventListener("click",(function(){var i;n.listStyle=e.name;var o=null===(i=a.parentNode)||void 0===i?void 0:i.querySelectorAll("."+t.settingsButton);Array.from(o||[]).forEach((function(e){return e.classList.remove(t.settingsButtonActive)})),a.classList.toggle(t.settingsButtonActive)})),n._blockEditable.state.tooltip.onHover(a,e.title,{placement:"top",hidingDelay:500}),o===e.name&&a.classList.add(t.settingsButtonActive),i.appendChild(a)})),this._cacheCurrentItem=this.currentItem,i}},{key:"save",value:function(){return this.data}},{key:"merge",value:function(){var e=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={items:this.data.items.concat(t.items)},this.data=n;case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"extractInputs",value:function(t){var n,o;return 0===t.length?{style:"unordered",items:[]}:{style:"OL"===(null===(n=t[0].closest("li"))||void 0===n||null===(o=n.parentElement)||void 0===o?void 0:o.tagName)?"ordered":"unordered",items:t.reduce((function(t,n){var o=[{content:n.innerHTML,items:[]}],a=n.closest(".".concat(e.Class.item));if(a&&a.classList.contains(e.Class.itemListClosed)){var s=a.querySelectorAll(".".concat(e.Class.itemContent));o.push.apply(o,Object(i.a)(Array.from(s).map((function(e){return{content:e.innerHTML,items:[]}}))))}return[].concat(Object(i.a)(t),o)}),[])}}},{key:"removeInputs",value:function(t){return t.forEach((function(t,n){if(0===n){t.innerHTML="";var i=t.closest(".".concat(e.Class.item));if(i&&i.classList.contains(e.Class.itemListClosed)){var o=i.querySelector(".".concat(e.Class.itemChildren));o&&o.remove()}}else{var a=t.closest("li");if(null===a||void 0===a?void 0:a.parentElement){var s=a.parentElement;if(s.removeChild(a),0==s.childNodes.length){var r=s.closest(".".concat(e.Class.item));s.remove(),null===r||void 0===r||r.classList.toggle(e.Class.itemList,!1),null===r||void 0===r||r.classList.toggle(e.Class.itemListClosed,!1)}}}})),t[0]}},{key:"onPaste",value:function(e){var t=e.detail.data;this.data=this.pasteHandler(t)}},{key:"destroy",value:function(){}},{key:"pasteHandler",value:function(e){var t=e.tagName,n="ordered";switch(t){case"OL":n="ordered";break;case"UL":case"LI":n="unordered"}var i={style:n,items:[]};if("LI"===t){var o=e.querySelector("ol")||e.querySelector("ul");o&&o.remove(),i.items=[{content:e.textContent||"",items:y(o)}]}else i.items=y(e);return i}},{key:"makeListWrapper",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.listStyle,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o="ordered"===(t=t||this.listStyle||this._data.style||this._defaultListStyle)?e.Class.targetOrdered:e.Class.targetUnordered,a="ordered"===t?"ol":"ul";return Object(d.make)(a,[e.Class.target,o].concat(Object(i.a)(n)))}},{key:"addChildrenList",value:function(t,n,i){var o=this.makeListWrapper(t,[e.Class.itemChildren]);this.appendItems(i,o),null===n||void 0===n||n.appendChild(o)}},{key:"appendItems",value:function(e,t){var n=this;e.forEach((function(e){var i=n.createItem(e.style||"",e.content,e.items,e.closed);t.appendChild(i)}))}},{key:"createItem",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Object(d.make)("li",e.Class.item),s=Object(d.make)("p",e.Class.itemContent,{contentEditable:!0});return s.innerHTML=n,a.appendChild(s),i&&i.length>0&&(this.addChildrenList(t,a,i),a.classList.add(e.Class.itemList),a.classList.toggle(e.Class.itemListClosed,o)),a}},{key:"make",value:function(){return this._nodes.target=this.makeListWrapper(this._data.style),this._data.items.length?this.appendItems(this._data.items,this._nodes.target):this.appendItems([{content:"",items:[]}],this._nodes.target),this.bindEvents(),this._nodes.target}},{key:"bindEvents",value:function(){var t=this;this._nodes.target.addEventListener("keydown",(function(e){switch(e.key){case"Enter":t.enterPressed(e);break;case"Backspace":t.backspace(e);break;case"Tab":e.shiftKey?t.shiftTab(e):t.addTab(e)}}),!1),this._nodes.target.addEventListener("paste",(function(n){var i=t.getListData(n.clipboardData);if(null===i||void 0===i?void 0:i.length){var o=t.currentItem;if(!o)return;n.stopPropagation(),n.preventDefault();var a=i.map((function(e){var n=e.data;return t.createItem(n.style,"",n.items)})),s=document.createDocumentFragment();a.forEach((function(t){var n=t.querySelector(".".concat(e.Class.itemChildren));if(n)for(;n.firstChild;)s.appendChild(n.firstChild)}));var r=o.querySelector(".".concat(e.Class.itemChildren)),l=r&&Array.from(r.querySelectorAll(".".concat(e.Class.item))).length>0,c=t._blockEditable.selection.getRangeAt(0);if(l)null===r||void 0===r||r.prepend(s),c.select(!0);else{var u=0===k(o).trim().length;o.after(s);var d=o.nextElementSibling;u&&d?d&&(o.remove(),t.focusItem(d)):c.select(!0)}n.stopPropagation(),n.preventDefault()}})),this._nodes.target.addEventListener("mousedown",(function(t){var n=t.target;n.classList.contains(e.Class.itemList)&&n.classList.toggle(e.Class.itemListClosed,!n.classList.contains(e.Class.itemListClosed))}))}},{key:"getListData",value:function(t){if(!t)return[];var n=t.getData("application/block-editable");if(n)try{return JSON.parse(n).filter((function(t){return t.key===e.key}))}catch(i){return[]}}},{key:"enterPressed",value:function(t){var n=this._blockEditable.state.ui;if(!n.someToolbarOpened||!n.someFlipperButtonFocused){var i=this.currentItem;if(i){t.stopPropagation(),t.preventDefault();var o=0===k(i).trim().length,a=i.parentNode===this._nodes.target,s=null===i.nextElementSibling;if(a&&s&&o)this.getOutOfList();else if(s&&o)this.unshiftItem();else{var r=Object(d.extractFragmentFromCaretPositionTillTheEnd)(this._blockEditable.selection);if(r){var l=Object(d.fragmentToString)(r),c=i.querySelector(".".concat(e.Class.itemChildren)),u=i.classList.contains(e.Class.itemListClosed),h=this.createItem(this.listStyle,l,void 0),p=c&&Array.from(c.querySelectorAll(".".concat(e.Class.item))).length>0;p&&!u?null===c||void 0===c||c.prepend(h):i.after(h),i.classList.toggle(e.Class.itemList,!!p),this.focusItem(h)}}}}}},{key:"unshiftItem",value:function(){var t=this.currentItem;if(t){var n=t.parentNode&&t.parentNode.closest(".".concat(e.Class.item));if(n){var i=this._blockEditable.selection.getRangeAt(0),o=i.createBookmark();n.after(t),i.moveToBookmark(o).select(!0);var a=n.querySelector(".".concat(e.Class.itemChildren)),s=0===(null===a||void 0===a?void 0:a.children.length);s&&a&&a.remove(),n.classList.toggle(e.Class.itemList,!s&&!!a)}}}},{key:"focusItem",value:function(t){var n=t.querySelector(".".concat(e.Class.itemContent)),i=this._blockEditable.selection;n&&Object(d.focus)(i,n)}},{key:"getOutOfList",value:function(){var e=this.currentItem;null===e||void 0===e||e.remove();var t=this._blockEditable.state,n=t.content,i=t.cursor,o=t.toolbar,a=n.insert();a&&i.setToBlock(a),o.move()}},{key:"backspace",value:function(t){if(Object(d.isAtStart)(this._blockEditable.selection)){var n=this.currentItem;if(n){var i=n.previousSibling,o=n&&n.parentNode.closest(".".concat(e.Class.item));if(i||o){var a;if(t.preventDefault(),t.stopPropagation(),i){var s=i.querySelectorAll(".".concat(e.Class.item));a=Array.from(s).pop()||i,i.classList.toggle(e.Class.itemListClosed,!1)}else a=o;var r=Object(d.extractFragmentFromCaretPositionTillTheEnd)(this._blockEditable.selection),l=r?Object(d.fragmentToString)(r):"",c=a.querySelector(".".concat(e.Class.itemContent));if(c){var u=this._blockEditable.selection;Object(d.focus)(u,c,!1);var h=u.getRangeAt(0),p=h.createBookmark();c.insertAdjacentHTML("beforeend",l);var f=n.querySelectorAll(".".concat(e.Class.itemChildren," > .").concat(e.Class.item)),v=Array.from(f);(v=v.filter((function(t){return t.parentNode.closest(".".concat(e.Class.item))===n}))).reverse().forEach((function(e){i?a.after(e):n.after(e)})),n.remove();var b=a.querySelector(".".concat(e.Class.itemChildren)),m=0===(null===b||void 0===b?void 0:b.children.length);m&&b&&b.remove(),a.classList.toggle(e.Class.itemList,!m&&!!b),h.moveToBookmark(p).select(!0)}}}}}},{key:"addTab",value:function(t){var n=this.currentItem;if(n){var i=n.previousSibling;if(i){t.stopPropagation(),t.preventDefault();var o=i.querySelector(".".concat(e.Class.itemChildren)),a=this._blockEditable.selection.getRangeAt(0),s=a.createBookmark();if(o)o.appendChild(n);else{var r=this.makeListWrapper(void 0,[e.Class.itemChildren]);r.appendChild(n),null===i||void 0===i||i.appendChild(r)}i.classList.toggle(e.Class.itemList,!!i.querySelector(".".concat(e.Class.itemChildren))),a.moveToBookmark(s).select(!0)}}}},{key:"shiftTab",value:function(e){e.stopPropagation(),e.preventDefault(),this.unshiftItem()}},{key:"data",get:function(){var e;return this._data.items=y(this._nodes.target),this._data.style="OL"===(null===(e=this._nodes.target)||void 0===e?void 0:e.tagName)?"ordered":"unordered",this._data},set:function(e){e||(e={}),this._data.style=e.style||this._defaultListStyle,this._data.items=e.items||[];var t=this._nodes.target;t&&t.parentNode&&t.parentNode.replaceChild(this.make(),t)}},{key:"listStyle",get:function(){var t=this.currentItem,n=(null===t||void 0===t?void 0:t.closest(".".concat(e.Class.itemChildren)))||this._nodes.target;return"OL"===(null===n||void 0===n?void 0:n.tagName)?"ordered":"unordered"},set:function(t){var n=this._blockEditable.selection.getRangeAt(0),i=n.createBookmark(),o=this._cacheCurrentItem||this.currentItem,a=null===o||void 0===o?void 0:o.closest(".".concat(e.Class.itemChildren)),s=this.makeListWrapper(t,a?[e.Class.itemChildren]:[]);s.classList.toggle(e.Class.targetUnordered,"unordered"===t),s.classList.toggle(e.Class.targetOrdered,"ordered"===t);var r=a||this._nodes.target;if(r){for(;r.firstChild;)s.appendChild(r.firstChild);var l=r.parentNode;null===l||void 0===l||l.replaceChild(s,r),a||(this._nodes.target=s,this._data.style=t,this.bindEvents())}n.moveToBookmark(i).select(!0),this._blockEditable.state.toolbar.close()}},{key:"currentItem",get:function(){var t=this._blockEditable.selection.anchorNode;return t&&t.nodeType!==Node.ELEMENT_NODE&&(t=t.parentNode),t&&t.closest(".".concat(e.Class.item))}}]),e}();E.key="list",u.a.regiester(E)},582:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var i=n(22),o=n.n(i),a=n(38),s=n(7),r=n(6),l=n(111),c=n(518),u=n(771),d=n(755),h=n(756),p=n(757),f=n(758).default,v=function(){function e(t){Object(s.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._editData=void 0,this._nodes={},this._mathInput=void 0,this._blockEditable=t.blockEditable,this._data=t.data||e.defaultData,this._mathInput=new u.a}return Object(r.a)(e,null,[{key:"toHtml",value:function(t,n){var i=n.type,o=t.html||"";return"zhihu"===i?o='<img class="Formula-image" data-eeimg="true" src="" alt="'.concat(t.tex,'">'):"juejin"===i&&(o='<img class="equation" src="https://juejin.im/equation?tex='.concat(t.tex,'" alt=""/>')),'<section class="'.concat(e.Class.target,'"><section class="').concat(e.Class.preview,'">').concat(o,"</section>")}},{key:"toMarkdown",value:function(e,t){return e.tex?"$$".concat(e.tex,"$$"):""}},{key:"toData",value:function(e){return{tex:"",html:e}}},{key:"toolbox",get:function(){return{icon:f,title:"Math",commands:[{regex:/^(\$\$)([^\$]*)?(\$\$)?/i,data:function(e,t){return{data:{tex:"",html:""}}}}]}}},{key:"Class",get:function(){return{target:"be-math",preview:"be-math__preview",input:"be-math__input"}}},{key:"sanitize",get:function(){return{tex:!0,html:!0}}},{key:"isLineBreaksEnabled",get:function(){return!1}},{key:"enabledInlineTools",get:function(){return!1}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{tex:"",html:""}}},{key:"builtinTypesets",get:function(){return{default:h,common:p}}},{key:"CSS",get:function(){return d}}]),Object(r.a)(e,[{key:"renderBlock",value:function(e){return this.make(e)}},{key:"renderSettings",value:function(e){return null}},{key:"save",value:function(){return this.data}},{key:"onEditFakeInput",value:function(e){if(e===this._nodes.preview){var t=this._blockEditable.state.content;t.stretchBlock(t.activeBlockIndex)}}},{key:"onAdded",value:function(){var e=this;setTimeout((function(){var t=e._blockEditable.state.content;t.stretchBlock(t.activeBlockIndex)}),200)}},{key:"onWillChangeStreched",value:function(){var e=Object(a.a)(o.a.mark((function e(t){var n=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t?this._mathInput.mount(this._nodes.input,this._data.tex,(function(e){var t=e.tex,i=e.html;n._editData={tex:t,html:i}})):(this._mathInput.unmount(),this._editData.tex!==this._data.tex&&(this.data={tex:this._editData.tex,html:this._mathInput.removeSVGUse(this._editData.html)})),e.abrupt("return",!0);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){}},{key:"make",value:function(t){var n=Object(c.make)("div",["be-".concat(e.key)]),i=Object(c.make)("div",[e.Class.preview,t.fakeInput],{placeholder:"\u6309".concat(c.isMac?"Command":"Ctrl","+Enter\u952e\u6216\u53cc\u51fb\u9f20\u6807\u8fdb\u5165\u7f16\u8f91"),empty:"TeX \u516c\u5f0f"}),o=Object(c.make)("div",[e.Class.input]);return n.appendChild(o),n.appendChild(i),this._nodes.target=n,this._nodes.preview=i,this._nodes.input=o,this.renderTex(),n}},{key:"renderTex",value:function(){this._nodes.preview&&(this._nodes.preview.innerHTML=this._data.html||"")}},{key:"backspaceRemovable",get:function(){return!0}},{key:"data",get:function(){return this._data.html=this._nodes.preview.innerHTML,this._data},set:function(e){this._data={tex:e.tex||"",html:e.html||""},this.renderTex()}}]),e}();v.key="math",l.a.regiester(v)},583:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var i=n(11),o=n(7),a=n(6),s=n(111),r=n(635),l=n(584),c=n(761),u=n(762),d=n(763),h=n(764).default;function p(e){if(!e)return{};var t=[],n=[],i=e.tHead;if(i)for(var o=i.rows,a=0;a<o.length;a++){var s=o[a],r=Array.from(s.cells).map((function(e){var t=e.querySelector("."+v.Class.input);return t?t.innerHTML:e.innerText}));t.push(r)}for(var l=null===e||void 0===e?void 0:e.tBodies,c=0;c<l.length;c++)for(var u=l[c].rows,d=0;d<u.length;d++){var h=u[d],p=Array.from(h.cells).map((function(e){var t=e.querySelector("."+v.Class.input);return t?t.innerHTML:e.innerText}));n.push(p)}return{head:t,body:n}}function f(e,t){var n=e.head,i=e.body,o=(null===n||void 0===n?void 0:n.map((function(e){var n=e.map((function(e){return'<th class="'.concat(l.Class.cell,'">').concat(t?e:'<section class="'.concat(l.Class.inputField,'">').concat(e,"</section>"),"</th>")}));return"<tr>".concat(n.join(""),"</tr>")})))||[],a=(null===i||void 0===i?void 0:i.map((function(e){var n=e.map((function(e){return'<td class="'.concat(l.Class.cell,'">').concat(t?e:'<section class="'.concat(l.Class.inputField,'">').concat(e,"</section>"),"</td>")}));return"<tr>".concat(n.join(""),"</tr>")})))||[];return'<table class="'.concat(l.Class.table,'"><thead>').concat(o.join(""),"</thead><tbody>").concat(a.join(""),"</tbody></table>")}var v=function(){function e(t){Object(o.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._nodes={},this._tableContructor=void 0,this._blockEditable=t.blockEditable,this._data=t.data||e.defaultData}return Object(a.a)(e,null,[{key:"validData",value:function(e){return!!(e.body&&e.body.length&&e.body[0].length)||!!(e.head&&e.head.length&&e.head[0].length)}},{key:"toHtml",value:function(e){var t=f(e);return'<section class="'.concat(r.Class.editor,'"><section class="').concat(l.Class.wrapper,'">').concat(t,"</section></section>")}},{key:"toData",value:function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.querySelector("table");return{content:n?p(n):[]}}},{key:"toMarkdown",value:function(e,t){return t(f(e,!0))}},{key:"Class",get:function(){return{input:"be-table__inp"}}},{key:"toolbox",get:function(){return{icon:h,title:"Table",commands:[{regex:/^\|.*/,data:function(e,t){return{data:{}}}}]}}},{key:"acceptConversionComps",get:function(){return!1}},{key:"isLineBreaksEnabled",get:function(){return!0}},{key:"enabledInlineTools",get:function(){return!0}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{}}},{key:"builtinTypesets",get:function(){return{default:d,common:u}}},{key:"CSS",get:function(){return c}},{key:"pasteConfig",get:function(){return{tags:["TABLE","THEAD","TBODY","TR","TH","TD"]}}}]),Object(a.a)(e,[{key:"renderBlock",value:function(e){return this._tableContructor=new r.default(this._data,this._blockEditable),this._tableContructor.htmlElement}},{key:"renderSettings",value:function(e){return null}},{key:"save",value:function(){return this.data}},{key:"onPaste",value:function(e){var t=p(e.detail.data);this.data=Object(i.a)({},t)}},{key:"destroy",value:function(){}},{key:"isEmpty",value:function(e){return!e||!e.textContent||!e.textContent.trim()}},{key:"data",get:function(){var e=p(this._tableContructor.htmlElement.querySelector("table"));return this._data=Object(i.a)({},e),this._data},set:function(e){this._data=e;var t=this._tableContructor.htmlElement;t&&t.parentElement&&(this._tableContructor=new r.default(this._data,this._blockEditable),t.parentElement.replaceChild(this._tableContructor.htmlElement,t))}}]),e}();v.key="table",s.a.regiester(v)},584:function(e,t,n){"use strict";n.r(t),n.d(t,"Class",(function(){return s})),n.d(t,"Table",(function(){return r}));var i=n(7),o=n(6),a=n(554),s={table:"be-table",inputField:"be-table__inp",cell:"be-table__cell",wrapper:"be-table__wrap"},r=function(){function e(){Object(i.a)(this,e),this._numberOfColumns=void 0,this._numberOfRows=void 0,this._element=void 0,this._table=void 0,this._selectedCell=void 0,this._numberOfColumns=0,this._numberOfRows=0,this._element=this.createTableWrapper(),this._table=this._element.querySelector("table"),this.hangEvents()}return Object(o.a)(e,[{key:"addColumn",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._numberOfColumns++;for(var n=this.body.rows,i=0;i<n.length;i++){var o=n[i].insertCell(t);this.fillCell(o)}for(var s=(null===(e=this.head)||void 0===e?void 0:e.rows)||[],r=0;r<s.length;r++){var l=Object(a.create)("th"),c=s[r].insertCell(t);c.replaceWith(l),this.fillCell(l)}}},{key:"addRow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._numberOfRows++,e>=this.body.rows.length&&(e=-1);var t=this.body.insertRow(e);return this.fillRow(t),t}},{key:"addHead",value:function(){if(this.head){var e=this.head.insertRow(-1);return this.fillHead(e),e}}},{key:"deleteColumn",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._numberOfColumns--;for(var n=this.body.rows,i=0;i<n.length;i++){var o=n[i];t<o.cells.length&&o.deleteCell(t)}for(var a=(null===(e=this.head)||void 0===e?void 0:e.rows)||[],s=0;s<a.length;s++){var r=a[s];t<r.cells.length&&r.deleteCell(t)}}},{key:"deleteRow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._numberOfRows--,e<this.body.rows.length&&this.body.deleteRow(e)}},{key:"createTableWrapper",value:function(){return Object(a.create)("div",[s.wrapper],null,[Object(a.create)("table",[s.table],null,[Object(a.create)("thead"),Object(a.create)("tbody")])])}},{key:"createContenteditableArea",value:function(){return Object(a.create)("div",[s.inputField],{contenteditable:"true"})}},{key:"fillCell",value:function(e){e.classList.add(s.cell);var t=this.createContenteditableArea();e.appendChild(t)}},{key:"fillRow",value:function(e){for(var t=0;t<this._numberOfColumns;t++){var n=e.insertCell();this.fillCell(n)}}},{key:"fillHead",value:function(e){for(var t=0;t<this._numberOfColumns;t++){var n=Object(a.create)("th");e.appendChild(n),this.fillCell(n)}}},{key:"hangEvents",value:function(){var e=this;this._table.addEventListener("focus",(function(t){e.focusEditField(t)}),!0),this._table.addEventListener("blur",(function(t){e.blurEditField(t)}),!0),this._table.addEventListener("keydown",(function(t){e.pressedEnterInEditField(t)})),this._table.addEventListener("click",(function(t){e.clickedOnCell(t)})),this._table.addEventListener("mouseover",(function(t){e.mouseEnterInDetectArea(t),t.stopPropagation()}),!0)}},{key:"focusEditField",value:function(e){e.target&&e.target.classList.contains(s.inputField)&&(this._selectedCell=e.target.closest("."+s.cell))}},{key:"blurEditField",value:function(e){e.target&&e.target.classList.contains(s.inputField)&&(this._selectedCell=null)}},{key:"pressedEnterInEditField",value:function(e){e.target&&e.target.classList.contains(s.inputField)&&(13!==e.keyCode||e.shiftKey||e.preventDefault())}},{key:"clickedOnCell",value:function(e){if(e.target&&e.target.classList.contains(s.cell)){var t=e.target.querySelector("."+s.inputField);null===t||void 0===t||t.focus()}}},{key:"mouseEnterInDetectArea",value:function(e){if(e.target){var t=e.target.closest(".".concat(s.cell));if(t){var n=Object(a.getCoords)(t),i=Object(a.getSideByCoords)(n,e.pageX,e.pageY);e.target.dispatchEvent(new CustomEvent("mouseInActivatingArea",{detail:{side:i},bubbles:!0}))}}}},{key:"htmlElement",get:function(){return this._element}},{key:"body",get:function(){return this._table.tBodies[0]}},{key:"head",get:function(){return this._table.tHead}},{key:"selectedCell",get:function(){return this._selectedCell}}]),e}()},585:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return m}));var i=n(22),o=n.n(i),a=n(38),s=n(7),r=n(6),l=n(111),c=n(518),u=n(71),d=n(765),h=n(766),p=n(767),f=n(768).default;function v(e,t){e&&e.forEach((function(e){t.push({content:e.content,checked:!1}),v(e.items,t)}))}function b(e){var t=e.querySelectorAll(".".concat(m.Class.item,",li,taskli"));return{items:Array.from(t).map((function(e){var t=e.classList.contains("".concat(m.Class.itemChecked));if(!t){var n=e.querySelector('[type="checkbox"]');n&&(t=null!==n.getAttribute("checked"),n.remove())}return{checked:t,content:(e.querySelector(".".concat(m.Class.textField))||u.a.removeBlockChildren(e)).innerHTML||""}}))}}var m=function(){function e(t){Object(s.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._nodes={items:[]},this._blockEditable=t.blockEditable,this._data=t.data||e.defaultData}return Object(r.a)(e,null,[{key:"convertData",value:function(e,t){var n=e.data;if("paragraph"===e.key||"header"===e.key)return[{items:[{content:n.content,checked:!1}]}];var i=[];return v(n.items,i),[{items:i}]}},{key:"toHtml",value:function(t){var n=t.items.map((function(t){return'<section class="'.concat(e.Class.item).concat(t.checked?" ".concat(e.Class.itemChecked):"",'"><span class="').concat(e.Class.checkbox,'"></span><section class="').concat(e.Class.textField,'">').concat(t.content,"</section></section>")}));return'<section class="be-'.concat(e.key,'">').concat(n.join("\n"),"</section>")}},{key:"toMarkdown",value:function(e,t){return e.items.map((function(e){return"- [".concat(e.checked?"x":" ","] ").concat(t(e.content))})).join("\n")}},{key:"toData",value:function(e){var t=document.createElement("div");return t.innerHTML=e,b(t)}},{key:"Class",get:function(){return{target:"be-todolist",item:"be-todolist__item",itemChecked:"be-todolist__item--checked",checkbox:"be-todolist__item-checkbox",textField:"be-todolist__item-text"}}},{key:"toolbox",get:function(){var e=/^(-)(\s*)\[([\sx]*)\](\s*)(.*)/i;return{icon:f,title:"TodoList",commands:[{regex:e,data:function(t,n){var i=t.match(e),o="",a=!1;if(i){o=n(i[5]),a=!!i[3]&&"x"===i[3].trim();var s=o.match(/<p>(.*)<\/p>/);s&&(o=s[1])}return{data:{items:[{checked:a,content:o}]}}}}]}}},{key:"acceptConversionComps",get:function(){return["paragraph","header","list"]}},{key:"isLineBreaksEnabled",get:function(){return!0}},{key:"enabledInlineTools",get:function(){return!0}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{items:[]}}},{key:"builtinTypesets",get:function(){return{default:h,common:p}}},{key:"pasteConfig",get:function(){return{tags:["TASKLIST","TASKLI","TASKINPUT"]}}},{key:"CSS",get:function(){return d}}]),Object(r.a)(e,[{key:"renderBlock",value:function(t){this._data;return this._nodes.target=this.make(),this._nodes.items=Array.from(this._nodes.target.querySelectorAll(".".concat(e.Class.item))),this._nodes.target}},{key:"renderSettings",value:function(e){return null}},{key:"save",value:function(){return this.data}},{key:"merge",value:function(){var e=Object(a.a)(o.a.mark((function e(t){var n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.data,i={items:n.items.concat(t.items)},this.data=i;case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"extractInputs",value:function(t){var n,i;if(0===t.length)return{items:[]};null===(n=t[0].closest("li"))||void 0===n||null===(i=n.parentElement)||void 0===i||i.tagName;return{items:t.map((function(t){return{content:t.innerHTML,checked:!!t.closest(".".concat(e.Class.itemChecked))}}))}}},{key:"removeInputs",value:function(t){return t.forEach((function(t,n){if(0===n)t.innerHTML="";else{var i=t.closest(".".concat(e.Class.item));if(null===i||void 0===i?void 0:i.parentElement)i.parentElement.removeChild(i)}})),t[0]}},{key:"onPaste",value:function(e){var t=e.detail.data;this.data=b(t)}},{key:"destroy",value:function(){}},{key:"make",value:function(){var t=this,n=Object(c.make)("div",[e.Class.target]);if(this._data.items.length)this._data.items.forEach((function(e){var i=t.createChecklistItem(e);n.appendChild(i)}));else{var i=this.createChecklistItem();n.appendChild(i)}return n.addEventListener("keydown",(function(e){switch(e.keyCode){case 13:t.appendNewElement(e);break;case 8:t.backspace(e)}}),!1),n.addEventListener("click",(function(e){t.toggleCheckbox(e)})),n.addEventListener("paste",(function(n){var i=t.getTodoListData(n.clipboardData);if(null===i||void 0===i?void 0:i.length){var o,a,s=t.currentItem;if(!s)return;n.stopPropagation(),n.preventDefault();var r=[],l=document.createDocumentFragment();i.map((function(e){e.data.items.forEach((function(e){var n=t.createChecklistItem(e);r.push(n),l.appendChild(n)}))}));var u=t._blockEditable.selection.getRangeAt(0),d=!(null===(o=s.querySelector(".".concat(e.Class.textField)))||void 0===o?void 0:o.innerHTML.replace("<br>"," ").trim());s.after(l);var h=s.nextElementSibling,p=t._nodes.items.indexOf(s),f=p+1;(a=t._nodes.items).splice.apply(a,[f,0].concat(r)),d&&h?h&&(s.remove(),t._nodes.items.splice(p,1),Object(c.moveCaretToStart)(h.querySelector(".".concat(e.Class.textField)),t._blockEditable.selection)):u.select(!0),n.stopPropagation(),n.preventDefault()}})),n}},{key:"getTodoListData",value:function(t){if(!t)return[];var n=t.getData("application/block-editable");if(n)try{return JSON.parse(n).filter((function(t){return t.key===e.key}))}catch(i){return[]}}},{key:"toggleCheckbox",value:function(t){var n,i=t.target.closest(".".concat(e.Class.item)),o=null===i||void 0===i?void 0:i.querySelector(".".concat(e.Class.checkbox));o&&t.target.closest(".".concat(e.Class.checkbox))===o&&(null===i||void 0===i||null===(n=i.classList)||void 0===n||n.toggle(e.Class.itemChecked))}},{key:"createChecklistItem",value:function(t){t=t||{content:"",checked:!1};var n=Object(c.make)("div",e.Class.item),i=Object(c.make)("span",e.Class.checkbox),o=Object(c.make)("div",e.Class.textField,{contentEditable:"true"});return o.innerHTML=t.content||"",t.checked&&n.classList.add(e.Class.itemChecked),n.appendChild(i),n.appendChild(o),n}},{key:"appendNewElement",value:function(t){var n=this._blockEditable.state.ui;if(!n.someToolbarOpened||!n.someFlipperButtonFocused){t.preventDefault();var i=this._blockEditable.selection,o=this._blockEditable.state,a=o.content,s=o.cursor,r=o.toolbar,l=i.anchorNode,u=this._nodes.items[this._nodes.items.length-1].querySelector(".".concat(e.Class.textField)),d=null===u||void 0===u?void 0:u.innerHTML.replace("<br>"," ").trim();if(l===u&&!d){var h=null===u||void 0===u?void 0:u.closest(".".concat(e.Class.item)),p=this._nodes.items.indexOf(h);h&&-1!==p&&(h.remove(),this._nodes.items.splice(p,1));var f=a.insert();return f&&s.setToBlock(f),r.move(),void t.stopPropagation()}if(l&&l.parentNode){var v=l.parentNode.closest(".".concat(e.Class.item));if(v){var b=Object(c.extractFragmentFromCaretPositionTillTheEnd)(this._blockEditable.selection);if(b){var m=Object(c.fragmentToString)(b),g=this.createChecklistItem({checked:!1,content:m});this._nodes.target.insertBefore(g,v.nextSibling);var k=this._nodes.items.indexOf(v)+1;this._nodes.items.splice(k,0,g),Object(c.moveCaretToStart)(g.querySelector(".".concat(e.Class.textField)),this._blockEditable.selection)}}}}}},{key:"backspace",value:function(t){if(t.target){var n=this._blockEditable.selection,i=t.target.closest(".".concat(e.Class.item));if(i&&Object(c.isAtStart)(this._blockEditable.selection)){var o=this._nodes.items.indexOf(i),a=i.previousSibling;if(a){var s;t.preventDefault();var r=a.querySelectorAll(".".concat(e.Class.textField));if(s=Array.from(r).pop()){var l=Object(c.extractFragmentFromCaretPositionTillTheEnd)(this._blockEditable.selection),u=l?Object(c.fragmentToString)(l):"";Object(c.focus)(n,s,!1);var d=n.getRangeAt(0),h=d.createBookmark();s.insertAdjacentHTML("beforeend",u),o&&(t.preventDefault(),this._nodes.items.splice(o,1)),i.remove(),d.moveToBookmark(h).select(!0)}}}}}},{key:"data",get:function(){this._data.items=[];for(var t=0;t<this._nodes.items.length;t++){var n=this._nodes.items[t].querySelector(".".concat(e.Class.textField));if(n){var i=n.innerHTML.replace("<br>"," ").trim();this._data.items.push({content:i,checked:this._nodes.items[t].classList.contains(e.Class.itemChecked)})}}return this._data},set:function(e){this._data.items=e.items||[];var t=this._nodes.target;t&&t.parentNode&&t.parentNode.replaceChild(this.make(),t)}},{key:"currentItem",get:function(){var t=this._blockEditable.selection.anchorNode;return t&&t.nodeType!==Node.ELEMENT_NODE&&(t=t.parentNode),t&&t.closest(".".concat(e.Class.item))}}]),e}();m.key="todolist",l.a.regiester(m)},586:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var i=n(11),o=n(7),a=n(6),s=n(111),r=n(515),l=n(771),c=(n(1101),n(769),function(){function e(t){Object(o.a)(this,e),this.nodes={actions:void 0},this._mathInput=void 0,this._cacheRange=void 0,this._editData=void 0,this._blockEditable=void 0,this._insertHTML=void 0,this._mathInput=new l.a,this._blockEditable=t.blockEditable,this._insertHTML=t.insertHTML}return Object(a.a)(e,[{key:"Class",get:function(){return{editor:"beui-insert-math__editor",button:"beui-insert-math__button"}}}],[{key:"checkHTML",value:function(e,t){var n=/<span class="inline-math" data-tex="([^<>]*)?"><svg.*?<\/svg><\/span>/g;return"zhihu"===t.type?e&&e.replace(n,'<img class="Formula-image" data-eeimg="true" src="" alt="$1">'):"juejin"===t.type?e&&e.replace(n,'<img class="equation" src="https://juejin.im/equation?tex=$1" alt=""/>'):e}},{key:"checkMarkdown",value:function(e){return e&&e.replace(/<span class="inline-math" data-tex="([^<>]*)?"><svg.*?<\/svg><\/span>/g,"$$$1$$$")}},{key:"sanitize",get:function(){return{span:!0,svg:!0,defs:!0,g:!0,use:!0,path:!0}}}]),Object(a.a)(e,[{key:"renderActions",value:function(){var e=this;return this.nodes.actions=r.a.make("div"),this.nodes.editor=r.a.make("div",[this.Class.editor]),this.nodes.button=r.a.make("button",[this.Class.button]),r.a.append(this.nodes.actions,[this.nodes.editor,this.nodes.button]),this._mathInput.mount(this.nodes.editor,"",(function(t){e._editData=Object(i.a)({},t)})),this.nodes.button.addEventListener("click",(function(){e._editData&&e._editData.tex?e._insertHTML("\u200b".concat('<span class="inline-math" data-tex="',e._editData.tex,'">').concat(e._mathInput.removeSVGUse(e._editData.html),"</span>","\u200b")):e._insertHTML(""),e._blockEditable.state.insertToolbar.close()})),this.nodes.actions}},{key:"destroy",value:function(){this._mathInput.unmount()}}]),e}());c.key="math",s.c.regiester(c)},587:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var i=n(7),o=n(6),a=n(10),s=n(9),r=n(528),l=n(111),c=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(e){return Object(i.a)(this,n),t.call(this,{cmdName:"bold",shortcut:"Ctrl+B",title:"Blod",blockEditable:e.blockEditable})}return Object(o.a)(n,null,[{key:"key",get:function(){return"bold"}},{key:"sanitize",get:function(){return{b:!0,strong:!0}}}]),n}(r.default);l.b.regiester(c)},588:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var i=n(7),o=n(6),a=n(10),s=n(9),r=n(528),l=n(111),c=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(e){return Object(i.a)(this,n),t.call(this,{cmdName:"inlinecode",shortcut:"Ctrl+Shift+C",title:"Inline Code",blockEditable:e.blockEditable})}return Object(o.a)(n,null,[{key:"key",get:function(){return"inlinecode"}},{key:"sanitize",get:function(){return{code:{}}}}]),n}(r.default);l.b.regiester(c)},589:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var i=n(7),o=n(6),a=n(10),s=n(9),r=n(528),l=n(111),c=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(e){return Object(i.a)(this,n),t.call(this,{cmdName:"italic",shortcut:"CMD+I",title:"Italic",blockEditable:e.blockEditable})}return Object(o.a)(n,null,[{key:"key",get:function(){return"italic"}},{key:"sanitize",get:function(){return{i:{}}}}]),n}(r.default);l.b.regiester(c)},590:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var i=n(7),o=n(6),a=n(515),s=n(111),r=function(){function e(t){Object(i.a)(this,e),this._cmdName=void 0,this._shortcut=void 0,this._title=void 0,this._inputOpened=!1,this.ENTER_KEY=13,this._blockEdtibale=void 0,this._linkRange=void 0,this._highligt=void 0,this.nodes={button:void 0,input:void 0},this._cmdName="link",this._shortcut="Ctrl+K",this._title="Link",this._blockEdtibale=t.blockEditable}return Object(o.a)(e,null,[{key:"key",get:function(){return"link"}},{key:"sanitize",get:function(){return{a:{href:!0,target:"_blank",rel:"nofollow"}}}}]),Object(o.a)(e,[{key:"render",value:function(){return this.nodes.button=document.createElement("button"),this.nodes.button.type="button",this.nodes.button.classList.add(this.Class.button,this.Class.buttonModifier),this.nodes.button.appendChild(a.a.icon(this._cmdName,12,14)),this.nodes.button.appendChild(a.a.icon("unlink",12,14)),this.nodes.button}},{key:"renderActions",value:function(){var e=this;return this.nodes.input=document.createElement("input"),this.nodes.input.placeholder=this._blockEdtibale.getLang("toolbar.inline.linkPlaceholder"),this.nodes.input.classList.add(this.Class.input),this.nodes.input.addEventListener("keydown",(function(t){t.keyCode===e.ENTER_KEY&&e.enterPressed(t),t.stopPropagation()})),this.nodes.input.addEventListener("focus",(function(){e.setHighlightLinkRange()})),this.nodes.input}},{key:"surround",value:function(e,t){t.selection;if(e&&(this._inputOpened,t.queryCommandValue(this._cmdName)))return t.execCommand("unlink"),void this.closeActions();this._linkRange=e?e.cloneRange():null,this.toggleActions()}},{key:"selectionChange",value:function(e,t){var n=t.queryCommandValue("link");if(n){var i,o;null===(i=this.nodes.button)||void 0===i||i.classList.add(this.Class.buttonUnlink),null===(o=this.nodes.button)||void 0===o||o.classList.add(this.Class.buttonActive),this.openActions();var a=n.getAttribute("href");this.nodes.input&&(this.nodes.input.value="null"!==a?a:"")}else{var s,r;null===(s=this.nodes.button)||void 0===s||s.classList.remove(this.Class.buttonUnlink),null===(r=this.nodes.button)||void 0===r||r.classList.remove(this.Class.buttonActive)}return this.removeHighlightLinkRange(),this._linkRange=e.getRangeAt(0).cloneRange(),!!n}},{key:"clear",value:function(){this.closeActions()}},{key:"toggleActions",value:function(){this._inputOpened?this.closeActions(!1):this.openActions(!0)}},{key:"openActions",value:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._blockEdtibale.editable.selection;null===(e=this.nodes.input)||void 0===e||e.classList.add(this.Class.inputShowed),n&&setTimeout((function(){var e;null===(e=t.nodes.input)||void 0===e||e.focus()}),300),this._inputOpened=!0}},{key:"closeActions",value:function(){this._blockEdtibale.editable.selection;this.nodes.input&&(this.nodes.input.classList.remove(this.Class.inputShowed),this.nodes.input.value=""),this._inputOpened=!1,this.removeHighlightLinkRange()}},{key:"enterPressed",value:function(e){var t,n=this._blockEdtibale.editable,i=(null===(t=this.nodes.input)||void 0===t?void 0:t.value)||"";if(!i.trim())return n.execCommand("unlink"),e.preventDefault(),void this.closeActions();this.validateURL(i)?(i=this.prepareLink(i),this._linkRange&&this._linkRange.select(!0),this.removeHighlightLinkRange(),n.execCommand("link",{href:i}),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),this._blockEdtibale.state.inlineToolbar.close()):this._blockEdtibale.state.notifier.show({message:"Pasted link is not valid.",style:"error"})}},{key:"validateURL",value:function(e){return!/\s/.test(e)}},{key:"prepareLink",value:function(e){return e=e.trim(),e=this.addProtocol(e)}},{key:"addProtocol",value:function(e){if(/^(\w+):(\/\/)?/.test(e))return e;var t=/^\/[^/\s]/.test(e),n="#"===e.substring(0,1),i=/^\/\/[^/\s]/.test(e);return t||n||i||(e="http://"+e),e}},{key:"setHighlightLinkRange",value:function(){var e=this._blockEdtibale.editable,t=e.holder.getBoundingClientRect(),n=t.top,i=t.left;if(this._linkRange){var o=this.makeHighlightCanvas();if(o&&this._highligt){var a=e.document.createRange(),s=o.getContext("2d");if(!s)return;a.setStart(this._linkRange.startContainer,this._linkRange.startOffset),a.setEnd(this._linkRange.endContainer,this._linkRange.endOffset);var r=a.getClientRects();o.height=this._highligt.offsetHeight,o.width=this._highligt.offsetWidth,s.clearRect(0,0,o.width,o.height),function(e,t,o,a){e.fillStyle=o;for(var s,r=0;s=t[r];r++){var l=s.left-i,c=s.top-n;a&&e.clearRect(l,c,s.width,s.height),e.fillRect(l,c,s.width,s.height)}}(s,r,"rgba(166,210,252,0.3)")}}}},{key:"removeHighlightLinkRange",value:function(){this._highligt&&(this._highligt.remove(),this._highligt=null)}},{key:"makeHighlightCanvas",value:function(){this.removeHighlightLinkRange();var e=this._blockEdtibale.editable,t=e.holder.parentNode;if(t){var n=e.document.createElement("div");n.setAttribute("id","link-highlight"),n.setAttribute("class","search-highlight"),n.style.cssText="position: absolute;pointer-events: none;top: 0;bottom: 0;right: 0;left: 0",t.appendChild(n),this._highligt=n}var i=e.document.createElement("canvas");return i.style.maxWidth="100%",this._highligt&&this._highligt.appendChild(i),i}},{key:"destroy",value:function(){}},{key:"title",get:function(){return this._title}},{key:"cmdName",get:function(){return this._cmdName}},{key:"shortcut",get:function(){return this._shortcut}},{key:"Class",get:function(){return{button:"beui-inline-tool",buttonActive:"beui-inline-tool--active",buttonModifier:"beui-inline-tool--".concat(this._cmdName),buttonUnlink:"beui-inline-tool--unlink",input:"beui-inline-tool-input",inputShowed:"beui-inline-tool-input--showed"}}}]),e}();s.b.regiester(r)},591:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var i=n(7),o=n(6),a=n(10),s=n(9),r=n(528),l=n(111),c=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(e){return Object(i.a)(this,n),t.call(this,{cmdName:"mark",shortcut:"Ctrl+M",title:"Mark",blockEditable:e.blockEditable})}return Object(o.a)(n,null,[{key:"key",get:function(){return"mark"}},{key:"sanitize",get:function(){return{mark:{}}}}]),n}(r.default);l.b.regiester(c)},592:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var i=n(7),o=n(6),a=n(10),s=n(9),r=n(528),l=n(111),c=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(e){return Object(i.a)(this,n),t.call(this,{cmdName:"strikethrough",shortcut:"Ctrl+Shift+X",title:"Strikethrough",blockEditable:e.blockEditable})}return Object(o.a)(n,null,[{key:"key",get:function(){return"strikethrough"}},{key:"sanitize",get:function(){return{s:{},del:{}}}}]),n}(r.default);l.b.regiester(c)},593:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var i=n(7),o=n(6),a=n(10),s=n(9),r=n(528),l=n(111),c=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(e){return Object(i.a)(this,n),t.call(this,{cmdName:"subscript",shortcut:"Ctrl+Shift+,",title:"Subscript",blockEditable:e.blockEditable})}return Object(o.a)(n,null,[{key:"key",get:function(){return"subscript"}},{key:"sanitize",get:function(){return{sub:{}}}}]),n}(r.default);l.b.regiester(c)},594:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var i=n(7),o=n(6),a=n(10),s=n(9),r=n(528),l=n(111),c=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(e){return Object(i.a)(this,n),t.call(this,{cmdName:"superscript",shortcut:"Ctrl+Shift+.",title:"Superscript",blockEditable:e.blockEditable})}return Object(o.a)(n,null,[{key:"key",get:function(){return"superscript"}},{key:"sanitize",get:function(){return{sup:{}}}}]),n}(r.default);l.b.regiester(c)},595:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var i=n(7),o=n(6),a=n(10),s=n(9),r=n(528),l=n(111),c=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(e){return Object(i.a)(this,n),t.call(this,{cmdName:"underline",shortcut:"Ctrl+U",title:"Underline",blockEditable:e.blockEditable})}return Object(o.a)(n,null,[{key:"key",get:function(){return"underline"}},{key:"sanitize",get:function(){return{u:{}}}}]),n}(r.default);l.b.regiester(c)},596:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var i=n(7),o=n(6),a=n(515),s=n(111),r=function(){function e(t){var n=this,o=t.blockEditable;Object(i.a)(this,e),this._blockEditable=void 0,this._needConfirmation=void 0,this.resetConfirmation=void 0,this._nodes={},this._blockEditable=o,this.resetConfirmation=function(){return n.setConfirmation(!1),{}},this._blockEditable.editable.registerCommand((function(){return{cmdName:"delete",execCommand:function(e){n.delete()},queryCommandState:function(){return n.api.content.activeBlock?0:-1}}}))}return Object(o.a)(e,null,[{key:"key",get:function(){return"delete"}}]),Object(o.a)(e,[{key:"render",value:function(){var t=this;this._nodes.button=a.a.make("div",[e.Class.button,e.Class.buttonDelete],{}),this._nodes.button.appendChild(a.a.icon("bin",12,12)),this.api.content.readOnlyMutableListeners.on(this._nodes.button,"click",(function(e){return t.handleClick(e)}),!1);var n=this._blockEditable.getLang("toolbar.settings.delete");return this.api.tooltip.onHover(this._nodes.button,n),this._nodes.button}},{key:"handleClick",value:function(e){this._needConfirmation?(this._blockEditable.eventsDispatcher.off("block-settings-closed",this.resetConfirmation),this._blockEditable.editable.execCommand("delete"),this.api.toolbar.close(),this.api.tooltip.hide(),e.stopPropagation()):(this.setConfirmation(!0),this._blockEditable.eventsDispatcher.on("block-settings-closed",this.resetConfirmation))}},{key:"setConfirmation",value:function(t){this._needConfirmation=t,this._nodes.button.classList.add(e.Class.buttonConfirm)}},{key:"delete",value:function(){this.api.content.delete()}},{key:"api",get:function(){return this._blockEditable.state}}]),e}();r.Class={button:"beui-settings__button",buttonDelete:"beui-settings__button--delete",buttonConfirm:"beui-settings__button--confirm"},s.d.regiester(r)},597:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var i=n(7),o=n(6),a=n(515),s=n(111),r=function(){function e(t){var n=this,o=t.blockEditable;Object(i.a)(this,e),this._blockEditable=void 0,this._blockEditable=o,this._blockEditable.editable.registerCommand((function(){return{cmdName:"movedown",execCommand:function(e){n.moveDown()},queryCommandState:function(){var e=n.api.content.activeBlockIndex,t=n.api.content.getBlockByIndex(e);return n.api.content.getBlockByIndex(e+1)&&t?0:-1}}}))}return Object(o.a)(e,null,[{key:"key",get:function(){return"movedown"}}]),Object(o.a)(e,[{key:"render",value:function(){var t=this,n=a.a.make("div",[e.Class.button,e.Class.wrapper],{});n.appendChild(a.a.icon("arrow-down",14,14)),this.api.content.readOnlyMutableListeners.on(n,"click",(function(e){return t.handleClick(e,n)}),!1);var i=this._blockEditable.getLang("toolbar.settings.moveDown");return this.api.tooltip.onHover(n,i),n}},{key:"handleClick",value:function(t,n){var i=this.api.content.activeBlockIndex;if(!this.api.content.getBlockByIndex(i+1))return n.classList.add(e.Class.animation),void window.setTimeout((function(){n.classList.remove(e.Class.animation)}),500);this._blockEditable.editable.execCommand("movedown")}},{key:"moveDown",value:function(){var e=this._blockEditable.editable.window,t=this.api.content.activeBlockIndex,n=this.api.content.getBlockByIndex(t+1);if(n){var i=n.holder,o=i.getBoundingClientRect(),a=Math.abs(e.innerHeight-i.offsetHeight);o.top<e.innerHeight&&(a=e.scrollY+i.offsetHeight),e.scrollTo(0,a),this.api.content.move(t+1),this.api.toolbar.move(!1),this.api.tooltip.hide()}}},{key:"api",get:function(){return this._blockEditable.state}}]),e}();r.Class={button:"beui-settings__button",wrapper:"beui-tune-move-down",animation:"wobble"},s.d.regiester(r)},598:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var i=n(7),o=n(6),a=n(515),s=n(111),r=function(){function e(t){var n=this,o=t.blockEditable;Object(i.a)(this,e),this._blockEditable=void 0,this._blockEditable=o,this._blockEditable.editable.registerCommand((function(){return{cmdName:"moveup",execCommand:function(e){n.moveUp()},queryCommandState:function(){var e=n.api.content.activeBlockIndex,t=n.api.content.getBlockByIndex(e);return n.api.content.getBlockByIndex(e-1)&&t?0:-1}}}))}return Object(o.a)(e,null,[{key:"key",get:function(){return"moveup"}}]),Object(o.a)(e,[{key:"render",value:function(){var t=this,n=a.a.make("div",[e.Class.button,e.Class.wrapper],{});n.appendChild(a.a.icon("arrow-up",14,14)),this.api.content.readOnlyMutableListeners.on(n,"click",(function(e){return t.handleClick(e,n)}),!1);var i=this._blockEditable.getLang("toolbar.settings.moveUp");return this.api.tooltip.onHover(n,i),n}},{key:"handleClick",value:function(t,n){var i=this.api.content.activeBlockIndex,o=this.api.content.getBlockByIndex(i),a=this.api.content.getBlockByIndex(i-1);if(0===i||!o||!a)return n.classList.add(e.Class.animation),void setTimeout((function(){n.classList.remove(e.Class.animation)}),500);this._blockEditable.editable.execCommand("moveup")}},{key:"moveUp",value:function(){var e=this._blockEditable.editable.window,t=this.api.content.activeBlockIndex,n=this.api.content.getBlockByIndex(t),i=this.api.content.getBlockByIndex(t-1);if(0!==t&&n&&i){var o,a=n.holder,s=i.holder,r=a.getBoundingClientRect(),l=s.getBoundingClientRect();o=l.top>0?Math.abs(r.top)-Math.abs(l.top):e.innerHeight-Math.abs(r.top)+Math.abs(l.top),e.scrollBy(0,-1*o),this.api.content.move(t-1),this.api.toolbar.move(!1),this.api.tooltip.hide()}}},{key:"api",get:function(){return this._blockEditable.state}}]),e}();r.Class={button:"beui-settings__button",wrapper:"beui-tune-move-up",animation:"wobble"},s.d.regiester(r)},599:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var i=n(7),o=n(6),a=n(515),s=n(111),r=function(){function e(t){var n=this,o=t.blockEditable;Object(i.a)(this,e),this._blockEditable=void 0,this._nodes={},this._settingsButtonActive="",this._blockEditable=o,this._blockEditable.editable.registerCommand((function(){return{cmdName:"quote",execCommand:function(e){n.quote()},queryCommandState:function(){var e=n.api.content.activeBlock;return e&&e.quoted?1:0}}})),this._blockEditable.editable.on("selectionchange",(function(){}))}return Object(o.a)(e,null,[{key:"key",get:function(){return"quote"}}]),Object(o.a)(e,[{key:"render",value:function(t){var n=this,i=a.a.make("div",[e.Class.button,e.Class.wrapper],{});i.appendChild(a.a.icon("quote",14,14)),this.api.content.readOnlyMutableListeners.on(i,"click",(function(e){return n.handleClick(e,i)}),!1),this._settingsButtonActive=t.settingsButtonActive;var o=this._blockEditable.getLang("toolbar.settings.quote");return this.api.tooltip.onHover(i,o),this._nodes.button=i,this.updateQuateButtonState(),i}},{key:"handleClick",value:function(e,t){this._blockEditable.editable.execCommand("quote")}},{key:"quote",value:function(){this._blockEditable.editable.window;var e=this.api.content.activeBlock;e&&(e.quoted=!e.quoted,this.updateQuateButtonState())}},{key:"updateQuateButtonState",value:function(){var e=this.api.content.activeBlock;this._nodes.button.classList.toggle(this._settingsButtonActive,e&&e.quoted)}},{key:"api",get:function(){return this._blockEditable.state}}]),e}();r.Class={button:"beui-settings__button",wrapper:"beui-tune-quote"},s.d.regiester(r)},600:function(e,t,n){"use strict";function i(e){var t=this;this.done=e,this.handleMessageEvent=function(e){if(null!=t.frame&&e.source==t.frame.contentWindow&&e.data)try{var n=e.data;null!=n&&t.handleMessage(n)}catch(i){console.error(i)}}}n.r(t),i.prototype.drawDomain="./image.html",i.prototype.frameStyle="position:absolute;border:0;width:100%;height:100%;z-index:100",i.prototype.startEditing=function(e){var t=this;return new Promise((function(n,i){null==t.frame&&(window.addEventListener("message",t.handleMessageEvent),t.frame=t.createFrame(t.getFrameUrl(e),t.getFrameStyle()),document.body.appendChild(t.frame),t.frame.onload=function(){n()},t.frame.onerror=function(){i()})}))},i.prototype.setWaiting=function(e){if(null!=this.startElement){var t=this.startElement,n=t.nodeName.toLowerCase();"svg"!=n&&"object"!=n||(t=t.parentNode),null!=t&&(e?(this.frame.style.pointerEvents="none",this.previousCursor=t.style.cursor,t.style.cursor="wait"):(t.style.cursor=this.previousCursor,this.frame.style.pointerEvents=""))}},i.prototype.setActive=function(e){e?(this.previousOverflow=document.body.style.overflow,document.body.style.overflow="hidden"):document.body.style.overflow=this.previousOverflow},i.prototype.stopEditing=function(){null!=this.frame&&(window.removeEventListener("message",this.handleMessageEvent),document.body.removeChild(this.frame),this.setActive(!1),this.frame=null)},i.prototype.postMessage=function(e){null!=this.frame&&this.frame.contentWindow.postMessage(JSON.stringify(e),"*")},i.prototype.getData=function(){return this.data},i.prototype.getTitle=function(){return this.title},i.prototype.getFrameStyle=function(){return this.frameStyle+";left:"+document.body.scrollLeft+"px;top:"+document.body.scrollTop+"px;"},i.prototype.getFrameUrl=function(e){return this.drawDomain+"?url="+e},i.prototype.createFrame=function(e,t){var n=document.createElement("iframe");return n.setAttribute("frameborder","0"),n.setAttribute("style",t),n.setAttribute("src",e),n},i.prototype.handleMessage=function(e){"save"==e.event?this.done(e.data.blob):"exit"==e.event&&this.stopEditing(e)},i.prototype.done=function(){},i.prototype.initialized=function(){},t.default=i},603:function(e,t,n){"use strict";n.r(t),n.d(t,"Constant",(function(){return c})),n.d(t,"unhtml",(function(){return v})),n.d(t,"default",(function(){return b}));var i=n(11),o=n(7),a=n(6),s=n(604),r=n(841),l=n.n(r),c={block:"be-code",line:"be-code__line",text:"be-code__line-text",langAttr:"data-lang",codeBlockTagName:"pre",lineTagName:"code",lineTextTagName:"span",tabSize:"  ",classPrefix:"be-code__"};for(var u in s.Languages)if(Object.prototype.hasOwnProperty.call(s.Languages,u)){var d=s.Languages[u];l.a.registerLanguage(u,d),l.a.configure({classPrefix:c.classPrefix})}function h(e){return e&&e.parentNode&&e.parentNode.closest(".".concat(c.line))}function p(e){return e&&e.parentNode&&e.parentNode.closest(".".concat(c.block))}function f(e,t){e=e||"";var n=(t=t||document).createElement(c.codeBlockTagName);n.innerHTML=e;for(var i=t.createDocumentFragment();n.firstChild;)i.appendChild(n.firstChild);return i}function v(e,t){return e?e.replace(t||/[&<">'](?:(amp|lt|ldquo|rdquo|quot|gt|#39|nbsp|middot|#\d+);)?/g,(function(e,t){return t?e:{"<":"&lt;","&":"&amp;",'"':"&quot;","\u201c":"&ldquo;","\u201d":"&rdquo;",">":"&gt;","'":"&#39;","\xb7":"&middot;"}[e]})):""}var b=function(){function e(t){Object(o.a)(this,e),this._blockEditable=void 0,this._blockEditable=t}return Object(a.a)(e,[{key:"highlightCurrentLine",value:function(){var e=this._blockEditable.editable.selection,t=e.anchorNode||e.focusNode,n=e.getRangeAt(0);this.highlightLine(t,n)}},{key:"highlightLine",value:function(e,t){var n=h(e);if(n){var i=p(e);if(i){var o=this._blockEditable.editable,a=o.document,s=o.$dom;if(n.textContent){var r=h(t.startContainer),l=h(t.endContainer),u={id:void 0,start:"",end:""},d=!1;n===r&&n===l&&(u=t.createBookmark(),d=!0);var f=this.getCommentSibling(n),v=i.getAttribute(c.langAttr)||"",b=this.highlightText(f.nodeText,v,d);b.result.language&&!v&&i.setAttribute(c.langAttr,b.result.language);var m=a.createElement(c.codeBlockTagName);m.innerHTML=b.result.value;for(var g=[],k=0,y=m.children.length;k<y;k++)g.push(m.children[k]);var _=g[f.pre.length].firstElementChild,C=((null===_||void 0===_?void 0:_.textContent)||"").replace(s.fillCharReg,"");if(d&&!C&&(!b.bookmark||!b.bookmark.startid)){var x=s.createBookmarkNode(a,Math.random());null===_||void 0===_||_.appendChild(x),null===_||void 0===_||_.appendChild(a.createTextNode(s.fillChar)),u.id=x.id,u.start=x.id}return this.updateLines(f.nodeList,g),d&&(!u.id&&b.bookmark&&b.bookmark.startid&&(u.id=u.start=b.bookmark.startid),!u.id&&b.bookmark&&b.bookmark.endid&&(u.end=b.bookmark.endid),t.moveToBookmark(u).select()),b}}}}},{key:"updateLines",value:function(e,t){if(e&&t&&e.length===t.length)for(var n=0,i=e.length;n<i;n++){var o,a,s=e[n],r=t[n];if(s.innerHTML!==r.innerHTML)null===(o=s.parentNode)||void 0===o||o.insertBefore(r,s),null===(a=s.parentNode)||void 0===a||a.removeChild(s)}}},{key:"blur",value:function(e){var t=p(e.target);if(t){var n=this._blockEditable.editable,i=n.$dom,o=n.document,a=t.getAttribute(c.langAttr);if(a){for(var s=[],r=[],l=0,u=t.children.length;l<u;l++){var d=t.children[l];s.push(d),r.push(d.textContent||"")}var h=r.join("\n").replace(/\n/g,"").replace(i.fillCharReg,"").replace(i.bookmarkFillCharReg,"");if(h){var f=this.highlightText(h,a,!1),v=o.createElement(c.codeBlockTagName);v.innerHTML=f.result.value;for(var b=[],m=0,g=v.children.length;m<g;m++){var k=t.children[m];b.push(k)}this.updateLines(s,b)}}}}},{key:"backspace",value:function(e){var t=this._blockEditable.editable,n=t.$dom,i=t.document,o=!1,a=t.selection.getRangeAt(0);if(a.collapsed){var s=h(a.startContainer);if(!s)return o;var r=a.createBookmark(),l=s.textContent||"";a.moveToBookmark(r);var u=s.parentNode;if(!u)return o;if(1===u.childNodes.length&&!l.replace(n.fillCharReg,"").replace(n.bookmarkFillCharReg,""))return o;var d=n.createBookmarkNode(i,Math.random()),p=i.createElement(c.codeBlockTagName);p.innerHTML=this.getCodeLineHtml(n.fillChar+d.outerHTML);var f={id:d.id,start:d.id,end:null},b=p.firstElementChild,m=new RegExp("[^"+n.fillChar+"]["+n.fillChar+"]*"+n.bookmarkFillChar,"m"),g="##__insertcode_tmp_char__##";if(m.test(l))s.innerHTML=v(l.replace(m,g)).replace(g,b.innerHTML),a.moveToBookmark(f),this.resetLanguage(u),this.highlightLine(a.startContainer,a),o=!0;else{var k=s.previousSibling;k&&(l=(k.textContent||"")+"\n"+l,k.remove(),s.innerHTML=v(l.replace(m,g)).replace(g,b.innerHTML),a.moveToBookmark(f),this.resetLanguage(u),this.highlightLine(a.startContainer,a),o=!0)}}else this.deleteRangeContents(a),this.highlightLine(a.startContainer,a),o=!0;return o&&e.preventDefault(),o}},{key:"del",value:function(e){var t=this._blockEditable.editable,n=t.$dom,i=t.document,o=!1,a=t.selection.getRangeAt(0);if(a.collapsed){var s=h(a.startContainer);if(!s)return o;var r=a.createBookmark(),l=s.textContent||"";a.moveToBookmark(r);var u=s.parentNode;if(!u)return o;var d=n.createBookmarkNode(i,Math.random()),p=i.createElement(c.codeBlockTagName);p.innerHTML=this.getCodeLineHtml(n.fillChar+d.outerHTML);var f={id:d.id,start:d.id,end:null},b=p.firstElementChild,m=new RegExp("[^"+n.fillChar+"]["+n.fillChar+"]*"+n.bookmarkFillChar,"m"),g="##__insertcode_tmp_char__##";if(m.test(l))s.innerHTML=v(l.replace(m,g)).replace(g,b.innerHTML),a.moveToBookmark(f),this.resetLanguage(u),this.highlightLine(a.startContainer,a),o=!0;else{var k=s.nextSibling;k&&(l=l+0+(k.textContent||""),k.remove(),s.innerHTML=v(l.replace(m,g)).replace(g,b.innerHTML),a.moveToBookmark(f),this.resetLanguage(u),this.highlightLine(a.startContainer,a),o=!0)}o=!0}else this.deleteRangeContents(a),this.highlightLine(a.startContainer,a),o=!0;return o&&e.preventDefault(),o}},{key:"tab",value:function(e){var t=this._blockEditable.editable,n=t.selection,i=t.document,o=n.getRangeAt(0);if(this.getCurrentBlock(o.startContainer))if(e.shiftKey){var a=this.getLinesInRange(o);if(a.length>0){for(var s=o.createBookmark(),r=0,l=a.length;r<l;r++)this.deletePreviousTab(a[r]);o.moveToBookmark(s).select()}}else if(o.collapsed)this.insertTabInCollapseRange(o);else{var u=this.getLinesInRange(o);if(1===u.length)this.deleteRangeContents(o),this.insertTabInCollapseRange(o);else if(u.length>1){for(var d=o.createBookmark(),h=i.createTextNode(c.tabSize),p=0,f=u.length;p<f;p++){var v=u[p];if(v.firstChild)v.firstChild.insertBefore(h.cloneNode(!0),v.firstChild.firstChild);else{var b=i.createElement(c.lineTextTagName);b.className=c.text,b.appendChild(h.cloneNode(!0)),v.appendChild(b)}}o.moveToBookmark(d).select()}}}},{key:"getCurrentLine",value:function(){var e=this._blockEditable.editable.selection;return h(e.anchorNode||e.focusNode)}},{key:"getCurrentBlock",value:function(e){var t=this._blockEditable.editable.selection;return p(e=e||t.anchorNode||t.focusNode)}},{key:"mergeCommentLine",value:function(e){var t=e.firstChild;if(!t||t.nodeName.toLowerCase()!==c.lineTextTagName)return!1;if(t.childNodes.length<=1)return!1;var n=this._blockEditable.editable,i=n.document,o=n.$dom,a=i.createElement(c.lineTagName);a.innerHTML=t.innerHTML;for(var s=a.firstChild,r=!1;s;){if(this.isCommentNode(s))for(var l=void 0;l=s.nextSibling;)if(o.isBookmarkNode(l)||o.isFillChar(l))s.appendChild(l),l=s,r=!0;else{if(!this.isCommentNode(l))break;var u=f(l.innerHTML,i);s.appendChild(u),l.remove(),l=s,r=!0}s=s.nextSibling}return r&&(e.innerHTML=a.innerHTML),r}},{key:"splitCodeLine",value:function(){var e=this._blockEditable.editable,t=e.selection,n=(e.document,e.$dom),i=t.anchorNode||t.focusNode,o=t.getRangeAt(0),a=h(i),s="";if(a){var r,l=o.createBookmark();s=(null===(r=a.textContent)||void 0===r?void 0:r.split(n.bookmarkFillChar)[0])||"";var u=new RegExp("^([\\s"+n.fillChar+"]+)([^\\s"+n.fillChar+"]|$)"),d=s.match(u);s=d&&d[0]?d[0].replace(u,"$1").replace(/\t/g,c.tabSize).replace(n.fillCharReg,""):"",o.moveToBookmark(l)}this.insertHighlight2Range("\n"+s,o)}},{key:"insertHighlight2Range",value:function(e,t){if(e){var n=this._blockEditable.editable,i=n.selection,o=n.document,a=n.$dom,s=n.holder,r=i.anchorNode||i.focusNode,l=p(r);if(!l)return;this.deleteRangeContents(t);var u=l.getAttribute(c.langAttr)||"",d=this.highlightText(e,u);d.result.language&&(u=d.result.language,l.setAttribute(c.langAttr,u));var v=d.result.value,b=h(r),m=null===b||void 0===b?void 0:b.firstElementChild;if(b&&10===a.getPosition(b,s)&&m){var g,k,y,_,C,x,E,O=f(v,o),S=O.firstElementChild,w=null===(g=S)||void 0===g?void 0:g.firstElementChild;(null===w||void 0===w?void 0:w.firstChild)||null===w||void 0===w||w.appendChild(o.createTextNode(a.fillChar));var T,j=O.lastElementChild,B=null===(k=j)||void 0===k?void 0:k.lastElementChild,N=null===(y=B)||void 0===y?void 0:y.lastChild;if(!N)N=o.createTextNode(a.fillChar),null===(T=B)||void 0===T||T.appendChild(N);var L,I=t.createBookmark();if(this.mergeFromStart2End(I.start,m,w,"pre"),this.mergeFromStart2End(I.end||I.start,m,B,"next"),S!==j)null===(L=B)||void 0===L||L.insertBefore(a.createBookmarkNode(o,Math.random()),N.nextSibling);var A,R,M=this.highlightText((null===(_=j)||void 0===_?void 0:_.textContent)||"",u,!0),D=M.bookmark,H=f(M.result.value,o);if(O.appendChild(H),O.removeChild(j),!D||!D.startid)A=a.createBookmarkNode(o,Math.random()),null===(R=B)||void 0===R||R.insertBefore(A,N.nextSibling);(M=this.highlightText((null===(C=S)||void 0===C?void 0:C.textContent)||"",u,!!A)).bookmark&&M.bookmark.startid&&(D=M.bookmark),H=f(M.result.value,o),O.insertBefore(H,S),O.removeChild(S),B=null===(x=j=O.lastElementChild)||void 0===x?void 0:x.lastElementChild,S=O.firstElementChild,null===(E=b.parentNode)||void 0===E||E.insertBefore(O,b),b.remove();var P={id:D&&D.startid?D.startid:"",start:D&&D.startid?D.startid:"",end:D&&D.endid?D.endid:""};return P.start?t.moveToBookmark(P):t.selectNodeContents(B).collapse(!1),t.select(),S}}}},{key:"highlightText",value:function(e,t,n){var o=this,a=this._blockEditable.editable,s=a.document,r=a.$dom,u=s.createElement("pre");u.classList.add("lang-".concat(t)),e=e.replace(/\r/g,"").replace(r.fillCharReg,"").replace(/\t/g,c.tabSize);var d=null;n&&(d=function(t){if(!e)return null;for(var n,i=r.bookmarkFillCharReg,o=[];(n=i.exec(e))&&o.length<2;)o.push(n.index);return{startPos:o[0],endPos:o[1]}}()),e=e.replace(r.bookmarkFillCharReg,""),u.textContent=e,l.a.highlightBlock(u);var h={};n&&d&&(h=function(e,t){var n=void 0===t.startPos,i=void 0===t.endPos;if(n&&i)return{};for(var o,a,l=e.ownerDocument.createTreeWalker(e,window.NodeFilter.SHOW_TEXT,{acceptNode:function(e){return e.nodeValue?window.NodeFilter.FILTER_ACCEPT:window.NodeFilter.FILTER_REJECT}},!1),c=0,u={start:{node:null},end:{node:null}},d=function(e){var t=e.node.ownerDocument||s,n=e.node.cloneNode(),i=n.splitText(e.pos+1),o=null===t||void 0===t?void 0:t.createDocumentFragment();null===o||void 0===o||o.appendChild(n);var a=r.createBookmarkNode(t,Math.random());null===o||void 0===o||o.appendChild(a),null===o||void 0===o||o.appendChild(t.createTextNode(r.fillChar)),o.appendChild(i);var l=e.node.parentNode;return null===l||void 0===l||l.insertBefore(o,e.node),null===l||void 0===l||l.removeChild(e.node),a};l.nextNode()&&(!n||!i);){var h,p=c+((null===(h=l.currentNode.nodeValue)||void 0===h?void 0:h.length)||0);!n&&c<=t.startPos&&t.startPos<=p&&(u.start.node=l.currentNode,u.start.pos=t.startPos-c-1,c++,p++,n=!0),!i&&c<=t.endPos&&t.endPos<=p&&(u.end.node=l.currentNode,u.end.pos=t.endPos-c-1,i=!0),c=p}if(u.start.node&&u.start.node!==u.end.node)o=d(u.start),u.end.node&&(a=d(u.end));else if(u.start.node&&u.start.node===u.end.node){var f=u.start.node.cloneNode(!0),v=f.splitText((u.start.pos||0)+1),b=(u.end.pos||0)-f.nodeValue.length+1,m=void 0;b<=v.nodeValue.length&&(m=v.splitText(b)),o=r.createBookmarkNode(s,Math.random()),a=r.createBookmarkNode(s,Math.random());var g=s.createDocumentFragment();g.appendChild(f),g.appendChild(o),g.appendChild(s.createTextNode(r.fillChar)),g.appendChild(v),g.appendChild(a),m&&g.appendChild(m);var k=u.start.node.parentNode;null===k||void 0===k||k.insertBefore(g,u.start.node),null===k||void 0===k||k.removeChild(u.start.node)}return a&&(a.id=a.id.replace("start","end")),{startid:o?o.id:"",endid:a?a.id:""}}(u,d));!function(e){var t=e.ownerDocument||s,n=".".concat(c.classPrefix,"comment"),i=[];e.querySelectorAll(n).forEach((function(e){if(e.innerHTML.indexOf("\n")>=0){var n="</"+e.nodeName.toLowerCase()+">",o=e.cloneNode(!1).outerHTML.replace(n,""),a=o+e.innerHTML.replace(/\n/g,n+"\n"+o)+n,s=t.createElement(c.codeBlockTagName);s.innerHTML=a;for(var r=t.createDocumentFragment();s.firstChild;)r.appendChild(s.firstChild);i.push([e,r])}}));for(var o=0;o<i.length;o++){var a=i[o],r=a[0].parentNode;r&&(r.insertBefore(a[1],a[0]),r.removeChild(a[0]))}}(u);return Object(i.a)(Object(i.a)({},function(e){for(var t=e.innerHTML,n=new RegExp("\\n[\\s]*(<\\/[^>]*>)","g");n.test(t);)t=t.replace(n,"$1\n");for(var a=t.split("\n"),s=0;s<a.length;s++)a[s]=o.getCodeLineHtml(a[s]);return{result:{language:e.result.language||"",relevance:e.result.relevance,value:a.join("")},second_best:e.second_best?Object(i.a)({},e.second_best):{language:"",relevance:0}}}(u)),{},{bookmark:h})}},{key:"getCodeLineHtml",value:function(e){var t=this._blockEditable.editable.$dom;return e=e||t.fillChar,'<code class="'.concat(c.line,'"><span class="').concat(c.text,'">').concat(e,"</span></code>")}},{key:"getCommentSibling",value:function(e){var t={cur:e,pre:[],next:[],nodeText:"",nodeList:[]};if(!e||e.nodeName.toLowerCase()!==c.lineTagName)return t;for(var n=e;n=n.previousSibling;){var i=n.firstChild;if(!(i&&i.childNodes&&1===i.childNodes.length&&this.isCommentNode(i.firstChild)))break;t.pre.push(n),t.nodeList.push(n)}for(t.nodeList.reverse(),t.nodeList.push(e),n=e;n=n.nextSibling;){var o=n.firstChild;if(!(o&&o.childNodes&&1===o.childNodes.length&&this.isCommentNode(o.firstChild)))break;t.next.push(n),t.nodeList.push(n)}for(var a=[],s=0;s<t.nodeList.length;s++){var r=t.nodeList[s];a.push(r.textContent||"")}return t.nodeText=a.join("\n"),t}},{key:"isCommentNode",value:function(e){return!!(e&&"span"===e.nodeName.toLowerCase()&&0<=e.className.indexOf(c.classPrefix+"comment"))}},{key:"insertTabInCollapseRange",value:function(e){var t=this,n=this._blockEditable.editable,i=n.document,o=n.$dom,a=i.createTextNode(c.tabSize);e.insertNode(a).setStartAfter(a).collapse(),o.findParent(a,(function(e){if(t.isCommentNode(e))return!0}))?e.select():this.highlightLine(a,e)}},{key:"deletePreviousTab",value:function(e){for(var t=this._blockEditable.editable,n=t.document,i=t.$dom,o=n.createTreeWalker(e,window.NodeFilter.SHOW_TEXT,{acceptNode:function(e){return e.nodeValue&&0<e.nodeValue.replace(i.fillCharReg,"").replace(i.bookmarkFillCharReg,"").length?window.NodeFilter.FILTER_ACCEPT:window.NodeFilter.FILTER_REJECT}},!1),a=new RegExp("^["+i.fillChar+"]* ["+i.fillChar+"]*"),s=[],r=0;o.nextNode()&&r<2;){var l="";for(l=o.currentNode.nodeValue||"";a.test(l)&&r<2;)l=l.replace(a,""),r++;if(l!==o.currentNode.nodeValue&&s.push({node:o.currentNode,text:l}),0===s.length)break}for(var c=[],u=0,d=s.length;u<d;u++){var h=s[u];if(h.node&&h.node.parentNode){var p=n.createTextNode(h.text),f=h.node.parentNode;f.insertBefore(p,h.node),f.removeChild(h.node),c.push(p)}}return c}},{key:"getLinesInRange",value:function(e){var t=[],n=h(e.startContainer),i=h(e.endContainer);if(!n||!i)return t;if(t.push(n),n===i)return t;for(var o=n;(o=o.nextSibling)&&1===o.nodeType&&o!==i;)t.push(o);return t.push(i),t}},{key:"resetLanguage",value:function(e){var t;if(e){var n=this._blockEditable.editable.$dom;(null===(t=e.textContent)||void 0===t?void 0:t.replace(/\s/g,"").replace(n.fillCharReg,"").replace(n.bookmarkFillCharReg,""))||e.setAttribute(n.languageAttr,"")}}},{key:"deleteRangeContents",value:function(e){if(!e.collapsed){var t=this._blockEditable.editable,n=t.document,i=t.$dom,o=e.createBookmark();e.deleteContents();var a=this.getCurrentBlock(o.start||o.end);a&&this.resetLanguage(a);var s=h(o.start),r=h(o.end),l=null===s||void 0===s?void 0:s.firstElementChild,c=null===r||void 0===r?void 0:r.firstElementChild,u={id:"",start:"",end:""};if(s||r){var d=f(this.getCodeLineHtml(),n),p=d.firstElementChild,v=null===p||void 0===p?void 0:p.firstElementChild;if(s&&l){var b;this.mergeFromStart2End(o.start,l,v,"pre");var m=i.createBookmarkNode(n,Math.random());null===v||void 0===v||v.appendChild(m),u.start=m.id,u.end=null,u.id=m.id,r&&c&&this.mergeFromStart2End(o.end,c,v,"next"),this.mergeCommentLine(p),null===(b=s.parentNode)||void 0===b||b.insertBefore(d,s)}else if(r&&c){var g;this.mergeFromStart2End(o.end,c,v,"next");var k=i.createBookmarkNode(n,Math.random());null===v||void 0===v||v.appendChild(k),u.start=k.id,u.end=null,u.id=k.id,this.mergeCommentLine(p),null===(g=r.parentNode)||void 0===g||g.insertBefore(d,r)}}s&&s.remove(),r&&r.remove(),u.id&&e.moveToBookmark(u)}}},{key:"mergeFromStart2End",value:function(e,t,n,i){var o=this._blockEditable.editable,a=o.document,s=o.$dom,r=new RegExp("[^>]*(<\\/?(\\w+)\\s*(?:[^>]*)>)[^<]*","g"),l=new RegExp("<(\\w+)\\s*(?:[^>]*)>[^<]*<\\/\\1>","g"),u=t.innerHTML.split(e.outerHTML);u[0]=(u[0]||"").replace(s.getBookmarkReg(),""),u[1]=(u[1]||"").replace(s.getBookmarkReg(),"");var d="";if("pre"===i)if(r.test(u[1])){for(u[1]=u[1].replace(r,"$1");l.test(u[1]);)u[1]=u[1].replace(l,"");d=u[0]+u[1]}else d=u[0];else if(r.test(u[0])){for(u[0]=u[0].replace(r,"$1");l.test(u[0]);)u[0]=u[0].replace(l,"");d=u[0]+u[1]}else d=u[1];var h=e.ownerDocument||a,p=h.createElement(c.codeBlockTagName);p.innerHTML=d;for(var f=h.createDocumentFragment();p.firstChild;)f.appendChild(p.firstChild);"pre"===i?n.insertBefore(f,n.firstChild):n.appendChild(f)}}]),e}()},604:function(e,t,n){"use strict";n.r(t),n.d(t,"Languages",(function(){return ae}));var i=n(812),o=n.n(i),a=n(813),s=n.n(a),r=n(814),l=n.n(r),c=n(815),u=n.n(c),d=n(816),h=n.n(d),p=n(817),f=n.n(p),v=n(818),b=n.n(v),m=n(819),g=n.n(m),k=n(820),y=n.n(k),_=n(821),C=n.n(_),x=n(822),E=n.n(x),O=n(823),S=n.n(O),w=n(824),T=n.n(w),j=n(825),B=n.n(j),N=n(826),L=n.n(N),I=n(827),A=n.n(I),R=n(828),M=n.n(R),D=n(829),H=n.n(D),P=n(830),F=n.n(P),q=n(831),z=n.n(q),V=n(832),U=n.n(V),W=n(833),K=n.n(W),$=n(834),X=n.n($),G=n(835),Y=n.n(G),Z=n(836),J=n.n(Z),Q=n(837),ee=n.n(Q),te=n(839),ne=n.n(te),ie=n(840),oe=n.n(ie),ae={javascript:o.a,apache:s.a,bash:l.a,shell:u.a,csharp:h.a,cpp:f.a,css:b.a,typescript:g.a,diff:y.a,xml:C.a,http:E.a,ini:S.a,json:T.a,java:B.a,makefile:L.a,markdown:A.a,nginx:M.a,objectivec:H.a,php:F.a,perl:z.a,properties:U.a,python:K.a,ruby:X.a,sql:Y.a,powershell:J.a,swift:ee.a,kotlin:ne.a,go:oe.a}},605:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return k}));var i=n(22),o=n.n(i),a=n(38),s=n(1),r=n(7),l=n(6),c=n(10),u=n(9),d=n(0),h=n.n(d),p=n(34),f=n.n(p),v=n(852),b=n.n(v),m=n(245);b.a.mermaidAPI.initialize({startOnLoad:!1});var g=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(r.a)(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o)))._textInput=void 0,e._preview=void 0,e.onSelect=function(t){e.insertText(t),e.onMermaidChange()},e.onMermaidChange=function(){var t=e.props.onMermaidChange,n=e._textInput,i=e._preview;if(n&&i)try{b.a.mermaidAPI.render("__ge_graph_render",n.value,(function(e,o){i.innerHTML=e,t({mermaid:n.value,html:e})}))}catch(o){i.innerHTML=""}},e}return Object(l.a)(n,[{key:"getMermaid",value:function(){var e=this._textInput,t=this._preview;if(e&&t)return{mermaid:e.value,html:t.innerHTML}}},{key:"insertText",value:function(e){var t=this._textInput;if(t)if(t.selectionStart||0===t.selectionStart){var n=t.selectionStart,i=t.selectionEnd;t.value=t.value.substring(0,n)+e+t.value.substring(i,t.value.length),t.focus(),t.selectionStart=n+e.length,t.selectionEnd=n+e.length}else t.value+=e,t.focus()}},{key:"componentDidMount",value:function(){if(this._textInput){var e=this.props.mermaid;e&&(this._textInput.value=e),this.onMermaidChange(),0===this._textInput.selectionStart&&(this._textInput.selectionStart=this._textInput.value.length)}}},{key:"render",value:function(){var e=this;return Object(s.jsxs)("div",{className:"beui-diagram-editor",children:[Object(s.jsx)("textarea",{onPaste:function(e){e.stopPropagation()},placeholder:"\u8f93\u5165 Mermaid \u8bed\u6cd5\u683c\u5f0f",onChange:this.onMermaidChange,ref:function(t){e._textInput=t},autoFocus:!0,suppressContentEditableWarning:!0,className:"beui-diagram-editor__input",contentEditable:!0}),Object(s.jsx)("div",{className:"beui-diagram-editor__preview",ref:function(t){return e._preview=t}})]})}}]),n}(d.Component),k=function(){function e(t){Object(r.a)(this,e),this._unmount=void 0,this._upload=void 0,this._blockEditable=void 0,this._blockEditable=t}return Object(l.a)(e,[{key:"mount",value:function(e,t,n){var i=this,s=f.a.render(h.a.createElement(g,{mermaid:t,onMermaidChange:n}),e);this._unmount=function(){f.a.unmountComponentAtNode(e)},this._upload=Object(a.a)(o.a.mark((function e(){var t,n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.getMermaid(),n=i._blockEditable.editable.getOpt("uploadImage"),a=i._blockEditable.utils.svgToBlob,!t||!n){e.next=5;break}return e.abrupt("return",a(t.html).then((function(e){return e?n(e):void 0})));case 5:case"end":return e.stop()}}),e)})))}},{key:"unmount",value:function(){var e=Object(a.a)(o.a.mark((function e(t){var n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._upload||!t){e.next=9;break}return i="".concat(Date.now()),m.b.loading({content:"\u4fdd\u5b58\u56fe\u7247\u4e2d...",duration:0,key:i}),e.next=5,this._upload();case 5:n=e.sent,m.b.destroy(i),n||m.b.error("\u4fdd\u5b58\u56fe\u7247\u5931\u8d25"),this._upload=null;case 9:return this._unmount&&(this._unmount(),this._unmount=null),e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}()},629:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var i=n(7),o=n(6),a=n(245),s=n(630),r=function(){function e(t){Object(i.a)(this,e),this._blockEditable=void 0,this._diagramEditor=void 0,this._blockEditable=t}return Object(o.a)(e,[{key:"edit",value:function(e,t){var n=this,i=this._blockEditable.editable.getOpt("uploadImage"),o=this._blockEditable.utils,r=o.svgToBlob,l=o.Base64;this._diagramEditor=new s.default(null,null,(function(e){var o=e.split(",").pop()||"",s=l.decode(o),c="".concat(Date.now());a.b.loading({content:"\u4fdd\u5b58\u56fe\u7247\u4e2d...",duration:0,key:c}),r(s).then((function(e){return e?i(e):void 0})).then((function(e){a.b.destroy(c),e?(t({html:s,url:e.url}),n._diagramEditor.stopEditing()):a.b.error("\u4fdd\u5b58\u56fe\u7247\u5931\u8d25")}))})),this._diagramEditor.startEditing("data:image/svg+xml;base64,".concat(l.encode(e)),"xmlsvg")}}]),e}()},630:function(e,t,n){"use strict";function i(e,t,n,i){this.config=null!=e?e:this.config,this.ui=null!=t?t:this.ui,this.done=null!=n?n:this.done,this.initialized=null!=i?i:this.initialized;var o=this;this.handleMessageEvent=function(e){if(null!=o.frame&&e.source==o.frame.contentWindow&&e.data.length>0)try{var t=JSON.parse(e.data);null!=t&&o.handleMessage(t)}catch(n){console.error(n)}}}n.r(t),i.prototype.config=null,i.prototype.drawDomain="https://embed.diagrams.net/",i.prototype.ui="min",i.prototype.xml=null,i.prototype.format="xml",i.prototype.libraries=!0,i.prototype.frameStyle="position:absolute;border:0;width:100%;height:100%;z-index:100",i.prototype.startEditing=function(e,t,n){null==this.frame&&(window.addEventListener("message",this.handleMessageEvent),this.format=null!=t?t:this.format,this.title=null!=n?n:this.title,this.data=e,this.frame=this.createFrame(this.getFrameUrl(),this.getFrameStyle()),document.body.appendChild(this.frame),this.setWaiting(!0))},i.prototype.setWaiting=function(e){if(null!=this.startElement){var t=this.startElement,n=t.nodeName.toLowerCase();"svg"!=n&&"object"!=n||(t=t.parentNode),null!=t&&(e?(this.frame.style.pointerEvents="none",this.previousCursor=t.style.cursor,t.style.cursor="wait"):(t.style.cursor=this.previousCursor,this.frame.style.pointerEvents=""))}},i.prototype.setActive=function(e){e?(this.previousOverflow=document.body.style.overflow,document.body.style.overflow="hidden"):document.body.style.overflow=this.previousOverflow},i.prototype.stopEditing=function(){null!=this.frame&&(window.removeEventListener("message",this.handleMessageEvent),document.body.removeChild(this.frame),this.setActive(!1),this.frame=null)},i.prototype.postMessage=function(e){null!=this.frame&&this.frame.contentWindow.postMessage(JSON.stringify(e),"*")},i.prototype.getData=function(){return this.data},i.prototype.getTitle=function(){return this.title},i.prototype.getFrameStyle=function(){return this.frameStyle+";left:"+document.body.scrollLeft+"px;top:"+document.body.scrollTop+"px;"},i.prototype.getFrameUrl=function(){var e=this.drawDomain+"?proto=json&spin=1";return null!=this.ui&&(e+="&ui="+this.ui),null!=this.libraries&&(e+="&libraries=1"),null!=this.config&&(e+="&configure=1"),e},i.prototype.createFrame=function(e,t){var n=document.createElement("iframe");return n.setAttribute("frameborder","0"),n.setAttribute("style",t),n.setAttribute("src",e),n},i.prototype.setStatus=function(e,t){this.postMessage({action:"status",messageKey:e,modified:t})},i.prototype.handleMessage=function(e){"configure"==e.event?this.configureEditor():"init"==e.event?this.initializeEditor():"autosave"==e.event||("export"==e.event?(this.done(e.data),this.xml=null):"save"==e.event&&(this.xml=e.xml,e.exit?e.event="exit":this.setStatus("allChangesSaved",!1))),"exit"==e.event&&("xml"!=this.format?null!=this.xml?this.postMessage({action:"export",format:this.format,xml:this.xml,spinKey:"export"}):this.stopEditing(e):((null==e.modified||e.modified)&&this.save(e.xml,!1,this.startElement),this.stopEditing(e)))},i.prototype.configureEditor=function(){this.postMessage({action:"configure",config:this.config})},i.prototype.initializeEditor=function(){this.postMessage({action:"load",autosave:1,save:0,saveAndExit:"1",modified:"unsavedChanges",xml:this.getData(),title:this.getTitle()}),this.setWaiting(!1),this.setActive(!0),this.initialized()},i.prototype.done=function(){},i.prototype.initialized=function(){},t.default=i},631:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var i=n(7),o=n(6),a=n(518),s=n(742).default,r=function(){function e(t){Object(i.a)(this,e),this.nodes={},this._blockEditable=void 0,this._onSelectFile=void 0,this._blockClass=void 0,this._blockEditable=t.blockEditable,this._onSelectFile=t.onSelectFile,this.make()}return Object(o.a)(e,[{key:"render",value:function(t,n){return this._blockClass=n,this.nodes.fileButton.classList.toggle(this._blockClass.button,!0),this.nodes.fileButton.classList.toggle(n.fakeInput,!0),this.nodes.imageContainer.classList.toggle(n.fakeInput,!0),t.image&&0!==Object.keys(t.image).length?this.toggleStatus(e.status.FILLED):this.toggleStatus(e.status.EMPTY),this.nodes.target}},{key:"createFileButton",value:function(){var e=this,t=Object(a.make)("div",[]);return t.innerHTML="".concat(s),t.addEventListener("click",(function(){e._onSelectFile()})),t}},{key:"showPreloader",value:function(t){this.nodes.imagePreloader.style.backgroundImage="url(".concat(t,")"),this.toggleStatus(e.status.UPLOADING)}},{key:"hidePreloader",value:function(){this.nodes.imagePreloader.style.backgroundImage="",this.toggleStatus(e.status.EMPTY)}},{key:"fillImage",value:function(t,n){var i=this,o=/\.mp4$/.test(t)?"VIDEO":"IMG",s={src:t},r="load";"VIDEO"===o&&(s.autoplay=!0,s.loop=!0,s.muted=!0,s.playsinline=!0,r="loadeddata"),this.nodes.image&&this.nodes.image.remove(),this.nodes.image=Object(a.make)(o,e.Class.image,s),n&&this.showPreloader(s.src),this.nodes.image.addEventListener(r,(function(){i.toggleStatus(e.status.FILLED),i.nodes.imagePreloader&&(i.nodes.imagePreloader.style.backgroundImage="")})),this.nodes.imageContainer.appendChild(this.nodes.image)}},{key:"fillCaption",value:function(e){this.nodes.caption&&(this.nodes.caption.innerHTML=e)}},{key:"toggleStatus",value:function(t){for(var n in e.status)Object.prototype.hasOwnProperty.call(e.status,n)&&this.nodes.target.classList.toggle("".concat(e.Class.target,"--").concat(e.status[n]),t===e.status[n])}},{key:"applySetting",value:function(t,n){this.nodes.target.classList.toggle("".concat(e.Class.target,"--").concat(t),n)}},{key:"make",value:function(){this.nodes.target=Object(a.make)("figure",[e.Class.target]),this.nodes.imageLoader=Object(a.make)("div",[e.Class.imageLoader]),this.nodes.fileButton=this.createFileButton(),this.nodes.imagePreloader=Object(a.make)("div",e.Class.imagePreloader),this.nodes.imageContainer=Object(a.make)("div",e.Class.imageContainer),this.nodes.imageEditor=Object(a.make)("div",[e.Class.imageEditor]),this.nodes.caption=Object(a.make)("figcaption",[e.Class.caption],{contentEditable:!0,placeholder:"\u8f93\u5165\u56fe\u7247\u63cf\u8ff0"}),this.nodes.imageLoader.appendChild(this.nodes.imagePreloader),this.nodes.target.appendChild(this.nodes.imageLoader),this.nodes.target.appendChild(this.nodes.imageContainer),this.nodes.target.appendChild(this.nodes.imageEditor),this.nodes.target.appendChild(this.nodes.fileButton),this.nodes.target.appendChild(this.nodes.caption)}}],[{key:"Class",get:function(){return{target:"be-image",imageLoader:"beui-image__loader",imageContainer:"beui-image__container",imageEditor:"beui-image__editor",imagePreloader:"beui-image__preloader",image:"be-image__img",caption:"be-image__caption"}}},{key:"status",get:function(){return{EMPTY:"empty",UPLOADING:"loading",FILLED:"filled"}}}]),e}()},632:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var i=n(7),o=n(6),a=n(518),s=n(743).default,r=(n(744).default,n(745).default,n(746).default,function(){function e(t){Object(i.a)(this,e),this._blockEditable=void 0,this._buttons=void 0,this._onChange=void 0,this._settingsClass=void 0,this._blockEditable=t.blockEditable,this._onChange=t.onChange,this._buttons=[]}return Object(o.a)(e,[{key:"render",value:function(t,n){var i=this;this._settingsClass=n;var o=Object(a.make)("div",e.Class.wrapper);return this._buttons=[],e.settings.forEach((function(n){var s=n.title,r=Object(a.make)("div",[i._settingsClass.settingsButton,e.Class.button],{title:s});r.innerHTML=n.icon,r.addEventListener("click",(function(){i.settingClicked(n.name,n.action)})),r.dataset.setting=n.name,r.classList.toggle(i._settingsClass.settingsButtonActive,t[n.name]),i._buttons.push(r),i.api.tooltip.onHover(r,s,{placement:"top"}),o.appendChild(r)})),o}},{key:"settingClicked",value:function(e,t){if("function"===typeof t&&!t(e))return!1;var n=this._buttons.find((function(t){return t.dataset.setting===e}));n&&(n.classList.toggle(this._settingsClass.settingsButtonActive,!n.classList.contains(this._settingsClass.settingsButtonActive)),this._onChange(e))}},{key:"api",get:function(){return this._blockEditable.state}}],[{key:"settings",get:function(){return[{name:"withCaption",icon:s,title:"With caption"}]}},{key:"Class",get:function(){return{wrapper:"",button:"be-image__setting"}}}]),e}())},633:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var i=n(7),o=n(6),a=n(634),s=function(){function e(t){var n=t.config,o=t.onUpload,a=t.onError;Object(i.a)(this,e),this._config=void 0,this._onUpload=void 0,this._onError=void 0,this._config=n,this._onUpload=o,this._onError=a}return Object(o.a)(e,[{key:"uploadSelectedFile",value:function(e){var t=this,n=e.onPreview;Object(a.selectFiles)({accept:this._config.types}).then((function(e){t.uploadByFile(e[0],{onPreview:n})}))}},{key:"uploadByUrl",value:function(e){var t=this;return Promise.resolve().then((function(){t._onUpload({success:!0,file:{url:e}})}))}},{key:"uploadByFile",value:function(e,t){var n,i=this,o=t.onPreview,a=new FileReader;if(a.readAsDataURL(e),a.onload=function(e){var t;(null===(t=e.target)||void 0===t?void 0:t.result)&&o(e.target.result)},this._config.uploadImage){var s=this._config.uploadImage(e);n=s,Promise.resolve(n)===n&&s.then((function(e){i._onUpload({success:!!e,file:{url:e?e.url:""}})})).catch((function(e){i._onError()}))}}}]),e}()},634:function(e,t,n){"use strict";function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((function(t,n){var i=document.createElement("INPUT");i.type="file",e.multiple&&i.setAttribute("multiple","multiple"),e.accept&&i.setAttribute("accept",e.accept),i.style.display="none",document.body.appendChild(i),i.addEventListener("change",(function(e){var n,o=null===(n=e.target)||void 0===n?void 0:n.files;t(o),document.body.removeChild(i)}),!1),i.click()}))}n.r(t),n.d(t,"selectFiles",(function(){return i})),t.default={}},635:function(e,t,n){"use strict";n.r(t),n.d(t,"Class",(function(){return l})),n.d(t,"default",(function(){return c}));var i=n(7),o=n(6),a=n(554),s=n(636),r=n(584),l={editor:"beui-table-editor",toolBarHor:"beui-table-toolbar--hor",toolBarVer:"beui-table-toolbar--ver",plusButton:"beui-table-toolbar__plus",minusButton:"beui-table-toolbar__minus",inputField:"be-table__inp"},c=function(){function e(t,n,o){Object(i.a)(this,e),this._table=void 0,this._container=void 0,this._verticalToolBar=void 0,this._horizontalToolBar=void 0,this._hoveredCell=void 0,this._activatedToolBar=void 0,this._hoveredCellSide=void 0,this._plusButDelay=void 0,this._toolbarShowDelay=void 0,this._blockEditable=void 0,this._blockEditable=n,this._table=new r.Table;var c=this.resizeTable(t,o||{rows:2,cols:2});this.fillTable(t,c),this._container=Object(a.create)("div",[l.editor],null,[this._table.htmlElement]),this._verticalToolBar=new s.VerticalBorderToolBar,this._horizontalToolBar=new s.HorizontalBorderToolBar,this._table.htmlElement.appendChild(this._horizontalToolBar.htmlElement),this._table.htmlElement.appendChild(this._verticalToolBar.htmlElement),this._hoveredCell=null,this._activatedToolBar=null,this._hoveredCellSide=null,this.hangEvents()}return Object(o.a)(e,[{key:"fillTable",value:function(e,t){if(void 0!==e.head&&this._table.head)for(var n=t.rows+1,i=0;i<n&&i<e.head.length;i++)for(var o=0;o<t.cols&&o<e.head[i].length;o++){var a=this._table.head.rows[i].cells[o].querySelector("."+l.inputField);a&&(a.innerHTML=e.head[i][o])}if(void 0!==e.body)for(var s=0;s<t.rows&&s<e.body.length;s++)for(var r=0;r<t.cols&&r<e.body[s].length;r++){var c=this._table.body.rows[s].cells[r].querySelector("."+l.inputField);c&&(c.innerHTML=e.body[s][r])}}},{key:"resizeTable",value:function(e,t){var n=Array.isArray(e.body),i=Array.isArray(e.head),o=e.head||[],a=!!i&&o.length?o[0].length:void 0,s=e.body||[],r=!!n&&s.length,l=n?s.length:void 0,c=r?s[0].length:void 0,u=t.rows,d=t.cols,h=(isNaN(u),!isNaN(d)&&d>0?d:void 0),p=l||0,f=c||a||h||2;this._table.addHead();for(var v=0;v<p;v++)this._table.addRow();for(var b=0;b<f;b++)this._table.addColumn();return{rows:p,cols:f}}},{key:"showToolBar",value:function(e,t){this.hideToolBar(),this._activatedToolBar=e,null===e||void 0===e||e.showIn(t)}},{key:"hideToolBar",value:function(){null!==this._activatedToolBar&&this._activatedToolBar.hide()}},{key:"hangEvents",value:function(){var e=this;this._container.addEventListener("mouseInActivatingArea",(function(t){e.toolbarCalling(t)})),this._container.addEventListener("click",(function(t){e.clickToolbar(t)})),this._container.addEventListener("input",(function(){e.hideToolBar()})),this._container.addEventListener("keydown",(function(t){e.containerKeydown(t)})),this._container.addEventListener("mouseout",(function(t){e.leaveDetectArea(t)})),this._container.addEventListener("mouseover",(function(t){e.mouseEnterInDetectArea(t)}))}},{key:"mouseInActivatingAreaListener",value:function(e,t){if(e){this._hoveredCellSide=t.side;var n=Object(a.getCoords)(this._container);if(this._hoveredCell=e.closest("TD,TH"),null!==this._hoveredCell&&("TH"!==this._hoveredCell.tagName||"top"!==this._hoveredCellSide&&"bottom"!==this._hoveredCellSide)){var i=Object(a.getCoords)(this._hoveredCell);"top"===this._hoveredCellSide&&this.showToolBar(this._horizontalToolBar,i.y1-n.y1),"bottom"===this._hoveredCellSide&&this.showToolBar(this._horizontalToolBar,i.y2-n.y1),"left"===this._hoveredCellSide&&this.showToolBar(this._verticalToolBar,i.x1-n.x1),"right"===this._hoveredCellSide&&this.showToolBar(this._verticalToolBar,i.x2-n.x1)}}}},{key:"isToolbar",value:function(e){return!(!e.closest("."+l.toolBarHor)&&!e.closest("."+l.toolBarVer))}},{key:"isToolbarButton",value:function(e){return!(!e.closest(".".concat(l.plusButton))&&!e.closest(".".concat(l.minusButton)))}},{key:"isToolbarPlusButton",value:function(e){return!!e.closest(".".concat(l.plusButton))}},{key:"isToolbarMinusButton",value:function(e){return!!e.closest(".".concat(l.minusButton))}},{key:"leaveDetectArea",value:function(e){e.relatedTarget&&!this.isToolbar(e.relatedTarget)&&(clearTimeout(this._toolbarShowDelay),this.hideToolBar())}},{key:"toolbarCalling",value:function(e){var t=this;if(e.target&&!this.isToolbar(e.target)){var n=e.target,i=e.detail;clearTimeout(this._toolbarShowDelay),this._toolbarShowDelay=window.setTimeout((function(){t.mouseInActivatingAreaListener(n,i)}),100)}}},{key:"clickToolbar",value:function(e){var t;if(e.target&&this.isToolbarButton(e.target))if(this._activatedToolBar===this._horizontalToolBar?(this.isToolbarPlusButton(e.target)?this.addRow():this.deleteRow(),t="y"):(this.isToolbarPlusButton(e.target)?this.addColumn():this.deleteColumn(),t="x"),isNaN(e.detail)&&null!==e.detail){var n,i=e.detail,o=Object(a.getCoords)(this._table.htmlElement);n="x"===t?i.x-o.x1:i.y-o.y1,this.delayAddButtonForMultiClickingNearMouse(n)}else this.hideToolBar()}},{key:"containerKeydown",value:function(e){if(13===e.keyCode){var t=this._blockEditable.state.ui;if(t.someToolbarOpened&&t.someFlipperButtonFocused)return;e.shiftKey?this.addColumn(!0):this.containerEnterPressed(e),e.preventDefault()}}},{key:"delayAddButtonForMultiClickingNearMouse",value:function(e){var t,n=this;this.showToolBar(this._activatedToolBar,e),null===(t=this._activatedToolBar)||void 0===t||t.hideLine(),clearTimeout(this._plusButDelay),this._plusButDelay=window.setTimeout((function(){n.hideToolBar()}),500)}},{key:"getHoveredSideOfContainer",value:function(){return this._hoveredCell===this._container?this.isBottomOrRight()?0:-1:1}},{key:"isBottomOrRight",value:function(){return"bottom"===this._hoveredCellSide||"right"===this._hoveredCellSide}},{key:"addRow",value:function(){var e,t=null===(e=this._hoveredCell)||void 0===e?void 0:e.closest("TR"),n=this.getHoveredSideOfContainer();1===n&&t&&(n=t.sectionRowIndex,n+=this.isBottomOrRight()?1:0),this._table.addRow(n)}},{key:"addColumn",value:function(e){var t=this.getHoveredSideOfContainer();1===t&&this._hoveredCell&&(t=this._hoveredCell.cellIndex,t+=e||this.isBottomOrRight()?1:0),this._table.addColumn(t)}},{key:"deleteRow",value:function(){var e,t=null===(e=this._hoveredCell)||void 0===e?void 0:e.closest("TR"),n=this.getHoveredSideOfContainer();1===n&&t&&(n=t.sectionRowIndex,n+=this.isBottomOrRight()?1:0),this._table.deleteRow(n)}},{key:"deleteColumn",value:function(){var e=this.getHoveredSideOfContainer();1===e&&this._hoveredCell&&(e=this._hoveredCell.cellIndex,e+=this.isBottomOrRight()?1:0),this._table.deleteColumn(e)}},{key:"containerEnterPressed",value:function(e){if(null!==this._table.selectedCell&&!e.shiftKey){var t=this._table.selectedCell.closest("TR"),n=this.getHoveredSideOfContainer();this._table.selectedCell.closest("THEAD")?n=0:1===n&&(n=t.sectionRowIndex+1),this._table.addRow(n).cells[0].click()}}},{key:"mouseEnterInDetectArea",value:function(e){var t=Object(a.getCoords)(this._container),n=Object(a.getSideByCoords)(t,e.pageX,e.pageY);e.target.dispatchEvent(new CustomEvent("mouseInActivatingArea",{detail:{side:n},bubbles:!0}))}},{key:"htmlElement",get:function(){return this._container}}]),e}()},636:function(e,t,n){"use strict";n.r(t),n.d(t,"HorizontalBorderToolBar",(function(){return C})),n.d(t,"VerticalBorderToolBar",(function(){return x}));var i=n(10),o=n(9),a=n(7),s=n(6),r=n(554),l=n(759).default,c=n(760).default,u="beui-table-toolbar",d="beui-table-toolbar--hidden",h="beui-table-toolbar--hor",p="beui-table-toolbar__shine-line--hor",f="beui-table-toolbar--ver",v="beui-table-toolbar__shine-line--ver",b="beui-table-toolbar__plus",m="beui-table-toolbar__plus--add",g="beui-table-toolbar__plus--ver",k="beui-table-toolbar__minus",y="tc-table__area",_=function(){function e(){Object(a.a)(this,e),this._plusButton=void 0,this._minusButton=void 0,this._highlightingLine=void 0,this._toolbar=void 0,this._plusButton=this.generatePlusButton(),this._minusButton=this.generateMinusButton(),this._highlightingLine=this.generateHighlightingLine(),this._toolbar=this.generateToolBar([this._plusButton,this._highlightingLine,this._minusButton])}return Object(s.a)(e,[{key:"hide",value:function(){this._toolbar.classList.add(d)}},{key:"show",value:function(){this._toolbar.classList.remove(d),this._highlightingLine.classList.remove(d)}},{key:"hideLine",value:function(){this._highlightingLine.classList.add(d)}},{key:"generatePlusButton",value:function(){var e=Object(r.create)("div",[b]);return e.innerHTML=l,e}},{key:"generateMinusButton",value:function(){var e=Object(r.create)("div",[k]);return e.innerHTML=c,e}},{key:"generateHighlightingLine",value:function(){var e=this,t=Object(r.create)("div",[u]);return t.addEventListener("click",(function(t){t.stopPropagation();var n=new CustomEvent("click",{bubbles:!0});e._toolbar.dispatchEvent(n)})),t}},{key:"generateToolBar",value:function(e){var t=this,n=Object(r.create)("div",[d],null,e);return n.addEventListener("mouseleave",(function(e){t.recalcMousePos(e)})),n}},{key:"recalcMousePos",value:function(e){this.hide();var t=document.elementFromPoint(e.pageX,e.pageY);if(null!==t&&t.classList.contains(y)){var n=new MouseEvent("mouseover",{clientX:e.pageX,clientY:e.pageY});t.dispatchEvent(n)}}},{key:"htmlElement",get:function(){return this._toolbar}}]),e}(),C=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.call(this))._toolbar.classList.add(h),e._plusButton.classList.add(m),e._highlightingLine.classList.add(p),e}return Object(s.a)(n,[{key:"showIn",value:function(e){var t=Math.floor(Number.parseInt(window.getComputedStyle(this._toolbar).height)/2);this._toolbar.style.top=e-t+"px",this.show()}}]),n}(_),x=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.call(this))._toolbar.classList.add(f),e._plusButton.classList.add(g),e._highlightingLine.classList.add(v),e}return Object(s.a)(n,[{key:"showIn",value:function(e){var t=Math.floor(Number.parseInt(window.getComputedStyle(this._toolbar).width)/2);this._toolbar.style.left=e-t+"px",this.show()}}]),n}(_)},637:function(e,t,n){},640:function(e,t,n){var i=n(806);e.exports="string"===typeof i?i:i.toString()},641:function(e,t,n){var i=n(807);e.exports="string"===typeof i?i:i.toString()},642:function(e,t,n){"use strict";n.r(t),t.default='<svg width="10" height="14" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 14">\n  <path d="M7.6 8.15H2.25v4.525a1.125 1.125 0 0 1-2.25 0V1.125a1.125 1.125 0 1 1 2.25 0V5.9H7.6V1.125a1.125 1.125 0 0 1 2.25 0v11.55a1.125 1.125 0 0 1-2.25 0V8.15z"/>\n</svg>\n'},643:function(e,t,n){"use strict";n.r(t),t.default='<svg width="16" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.14 1.494V4.98h4.62V1.494c0-.498.098-.871.293-1.12A.927.927 0 0 1 7.82 0c.322 0 .583.123.782.37.2.246.3.62.3 1.124v9.588c0 .503-.101.88-.303 1.128a.957.957 0 0 1-.779.374.921.921 0 0 1-.77-.378c-.193-.251-.29-.626-.29-1.124V6.989H2.14v4.093c0 .503-.1.88-.302 1.128a.957.957 0 0 1-.778.374.921.921 0 0 1-.772-.378C.096 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.285.374A.922.922 0 0 1 1.06 0c.321 0 .582.123.782.37.199.246.299.62.299 1.124zm11.653 9.985V5.27c-1.279.887-2.14 1.33-2.583 1.33a.802.802 0 0 1-.563-.228.703.703 0 0 1-.245-.529c0-.232.08-.402.241-.511.161-.11.446-.25.854-.424.61-.259 1.096-.532 1.462-.818a5.84 5.84 0 0 0 .97-.962c.282-.355.466-.573.552-.655.085-.082.246-.123.483-.123.267 0 .481.093.642.28.161.186.242.443.242.77v7.813c0 .914-.345 1.371-1.035 1.371-.307 0-.554-.093-.74-.28-.187-.186-.28-.461-.28-.825z"/></svg>'},644:function(e,t,n){"use strict";n.r(t),t.default='<svg width="18" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.152 1.494V4.98h4.646V1.494c0-.498.097-.871.293-1.12A.934.934 0 0 1 7.863 0c.324 0 .586.123.786.37.2.246.301.62.301 1.124v9.588c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378c-.194-.251-.29-.626-.29-1.124V6.989H2.152v4.093c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378C.097 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.286.374A.929.929 0 0 1 1.066 0c.323 0 .585.123.786.37.2.246.3.62.3 1.124zm10.99 9.288h3.527c.351 0 .62.072.804.216.185.144.277.34.277.588 0 .22-.073.408-.22.56-.146.154-.368.23-.665.23h-4.972c-.338 0-.601-.093-.79-.28a.896.896 0 0 1-.284-.659c0-.162.06-.377.182-.645s.255-.478.399-.631a38.617 38.617 0 0 1 1.621-1.598c.482-.444.827-.735 1.034-.875.369-.261.676-.523.922-.787.245-.263.432-.534.56-.81.129-.278.193-.549.193-.815 0-.288-.069-.546-.206-.773a1.428 1.428 0 0 0-.56-.53 1.618 1.618 0 0 0-.774-.19c-.59 0-1.054.26-1.392.777-.045.068-.12.252-.226.554-.106.302-.225.534-.358.696-.133.162-.328.243-.585.243a.76.76 0 0 1-.56-.223c-.149-.148-.223-.351-.223-.608 0-.31.07-.635.21-.972.139-.338.347-.645.624-.92a3.093 3.093 0 0 1 1.054-.665c.426-.169.924-.253 1.496-.253.69 0 1.277.108 1.764.324.315.144.592.343.83.595.24.252.425.544.558.875.133.33.2.674.2 1.03 0 .558-.14 1.066-.416 1.523-.277.457-.56.815-.848 1.074-.288.26-.771.666-1.45 1.22-.677.554-1.142.984-1.394 1.29a3.836 3.836 0 0 0-.331.44z"/></svg>'},645:function(e,t,n){"use strict";n.r(t),t.default='<svg width="18" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.152 1.494V4.98h4.646V1.494c0-.498.097-.871.293-1.12A.934.934 0 0 1 7.863 0c.324 0 .586.123.786.37.2.246.301.62.301 1.124v9.588c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378c-.194-.251-.29-.626-.29-1.124V6.989H2.152v4.093c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378C.097 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.286.374A.929.929 0 0 1 1.066 0c.323 0 .585.123.786.37.2.246.3.62.3 1.124zm11.61 4.919c.418 0 .778-.123 1.08-.368.301-.245.452-.597.452-1.055 0-.35-.12-.65-.36-.902-.241-.252-.566-.378-.974-.378-.277 0-.505.038-.684.116a1.1 1.1 0 0 0-.426.306 2.31 2.31 0 0 0-.296.49c-.093.2-.178.388-.255.565a.479.479 0 0 1-.245.225.965.965 0 0 1-.409.081.706.706 0 0 1-.5-.22c-.152-.148-.228-.345-.228-.59 0-.236.071-.484.214-.745a2.72 2.72 0 0 1 .627-.746 3.149 3.149 0 0 1 1.024-.568 4.122 4.122 0 0 1 1.368-.214c.44 0 .842.06 1.205.18.364.12.679.294.947.52.267.228.47.49.606.79.136.3.204.622.204.967 0 .454-.099.843-.296 1.168-.198.324-.48.64-.848.95.354.19.653.408.895.653.243.245.426.516.548.813.123.298.184.619.184.964 0 .413-.083.812-.248 1.198-.166.386-.41.73-.732 1.031a3.49 3.49 0 0 1-1.147.708c-.443.17-.932.256-1.467.256a3.512 3.512 0 0 1-1.464-.293 3.332 3.332 0 0 1-1.699-1.64c-.142-.314-.214-.573-.214-.777 0-.263.085-.475.255-.636a.89.89 0 0 1 .637-.242c.127 0 .25.037.367.112a.53.53 0 0 1 .232.27c.236.63.489 1.099.759 1.405.27.306.65.46 1.14.46a1.714 1.714 0 0 0 1.46-.824c.17-.273.256-.588.256-.947 0-.53-.145-.947-.436-1.249-.29-.302-.694-.453-1.212-.453-.09 0-.231.01-.422.028-.19.018-.313.027-.367.027-.25 0-.443-.062-.579-.187-.136-.125-.204-.299-.204-.521 0-.218.081-.394.245-.528.163-.134.406-.2.728-.2h.28z"/></svg>'},646:function(e,t,n){"use strict";n.r(t),t.default='<svg width="20" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.152 1.494V4.98h4.646V1.494c0-.498.097-.871.293-1.12A.934.934 0 0 1 7.863 0c.324 0 .586.123.786.37.2.246.301.62.301 1.124v9.588c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378c-.194-.251-.29-.626-.29-1.124V6.989H2.152v4.093c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378C.097 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.286.374A.929.929 0 0 1 1.066 0c.323 0 .585.123.786.37.2.246.3.62.3 1.124zm13.003 10.09v-1.252h-3.38c-.427 0-.746-.097-.96-.29-.213-.193-.32-.456-.32-.788 0-.085.016-.171.048-.259.031-.088.078-.18.141-.276.063-.097.128-.19.195-.28.068-.09.15-.2.25-.33l3.568-4.774a5.44 5.44 0 0 1 .576-.683.763.763 0 0 1 .542-.212c.682 0 1.023.39 1.023 1.171v5.212h.29c.346 0 .623.047.832.142.208.094.313.3.313.62 0 .26-.086.45-.256.568-.17.12-.427.179-.768.179h-.41v1.252c0 .346-.077.603-.23.771-.152.168-.356.253-.612.253a.78.78 0 0 1-.61-.26c-.154-.173-.232-.427-.232-.764zm-2.895-2.76h2.895V4.91L12.26 8.823z"/></svg>'},647:function(e,t,n){"use strict";n.r(t),t.default='<svg width="18" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.152 1.494V4.98h4.646V1.494c0-.498.097-.871.293-1.12A.934.934 0 0 1 7.863 0c.324 0 .586.123.786.37.2.246.301.62.301 1.124v9.588c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378c-.194-.251-.29-.626-.29-1.124V6.989H2.152v4.093c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378C.097 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.286.374A.929.929 0 0 1 1.066 0c.323 0 .585.123.786.37.2.246.3.62.3 1.124zm14.16 2.645h-3.234l-.388 2.205c.644-.344 1.239-.517 1.783-.517.436 0 .843.082 1.222.245.38.164.712.39.998.677.286.289.51.63.674 1.025.163.395.245.82.245 1.273 0 .658-.148 1.257-.443 1.797-.295.54-.72.97-1.276 1.287-.556.318-1.197.477-1.923.477-.813 0-1.472-.15-1.978-.45-.506-.3-.865-.643-1.076-1.031-.21-.388-.316-.727-.316-1.018 0-.177.073-.345.22-.504a.725.725 0 0 1 .556-.238c.381 0 .665.22.85.66.182.404.427.719.736.943.309.225.654.337 1.035.337.35 0 .656-.09.919-.272.263-.182.466-.431.61-.749.142-.318.214-.678.214-1.082 0-.436-.078-.808-.232-1.117a1.607 1.607 0 0 0-.62-.69 1.674 1.674 0 0 0-.864-.229c-.39 0-.67.048-.837.143-.168.095-.41.262-.725.5-.316.239-.576.358-.78.358a.843.843 0 0 1-.592-.242c-.173-.16-.259-.344-.259-.548 0-.022.025-.177.075-.463l.572-3.26c.063-.39.181-.675.354-.852.172-.177.454-.265.844-.265h3.595c.708 0 1.062.27 1.062.81a.711.711 0 0 1-.26.572c-.172.145-.426.218-.762.218z"/></svg>'},648:function(e,t,n){"use strict";n.r(t),t.default='<svg width="18" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.152 1.494V4.98h4.646V1.494c0-.498.097-.871.293-1.12A.934.934 0 0 1 7.863 0c.324 0 .586.123.786.37.2.246.301.62.301 1.124v9.588c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378c-.194-.251-.29-.626-.29-1.124V6.989H2.152v4.093c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378C.097 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.286.374A.929.929 0 0 1 1.066 0c.323 0 .585.123.786.37.2.246.3.62.3 1.124zM12.53 7.058a3.093 3.093 0 0 1 1.004-.814 2.734 2.734 0 0 1 1.214-.264c.43 0 .827.08 1.19.24.365.161.684.39.957.686.274.296.485.645.635 1.048a3.6 3.6 0 0 1 .223 1.262c0 .637-.145 1.216-.437 1.736-.292.52-.699.926-1.221 1.218-.522.292-1.114.438-1.774.438-.76 0-1.416-.186-1.967-.557-.552-.37-.974-.919-1.265-1.645-.292-.726-.438-1.613-.438-2.662 0-.855.088-1.62.265-2.293.176-.674.43-1.233.76-1.676.33-.443.73-.778 1.2-1.004.47-.226 1.006-.339 1.608-.339.579 0 1.089.113 1.53.34.44.225.773.506.997.84.224.335.335.656.335.964 0 .185-.07.354-.21.505a.698.698 0 0 1-.536.227.874.874 0 0 1-.529-.18 1.039 1.039 0 0 1-.36-.498 1.42 1.42 0 0 0-.495-.655 1.3 1.3 0 0 0-.786-.247c-.24 0-.479.069-.716.207a1.863 1.863 0 0 0-.6.56c-.33.479-.525 1.333-.584 2.563zm1.832 4.213c.456 0 .834-.186 1.133-.56.298-.373.447-.862.447-1.468 0-.412-.07-.766-.21-1.062a1.584 1.584 0 0 0-.577-.678 1.47 1.47 0 0 0-.807-.234c-.28 0-.548.074-.804.224-.255.149-.461.365-.617.647a2.024 2.024 0 0 0-.234.994c0 .61.158 1.12.475 1.527.316.407.714.61 1.194.61z"/></svg>'},649:function(e,t,n){var i=n(809);e.exports="string"===typeof i?i:i.toString()},650:function(e,t,n){var i=n(810);e.exports="string"===typeof i?i:i.toString()},651:function(e,t,n){"use strict";n.r(t),t.default='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0.2 -0.3 9 11.4" width="12" height="14">\n    <path d="M0 2.77V.92A1 1 0 01.2.28C.35.1.56 0 .83 0h7.66c.28.01.48.1.63.28.14.17.21.38.21.64v1.85c0 .26-.08.48-.23.66-.15.17-.37.26-.66.26-.28 0-.5-.09-.64-.26a1 1 0 01-.21-.66V1.69H5.6v7.58h.5c.25 0 .45.08.6.23.17.16.25.35.25.6s-.08.45-.24.6a.87.87 0 01-.62.22H3.21a.87.87 0 01-.61-.22.78.78 0 01-.24-.6c0-.25.08-.44.24-.6a.85.85 0 01.61-.23h.5V1.7H1.73v1.08c0 .26-.08.48-.23.66-.15.17-.37.26-.66.26-.28 0-.5-.09-.64-.26A1 1 0 010 2.77z"/>\n</svg>'},652:function(e,t,n){var i=n(846);e.exports="string"===typeof i?i:i.toString()},653:function(e,t,n){var i=n(847);e.exports="string"===typeof i?i:i.toString()},654:function(e,t,n){var i=n(848);e.exports="string"===typeof i?i:i.toString()},655:function(e,t,n){"use strict";n.r(t),t.default='<svg width="14" height="14" viewBox="0 -1 14 14" xmlns="http://www.w3.org/2000/svg" ><path d="M3.177 6.852c.205.253.347.572.427.954.078.372.117.844.117 1.417 0 .418.01.725.03.92.02.18.057.314.107.396.046.075.093.117.14.134.075.027.218.056.42.083a.855.855 0 0 1 .56.297c.145.167.215.38.215.636 0 .612-.432.934-1.216.934-.457 0-.87-.087-1.233-.262a1.995 1.995 0 0 1-.853-.751 2.09 2.09 0 0 1-.305-1.097c-.014-.648-.029-1.168-.043-1.56-.013-.383-.034-.631-.06-.733-.064-.263-.158-.455-.276-.578a2.163 2.163 0 0 0-.505-.376c-.238-.134-.41-.256-.519-.371C.058 6.76 0 6.567 0 6.315c0-.37.166-.657.493-.846.329-.186.56-.342.693-.466a.942.942 0 0 0 .26-.447c.056-.2.088-.42.097-.658.01-.25.024-.85.043-1.802.015-.629.239-1.14.672-1.522C2.691.19 3.268 0 3.977 0c.783 0 1.216.317 1.216.921 0 .264-.069.48-.211.643a.858.858 0 0 1-.563.29c-.249.03-.417.076-.498.126-.062.04-.112.134-.139.291-.031.187-.052.562-.061 1.119a8.828 8.828 0 0 1-.112 1.378 2.24 2.24 0 0 1-.404.963c-.159.212-.373.406-.64.583.25.163.454.342.612.538zm7.34 0c.157-.196.362-.375.612-.538a2.544 2.544 0 0 1-.641-.583 2.24 2.24 0 0 1-.404-.963 8.828 8.828 0 0 1-.112-1.378c-.009-.557-.03-.932-.061-1.119-.027-.157-.077-.251-.14-.29-.08-.051-.248-.096-.496-.127a.858.858 0 0 1-.564-.29C8.57 1.401 8.5 1.185 8.5.921 8.5.317 8.933 0 9.716 0c.71 0 1.286.19 1.72.574.432.382.656.893.671 1.522.02.952.033 1.553.043 1.802.009.238.041.458.097.658a.942.942 0 0 0 .26.447c.133.124.364.28.693.466a.926.926 0 0 1 .493.846c0 .252-.058.446-.183.58-.109.115-.281.237-.52.371-.21.118-.377.244-.504.376-.118.123-.212.315-.277.578-.025.102-.045.35-.06.733-.013.392-.027.912-.042 1.56a2.09 2.09 0 0 1-.305 1.097c-.2.323-.486.574-.853.75a2.811 2.811 0 0 1-1.233.263c-.784 0-1.216-.322-1.216-.934 0-.256.07-.47.214-.636a.855.855 0 0 1 .562-.297c.201-.027.344-.056.418-.083.048-.017.096-.06.14-.134a.996.996 0 0 0 .107-.396c.02-.195.031-.502.031-.92 0-.573.039-1.045.117-1.417.08-.382.222-.701.427-.954z" /></svg>'},656:function(e,t,n){"use strict";n.r(t),t.default={}},657:function(e,t){},658:function(e,t,n){var i=n(849);e.exports="string"===typeof i?i:i.toString()},659:function(e,t,n){var i=n(850);e.exports="string"===typeof i?i:i.toString()},660:function(e,t,n){var i=n(851);e.exports="string"===typeof i?i:i.toString()},661:function(e,t,n){"use strict";n.r(t),t.default='<svg width="19" height="4" viewBox="0 0 19 4" xmlns="http://www.w3.org/2000/svg"><path d="M1.25 0H7a1.25 1.25 0 1 1 0 2.5H1.25a1.25 1.25 0 1 1 0-2.5zM11 0h5.75a1.25 1.25 0 0 1 0 2.5H11A1.25 1.25 0 0 1 11 0z"/></svg>'},734:function(e,t,n){var i=n(1077);e.exports="string"===typeof i?i:i.toString()},735:function(e,t,n){var i=n(1078);e.exports="string"===typeof i?i:i.toString()},736:function(e,t,n){var i=n(1079);e.exports="string"===typeof i?i:i.toString()},737:function(e,t,n){"use strict";n.r(t),t.default='<svg viewBox="0 0 1024 1024" width="14" height="14"><path d="M165.25687 0C74.615623 0 0 74.615623 0 165.25687c0 71.189998 46.462499 131.906246 110.171247 154.94062v230.619368h110.171246V320.11874c63.708748-22.916249 110.131872-83.671872 110.131872-154.86187C330.474365 74.615623 255.858742 0 165.25687 0z m660.94873 0a165.25687 165.25687 0 0 0-155.531245 110.171247H440.606237v110.171246h229.949993a165.25687 165.25687 0 0 0 272.474991 61.739998A165.25687 165.25687 0 0 0 826.166225 0zM165.25687 110.171247c31.066874 0 55.085623 24.018749 55.085623 55.085623s-24.018749 55.085623-55.124998 55.085623c-31.027499 0-55.046248-24.018749-55.046248-55.124998 0-31.027499 24.018749-55.046248 55.085623-55.046248z m605.863106 330.474365v220.342493l-126.275621 126.275621a55.085623 55.085623 0 0 0 0 77.883748l142.419371 142.458745a55.006873 55.006873 0 0 0 77.883748 0l142.458745-142.458745a55.006873 55.006873 0 0 0 0-77.883748l-126.314996-126.275621V440.606237h-110.171247zM55.124998 660.988105c-30.436874 0-55.085623 24.648749-55.085623 55.085623v220.303118c0 30.436874 24.648749 55.085623 55.085623 55.085624h220.303119c30.436874 0 55.124998-24.648749 55.124998-55.085624v-220.303118c0-30.436874-24.688124-55.124998-55.124998-55.124998H55.124998z" fill="currentColor" ></path></svg>'},738:function(e,t,n){var i=n(1081);e.exports="string"===typeof i?i:i.toString()},739:function(e,t,n){var i=n(1082);e.exports="string"===typeof i?i:i.toString()},740:function(e,t,n){var i=n(1083);e.exports="string"===typeof i?i:i.toString()},741:function(e,t,n){"use strict";n.r(t),t.default='<svg fill="currentColor" viewBox="0 0 1024 1024" width="24" height="24"><path d="M807.68 574.72h-105.408l-98.272-170.24h6.4a35.808 35.808 0 0 0 35.84-35.84V216.32a35.808 35.808 0 0 0-35.84-35.84H413.44a35.808 35.808 0 0 0-35.84 35.84v152.32a35.808 35.808 0 0 0 35.84 35.84h6.56l-98.272 170.24H216.32a35.808 35.808 0 0 0-35.84 35.84v152.32a35.808 35.808 0 0 0 35.84 35.84h197.12a35.808 35.808 0 0 0 35.84-35.84v-152.32a35.808 35.808 0 0 0-35.84-35.84h-29.664l98.304-170.24h59.84l98.272 170.24h-29.632a35.808 35.808 0 0 0-35.84 35.84v152.32a35.808 35.808 0 0 0 35.84 35.84h197.12a35.808 35.808 0 0 0 35.84-35.84v-152.32a35.808 35.808 0 0 0-35.84-35.84z" fill="currentColor"></path></svg>'},742:function(e,t,n){"use strict";n.r(t),t.default='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1625210778645" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3827" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32"><defs><style type="text/css"></style></defs><path d="M883.6 926.7H140.4c-42.1 0-76.4-35.9-76.4-80V577.8c0-22.1 17.9-40 40-40s40 17.9 40 40v268.9h736V577.8c0-22.1 17.9-40 40-40s40 17.9 40 40v268.9c0 44.1-34.3 80-76.4 80z" fill="currentColor" p-id="3828"></path><path d="M512 744.2c-22.1 0-40-17.9-40-40V104.6c0-22.1 17.9-40 40-40s40 17.9 40 40v599.6c0 22.1-17.9 40-40 40z" fill="currentColor" p-id="3829"></path><path d="M320 335.9c-10.2 0-20.5-3.9-28.3-11.7-15.6-15.6-15.6-40.9 0-56.6L481.6 77.8c4.5-4.5 13.9-13.9 30.4-13.9 10.6 0 20.8 4.2 28.3 11.7l192 192c15.6 15.6 15.6 40.9 0 56.6s-40.9 15.6-56.6 0L512 160.5 348.3 324.2c-7.8 7.8-18.1 11.7-28.3 11.7z" fill="currentColor" p-id="3830"></path></svg>'},743:function(e,t,n){"use strict";n.r(t),t.default='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1624683024317" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1825" xmlns:xlink="http://www.w3.org/1999/xlink" width="128" height="128"><defs><style type="text/css"></style></defs><path d="M641.365333 536.576v-142.336h-142.336V249.856a313.685333 313.685333 0 1 0 252.586667 307.2v-20.821333z m-69.973333 144.042667H304.128v-55.637334h267.264z m0-156.330667H304.128v-55.637333h267.264z" p-id="1826"></path><path d="M751.616 284.330667V141.994667h-68.608v142.336h-142.336v68.266666h142.336v142.336h68.608v-142.336h142.336v-68.266666h-142.336z" p-id="1827"></path></svg>'},744:function(e,t,n){"use strict";n.r(t),t.default='<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.043 8.265l3.183-3.183h-2.924L4.75 10.636v2.923l4.15-4.15v2.351l-2.158 2.159H8.9v2.137H4.7c-1.215 0-2.2-.936-2.2-2.09v-8.93c0-1.154.985-2.09 2.2-2.09h10.663l.033-.033.034.034c1.178.04 2.12.96 2.12 2.089v3.23H15.3V5.359l-2.906 2.906h-2.35zM7.951 5.082H4.75v3.201l3.201-3.2zm5.099 7.078v3.04h4.15v-3.04h-4.15zm-1.1-2.137h6.35c.635 0 1.15.489 1.15 1.092v5.13c0 .603-.515 1.092-1.15 1.092h-6.35c-.635 0-1.15-.489-1.15-1.092v-5.13c0-.603.515-1.092 1.15-1.092z"/></svg>'},745:function(e,t,n){"use strict";n.r(t),t.default='<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M15.8 10.592v2.043h2.35v2.138H15.8v2.232h-2.25v-2.232h-2.4v-2.138h2.4v-2.28h2.25v.237h1.15-1.15zM1.9 8.455v-3.42c0-1.154.985-2.09 2.2-2.09h4.2v2.137H4.15v3.373H1.9zm0 2.137h2.25v3.325H8.3v2.138H4.1c-1.215 0-2.2-.936-2.2-2.09v-3.373zm15.05-2.137H14.7V5.082h-4.15V2.945h4.2c1.215 0 2.2.936 2.2 2.09v3.42z"/></svg>'},746:function(e,t,n){"use strict";n.r(t),t.default='<svg width="17" height="10" viewBox="0 0 17 10" xmlns="http://www.w3.org/2000/svg"><path d="M13.568 5.925H4.056l1.703 1.703a1.125 1.125 0 0 1-1.59 1.591L.962 6.014A1.069 1.069 0 0 1 .588 4.26L4.38.469a1.069 1.069 0 0 1 1.512 1.511L4.084 3.787h9.606l-1.85-1.85a1.069 1.069 0 1 1 1.512-1.51l3.792 3.791a1.069 1.069 0 0 1-.475 1.788L13.514 9.16a1.125 1.125 0 0 1-1.59-1.591l1.644-1.644z"/></svg>'},747:function(e,t,n){var i=n(1085);e.exports="string"===typeof i?i:i.toString()},748:function(e,t,n){var i=n(1086);e.exports="string"===typeof i?i:i.toString()},749:function(e,t,n){"use strict";n.r(t),t.default='<svg width="17" height="15" viewBox="0 0 336 276" xmlns="http://www.w3.org/2000/svg"><path d="M291 150.242V79c0-18.778-15.222-34-34-34H79c-18.778 0-34 15.222-34 34v42.264l67.179-44.192 80.398 71.614 56.686-29.14L291 150.242zm-.345 51.622l-42.3-30.246-56.3 29.884-80.773-66.925L45 174.187V197c0 18.778 15.222 34 34 34h178c17.126 0 31.295-12.663 33.655-29.136zM79 0h178c43.63 0 79 35.37 79 79v118c0 43.63-35.37 79-79 79H79c-43.63 0-79-35.37-79-79V79C0 35.37 35.37 0 79 0z"/></svg>'},750:function(e,t,n){var i=n(1087);e.exports="string"===typeof i?i:i.toString()},751:function(e,t,n){var i=n(1088);e.exports="string"===typeof i?i:i.toString()},752:function(e,t,n){"use strict";n.r(t),t.default='<svg width="17" height="13" viewBox="0 0 17 13" xmlns="http://www.w3.org/2000/svg"><path d="M5.625 4.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm0-4.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm0 9.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm-4.5-5a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25zm0-4.85a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25zm0 9.85a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25z"/></svg>'},753:function(e,t,n){"use strict";n.r(t),t.default='<svg width="17" height="13" viewBox="0 0 17 13" xmlns="http://www.w3.org/2000/svg"> <path d="M5.625 4.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm0-4.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm0 9.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm-4.5-5a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25zm0-4.85a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25zm0 9.85a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25z"/></svg>'},754:function(e,t,n){"use strict";n.r(t),t.default='<svg width="17" height="13" viewBox="0 0 17 13" xmlns="http://www.w3.org/2000/svg"><path d="M5.819 4.607h9.362a1.069 1.069 0 0 1 0 2.138H5.82a1.069 1.069 0 1 1 0-2.138zm0-4.607h9.362a1.069 1.069 0 0 1 0 2.138H5.82a1.069 1.069 0 1 1 0-2.138zm0 9.357h9.362a1.069 1.069 0 0 1 0 2.138H5.82a1.069 1.069 0 0 1 0-2.137zM1.468 4.155V1.33c-.554.404-.926.606-1.118.606a.338.338 0 0 1-.244-.104A.327.327 0 0 1 0 1.59c0-.107.035-.184.105-.234.07-.05.192-.114.369-.192.264-.118.475-.243.633-.373.158-.13.298-.276.42-.438a3.94 3.94 0 0 1 .238-.298C1.802.019 1.872 0 1.975 0c.115 0 .208.042.277.127.07.085.105.202.105.351v3.556c0 .416-.15.624-.448.624a.421.421 0 0 1-.32-.127c-.08-.085-.121-.21-.121-.376zm-.283 6.664h1.572c.156 0 .275.03.358.091a.294.294 0 0 1 .123.25.323.323 0 0 1-.098.238c-.065.065-.164.097-.296.097H.629a.494.494 0 0 1-.353-.119.372.372 0 0 1-.126-.28c0-.068.027-.16.081-.273a.977.977 0 0 1 .178-.268c.267-.264.507-.49.722-.678.215-.188.368-.312.46-.371.165-.11.302-.222.412-.334.109-.112.192-.226.25-.344a.786.786 0 0 0 .085-.345.6.6 0 0 0-.341-.553.75.75 0 0 0-.345-.08c-.263 0-.47.11-.62.329-.02.029-.054.107-.101.235a.966.966 0 0 1-.16.295c-.059.069-.145.103-.26.103a.348.348 0 0 1-.25-.094.34.34 0 0 1-.099-.258c0-.132.031-.27.093-.413.063-.143.155-.273.279-.39.123-.116.28-.21.47-.282.189-.072.411-.107.666-.107.307 0 .569.045.786.137a1.182 1.182 0 0 1 .618.623 1.18 1.18 0 0 1-.096 1.083 2.03 2.03 0 0 1-.378.457c-.128.11-.344.282-.646.517-.302.235-.509.417-.621.547a1.637 1.637 0 0 0-.148.187z"/></svg>'},755:function(e,t,n){var i=n(1092);e.exports="string"===typeof i?i:i.toString()},756:function(e,t,n){var i=n(1093);e.exports="string"===typeof i?i:i.toString()},757:function(e,t,n){var i=n(1094);e.exports="string"===typeof i?i:i.toString()},758:function(e,t,n){"use strict";n.r(t),t.default='<svg viewBox="0 0 1088 1024" width="16" height="14"><path d="M829.508267 999.424c50.107733 0 82.5344-30.993067 82.5344-78.165333 0-47.172267-32.426667-78.848-81.851734-78.848H367.547733v-8.465067l169.301334-240.8448c26.760533-38.024533 35.2256-58.436267 35.2256-83.080533 0-25.326933-9.8304-47.854933-40.209067-89.429334L374.5792 203.025067V195.242667h453.495467c47.3088 0 80.418133-31.675733 80.418133-78.165334 0-46.421333-33.109333-78.848-80.418133-78.848H231.424C167.936 38.229333 130.525867 70.587733 130.525867 126.293333c0 28.125867 12.6976 55.569067 43.690666 97.826134l210.944 292.181333-212.309333 300.714667c-40.891733 59.1872-47.240533 73.250133-47.240533 100.693333 0 50.722133 38.775467 81.7152 103.0144 81.7152h600.8832z"></path></svg>'},759:function(e,t,n){"use strict";n.r(t),t.default='<svg viewBox="0 0 20 20"><circle cx="10" cy="10" r="10" fill="#388AE5"/><path fill="#FFF" d="M10.9 9.1h3.7a.9.9 0 1 1 0 1.8h-3.7v3.7a.9.9 0 1 1-1.8 0v-3.7H5.4a.9.9 0 0 1 0-1.8h3.7V5.4a.9.9 0 0 1 1.8 0v3.7z"/></svg>'},760:function(e,t,n){"use strict";n.r(t),t.default='<svg viewBox="0 0 1024 1024" width="20" height="20" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M496.008533 112.008533c-229.751467 0-416 186.248533-416 416s186.248533 416 416 416S912.008533 757.76 912.008533 528.008533 725.76 112.008533 496.008533 112.008533zM704 540.0064c0 17.698133-14.336 32-32 32H320a31.965867 31.965867 0 0 1-32-32v-32c0-17.664 14.301867-32 32-32h352c17.664 0 32 14.336 32 32v32z" p-id="3903" fill="#d81e06"></path></svg>'},761:function(e,t,n){var i=n(1095);e.exports="string"===typeof i?i:i.toString()},762:function(e,t,n){var i=n(1096);e.exports="string"===typeof i?i:i.toString()},763:function(e,t,n){var i=n(1097);e.exports="string"===typeof i?i:i.toString()},764:function(e,t,n){"use strict";n.r(t),t.default='<svg width="18" height="14"><path d="M2.833 8v1.95a1.7 1.7 0 0 0 1.7 1.7h3.45V8h-5.15zm0-2h5.15V2.35h-3.45a1.7 1.7 0 0 0-1.7 1.7V6zm12.3 2h-5.15v3.65h3.45a1.7 1.7 0 0 0 1.7-1.7V8zm0-2V4.05a1.7 1.7 0 0 0-1.7-1.7h-3.45V6h5.15zM4.533.1h8.9a3.95 3.95 0 0 1 3.95 3.95v5.9a3.95 3.95 0 0 1-3.95 3.95h-8.9a3.95 3.95 0 0 1-3.95-3.95v-5.9A3.95 3.95 0 0 1 4.533.1z"/></svg>'},765:function(e,t,n){var i=n(1098);e.exports="string"===typeof i?i:i.toString()},766:function(e,t,n){var i=n(1099);e.exports="string"===typeof i?i:i.toString()},767:function(e,t,n){var i=n(1100);e.exports="string"===typeof i?i:i.toString()},768:function(e,t,n){"use strict";n.r(t),t.default='<svg width="15" height="15" viewBox="0 0 15 15" xmlns="http://www.w3.org/2000/svg"><path d="M7.5 15a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15zm0-2.394a5.106 5.106 0 1 0 0-10.212 5.106 5.106 0 0 0 0 10.212zm-.675-4.665l2.708-2.708 1.392 1.392-2.708 2.708-1.392 1.391-2.971-2.971L5.245 6.36l1.58 1.58z"/></svg>'},769:function(e,t,n){},771:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var i=n(7),o=n(6),a=n(0),s=n.n(a),r=n(34),l=n.n(r),c=n(1),u=n(10),d=n(9),h=n(482),p=(n(1089),n(1090),n(33)),f=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this.props,t=e.item,n=e.onSelect;return Object(c.jsx)(p.a,{wrapClassName:"math-toolbar__item",icon:Object(c.jsx)("i",{className:"gem-".concat(t.id)}),onClick:function(){n(t.tex)}})}}]),n}(a.Component);function v(e,t){return function(n){Object(u.a)(s,n);var a=Object(d.a)(s);function s(){return Object(i.a)(this,s),a.apply(this,arguments)}return Object(o.a)(s,[{key:"render",value:function(){var n=this.props.onSelect,i=e.map((function(e){return Object(c.jsx)(f,{item:e,onSelect:n},e.id)}));return Object(c.jsx)("div",{className:"math-toolbar math-toolbar--".concat(t),children:i})}}]),s}(a.Component)}var b=v([{id:"alpha_1318469421",tex:"\\alpha"},{id:"beta_170234155",tex:"\\beta"},{id:"gamma_1311936542",tex:"\\gamma"},{id:"delta_1323077121",tex:"\\delta"},{id:"epsilon_3526400827",tex:"\\epsilon"},{id:"varepsilon_960150590",tex:"\\varepsilon"},{id:"zeta_170233907",tex:"\\zeta"},{id:"eta_2087567017",tex:"\\eta"},{id:"theta_1322769205",tex:"\\theta"},{id:"vartheta_3952813808",tex:"\\vartheta"},{id:"iota_170249034",tex:"\\iota"},{id:"kappa_1326819122",tex:"\\kappa"},{id:"lambda_79015454",tex:"\\lambda"},{id:"mu_193423105",tex:"\\mu"},{id:"nu_193423138",tex:"\\nu"},{id:"xi_193418728",tex:"\\xi"},{id:"pi_193418976",tex:"\\pi"},{id:"varpi_1640113541",tex:"\\varpi"},{id:"rho_2087900556",tex:"\\rho"},{id:"varrho_4099271785",tex:"\\varrho"},{id:"sigma_1312148424",tex:"\\sigma"},{id:"varsigma_233085869",tex:"\\varsigma"},{id:"tau_2087983641",tex:"\\tau"},{id:"upsilon_3526401323",tex:"\\upsilon"},{id:"phi_2087833096",tex:"\\phi"},{id:"varphi_1675249005",tex:"\\varphi"},{id:"chi_2087832827",tex:"\\chi"},{id:"psi_2087863571",tex:"\\psi"},{id:"omega_1309716888",tex:"\\omega"},{id:"gamma_1311937598",tex:"\\Gamma"},{id:"delta_1323076193",tex:"\\Delta"},{id:"theta_1322770389",tex:"\\Theta"},{id:"lambda_79016510",tex:"\\Lambda"},{id:"xi_193417672",tex:"\\Xi"},{id:"pi_193417920",tex:"\\Pi"},{id:"sigma_1312149480",tex:"\\Sigma"},{id:"upsilon_3526402507",tex:"\\Upsilon"},{id:"phi_2087834152",tex:"\\Phi"},{id:"psi_2087862643",tex:"\\Psi"},{id:"omega_1309717944",tex:"\\Omega"}],"greek"),m=v([{id:"times_2159110463",tex:"\\times"},{id:"div_2088172514",tex:"\\div"},{id:"cdot_183307621",tex:"\\cdot"},{id:"pm_193414628",tex:"\\pm"},{id:"mp_193426244",tex:"\\mp"},{id:"ast_2087933023",tex:"\\ast"},{id:"star_194646573",tex:"\\star"},{id:"circ_177147074",tex:"\\circ"},{id:"bullet_1823366303",tex:"\\bullet"},{id:"oplus_2140408172",tex:"\\oplus"},{id:"ominus_1906208922",tex:"\\ominus"},{id:"oslash_1351473011",tex:"\\oslash"},{id:"otimes_2531166928",tex:"\\otimes"},{id:"odot_183307497",tex:"\\odot"},{id:"dagger_1389219435",tex:"\\dagger"},{id:"ddagger_2894567663",tex:"\\ddagger"},{id:"vee_2087413967",tex:"\\vee"},{id:"wedge_1162335725",tex:"\\wedge"},{id:"cap_2088096139",tex:"\\cap"},{id:"cup_2088074399",tex:"\\cup"},{id:"aleph_1603530409",tex:"\\aleph"},{id:"re_193404814",tex:"\\Re"},{id:"im_193412861",tex:"\\Im"},{id:"top_2088097970",tex:"\\top"},{id:"bot_2087963360",tex:"\\bot"},{id:"infty_2224287093",tex:"\\infty"},{id:"partial_1646186250",tex:"\\partial"},{id:"forall_4023651683",tex:"\\forall"},{id:"exists_1947215609",tex:"\\exists"},{id:"neg_2087624725",tex:"\\neg"},{id:"angle_1166132696",tex:"\\angle"},{id:"triangle_1315666263",tex:"\\triangle"},{id:"diamond_2948158269",tex:"\\diamond"}],"symbol"),g=v([{id:"leq_2088123777",tex:"\\leq"},{id:"geq_2088123562",tex:"\\geq"},{id:"prec_176608541",tex:"\\prec"},{id:"succ_176814527",tex:"\\succ"},{id:"preceq_3517413801",tex:"\\preceq"},{id:"succeq_3517341131",tex:"\\succeq"},{id:"ll_193412985",tex:"\\ll"},{id:"gg_193411929",tex:"\\gg"},{id:"equiv_1981568039",tex:"\\equiv"},{id:"sim_2087688366",tex:"\\sim"},{id:"simeq_1929181338",tex:"\\simeq"},{id:"asymp_1903012079",tex:"\\asymp"},{id:"approx_3715476797",tex:"\\approx"},{id:"ne_193405746",tex:"\\ne"},{id:"subset_1805468287",tex:"\\subset"},{id:"supset_1806220461",tex:"\\supset"},{id:"subseteq_2051895947",tex:"\\subseteq"},{id:"supseteq_2051566041",tex:"\\supseteq"},{id:"in_193419230",tex:"\\in"},{id:"ni_193418046",tex:"\\ni"},{id:"notin_1650680875",tex:"\\notin"}],"comparison"),k=v([{id:"x_a_193458981",tex:"x_{a}"},{id:"xb_193427367",tex:"x^{b}"},{id:"x_ab_3953731551",tex:"x_{a}^{b}"},{id:"barx_3677001718",tex:"\\bar{x}"},{id:"tildex_2388847703",tex:"\\tilde{x}"},{id:"fracab_2392580300",tex:"\\frac{a}{b}"},{id:"sqrtx_1093998339",tex:"\\sqrt{x}\\sqrt{x}"},{id:"sqrtnx_3625618123",tex:"\\sqrt[n]{x}"},{id:"bigcap_ab_1527652773",tex:"\\bigcap_{a}^{b}"},{id:"bigcup_ab_745232433",tex:"\\bigcup_{a}^{b}"},{id:"prod_ab_1740866194",tex:"\\prod_{a}^{b}"},{id:"coprod_ab_1722723006",tex:"\\coprod_{a}^{b}"},{id:"leftxright_308942087",tex:"\\left( x \\right)"},{id:"leftxright_1060968992",tex:"\\left[ x \\right]"},{id:"leftxright_1282332352",tex:"\\left\\{ x \\right\\}"},{id:"leftxright_791668582",tex:"\\left| x \\right|"},{id:"int_ab_3437240392",tex:"\\int_{a}^{b}"},{id:"oint_ab_1759784839",tex:"\\oint_{a}^{b}"},{id:"sum_abx_3782346798",tex:"\\sum_{a}^{b}{x}"},{id:"lim_arightarrowbx_3542561616",tex:"\\lim_{a \\rightarrow b}{x}"}],"math"),y=v([{id:"leftarrow_2463726907",tex:"\\leftarrow"},{id:"rightarrow_3982089376",tex:"\\rightarrow"},{id:"leftrightarrow_2294107771",tex:"\\leftrightarrow"},{id:"leftarrow_2463728091",tex:"\\Leftarrow"},{id:"rightarrow_3982088320",tex:"\\Rightarrow"},{id:"leftrightarrow_2294108699",tex:"\\Leftrightarrow"},{id:"uparrow_3989605765",tex:"\\uparrow"},{id:"downarrow_2479725650",tex:"\\downarrow"},{id:"updownarrow_3181819383",tex:"\\updownarrow"},{id:"uparrow_3989604837",tex:"\\Uparrow"},{id:"downarrow_2479726706",tex:"\\Downarrow"},{id:"updownarrow_3181820311",tex:"\\Updownarrow"}],"arrow"),_=(n(1091),window.MathJax),C=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(i.a)(this,n);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a)))._textInput=void 0,e._preview=void 0,e.onSelect=function(t){e.insertText(t),e.onTexChange()},e.onTexChange=function(){var t=e.props.onTeXChange,n=e._textInput,i=e._preview;n&&i&&_.tex2svgPromise(n.value).then((function(e){var o=e.outerHTML.match(/(<svg.*?>.*<\/?svg>)/);o&&(i.innerHTML=o[1],t({tex:n.value,html:o[1]}))}))},e}return Object(o.a)(n,[{key:"getMath",value:function(){var e=this._textInput,t=this._preview;return e&&t?{tex:e.value,html:t.innerHTML}:""}},{key:"insertText",value:function(e){var t=this._textInput;if(t)if(t.selectionStart||0===t.selectionStart){var n=t.selectionStart,i=t.selectionEnd;t.value=t.value.substring(0,n)+e+t.value.substring(i,t.value.length),t.focus(),t.selectionStart=n+e.length,t.selectionEnd=n+e.length}else t.value+=e,t.focus()}},{key:"componentDidMount",value:function(){if(this._textInput){var e=this.props.tex;e&&(this._textInput.value=e),0===this._textInput.selectionStart&&(this._textInput.selectionStart=this._textInput.value.length),this.onTexChange()}}},{key:"render",value:function(){var e=this;this.props.tex;return Object(c.jsxs)("div",{className:"beui-math-editor",children:[Object(c.jsxs)("div",{className:"beui-math-editor__toolbar",children:[Object(c.jsx)(h.a,{placement:"top",title:null,content:Object(c.jsx)(b,{onSelect:this.onSelect}),trigger:"hover",children:Object(c.jsx)("button",{className:"beui-math-editor__button",children:Object(c.jsx)("svg",{width:"46",height:"24",viewBox:"0 0 46 24",fill:"#8590a6",children:Object(c.jsxs)("g",{fillRule:"evenodd",children:[Object(c.jsx)("path",{fillRule:"nonzero",d:"M27.21 6.302L33 16.344H21.42l5.79-10.042zm-3.623 8.79h7.247L27.21 8.806l-3.623 6.286zM6.655 17.258C4.457 17.258 3 15.48 3 12.71c0-2.764 1.465-4.55 3.655-4.55 1.32 0 2.214.62 2.662 1.786h.13v-1.63H10.8v6.595c0 .81.227 1.05.73 1.05.14 0 .262-.01.4-.03v1.18c-.203.06-.407.08-.708.08-1.034 0-1.66-.51-1.766-1.55l-.01-.08h-.13c-.47 1.12-1.375 1.7-2.66 1.7zm7.93.325C14.52 17.91 14.29 18 14 18c-.327 0-.63-.242-.526-.655l2.135-8.483C16.12 6.785 17.48 5 19.21 5c1.36 0 2.336.942 2.336 2.082 0 1.013-.466 1.868-1.295 2.47.09.1.17.205.24.318.32.485.48 1.07.48 1.69 0 2.19-1.946 3.95-4.174 3.95-.58 0-1.132-.26-1.53-.665l-.682 2.738zm5.43-10.623c0-.55-.237-.855-.826-.855-1 0-2.05 1.303-2.49 3.053l-.88 3.566c-.04.12-.04.217-.04.393 0 .782.41 1.288 1.08 1.288.8 0 1.682-.584 2.05-1.402.3-.673.44-1.212.44-1.835 0-.466-.1-.778-.32-1.023-.34.09-.588.128-.877.128h-.07c-.175.003-.29 0-.42-.012-.527-.04-.9-.23-.9-.73 0-.52.4-.74.967-.8.156-.01.285-.02.495-.02h.05c.267 0 .574.05.845.13.55-.4.887-1.17.887-1.87zM6.762 15.995c1.637 0 2.663-1.296 2.663-3.285 0-1.957-.96-3.285-2.475-3.285-1.538 0-2.5 1.23-2.5 3.285 0 2.013.913 3.285 2.313 3.285z"}),Object(c.jsx)("path",{d:"M39.914 10l2.914 3.416H37"})]})})})}),Object(c.jsx)(h.a,{placement:"top",title:null,content:Object(c.jsx)(m,{onSelect:this.onSelect}),trigger:"hover",children:Object(c.jsx)("button",{className:"beui-math-editor__button",children:Object(c.jsx)("svg",{width:"46",height:"24",viewBox:"0 0 46 24",fill:"#8590a6",children:Object(c.jsx)("path",{d:"M39.914 10l2.914 3.416H37m-25.02 2.062l-.984.98-3.507-3.493-3.51 3.492-.98-.98 3.504-3.49L3 8.494l.982-.98L7.49 11.01l3.506-3.492.983.98-3.51 3.49 3.506 3.492zm6.25-6.902c0-.64.53-1.182 1.186-1.182.655 0 1.187.543 1.187 1.182 0 .652-.532 1.182-1.187 1.182s-1.187-.53-1.187-1.182zm-3.658 2.73h9.688v1.387h-9.688v-1.386zm3.657 4.118c0-.652.53-1.182 1.183-1.182s1.187.53 1.187 1.182c0 .64-.53 1.182-1.186 1.182s-1.187-.544-1.187-1.182zM26.26 7H33v10h-6.74v-1.372h5.348v-2.95h-5.35v-1.385h5.35v-2.92h-5.35V7z",fillRule:"evenodd"})})})}),Object(c.jsx)(h.a,{placement:"top",title:null,content:Object(c.jsx)(g,{onSelect:this.onSelect}),trigger:"hover",children:Object(c.jsx)("button",{className:"beui-math-editor__button",children:Object(c.jsx)("svg",{width:"46",height:"24",viewBox:"0 0 46 24",fill:"#8590a6",children:Object(c.jsx)("path",{d:"M31.265 8.03c2.66 0 4.735 1.946 4.735 4.526s-2.076 4.527-4.735 4.527h-5.93V15.66h5.93c1.863 0 3.285-1.327 3.285-3.104 0-1.777-1.422-3.102-3.285-3.102h-5.93V8.03h5.93zm-7.102 3.567H20.21l-.668 1.82h4.62v1.438h-5.147l-.938 2.595-1.365-.494.782-2.1h-3.427v-1.44h3.94l.667-1.82h-4.607v-1.423H19.2l.953-2.623 1.365.494-.782 2.13h3.427v1.423zM11.523 7l.682 1.27-8.148 4.202v.056l8.148 4.203-.683 1.27L1 12.53v-.056L11.522 7zm29.39 3l2.915 3.416H38",fillRule:"evenodd"})})})}),Object(c.jsx)(h.a,{placement:"top",title:null,content:Object(c.jsx)(k,{onSelect:this.onSelect}),trigger:"hover",children:Object(c.jsx)("button",{className:"beui-math-editor__button",children:Object(c.jsx)("svg",{width:"46",height:"24",viewBox:"0 0 46 24",fill:"#8590a6",children:Object(c.jsx)("path",{d:"M1 12.18h1.583l1.496 5.235h.12l2.87-10.79h3.65v1.47H8.19L5.17 18.988H3.12L1 12.18zm13.708 7.174c-1.222-1.993-1.945-4.104-1.945-6.713 0-2.58.723-4.72 1.945-6.7l.946.41C14.524 8.24 14 10.45 14 12.64c0 2.203.524 4.42 1.654 6.294l-.946.42zm3.1 0l-.945-.42c1.13-1.875 1.656-4.09 1.656-6.293 0-2.19-.53-4.4-1.66-6.29l.94-.4c1.23 1.98 1.95 4.12 1.95 6.7 0 2.61-.73 4.72-1.96 6.72zm13.738-4.91c-.103.618-.502 1.332-1.197 2.142-.7.81-1.56 1.22-2.58 1.236-.52 0-.99-.133-1.42-.398-.43-.265-.75-.596-.96-.993-.62.93-1.37 1.4-2.24 1.4-.55 0-1.02-.16-1.42-.48-.4-.32-.61-.76-.62-1.3 0-.42.1-.77.31-1.03.2-.266.4-.43.6-.486.19-.06.36-.09.51-.09.28 0 .51.08.68.245.18.16.263.375.263.64 0 .677-.37 1.14-1.11 1.39.165.19.46.29.89.29.19 0 .33-.016.42-.045.56-.236.975-.72 1.24-1.457.89-3.253 1.33-5.15 1.33-5.696 0-.41-.117-.707-.354-.884-.235-.173-.494-.262-.775-.262-.545 0-1.085.24-1.617.73s-.895 1.08-1.087 1.79c-.043.146-.087.227-.13.24-.045.016-.16.03-.355.046h-.09c-.22 0-.33-.06-.33-.18 0-.017.016-.1.046-.245.234-.84.69-1.583 1.37-2.23.68-.648 1.47-.97 2.374-.97 1.032 0 1.815.462 2.35 1.39.603-.913 1.3-1.37 2.08-1.37h.136c.724 0 1.24.19 1.55.575.31.38.474.79.49 1.216 0 .47-.14.85-.42 1.146-.28.294-.615.44-1 .44-.636 0-.954-.31-.954-.926 0-.297.09-.554.267-.775.18-.22.35-.365.51-.44.165-.072.26-.11.29-.11l.067-.02c0-.013-.043-.043-.13-.087-.09-.046-.21-.1-.357-.157-.15-.057-.29-.08-.42-.065-.537 0-.99.33-1.38.996-.134.24-.304.74-.51 1.5-.21.77-.415 1.56-.622 2.39-.205.825-.323 1.31-.352 1.458-.075.4-.11.685-.11.86 0 .414.11.71.33.885.222.18.473.268.754.268.59 0 1.14-.233 1.66-.704.51-.47.88-1.07 1.08-1.81.03-.13.066-.203.11-.22.045-.012.163-.03.355-.04h.31c.09.09.13.17.13.24zm.736-5.734V5H36v3.71h-3.718zm.93-.955h1.836V5.933h-1.836v1.822zM32.282 20v-3.71H36V20h-3.718zm.93-.955h1.836v-1.82h-1.836v1.82zM41.914 10l2.914 3.416H39",fillRule:"evenodd"})})})}),Object(c.jsx)(h.a,{placement:"top",title:null,content:Object(c.jsx)(y,{onSelect:this.onSelect}),trigger:"hover",children:Object(c.jsx)("button",{className:"beui-math-editor__button",children:Object(c.jsx)("svg",{width:"46",height:"24",viewBox:"0 0 46 24",fill:"#8590a6",children:Object(c.jsx)("path",{d:"M22.448 10.226h8.53c-.36-.486-.612-.918-1.062-1.746l1.476-.828c.684 1.458 1.08 2.124 1.8 3.006.666.81 1.17 1.278 2.34 2.142-1.17.864-1.674 1.332-2.34 2.142-.72.882-1.116 1.548-1.8 3.006l-1.476-.81c.594-1.08.648-1.188 1.026-1.746h-8.494V13.79h9.592c.27-.306.486-.522 1.008-.99-.216-.198-.774-.738-.99-.972h-9.61v-1.602zM17.326 7l3.092 3.092H17.9l-.014 7.56h-1.133l.006-7.56h-2.527L17.323 7zM2 12.326l3.092-3.09v2.517l7.56.013V12.9l-7.56-.007v2.525L2 12.326zM41.914 10l2.914 3.416H39",fillRule:"evenodd"})})})})]}),Object(c.jsx)("textarea",{onPaste:function(e){e.stopPropagation()},placeholder:"\u8f93\u5165 Tex \u8bed\u6cd5\u683c\u5f0f",onChange:this.onTexChange,ref:function(t){e._textInput=t},autoFocus:!0,suppressContentEditableWarning:!0,className:"beui-math-editor__input",contentEditable:!0}),Object(c.jsx)("div",{className:"beui-math-editor__preview",ref:function(t){return e._preview=t}})]})}}]),n}(a.Component),x=function(){function e(){Object(i.a)(this,e),this._unmount=void 0}return Object(o.a)(e,[{key:"mount",value:function(e,t,n){l.a.render(s.a.createElement(C,{tex:t,onTeXChange:n}),e);this._unmount=function(){l.a.unmountComponentAtNode(e)}}},{key:"unmount",value:function(){this._unmount&&(this._unmount(),this._unmount=null)}},{key:"removeSVGUse",value:function(e){var t,n=document.createElement("div");n.innerHTML=e;var i=null===(t=n.querySelector("svg"))||void 0===t?void 0:t.cloneNode(!0),o="";if(i){var a=i.getAttribute("width");i.style.width=a||"",i.querySelectorAll("use").forEach((function(e){var t=e.getAttribute("xlink:href");if(t){var n=i.querySelector(t);if(n){var o=n.cloneNode(!0);o.removeAttribute("id");var a=e.attributes,s=document.createElement("g");for(var r in a){var l=a[r];"xlink:href"!==l.name&&s.setAttribute(l.name,l.value)}s.appendChild(o),e.replaceWith(s)}}}));var s=i.querySelector("defs");s&&s.remove(),o=i.outerHTML}return o}}]),e}()},772:function(e,t,n){},773:function(e,t,n){},774:function(e,t,n){},775:function(e,t,n){},776:function(e,t,n){},777:function(e,t,n){},778:function(e,t,n){},779:function(e,t,n){},791:function(e,t,n){},792:function(e,t,n){},793:function(e,t,n){},794:function(e,t,n){},795:function(e,t,n){},796:function(e,t,n){var i=n(797);e.exports="string"===typeof i?i:i.toString()},797:function(e,t,n){var i=n(93)(!1);i.push([e.i,".be-paragraph[placeholder]:empty:focus::before {\n  content: attr(placeholder);\n  color: #70768433;\n  font-weight: normal;\n}\n",""]),e.exports=i},798:function(e,t,n){"use strict";n.r(t),t.default='<svg xmlns="http://www.w3.org/2000/svg" width="52" height="52" viewBox="0 0 52 52">\n    <path fill="#D76B6B" fill-rule="nonzero" d="M26 52C11.64 52 0 40.36 0 26S11.64 0 26 0s26 11.64 26 26-11.64 26-26 26zm0-3.25c12.564 0 22.75-10.186 22.75-22.75S38.564 3.25 26 3.25 3.25 13.436 3.25 26 13.436 48.75 26 48.75zM15.708 33.042a2.167 2.167 0 1 1 0-4.334 2.167 2.167 0 0 1 0 4.334zm23.834 0a2.167 2.167 0 1 1 0-4.334 2.167 2.167 0 0 1 0 4.334zm-15.875 5.452a1.083 1.083 0 1 1-1.834-1.155c1.331-2.114 3.49-3.179 6.334-3.179 2.844 0 5.002 1.065 6.333 3.18a1.083 1.083 0 1 1-1.833 1.154c-.913-1.45-2.366-2.167-4.5-2.167s-3.587.717-4.5 2.167z"/>\n</svg>'},799:function(e,t,n){},800:function(e,t,n){},806:function(e,t,n){var i=n(93)(!1);i.push([e.i,"/**\n * Plugin styles\n */\n.beui-block--header {\n  position: relative;\n}\n.beui-block--header::before {\n  content: attr(data-key);\n  position: absolute;\n  left: -25px;\n  color: var(--placeholder-color);\n  height: 100%;\n  display: flex;\n  align-items: center;\n  font-size: 12px;\n}\n",""]),e.exports=i},807:function(e,t,n){var i=n(93)(!1);i.push([e.i,".be-header {\n  padding: 1em 0;\n  margin: 0;\n  margin-bottom: -0.9em;\n  line-height: 1.5em;\n}\n",""]),e.exports=i},809:function(e,t,n){var i=n(93)(!1);i.push([e.i,".be-paragraph[placeholder]:empty:focus::before {\n  content: attr(placeholder);\n  color: rgba(112, 118, 132, 0.2);\n  font-weight: normal;\n  display: inline-block;\n}\n.be-paragraph[placeholder]:empty::before {\n  display: none;\n}\n",""]),e.exports=i},810:function(e,t,n){var i=n(93)(!1);i.push([e.i,".be-paragraph {\n  line-height: 1.6em;\n  margin: 0px;\n}\n",""]),e.exports=i},811:function(e,t,n){var i={"./components/code":556,"./components/code/":556,"./components/code/highlight":603,"./components/code/highlight.ts":603,"./components/code/icon.svg.xml":655,"./components/code/index":556,"./components/code/index.text.less":652,"./components/code/index.ts":556,"./components/code/languages":604,"./components/code/languages.ts":604,"./components/code/typesets/common.text.less":654,"./components/code/typesets/default.text.less":653,"./components/code/utils":656,"./components/code/utils.ts":656,"./components/data.d":657,"./components/data.d.ts":657,"./components/delimiter":557,"./components/delimiter/":557,"./components/delimiter/icon.svg.xml":661,"./components/delimiter/index":557,"./components/delimiter/index.text.less":658,"./components/delimiter/index.ts":557,"./components/delimiter/typesets/common.text.less":660,"./components/delimiter/typesets/default.text.less":659,"./components/diagram":558,"./components/diagram/":558,"./components/diagram/DiagramInput":605,"./components/diagram/DiagramInput.less":1080,"./components/diagram/DiagramInput.tsx":605,"./components/diagram/icon.svg.xml":737,"./components/diagram/index":558,"./components/diagram/index.text.less":734,"./components/diagram/index.ts":558,"./components/diagram/typesets/common.text.less":736,"./components/diagram/typesets/default.text.less":735,"./components/drawio":579,"./components/drawio/":579,"./components/drawio/DiagramEditor":630,"./components/drawio/DiagramEditor.js":630,"./components/drawio/DrawioInput":629,"./components/drawio/DrawioInput.less":1084,"./components/drawio/DrawioInput.tsx":629,"./components/drawio/icon.svg.xml":741,"./components/drawio/index":579,"./components/drawio/index.text.less":738,"./components/drawio/index.ts":579,"./components/drawio/typesets/common.text.less":740,"./components/drawio/typesets/default.text.less":739,"./components/header":547,"./components/header/":547,"./components/header/h1.svg.xml":643,"./components/header/h2.svg.xml":644,"./components/header/h3.svg.xml":645,"./components/header/h4.svg.xml":646,"./components/header/h5.svg.xml":647,"./components/header/h6.svg.xml":648,"./components/header/icon.svg.xml":642,"./components/header/index":547,"./components/header/index.text.less":640,"./components/header/index.ts":547,"./components/header/typesets/default.text.less":641,"./components/image":580,"./components/image/":580,"./components/image/ImageEditor":600,"./components/image/ImageEditor.js":600,"./components/image/ImageInput":555,"./components/image/ImageInput.tsx":555,"./components/image/assets/add-title.svg.xml":743,"./components/image/assets/background.svg.xml":744,"./components/image/assets/border.svg.xml":745,"./components/image/assets/button-icon.svg.xml":742,"./components/image/assets/stretched.svg.xml":746,"./components/image/assets/toolbox.svg.xml":749,"./components/image/editor":257,"./components/image/editor/":257,"./components/image/editor/App":180,"./components/image/editor/App.less":258,"./components/image/editor/App.tsx":180,"./components/image/editor/index":257,"./components/image/editor/index.tsx":257,"./components/image/index":580,"./components/image/index.text.less":747,"./components/image/index.ts":580,"./components/image/settings":632,"./components/image/settings.ts":632,"./components/image/typesets/default.text.less":748,"./components/image/ui":631,"./components/image/ui.ts":631,"./components/image/uploader":633,"./components/image/uploader.ts":633,"./components/image/utils":634,"./components/image/utils.ts":634,"./components/list":581,"./components/list/":581,"./components/list/icon.svg.xml":752,"./components/list/index":581,"./components/list/index.text.less":750,"./components/list/index.ts":581,"./components/list/ordered.svg.xml":754,"./components/list/typesets/default.text.less":751,"./components/list/unordered.svg.xml":753,"./components/math":582,"./components/math/":582,"./components/math/icon.svg.xml":758,"./components/math/index":582,"./components/math/index.text.less":755,"./components/math/index.ts":582,"./components/math/typesets/common.text.less":757,"./components/math/typesets/default.text.less":756,"./components/paragraph":548,"./components/paragraph/":548,"./components/paragraph/icon.svg.xml":651,"./components/paragraph/index":548,"./components/paragraph/index.text.less":649,"./components/paragraph/index.ts":548,"./components/paragraph/typesets/default.text.less":650,"./components/table":583,"./components/table/":583,"./components/table/borderToolBar":636,"./components/table/borderToolBar.ts":636,"./components/table/documentUtils":554,"./components/table/documentUtils.ts":554,"./components/table/icon.svg.xml":764,"./components/table/index":583,"./components/table/index.text.less":761,"./components/table/index.ts":583,"./components/table/minus.svg.xml":760,"./components/table/plus.svg.xml":759,"./components/table/table":584,"./components/table/table.ts":584,"./components/table/tableConstructor":635,"./components/table/tableConstructor.ts":635,"./components/table/typesets/common.text.less":762,"./components/table/typesets/default.text.less":763,"./components/todolist":585,"./components/todolist/":585,"./components/todolist/icon.svg.xml":768,"./components/todolist/index":585,"./components/todolist/index.text.less":765,"./components/todolist/index.ts":585,"./components/todolist/typesets/common.text.less":767,"./components/todolist/typesets/default.text.less":766,"./components/utils":518,"./components/utils.ts":518,"./inserts/math":586,"./inserts/math/":586,"./inserts/math/index":586,"./inserts/math/index.less":769,"./inserts/math/index.ts":586,"./tools/bold":587,"./tools/bold/":587,"./tools/bold/index":587,"./tools/bold/index.ts":587,"./tools/inlinecode":588,"./tools/inlinecode/":588,"./tools/inlinecode/index":588,"./tools/inlinecode/index.ts":588,"./tools/italic":589,"./tools/italic/":589,"./tools/italic/index":589,"./tools/italic/index.ts":589,"./tools/link":590,"./tools/link/":590,"./tools/link/index":590,"./tools/link/index.ts":590,"./tools/mark":591,"./tools/mark/":591,"./tools/mark/index":591,"./tools/mark/index.ts":591,"./tools/strikethrough":592,"./tools/strikethrough/":592,"./tools/strikethrough/index":592,"./tools/strikethrough/index.ts":592,"./tools/sub":593,"./tools/sub/":593,"./tools/sub/index":593,"./tools/sub/index.ts":593,"./tools/sup":594,"./tools/sup/":594,"./tools/sup/index":594,"./tools/sup/index.ts":594,"./tools/tool":528,"./tools/tool.ts":528,"./tools/underline":595,"./tools/underline/":595,"./tools/underline/index":595,"./tools/underline/index.ts":595,"./tunes/delete":596,"./tunes/delete/":596,"./tunes/delete/index":596,"./tunes/delete/index.ts":596,"./tunes/move-down":597,"./tunes/move-down/":597,"./tunes/move-down/index":597,"./tunes/move-down/index.ts":597,"./tunes/move-up":598,"./tunes/move-up/":598,"./tunes/move-up/index":598,"./tunes/move-up/index.ts":598,"./tunes/quote":599,"./tunes/quote/":599,"./tunes/quote/index":599,"./tunes/quote/index.ts":599};function o(e){var t=a(e);return n(t)}function a(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}o.keys=function(){return Object.keys(i)},o.resolve=a,e.exports=o,o.id=811},846:function(e,t,n){var i=n(93)(!1);i.push([e.i,"",""]),e.exports=i},847:function(e,t,n){var i=n(93)(!1);i.push([e.i,".be-code__content {\n  line-height: 1.6em;\n  outline: none;\n  margin: 0px;\n  display: block;\n}\n",""]),e.exports=i},848:function(e,t,n){var i=n(93)(!1);i.push([e.i,'.be-code {\n  font-size: 14px;\n  margin: 10px 0;\n  display: block;\n  overflow-x: auto;\n  padding: 1em 1em 1em 0.5em;\n  color: #333;\n  position: relative;\n  background-color: rgba(0, 0, 0, 0.03);\n  border: 1px solid #f0f0f0;\n  border-radius: 2px;\n  counter-reset: line;\n  line-height: 26px;\n  white-space: normal;\n}\n.be-code .be-code__line {\n  text-align: left;\n  font-size: 14px;\n  display: flex;\n  white-space: pre;\n  position: relative;\n  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;\n  background-color: transparent;\n  color: #333;\n}\n.be-code .be-code__line::before {\n  min-width: 1.5em;\n  text-align: right;\n  counter-increment: line;\n  content: counter(line);\n  display: inline;\n  margin-right: 12px;\n  color: rgba(0, 0, 0, 0.15);\n}\n.be-code .be-code__line .be-code__line-text::after {\n  content: " ";\n}\n.be-code__comment,\n.be-code__quote {\n  color: #afafaf;\n  font-style: italic;\n}\n.be-code__keyword,\n.be-code__selector-tag,\n.be-code__subst {\n  color: #ca7d37;\n}\n.be-code__number,\n.be-code__literal,\n.be-code__variable,\n.be-code__template-variable,\n.be-code__tag .be-code__attr {\n  color: #0e9ce5;\n}\n.be-code__string,\n.be-code__doctag {\n  color: #d14;\n}\n.be-code__title,\n.be-code__section,\n.be-code__selector-id {\n  color: #d14;\n}\n.be-code__subst {\n  font-weight: normal;\n}\n.be-code__type,\n.be-code__class .be-code__title {\n  color: #0e9ce5;\n}\n.be-code__tag,\n.be-code__name,\n.be-code__attribute {\n  color: #0e9ce5;\n  font-weight: normal;\n}\n.be-code__regexp,\n.be-code__link {\n  color: #ca7d37;\n}\n.be-code__symbol,\n.be-code__bullet {\n  color: #d14;\n}\n.be-code__built_in,\n.be-code__builtin-name {\n  color: #ca7d37;\n}\n.be-code__meta {\n  color: #afafaf;\n}\n.be-code__deletion {\n  background: #fdd;\n}\n.be-code__addition {\n  background: #dfd;\n}\n.be-code__emphasis {\n  font-style: italic;\n}\n.be-code__strong {\n  font-weight: bold;\n}\n',""]),e.exports=i},849:function(e,t,n){var i=n(93)(!1);i.push([e.i,"/*\n.be-delimiter {\n    margin: 0px;\n    border: none;\n}\n*/\n",""]),e.exports=i},850:function(e,t,n){var i=n(93)(!1);i.push([e.i,'/*\n.be-delimiter {\n    line-height: 1.6em;\n    width: 100%;\n    text-align: center;\n}\n\n.be-delimiter:before {\n    display: inline-block;\n    content: "***";\n    font-size: 30px;\n    line-height: 65px;\n    height: 30px;\n    letter-spacing: 0.2em;\n}\n*/\n',""]),e.exports=i},851:function(e,t,n){var i=n(93)(!1);i.push([e.i,".be-delimiter {\n  display: inline-block;\n  width: 100%;\n}\n",""]),e.exports=i}}]);