(this.webpackJsonpmain=this.webpackJsonpmain||[]).push([[2],{1112:function(e,t,n){var o={"./locale":762,"./locale.js":762};function i(e){var t=a(e);return n(t)}function a(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}i.keys=function(){return Object.keys(o)},i.resolve=a,e.exports=i,i.id=1112},1114:function(e,t,n){var o=n(88)(!1);o.push([e.i,".beui-diagram-editor {\n  text-align: center;\n  width: 500px;\n  margin: auto;\n  border: 1px solid var(--editor-border-color);\n  border-radius: 2px;\n  position: absolute;\n  bottom: 50px;\n  top: 100px;\n  left: 50%;\n  transform: translateX(-50%);\n}\n.beui-diagram-editor .beui-diagram-editor__toolbar {\n  display: block;\n  padding: 4px 12px;\n  background: var(--editor-toolbar-bgcolor);\n  border-bottom: 1px solid var(--editor-border-color);\n  user-select: none;\n  height: 35px;\n  box-sizing: border-box;\n  text-align: left;\n}\n.beui-diagram-editor .beui-diagram-editor__toolbar .beui-diagram-editor__button {\n  height: 28px;\n  padding: 2px 4px;\n  box-sizing: border-box;\n  border: 1px solid transparent;\n  vertical-align: middle;\n  background-color: transparent;\n  border-radius: 0;\n  color: var(--color);\n  cursor: pointer;\n}\n.beui-diagram-editor .beui-diagram-editor__toolbar .beui-diagram-editor__button:hover {\n  border-color: var(--editor-border-color);\n}\n.beui-diagram-editor .beui-diagram-editor__input {\n  resize: none;\n  width: 100%;\n  background-color: var(--content-background-color);\n  border: none;\n  padding: 6px 12px;\n  height: 200px;\n  box-sizing: border-box;\n  line-height: 1.5em;\n  display: block;\n}\n.beui-diagram-editor .beui-diagram-editor__preview {\n  padding: 20px 10px;\n  text-align: center;\n  border-top: 1px solid var(--editor-border-color);\n  max-height: calc(100% - 200px);\n  overflow: auto;\n  box-sizing: border-box;\n}\n.beui-diagram-editor__panel {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  margin: -4px;\n  padding: 16px;\n  max-width: 384px;\n}\n.beui-block--stretched .be-diagram__preview {\n  display: none;\n}\n.beui-block--stretched .be-diagram__input {\n  margin-top: 100px;\n}\n",""]),e.exports=o},1115:function(e,t,n){var o=n(88)(!1);o.push([e.i,"",""]),e.exports=o},1116:function(e,t,n){var o=n(88)(!1);o.push([e.i,".be-diagram__preview {\n  padding: 20px 10px;\n  text-align: center;\n}\n",""]),e.exports=o},1117:function(e,t,n){},1118:function(e,t,n){var o=n(88)(!1);o.push([e.i,".beui-block--stretched .be-drawio__preview {\n  display: none;\n}\n.beui-block--stretched .be-drawio__input {\n  margin-top: 100px;\n}\n",""]),e.exports=o},1119:function(e,t,n){var o=n(88)(!1);o.push([e.i,"",""]),e.exports=o},1120:function(e,t,n){var o=n(88)(!1);o.push([e.i,".be-drawio__preview {\n  padding: 20px 10px;\n  text-align: center;\n}\n",""]),e.exports=o},1121:function(e,t,n){},1122:function(e,t,n){var o=n(88)(!1);o.push([e.i,'.be-footnote:empty::before {\n  content: "\u6587\u4e2d\u6682\u672a\u8bbe\u7f6e\u811a\u6ce8";\n  color: var(--placeholder-color);\n}\n',""]),e.exports=o},1123:function(e,t,n){var o=n(88)(!1);o.push([e.i,"",""]),e.exports=o},1124:function(e,t,n){var o=n(88)(!1);o.push([e.i,'.be-footnote {\n  counter-reset: footnotelist;\n  color: #3f3f3f;\n  line-height: 1.5;\n  font-size: 14px;\n  word-break: break-all;\n}\n.be-footnote__item-title {\n  font-weight: bold;\n}\n.be-footnote__item-title:not(:empty)::after {\n  content: "\uff1a";\n}\n.be-footnote__item-note {\n  font-style: italic;\n}\n.be-footnote__item::before {\n  content: "[ " counter(footnotelist) " ] ";\n  counter-increment: footnotelist 1;\n  font-size: 90%;\n  opacity: 0.6;\n}\n',""]),e.exports=o},1125:function(e,t,n){var o=n(88)(!1);o.push([e.i,'.be-image {\n  --bg-color: #cdd1e0;\n  --front-color: #388ae5;\n  --border-color: #e8e8eb;\n  /**\n     * Tunes\n     * ----------------\n     */\n}\n.be-image .beui-image__loader {\n  border-radius: 3px;\n  overflow: hidden;\n  margin-bottom: 10px;\n  width: 100%;\n  box-sizing: border-box;\n}\n.be-image .beui-block__button {\n  width: 60px;\n  margin: auto;\n  box-sizing: content-box;\n}\n.be-image__container {\n  width: 100%;\n}\n.be-image__img {\n  max-width: 100%;\n  display: block;\n}\n.be-image [contentEditable="true"][placeholder]::before {\n  content: attr(placeholder);\n  color: #70768433;\n  font-weight: normal;\n  display: none;\n}\n.be-image [contentEditable="true"][placeholder]:empty::before {\n  display: inline;\n}\n.be-image [contentEditable="true"][placeholder]:empty:focus::before {\n  display: none;\n}\n.be-image--empty .beui-image__loader {\n  display: none;\n}\n.be-image--empty .beui-image__container {\n  display: none;\n}\n.be-image--empty .be-image__caption,\n.be-image--loading .be-image__caption {\n  display: none;\n}\n.be-image--empty .beui-image__container,\n.be-image--loading .beui-image__container {\n  display: none;\n}\n.be-image--filled .beui-block__button {\n  display: none;\n}\n.be-image--filled .beui-image__loader {\n  display: none;\n}\n.be-image--loading .beui-image__loader {\n  min-height: 200px;\n  display: flex;\n  border: 1px solid var(--border-color);\n  background-color: #fff;\n}\n.be-image--loading .beui-block__button {\n  display: none;\n}\n.be-image--withBorder .beui-image__loader {\n  border: 1px solid var(--border-color);\n}\n.be-image--withBackground .beui-image__loader {\n  padding: 15px;\n  background: var(--bg-color);\n}\n.be-image--withBackground .be-image__img {\n  max-width: 60%;\n  margin: 0 auto;\n}\n.be-image--stretched .be-image__img {\n  width: 100%;\n}\n.beui-image__preloader {\n  width: 50px;\n  height: 50px;\n  border-radius: 50%;\n  background-size: cover;\n  margin: auto;\n  position: relative;\n  background-color: var(--bg-color);\n  background-position: center center;\n}\n.beui-image__preloader::after {\n  content: "";\n  position: absolute;\n  z-index: 3;\n  width: 60px;\n  height: 60px;\n  border-radius: 50%;\n  border: 2px solid var(--bg-color);\n  border-top-color: var(--front-color);\n  left: 50%;\n  top: 50%;\n  margin-top: -30px;\n  margin-left: -30px;\n  animation: image-preloader-spin 2s infinite linear;\n  box-sizing: border-box;\n}\n@keyframes image-preloader-spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n.beui-block--stretched .be-image__container {\n  display: none;\n}\n.beui-block--stretched .be-image__caption {\n  display: none;\n}\n.beui-block--stretched .be-image__editor {\n  position: relative;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n}\n',""]),e.exports=o},1126:function(e,t,n){var o=n(88)(!1);o.push([e.i,".be-image__caption {\n  text-align: center;\n}\n",""]),e.exports=o},1127:function(e,t,n){var o=n(88)(!1);o.push([e.i,'.be-list__item-list {\n  position: relative;\n}\n.be-list__item-list::before {\n  content: "";\n  width: 5px;\n  height: 5px;\n  border: solid #999;\n  border-width: 0 2px 2px 0;\n  transform: rotate(45deg);\n  position: absolute;\n  left: -30px;\n  top: 7px;\n  transition: transform 0.1s ease-in-out;\n  cursor: pointer;\n}\n.be-list__item-list--closed::before {\n  transform: rotate(-45deg);\n  top: 9px;\n}\n.be-list__item-list--closed .be-list__item-children {\n  display: none;\n}\n',""]),e.exports=o},1128:function(e,t,n){var o=n(88)(!1);o.push([e.i,"",""]),e.exports=o},1129:function(e,t,n){},1130:function(e,t,n){},1131:function(e,t,n){var o=n(88)(!1);o.push([e.i,".beui-math-editor {\n  text-align: center;\n  max-width: 500px;\n  margin: auto;\n  border: 1px solid var(--editor-border-color);\n  border-radius: 2px;\n}\n.beui-math-editor .beui-math-editor__toolbar {\n  display: block;\n  padding: 4px 12px;\n  background: var(--editor-toolbar-bgcolor);\n  border-bottom: 1px solid var(--editor-border-color);\n  user-select: none;\n  height: 35px;\n  box-sizing: border-box;\n  text-align: left;\n}\n.beui-math-editor .beui-math-editor__toolbar .beui-math-editor__button {\n  height: 28px;\n  padding: 2px 4px;\n  box-sizing: border-box;\n  border: 1px solid transparent;\n  vertical-align: middle;\n  background-color: transparent;\n  border-radius: 0;\n  color: var(--color);\n  cursor: pointer;\n}\n.beui-math-editor .beui-math-editor__toolbar .beui-math-editor__button:hover {\n  border-color: var(--editor-border-color);\n}\n.beui-math-editor .beui-math-editor__input {\n  resize: none;\n  width: 100%;\n  background-color: var(--content-background-color);\n  padding: 6px 12px;\n  min-height: 100px;\n  box-sizing: border-box;\n  line-height: 1.5em;\n  display: block;\n  outline: none;\n  border: none;\n}\n.beui-math-editor .beui-math-editor__preview {\n  padding: 20px 10px;\n  text-align: center;\n  border-top: 1px solid var(--editor-border-color);\n}\n.beui-math-editor__panel {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  margin: -4px;\n  padding: 16px;\n  max-width: 384px;\n}\n.beui-block--stretched .be-math__preview {\n  display: none;\n}\n.beui-block--stretched .be-math__input {\n  margin-top: 200px;\n}\n",""]),e.exports=o},1132:function(e,t,n){var o=n(88)(!1);o.push([e.i,"",""]),e.exports=o},1133:function(e,t,n){var o=n(88)(!1);o.push([e.i,".be-math__preview {\n  padding: 20px 10px;\n  text-align: center;\n}\n",""]),e.exports=o},1134:function(e,t,n){var o=n(88)(!1);o.push([e.i,'.be-richtext:empty::before {\n  content: "\u7c98\u8d34\u5bcc\u6587\u672c\uff08\u4fdd\u7559\u6e90\u683c\u5f0f\uff0c\u517c\u5bb9135\u3001\u79c0\u7c73\u7b49\u7d20\u6750\u6a21\u677f\uff09";\n  color: var(--placeholder-color);\n}\n',""]),e.exports=o},1135:function(e,t,n){var o=n(88)(!1);o.push([e.i,"",""]),e.exports=o},1136:function(e,t,n){var o=n(88)(!1);o.push([e.i,"",""]),e.exports=o},1137:function(e,t,n){var o=n(88)(!1);o.push([e.i,".beui-table-editor {\n  padding: 10px;\n  position: relative;\n  width: 100%;\n  box-sizing: border-box;\n}\n.beui-table-toolbar {\n  background: #368be6;\n}\n.beui-table-toolbar--hidden {\n  visibility: hidden;\n}\n.beui-table-toolbar--hor {\n  width: 100%;\n  height: 21px;\n  display: flex;\n  align-items: center;\n  flex-direction: row;\n  position: absolute;\n  left: 0;\n  top: 1px;\n  z-index: 100;\n}\n.beui-table-toolbar--ver {\n  height: 100%;\n  width: 21px;\n  display: flex;\n  align-items: center;\n  flex-direction: column;\n  position: absolute;\n  top: 0;\n  left: -1px;\n  z-index: 100;\n}\n.beui-table-toolbar__plus {\n  height: 21px;\n  width: 21px;\n  margin-top: 0;\n  cursor: pointer;\n}\n.beui-table-toolbar__plus--hor {\n  margin-left: -10px;\n}\n.beui-table-toolbar__plus--ver {\n  margin-top: -10px;\n}\n.beui-table-toolbar__minus {\n  height: 21px;\n  width: 21px;\n  margin-top: 0;\n  cursor: pointer;\n}\n.beui-table-toolbar__minus--hor {\n  margin-right: -10px;\n}\n.beui-table-toolbar__minus--ver {\n  margin-bottom: -10px;\n}\n.beui-table-toolbar__shine-line--hor {\n  min-height: 1px;\n  width: 100%;\n}\n.beui-table-toolbar__shine-line--ver {\n  min-width: 1px;\n  height: 100%;\n}\n",""]),e.exports=o},1138:function(e,t,n){var o=n(88)(!1);o.push([e.i,".beui-table-editor {\n  padding: 10px;\n}\n.be-table {\n  border-collapse: collapse;\n  width: 100%;\n  table-layout: fixed;\n}\n",""]),e.exports=o},1139:function(e,t,n){var o=n(88)(!1);o.push([e.i,"",""]),e.exports=o},1140:function(e,t,n){var o=n(88)(!1);o.push([e.i,"",""]),e.exports=o},1141:function(e,t,n){var o=n(88)(!1);o.push([e.i,".be-todolist__item--checked .be-todolist__item-checkbox {\n  background: #388ae5;\n  border-color: #388ae5;\n}\n",""]),e.exports=o},1142:function(e,t,n){var o=n(88)(!1);o.push([e.i,".be-todolist__item {\n  display: flex;\n  padding: 0 10px;\n  box-sizing: content-box;\n  align-items: center;\n}\n.be-todolist__item-text {\n  outline: none;\n  flex-grow: 1;\n  padding: 10px 0;\n}\n.be-todolist__item-checkbox {\n  display: inline-flex;\n  flex-shrink: 0;\n  position: relative;\n  width: 20px;\n  height: 20px;\n  margin: 10px 10px 10px 0;\n  border: 1px solid #d0d0d0;\n  background: #fff;\n  cursor: pointer;\n  -webkit-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  border-radius: 10%;\n  align-items: center;\n  justify-content: center;\n}\n.be-todolist__item-checkbox:hover {\n  border-color: #b5b5b5;\n}\n.be-todolist__item-checkbox::after {\n  width: 8px;\n  height: 5px;\n  border: 2px solid #fcfff4;\n  border-top: none;\n  border-right: none;\n  background: transparent;\n  content: '';\n  opacity: 0;\n  transform: rotate(-45deg);\n  margin-bottom: 3px;\n}\n.be-todolist__item--checked .be-todolist__item-checkbox {\n  background: #388ae5;\n  border-color: #388ae5;\n}\n.be-todolist__item--checked .be-todolist__item-checkbox::after {\n  opacity: 1;\n}\n",""]),e.exports=o},1143:function(e,t,n){},1144:function(e,t,n){var o=n(1145);e.exports="string"===typeof o?o:o.toString()},1145:function(e,t,n){var o=n(88)(!1);o.push([e.i,'@custom-media --mobile (width <= 650px);\n@custom-media --not-mobile (width >= 651px);\n/**\n   * Selection color\n   */\n/**\n    * Toolbar buttons\n    */\n/**\n    * All gray texts: placeholders, settings\n    */\n/**\n    * Gray icons hover\n    */\n/**\n    * Blue icons\n    */\n/**\n    * Gray border, loaders\n    */\n/**\n    * Block content width\n    * Should be set in a constant at the modules/ui.js\n    */\n/**\n    * In narrow mode, we increase right zone contained Block Actions button\n    */\n/**\n    * Toolbar buttons height and width\n    */\n/**\n    * Toolbar Plus Button and Toolbox buttons height and width\n    */\n/**\n    * Confirm deletion bg\n    */\n.overlay-pane {\n  position: absolute;\n  background-color: var(--editor-toolbar-bgcolor);\n  border: 1px solid var(--editor-toolbar-bdcolor);\n  box-shadow: 0 3px 15px -3px rgba(13, 20, 33, 0.13);\n  border-radius: 4px;\n  z-index: 2;\n}\n.overlay-pane--left-oriented::before {\n  left: 15px;\n  margin-left: 0;\n}\n.overlay-pane--right-oriented::before {\n  left: auto;\n  right: 15px;\n  margin-left: 0;\n}\n/**\n    * Styles for Toolbox Buttons and Plus Button\n    */\n.toolbox-button {\n  color: #707684;\n  cursor: pointer;\n  width: 30px;\n  height: 30px;\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n}\n.toolbox-button:hover,\n.toolbox-button--active {\n  color: #388ae5;\n}\n.toolbox-button--active {\n  animation: bounceIn 0.75s 1;\n  animation-fill-mode: forwards;\n}\n/**\n    * Styles for Settings Button in Toolbar\n    */\n.toolbar-button {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  width: 30px;\n  height: 30px;\n  line-height: 30px;\n  padding: 0 !important;\n  text-align: center;\n  border-radius: 3px;\n  cursor: pointer;\n  border: 0;\n  outline: none;\n  background-color: transparent;\n  vertical-align: bottom;\n  color: var(--editor-toolbar-btncolor);\n  margin: 0;\n}\n.toolbar-button:hover {\n  background-color: var(--editor-toolbar-hover-color);\n}\n.toolbar-button--active {\n  color: #388ae5 !important;\n}\n.toolbar-button--focused {\n  box-shadow: inset 0 0 0px 1px rgba(7, 161, 227, 0.08);\n  background: rgba(34, 186, 255, 0.08) !important;\n}\n.toolbar-button--focused-animated {\n  animation-name: buttonClicked;\n  animation-duration: 250ms;\n}\n.toolbar-button .icon--arrow {\n  margin-left: 0px;\n  font-size: 12px;\n  color: #666;\n  line-height: 24px;\n  height: 80%;\n}\n.toolbar-button .icon--arrow:hover {\n  background-color: var(--editor-toolbar-bgcolor);\n}\n.toolbar-button .icon--math,\n.toolbar-button .icon--forecolor,\n.toolbar-button .icon--backcolor {\n  font-size: 12px;\n}\n.beui-block {\n  position: relative;\n}\n.beui-block:first-of-type {\n  margin-top: 0;\n}\n.beui-block [placeholder]:empty:focus::before {\n  content: attr(placeholder);\n  color: #70768433;\n  font-weight: normal;\n}\n.beui-block--stretched {\n  position: fixed;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  top: 0;\n  background-color: var(--mask-background-color);\n  overflow: auto;\n  z-index: 1000;\n}\n.beui-block--stretched::before {\n  content: \'\u6309ESC\u952e\u4fdd\u5b58\u5e76\u9000\u51fa\';\n  position: absolute;\n  display: block;\n  top: 5px;\n  left: 50%;\n  transform: translateX(-50%);\n  color: var(--color);\n}\n.beui-block--selected .beui-block__content {\n  background-color: var(--block-selected-bgcolor);\n  /**\n     * Workaround Safari case when user can select inline-fragment with cross-block-selection\n     */\n}\n.beui-block--selected .beui-block__content [contenteditable] {\n  -webkit-user-select: none;\n  user-select: none;\n}\n.beui-block--selected .beui-block__content img,\n.beui-block--selected .beui-block__content .be-stub {\n  opacity: 0.55;\n}\n.beui-block--stretched .beui-block__content {\n  max-width: none;\n}\n.beui-block__content {\n  margin: 0 auto;\n  transition: background-color 150ms ease;\n}\n.beui-block--drop-target .beui-block__content:before {\n  content: "";\n  position: absolute;\n  top: 100%;\n  left: -20px;\n  margin-top: -1px;\n  height: 8px;\n  width: 8px;\n  border: solid #388ae5;\n  border-width: 1px 1px 0 0;\n  transform-origin: right;\n  transform: rotate(45deg);\n}\n.beui-block--drop-target .beui-block__content:after {\n  content: "";\n  position: absolute;\n  top: 100%;\n  height: 1px;\n  width: 100%;\n  color: #388ae5;\n  background: repeating-linear-gradient(90deg, #388ae5, #388ae5 1px, #fff 1px, #fff 6px);\n}\n.beui-block a {\n  cursor: pointer;\n  text-decoration: underline;\n}\n.beui-block b {\n  font-weight: bold;\n}\n.beui-block i {\n  font-style: italic;\n}\n.beui-block svg {\n  fill: currentColor;\n  max-width: 100%;\n}\n.beui-block__button {\n  padding: 13px;\n  border-radius: 3px;\n  border: 1px solid rgba(201, 201, 204, 0.48);\n  font-size: 14.9px;\n  background: #fff;\n  -webkit-box-shadow: 0 2px 2px 0 rgba(18, 30, 57, 0.04);\n  box-shadow: 0 2px 2px 0 rgba(18, 30, 57, 0.04);\n  color: #9e9e9e;\n  text-align: center;\n  cursor: pointer;\n}\n.beui-block__input {\n  border: 1px solid rgba(201, 201, 204, 0.48);\n  -webkit-box-shadow: inset 0 1px 2px 0 rgba(35, 44, 72, 0.06);\n  box-shadow: inset 0 1px 2px 0 rgba(35, 44, 72, 0.06);\n  border-radius: 3px;\n  padding: 10px 12px;\n  outline: none;\n  width: 100%;\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n}\n.beui-block__fakeinput {\n  user-select: all;\n  position: relative;\n}\n.beui-block__input--selected {\n  background-color: var(--block-selected-bgcolor);\n}\n.beui-block__fakeinput.beui-block__input--focused {\n  outline: 1px solid rgba(56, 138, 229, 0.3);\n}\n@media (--not-mobile) {\n  .beui-editor--card .beui-block--focused {\n    margin-right: calc(50px * -1);\n    padding-right: 50px;\n  }\n}\n/**\n * Block Tool wrapper\n */\n/*\n .be-block {\n    padding: 0.4em 0;\n  }\n  */\n/**\n   * Input\n   */\n.beui-input {\n  border: 1px solid rgba(201, 201, 204, 0.48);\n  box-shadow: inset 0 1px 2px 0 rgba(35, 44, 72, 0.06);\n  border-radius: 3px;\n  padding: 10px 12px;\n  outline: none;\n  width: 100%;\n  box-sizing: border-box;\n  /**\n     * Workaround Firefox bug with cursor position on empty content editable elements with ::before pseudo\n     * https://bugzilla.mozilla.org/show_bug.cgi?id=904846\n     */\n}\n.beui-input[placeholder]::before {\n  position: static !important;\n  display: inline-block;\n  width: 0;\n  white-space: nowrap;\n  pointer-events: none;\n}\n.be-stub {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  padding: 3.5em 0;\n  margin: 17px 0;\n  border-radius: 3px;\n  background: #fcf7f7;\n  color: #b46262;\n}\n.be-stub__info {\n  margin-left: 20px;\n}\n.be-stub__title {\n  margin-bottom: 3px;\n  font-weight: 600;\n  font-size: 18px;\n  text-transform: capitalize;\n}\n.be-stub__subtitle {\n  font-size: 16px;\n}\n::-webkit-scrollbar {\n  width: 3px;\n  height: 10px;\n  background-color: var(--scrollbar-background-color);\n}\n::-webkit-scrollbar-thumb {\n  -webkit-box-shadow: inset 0 0 16px var(--scrollbar-thumb-color);\n}\n.beui-editor__content {\n  display: inline-block !important;\n  width: 100%;\n}\n.beui-editor__content.dark-mode *:not([class^="be-code__"]) {\n  color: var(--dark-color) !important;\n}\n.beui-editor__content.dark-mode *:not([class^="be-code__"]) #__ge_graph_render .node rect,\n.beui-editor__content.dark-mode *:not([class^="be-code__"]) #__ge_graph_render .node circle,\n.beui-editor__content.dark-mode *:not([class^="be-code__"]) #__ge_graph_render .node ellipse,\n.beui-editor__content.dark-mode *:not([class^="be-code__"]) #__ge_graph_render .node polygon,\n.beui-editor__content.dark-mode *:not([class^="be-code__"]) #__ge_graph_render .node path {\n  fill: #333;\n}\n.beui-editor__content.dark-mode code:not(.be-code__line),\n.beui-editor__content.dark-mode table *,\n.beui-editor__content.dark-mode blockquote {\n  background-color: var(--background-color) !important;\n}\n.beui-editor__content.dark-mode .be-code__line,\n.beui-editor__content.dark-mode .be-code__line::before {\n  color: var(--color);\n}\n.beui-editor__content.dark-mode pre {\n  background-color: var(--background-color) !important;\n}\n[contenteditable] {\n  outline: none;\n  -webkit-user-select: auto;\n  -ms-user-select: auto;\n  user-select: auto;\n}\n[contenteditable]:empty:after {\n  content: "\\feff ";\n}\n[contenteditable][placeholder]:empty::before {\n  content: attr(placeholder);\n  color: var(--placeholder-color);\n  font-weight: normal;\n  display: none;\n  cursor: text;\n  display: inline-block;\n  position: static;\n}\n[contenteditable][placeholder]:empty:focus::before {\n  display: none;\n}\n[contenteditable][placeholder]:empty::after {\n  display: none;\n}\n.beui-block__fakeinput[empty]:empty:before {\n  font-size: 14px;\n  content: attr(empty);\n  display: block;\n  text-align: center;\n  color: var(--placeholder-color);\n  line-height: 2em;\n}\n.beui-block__fakeinput.beui-block__input--focused[placeholder]:empty:before {\n  font-size: 14px;\n  content: attr(placeholder);\n  display: block;\n  text-align: center;\n  color: var(--placeholder-color);\n  line-height: 2em;\n}\n',""]),e.exports=o},1147:function(e,t,n){"use strict";n.r(t);var o,i=n(1),a=n(7),r=n(6),s=n(10),l=n(9),c=n(0),d=(n(810),n(1161)),u=n(526),h=n(34),p=n(44),f=(n(811),n(812),n(512)),v=(n(813),n(119));!function(e){e[e.ECatalogDataTypeSubItem=0]="ECatalogDataTypeSubItem",e[e.ECatalogDataTypeNextItem=1]="ECatalogDataTypeNextItem"}(o||(o={}));var b=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).onJump=function(e){var t=i.props;(0,t.onJump)(t.node),e.stopPropagation()},i.onCreateNode=function(e,t){i.setState({addCatalogEditing:!0,addCatalogType:e,addLevel:t})},i.onAddCatalogEditing=function(e){if(e.length){var t=i.props,n=t.onCreate,a=t.node,r=i.state,s=r.addCatalogType,l=r.addLevel;n({title:e,level:s===o.ECatalogDataTypeNextItem?a.level:l||a.level+1},a)}i.setState({addCatalogEditing:!1})},i.onTitleEditing=function(e){},i.state={addCatalogEditing:!1,titleEditing:!1,addCatalogType:o.ECatalogDataTypeSubItem,addLevel:void 0},i}return Object(r.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this,t=this.props,n=t.node,a=t.activeNode,r=this.state,s=r.addCatalogType,l=r.addCatalogEditing,c=r.titleEditing,d=n.title,u=n.level,p=u<6,b=0!==u,m=n.el===(null===a||void 0===a?void 0:a.el)?"active":"",g=s===o.ECatalogDataTypeSubItem;return Object(i.jsxs)("div",{className:["catalog-node","level".concat(u),m].join(" "),onContextMenu:function(e){e.preventDefault(),e.stopPropagation()},children:[!c&&Object(i.jsxs)("div",{className:"catalog-node__nav",onClick:this.onJump,children:[Object(i.jsx)("div",{className:"catalog-node__info","data-header":0!==u?"H".concat(u):"",children:Object(i.jsx)("span",{className:"catalog-node__name",children:d})}),0!==u?Object(i.jsxs)("div",{className:"catalog-node__ops",children:[p&&Object(i.jsx)(h.a,{onClick:function(){e.onCreateNode(o.ECatalogDataTypeSubItem)},icon:Object(i.jsx)(f.a,{}),tip:"\u6dfb\u52a0\u4e0b\u7ea7\u6807\u9898",placement:"top"}),b&&Object(i.jsx)(h.a,{onClick:function(){e.onCreateNode(o.ECatalogDataTypeNextItem)},icon:Object(i.jsx)("i",{className:"bei-copy-add",style:{fontSize:"18px"}}),tip:"\u5411\u540e\u6dfb\u52a0\u540c\u7ea7\u6807\u9898",placement:"top"})]}):Object(i.jsxs)("div",{className:"catalog-node__ops catalog-node__level0",children:[Object(i.jsx)(h.a,{onClick:function(){e.onCreateNode(o.ECatalogDataTypeSubItem,1)},icon:Object(i.jsx)(f.a,{}),tip:"\u6dfb\u52a0\u4e00\u7ea7\u6807\u9898",label:"H1",placement:"top"}),Object(i.jsx)(h.a,{onClick:function(){e.onCreateNode(o.ECatalogDataTypeSubItem,2)},icon:Object(i.jsx)(f.a,{}),tip:"\u6dfb\u52a0\u4e8c\u7ea7\u6807\u9898",label:"H2",placement:"top"})]})]}),c&&Object(i.jsx)("div",{className:"catalog-node__title-editing",children:Object(i.jsx)(v.a,{text:d,onFinishing:this.onTitleEditing})}),Object(i.jsx)("div",{className:["catalog-node__content",g?" padding":""].join(""),style:{display:l?"block":"none"},children:l&&Object(i.jsx)("div",{children:Object(i.jsx)(v.a,{text:"",onFinishing:this.onAddCatalogEditing})})})]})}}]),n}(c.Component),m=n(69),g=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){return Object(a.a)(this,n),t.call(this,e)}return Object(r.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.nodes,n=e.activeNode,o=e.loading,a=e.onCreate,r=e.onJump,s=this.props.wrapClassName||"",l=t.map((function(e,t){var o;return Object(i.jsx)(b,{node:e,activeNode:n,onCreate:a,onJump:r},(null===(o=e.el)||void 0===o?void 0:o.dataset.id)||t)}));return Object(i.jsxs)("div",{className:["catalog-bar",s].join(" "),children:[o&&Object(i.jsx)(m.a,{}),l]})}}]),n}(c.Component),k=n(109),y=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).onToggleVisible=function(){var e=o.state.visible,t=o.props.editable;e?t&&t.off("contentchange",o.onUpdateCatalog):t&&(o.setState({loading:!0}),t.catalog.getCatalogDatas().then((function(e){o.setState({nodes:e,loading:!1})})),t.on("contentchange",o.onUpdateCatalog)),o.setState({visible:!e}),(0,o.props.onShowingCatalog)(!e)},o.onUpdateCatalog=function(){var e=o.props.editable;e&&e.catalog.getCatalogDatas().then((function(e){o.setState({nodes:e})}))},o.onCreate=function(e,t){var n,i=o.props.editable;if(i){var a=o.state.nodes,r=a.findIndex((function(e){return e.el===t.el}));if(e.level>t.level){var s=i.catalog.insertAfter(e,t);r<a.length-1?a.splice(r+1,0,s):a.push(s),n=s}else{for(var l=r+1;l<a.length&&!(a[l].level<=e.level);l++);if(l<a.length){var c=i.catalog.insertBefore(e,a[l]);a.splice(l,0,c),n=c}else{var d=i.catalog.append(e);a.push(d),n=d}}o.setState({nodes:Object(p.a)(a)}),n&&o.onJump(n)}},o.onJump=function(e){var t=o.props.editable;t&&(t.catalog.jumpTo(e),o.setState({activeNode:e}))},o.state={nodes:[],activeNode:null,loading:!1,visible:!1},o}return Object(r.a)(n,[{key:"render",value:function(){var e=this.state,t=e.nodes,n=e.activeNode,o=e.loading,a=e.visible,r=Object(i.jsxs)("div",{className:"catalog-container",children:[Object(i.jsxs)("div",{className:"catalog-header",children:[Object(i.jsx)("div",{className:"catalog-header__title",children:"\u76ee\u5f55"}),Object(i.jsx)(h.a,{icon:Object(i.jsx)(k.a,{}),onClick:this.onToggleVisible})]}),Object(i.jsx)(g,{loading:o,nodes:t,activeNode:n,onCreate:this.onCreate,onJump:this.onJump})]});return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(h.a,{tip:"\u76ee\u5f55",placement:"left",selected:a,wrapClassName:"editor-side-bar-item app-guide-catalog",icon:Object(i.jsx)("i",{className:"bei-catalog"}),onClick:this.onToggleVisible}),a&&r]})}}]),n}(c.Component),C=(n(667),n(496)),_=n(1148),x=n(82),E=n(1150),O=n(508),T=n(1151),w=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).onUpdateScreen=function(){var e=o.props.editable;if(e){var t=e.queryCommandValue("layout");o.setState({layout:t})}},o.onChangeScreen=function(e){var t=o.props.editable;t&&(t.execCommand("layout",e.target.value),o.setState({layout:e.target.value}))},o.state={layout:"web"},o}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.editable;e&&e.on("selectionchange",this.onUpdateScreen),this.onUpdateScreen()}},{key:"componentWillUnmount",value:function(){var e=this.props.editable;e&&e.off("selectionchange",this.onUpdateScreen)}},{key:"render",value:function(){var e=this.state.layout;return Object(i.jsxs)(_.a.Group,{value:e,buttonStyle:"solid",className:"layout__group",onChange:this.onChangeScreen,children:[Object(i.jsx)(x.a,{title:"Web \u7248\u5f0f",placement:"bottom",children:Object(i.jsx)(_.a.Button,{className:"layout__button",value:"web",children:Object(i.jsx)(E.a,{className:"layout__radio"})})}),Object(i.jsx)(x.a,{title:"\u9875\u9762\u7248\u5f0f",placement:"bottom",children:Object(i.jsx)(_.a.Button,{className:"layout__button",value:"print",children:Object(i.jsx)(O.a,{className:"layout__radio"})})}),Object(i.jsx)(x.a,{title:"\u624b\u673a\u7248\u5f0f",placement:"bottom",children:Object(i.jsx)(_.a.Button,{className:"layout__button",value:"mobile",children:Object(i.jsx)(T.a,{className:"layout__radio"})})})]})}}]),n}(c.Component),S=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"render",value:function(){var e=this.props.editable,t=Object(i.jsx)("div",{children:e&&Object(i.jsx)(w,{editable:e})});return Object(i.jsx)(C.a,{placement:"leftTop",title:null,content:t,trigger:"click",children:Object(i.jsx)(h.a,{tip:"\u7f16\u8f91\u533a\u7248\u5f0f",placement:"left",wrapClassName:"editor-side-bar-item app-guide-layout",disabled:!e,icon:Object(i.jsx)("i",{className:"bei-screen"})})})}}]),n}(c.Component),j=(n(814),n(501)),B=n(53),N=n(499),L=n(94),I=n(258),A=n(1152),R=n(1153),M=n(63),D=j.a.Group,H=B.a.Group,P=N.a.Option,F=["bold","italic","underline","strikethrough","inlinecode","kbd","subscript","superscript","mark"],z=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).onSearchDebounce=void 0,o.onReplaceTrigger=function(){o.setState({isReplace:!o.state.isReplace})},o.onChangeSearchKey=function(e){var t;o.setState({searchKey:null===(t=e.target)||void 0===t?void 0:t.value}),o.onSearchDebounce()},o.onChangeReplaceKey=function(e){var t;o.setState({replaceKey:null===(t=e.target)||void 0===t?void 0:t.value})},o.onReplaceCurrent=function(){var e=o.props.editable;if(e){var t=e.search.replace({searchKey:o.state.searchKey,replaceKey:o.state.replaceKey,replaceType:o.state.replaceType,replaceFormat:o.state.replaceFormat,all:!1,dir:1});o.onUpdateResult(t)}},o.onReplaceAll=function(){var e=o.props.editable;if(e){var t=e.search.replace({searchKey:o.state.searchKey,replaceKey:o.state.replaceKey,replaceType:o.state.replaceType,replaceFormat:o.state.replaceFormat,all:!0,dir:1});o.onUpdateResult(t)}},o.onSearch=function(){var e=o.props.editable;if(e)if(o.state.searchKey){var t=e.search.search({searchKey:o.state.searchKey,all:!0,dir:1});o.onUpdateResult(t)}else{var n=e.search.clear();o.onUpdateResult(n)}},o.onPrev=function(){var e=o.props.editable;if(e){var t=e.search.jumpPrev();o.onUpdateResult(t)}},o.onNext=function(){var e=o.props.editable;if(e){var t=e.search.jumpNext();o.onUpdateResult(t)}},o.onSearchTrigger=function(e){e?o.onSearch():o.onClear(),o.setState({visible:e})},o.onClear=function(){var e=o.props.editable;if(e){var t=e.search.clear();o.onUpdateResult(t)}},o.onUpdateResult=function(e){e?o.setState({result:e}):o.setState({result:{list:[],index:0}})},o.onChangeReplaceType=function(e){o.setState({replaceType:e,replaceKey:"format"===e?"":o.state.replaceKey})},o.onChangeReplaceFormat=function(e){o.setState({replaceFormat:e})},o.state={mode:"search",searchKey:"",replaceKey:"",isReplace:!1,result:{list:[],index:0},visible:!1,replaceType:"text",replaceFormat:"bold"},o.onSearchDebounce=Object(M.a)(o.onSearch,200),o}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){var t=e.props.editable;t&&t.on("search",(function(){var n=t.selection.getRangeAt(0).cloneContents(),o=document.createElement("div");n&&o.appendChild(n);var i=o.textContent;i&&e.setState({searchKey:i}),e.setState({visible:!0}),e.onSearch()}))}),100)}},{key:"render",value:function(){var e=this.state,t=e.isReplace,n=e.searchKey,o=e.replaceKey,a=e.result,r=e.visible,s=e.replaceType,l=e.replaceFormat,c=Object(i.jsxs)(N.a,{value:s,onChange:this.onChangeReplaceType,className:"search-before",children:[Object(i.jsx)(P,{value:"text",children:Object(i.jsx)("i",{className:"bei-text"})}),Object(i.jsx)(P,{value:"format",children:Object(i.jsx)("i",{className:"bei-format"})})]}),d=F.map((function(e){return Object(i.jsx)(P,{value:e,children:Object(i.jsx)("i",{className:"bei-".concat(e)})},e)})),u=Object(i.jsx)(N.a,{value:l,onChange:this.onChangeReplaceFormat,className:"search-after",children:d}),p="format"===s,f=Object(i.jsxs)("div",{className:"search-replace",children:[Object(i.jsx)("div",{className:"search-replace__trigger",onClick:this.onReplaceTrigger,children:t?Object(i.jsx)(I.a,{}):Object(i.jsx)(L.a,{})}),Object(i.jsxs)("div",{className:"search-replace__main",children:[Object(i.jsxs)("div",{className:"search-block",children:[Object(i.jsx)(D,{className:"search-input-box",children:Object(i.jsx)(j.a,{type:"text",className:"search-input",value:n,onChange:this.onChangeSearchKey,placeholder:"\u67e5\u627e\u5185\u5bb9",onPressEnter:this.onSearch,suffix:Object(i.jsx)("span",{className:"search-result",children:!!a.list.length&&Object(i.jsxs)("span",{children:[a.index+1,"/",a.list.length]})})})}),Object(i.jsxs)(H,{className:"search-arrow",children:[Object(i.jsx)(B.a,{size:"small",type:"text",className:"search-arrow-btn",disabled:0==a.list.length,onClick:this.onPrev,icon:Object(i.jsx)(A.a,{})}),Object(i.jsx)(B.a,{size:"small",type:"text",icon:Object(i.jsx)(R.a,{}),className:"search-arrow-btn",disabled:0==a.list.length,onClick:this.onNext})]})]}),t&&Object(i.jsxs)("div",{className:"replace-block",children:[Object(i.jsx)(j.a,{disabled:p,addonBefore:c,addonAfter:p?u:null,type:"text",className:"replace-input",value:o,onChange:this.onChangeReplaceKey,placeholder:"\u66ff\u6362\u4e3a"}),Object(i.jsx)("div",{className:"operation-btns",children:Object(i.jsxs)(D,{children:[Object(i.jsx)(B.a,{size:"small",type:"text",onClick:this.onReplaceCurrent,disabled:0==a.list.length,icon:Object(i.jsx)("i",{className:"bei-replace"})}),Object(i.jsx)(B.a,{size:"small",type:"text",disabled:0==a.list.length,onClick:this.onReplaceAll,icon:Object(i.jsx)("i",{className:"bei-replace-all"})})]})})]})]})]});return Object(i.jsx)(C.a,{placement:"leftTop",title:null,content:f,visible:r,trigger:"click",onVisibleChange:this.onSearchTrigger,children:Object(i.jsx)(h.a,{tip:"\u641c\u7d22 & \u66ff\u6362",placement:"left",wrapClassName:"editor-side-bar-item app-guide-searchreplace",icon:Object(i.jsx)("i",{className:"bei-search"})})})}}]),n}(c.Component),q=(n(815),n(1155)),$=(n(816),n(1154)),V=n(495),U=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).onDelete=function(t){var n=e.props.onDelete;n&&n(),t&&t.stopPropagation()},e.onCopyAdd=function(){var t=e.props.onCopyAdd;t&&t()},e.onEdit=function(){var t=e.props.onEdit;t&&t()},e.onClick=function(){var t=e.props.onClick;t&&t()},e}return Object(r.a)(n,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.copyable,o=e.editable,a=e.markable,r=e.deletable;return Object(i.jsxs)("div",{className:"beui-typeset-item",onClick:this.onClick,children:[a&&Object(i.jsx)("span",{className:"beui-typeset-item__mark",children:Object(i.jsx)(h.a,{icon:Object(i.jsx)("i",{className:"bei-check"})})}),Object(i.jsx)("span",{className:"beui-typeset-item__name",children:t}),Object(i.jsxs)("div",{className:"beui-typeset-item__ops",children:[r&&Object(i.jsx)(V.a,{title:"\u786e\u8ba4\u5220\u9664\u8be5\u4e3b\u9898\uff1f",placement:"bottom",onConfirm:this.onDelete,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",children:Object(i.jsx)(h.a,{icon:Object(i.jsx)($.a,{style:{fontSize:"16px"}}),tip:"\u5220\u9664",placement:"top"})}),n&&Object(i.jsx)(h.a,{icon:Object(i.jsx)("i",{className:"bei-copy-add"}),tip:"\u590d\u5236 + \u65b0\u589e",placement:"top",onClick:this.onCopyAdd}),o&&Object(i.jsx)(h.a,{icon:Object(i.jsx)("i",{className:"bei-edit"}),tip:"\u4fee\u6539",placement:"top",onClick:this.onEdit})]})]})}}]),n}(c.Component),W=n(11),K=(n(817),n(818)),X=n.n(K);n(823),n(824),n(825),n(826);n(561),n(668),n(827),n(828);var Y=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).startX=void 0,o.startY=void 0,o.startTop=void 0,o.startRight=void 0,o.mirror=void 0,o.onCodeChange=function(e){var t=o.props,n=t.data,i=t.onUpdate;n.content=e,i(n)},o.onCodeComplete=function(){var e=o.props,t=e.data,n=e.onComplete;t.title=o.state.title,n(t)},o.onChangeTitle=function(e){o.props.data;o.setState({title:e.target.value})},o.onKeyDown=function(e){if(o.mirror){var t=o.mirror.getCodeMirror();"Enter"===e.key||"ArrowLeft"===e.key||"ArrowRight"===e.key||"Tab"===e.key?t.closeHint():"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&t.showHint()}e.stopPropagation()},o.state={title:"",content:""},o}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.data;this.setState(Object(W.a)({},e))}},{key:"render",value:function(){var e=this,t=this.props,n=t.data,o=t.onClose,a=this.state,r=a.title;a.content;return Object(i.jsxs)("div",{className:["typeset-editor"].join(""),children:[Object(i.jsxs)("div",{className:"typeset-editor__header",children:[Object(i.jsx)(h.a,{icon:Object(i.jsx)(k.a,{}),onClick:o}),Object(i.jsx)("div",{children:n.id?"\u4fee\u6539\u81ea\u5b9a\u4e49\u4e3b\u9898":"\u6dfb\u52a0\u81ea\u5b9a\u4e49\u4e3b\u9898"})]}),Object(i.jsx)("div",{className:"typeset-editor__body",onKeyDown:this.onKeyDown,onKeyPressCapture:function(e){e.stopPropagation()},children:Object(i.jsx)(X.a,{value:n.content,ref:function(t){e.mirror=t},options:{tabSize:2,lineNumbers:!0,line:!1,indentWithTabs:!0,smartIndent:!0,autofocus:!0,mode:"css",theme:"idea",height:"100%",hintOptions:{completeSingle:!0}},onChange:this.onCodeChange})}),Object(i.jsxs)("div",{className:"typeset-editor__bar",children:[Object(i.jsx)(j.a,{className:"typeset-editor__title",value:r,onChange:this.onChangeTitle,placeholder:"\u8bf7\u586b\u5199\u81ea\u5b9a\u4e49\u4e3b\u9898\u6807\u9898"}),Object(i.jsx)(B.a,{type:"primary",disabled:!r,onClick:this.onCodeComplete,children:"\u4fdd\u5b58"})]})]})}}]),n}(c.Component),G=n(184),Z=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).unsubscrible=void 0,o.onCloseEditor=function(){o.setState({openEditor:!1}),o.onUpdateCurrentTypeset(),(0,o.props.onTypesetEditing)(!1)},o.onAddTypeset=function(e){var t={title:"".concat((null===e||void 0===e?void 0:e.title)||"\u9ed8\u8ba4","-\u81ea\u5b9a\u4e49"),content:e?e.content:G.a.builtinDefaultTypeset};o.onEditTypeset(t)},o.onEditTypeset=function(e){o.setState({openEditor:!0,editTypeset:e}),o.onUpdateTypeset(e),o.setState({visible:!1}),(0,o.props.onTypesetEditing)(!0)},o.onDeleteTypeset=function(e){G.a.deleteCustomTypeset(e),o.onUpdateCurrentTypeset()},o.onCompleteTypeset=function(e){G.a.saveCustomTypeset(e),o.onUpdateTypeset(e),o.setState({openEditor:!1}),(0,o.props.onTypesetEditing)(!1)},o.onUpdateTypeset=function(e){var t=o.props.editable;t&&t.execCommand("typeset",e)},o.onUpdateCurrentTypeset=function(){var e=o.props.editable;e&&e.execCommand("typeset",o.state.currentTypesetId)},o.onSelectTypeset=function(e){var t=o.props.editable;t&&(t.execCommand("typeset",e),o.setState({currentTypesetId:e.id||"default"}))},o.onVisibleChange=function(e){var t=o.props.editable;if(e&&t){var n=t.queryCommandValue("typeset");o.setState({currentTypesetId:n||""})}o.setState({visible:e})},o.state={openEditor:!1,builtinTypesets:G.a.builtinTypesets,customTypesets:G.a.customTypesets,currentTypesetId:"",visible:!1,editTypeset:{title:"",content:""}},o}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.unsubscrible=G.a.subscribeChanged((function(){e.setState({customTypesets:G.a.customTypesets})}))}},{key:"componentWillUnmount",value:function(){this.unsubscrible&&this.unsubscrible()}},{key:"render",value:function(){var e=this,t=this.props.editable,n=this.state,o=n.openEditor,a=n.editTypeset,r=n.builtinTypesets,s=n.customTypesets,l=n.currentTypesetId,c=n.visible,d=Object(i.jsx)("span",{children:"\u4e3b\u9898\u6392\u7248"}),u=r.map((function(t,n){return Object(i.jsx)(U,{name:t.title,copyable:!0,markable:l===t.id,onCopyAdd:function(){e.onAddTypeset(t)},onClick:function(){e.onSelectTypeset(t)}},t.id||n)})),p=s.map((function(t,n){return Object(i.jsx)(U,{name:t.title,copyable:!0,editable:!0,deletable:!0,markable:l===t.id,onCopyAdd:function(){e.onAddTypeset(t)},onEdit:function(){e.onEditTypeset(t)},onDelete:function(){e.onDeleteTypeset(t)},onClick:function(){e.onSelectTypeset(t)}},t.id||n)})),v=Object(i.jsxs)("div",{children:[Object(i.jsxs)("div",{className:"typeset-category",children:[Object(i.jsxs)("div",{className:"typeset-category__header",children:[Object(i.jsx)("span",{className:"typeset-category__title",children:"\u5185\u7f6e\u4e3b\u9898"}),Object(i.jsx)("span",{className:"typeset-category__add",children:Object(i.jsx)("a",{href:"https://github.com/xitu/juejin-markdown-themes",target:"_blank",children:Object(i.jsx)(h.a,{icon:Object(i.jsx)(q.a,{}),tip:"\u5185\u7f6e\u4e3b\u9898\u53c2\u8003\u6765\u6e90",placement:"top"})})})]}),Object(i.jsx)("div",{className:"typeset-category__list",children:u})]}),Object(i.jsxs)("div",{className:"typeset-category",children:[Object(i.jsxs)("div",{className:"typeset-category__header",children:[Object(i.jsx)("span",{className:"typeset-category__title",children:"\u81ea\u5b9a\u4e49\u4e3b\u9898"}),Object(i.jsx)("span",{className:"typeset-category__add",children:Object(i.jsx)(h.a,{onClick:function(){e.onAddTypeset()},icon:Object(i.jsx)(f.a,{}),tip:"\u65b0\u589e\u81ea\u5b9a\u4e49\u4e3b\u9898",placement:"top"})})]}),Object(i.jsx)("div",{className:"typeset-category__list",children:p})]})]});return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(C.a,{placement:"leftTop",title:d,content:v,trigger:"click",onVisibleChange:this.onVisibleChange,visible:c,children:Object(i.jsx)(h.a,{tip:"\u4e3b\u9898\u6392\u7248",placement:"left",disabled:o||!t,wrapClassName:"editor-side-bar-item app-guide-typeset",icon:Object(i.jsx)("i",{className:"bei-typography"})})}),o&&Object(i.jsx)(Y,{data:a,onClose:this.onCloseEditor,onComplete:this.onCompleteTypeset,onUpdate:this.onUpdateTypeset})]})}}]),n}(c.Component),J=(n(829),n(251)),Q=n(494),ee=(n(830),function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"render",value:function(){var e=this.props,t=e.icon,n=e.name,o=e.onClick;return Object(i.jsxs)("div",{className:"beui-menu-item",onClick:o,children:[Object(i.jsx)("span",{className:"beui-menu-item__icon",children:t}),Object(i.jsx)("span",{className:"beui-menu-item__name",children:n})]})}}]),n}(c.Component)),te=n(1156),ne=n(1157),oe=n(1158),ie=n(1159),ae=n(1160),re=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).onCopyContent=function(t,n){var o=e.props.editable;if(o){var i=o.execCommand("export",t);i&&i.then((function(){J.b.success(n||"\u5df2\u590d\u5236")}))}},e}return Object(r.a)(n,[{key:"render",value:function(){var e=this,t=Object(i.jsxs)("div",{children:[Object(i.jsx)(ee,{name:"\u590d\u5236\u5230\u516c\u4f17\u53f7 (\u5bcc\u6587\u672c)",icon:Object(i.jsx)("i",{className:"bei-official-account",style:{color:"currentColor",fontSize:"12px"}}),onClick:function(){e.onCopyContent("wechat","\u5df2\u590d\u5236\uff0c\u8bf7\u5230\u5fae\u4fe1\u516c\u4f17\u53f7\u7c98\u8d34\u5185\u5bb9")}}),Object(i.jsx)(ee,{name:"\u590d\u5236\u5230\u77e5\u4e4e (\u5bcc\u6587\u672c)",icon:Object(i.jsx)(te.a,{style:{color:"#1389e9"}}),onClick:function(){e.onCopyContent("zhihu","\u5df2\u590d\u5236\uff0c\u8bf7\u5230\u77e5\u4e4e\u7c98\u8d34\u5185\u5bb9")}}),Object(i.jsx)(ee,{name:"\u590d\u5236\u5230\u6398\u91d1 (Markdown)",icon:Object(i.jsx)("i",{className:"bei-juejin",style:{color:"currentColor",fontSize:"12px"}}),onClick:function(){e.onCopyContent("juejin","\u5df2\u590d\u5236\uff0c\u8bf7\u5230\u6398\u91d1\u7c98\u8d34\u5185\u5bb9")}}),Object(i.jsx)(Q.a,{plain:!0,className:"beui-menu-divider"}),Object(i.jsx)(ee,{name:"\u590d\u5236\u4e3a HTML (\u5bcc\u6587\u672c)",icon:Object(i.jsx)(ne.a,{}),onClick:function(){e.onCopyContent("html","\u5df2\u590d\u5236\u4e3a HTML")}}),Object(i.jsx)(ee,{name:"\u590d\u5236\u4e3a Markdown",icon:Object(i.jsx)(oe.a,{}),onClick:function(){e.onCopyContent("markdown","\u5df2\u590d\u5236\u4e3a Markdown")}}),Object(i.jsx)(ee,{name:"\u590d\u5236\u4e3a\u7eaf\u6587\u672c",icon:Object(i.jsx)(ie.a,{}),onClick:function(){e.onCopyContent("plain","\u5df2\u590d\u5236\u4e3a\u7eaf\u6587\u672c")}})]});return Object(i.jsx)(C.a,{placement:"leftTop",title:null,content:t,trigger:"click",children:Object(i.jsx)(h.a,{tip:"\u590d\u5236 & \u5bfc\u51fa",placement:"left",wrapClassName:"editor-side-bar-item app-guide-export",icon:Object(i.jsx)(ae.a,{})})})}}]),n}(c.Component),se=(n(831),n(519)),le=n(115),ce=n(17),de=(n(832),n(525)),ue=n(562),he=n(574),pe=(j.a.TextArea,function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e))._imageEditor=void 0,o.onEditImage=function(e){if(o.props.editable){var t=o.state.url;o._imageEditor||(o._imageEditor=new ue.default({editable:o.props.editable})),o._imageEditor.edit(t,(function(e){e&&o.onChange(e)}))}null===e||void 0===e||e.stopPropagation()},o.onAddImage=function(e){o.props.editable&&(o.state.url?o.onEditImage():Object(he.selectFiles)({accept:"image/*"}).then((function(e){o.uploadByFile(e[0])})));e.stopPropagation()},o.onDelImage=function(e){o.onChange(""),e.stopPropagation()},o.onChange=function(e){o.setState({url:e},(function(){(0,o.props.onChange)(e)}))},o.onDrop=function(e){e.preventDefault(),e.stopPropagation();var t=e.dataTransfer;if(t){var n=t.types;if(n.includes?n.includes("Files"):n.contains("Files")){var i=t.files;return void(i&&i.length&&o.uploadByFile(i[0]))}var a=t.getData("text/html");if(a){var r=document.createElement("div");r.innerHTML=a;var s=r.querySelector("img");s&&s.src&&o.onChange(s.src)}}},o.onDragOver=function(e){o.setState({dragging:!0}),e.preventDefault()},o.onDragLeave=function(e){o.setState({dragging:!1}),e.preventDefault()},o.state={uploading:!1,dragging:!1,url:""},o}return Object(r.a)(n,[{key:"uploadByFile",value:function(e){var t=this;this.props.editable&&(this.setState({uploading:!0}),this.props.editable.getOpt("uploadImage")(e).then((function(e){e?t.onChange(e.url):J.b.error("\u4e0a\u4f20\u56fe\u7247\u5931\u8d25"),t.setState({uploading:!1})})))}},{key:"componentDidMount",value:function(){this.setState({url:this.props.url||""})}},{key:"render",value:function(){var e=this.props.defaultTitle,t=this.state,n=t.url,o=t.uploading,a=t.dragging;return Object(i.jsx)(i.Fragment,{children:Object(i.jsxs)("div",{className:["image-input",a?" image-input--dragging":""].join(""),onClick:this.onAddImage,onDrop:this.onDrop,onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,children:[n&&!o?Object(i.jsx)("img",{src:n}):Object(i.jsxs)("div",{children:[o?Object(i.jsx)(m.a,{}):Object(i.jsx)(f.a,{}),Object(i.jsx)("span",{style:{marginLeft:"10px"},children:o?"\u4e0a\u4f20\u4e2d...":e})]}),!!n&&!o&&Object(i.jsxs)("div",{className:"image-input__ops",children:[Object(i.jsx)(de.a,{className:"image-input__op",onClick:this.onEditImage}),Object(i.jsx)($.a,{className:"image-input__op",onClick:this.onDelImage})]})]})})}}]),n}(c.Component)),fe=j.a.TextArea,ve=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).onToggleVisible=function(){var e=o.state.visible;if(o.setState({visible:!e}),!e){var t=o.props.editable;if(t){var n=t.queryCommandValue("basic");o.setState({title:n.title,cover:n.cover,summary:n.summary})}}(0,o.props.onProfileEditing)(!e)},o.onChangeTitle=function(e){o.setState({title:e.target.value})},o.onChangeSummary=function(e){o.setState({summary:e.target.value})},o.onSave=function(){var e=o.state,t=e.title,n=e.summary,i=e.cover,a=o.props.editable;a&&a.execCommand("basic",{title:t,cover:i,summary:n})},o.onSync=function(){o.onSave();var e=window.syncManager;if(e){var t=o.props.editable;if(t){var n=t.getContent(!0),a=Object(le.e)(n);a?e.sync([a]):J.b.error("\u540c\u6b65\u89e3\u6790\u5185\u5bb9\u5931\u8d25")}}else J.b.info(Object(i.jsxs)(i.Fragment,{children:["\u4ec5\u5728\u684c\u9762\u8f6f\u4ef6\u652f\u6301\u540c\u6b65\u529f\u80fd\uff0c\u7acb\u5373",Object(i.jsx)("a",{href:ce.b,target:"_blank",children:"\u4e0b\u8f7d\u684c\u9762\u8f6f\u4ef6"})]}))},o.onChangeCover=function(e){o.setState({cover:e})},o.state={visible:!1,title:"",cover:"",summary:""},o}return Object(r.a)(n,[{key:"render",value:function(){var e=this.props.editable,t=this.state,n=t.visible,o=t.title,a=t.cover,r=t.summary,s=Object(i.jsxs)("div",{className:"profile-container",children:[Object(i.jsxs)("div",{className:"profile-header",children:[Object(i.jsx)(j.a,{className:"profile-header__title",placeholder:"\u8f93\u5165\u6587\u7ae0\u6807\u9898(\u4e0d\u8d85\u8fc764\u4e2a\u5b57)",spellCheck:!1,value:o,onChange:this.onChangeTitle}),Object(i.jsx)(h.a,{icon:Object(i.jsx)(k.a,{}),onClick:this.onToggleVisible})]}),Object(i.jsxs)("div",{className:["profile-bar"].join(" "),children:[Object(i.jsx)(pe,{url:a,onChange:this.onChangeCover,editable:e,defaultTitle:"\u5c01\u9762\u56fe"}),Object(i.jsx)(fe,{placeholder:"\u8f93\u5165\u6458\u8981(\u4e0d\u8d85\u8fc7120\u4e2a\u5b57)",showCount:!0,rows:3,value:r,maxLength:120,onChange:this.onChangeSummary,spellCheck:!1}),Object(i.jsxs)("div",{className:"profile-buttons",children:[Object(i.jsx)(B.a,{className:"profile-button",disabled:!o&&!a&&!r,onClick:this.onSave,children:"\u4fdd\u5b58"}),Object(i.jsx)(B.a,{type:"primary",className:"profile-button",disabled:!o,onClick:this.onSync,children:"\u540c\u6b65\u5230\u516c\u4f17\u53f7"})]})]})]});return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(h.a,{tip:"\u540c\u6b65\u5230\u516c\u4f17\u53f7",placement:"left",selected:n,wrapClassName:"editor-side-bar-item app-guide-profile",icon:Object(i.jsx)(se.a,{}),onClick:this.onToggleVisible}),n&&s]})}}]),n}(c.Component),be=(n(833),n(1149)),me=Object(i.jsxs)("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"18565",width:"18",height:"18",children:[Object(i.jsx)("path",{d:"M448 320m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z",fill:"currentColor","p-id":"18566"}),Object(i.jsx)("path",{d:"M928 659.2l-130.133333-115.2c-14.933333-14.933333-38.4-14.933333-55.466667 0l-136.533333 113.066667c-8.533333 8.533333-10.666667 21.333333-2.133334 29.866666l27.733334 32c8.533333 8.533333 21.333333 10.666667 29.866666 2.133334l66.133334-55.466667V874.666667c0 12.8 8.533333 21.333333 21.333333 21.333333h42.666667c12.8 0 21.333333-8.533333 21.333333-21.333333v-204.8l57.6 51.2c8.533333 8.533333 21.333333 6.4 29.866667-2.133334l27.733333-32c10.666667-6.4 8.533333-19.2 0-27.733333z",fill:"currentColor","p-id":"18567"}),Object(i.jsx)("path",{d:"M810.666667 128H213.333333c-46.933333 0-85.333333 38.4-85.333333 85.333333v597.333334c0 46.933333 38.4 85.333333 85.333333 85.333333h320c12.8 0 21.333333-8.533333 21.333334-21.333333v-42.666667c0-12.8-8.533333-21.333333-21.333334-21.333333H256c-23.466667 0-42.666667-19.2-42.666667-42.666667v-189.866667l162.133334-102.4 151.466666 110.933334c14.933333 10.666667 34.133333 10.666667 49.066667 0l234.666667-166.4V490.666667c0 12.8 8.533333 21.333333 21.333333 21.333333h42.666667c12.8 0 21.333333-8.533333 21.333333-21.333333V213.333333c0-46.933333-38.4-85.333333-85.333333-85.333333zM554.666667 499.2l-151.466667-108.8c-14.933333-10.666667-32-10.666667-46.933333-2.133333L213.333333 477.866667V256c0-23.466667 19.2-42.666667 42.666667-42.666667h512c23.466667 0 42.666667 19.2 42.666667 42.666667v57.6l-256 185.6z",fill:"currentColor","p-id":"18568"})]}),ge=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).onCache=function(){if(ce.i){var e=o.props.editable;if(e){if(e.image.isCatching)return;o.setState({isCaching:!0}),e.image.cache().then((function(){o.setState({isCaching:!1})}))}}else J.b.info(Object(i.jsxs)(i.Fragment,{children:["\u4ec5\u5728\u684c\u9762\u8f6f\u4ef6\u652f\u6301\u4e0a\u4f20\uff0c\u7acb\u5373",Object(i.jsx)("a",{href:ce.b,target:"_blank",children:"\u4e0b\u8f7d\u684c\u9762\u8f6f\u4ef6"})]}))},o.state={isCaching:!1},o}return Object(r.a)(n,[{key:"render",value:function(){var e=this.props.unmatchedImageCount,t=this.state.isCaching;return Object(i.jsx)(i.Fragment,{children:Object(i.jsx)(be.a,{count:e,size:"small",children:Object(i.jsx)(h.a,{tip:"\u540c\u6b65\u5230\u56fe\u5e8a",placement:"left",wrapClassName:"editor-side-bar-item app-guide-upload",disabled:!e,icon:t?Object(i.jsx)(m.a,{}):me,onClick:this.onCache})})})}}]),n}(c.Component),ke=(n(834),n(111)),ye=ke.a.getLang("toolbar.edit"),Ce=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).onUpdateState=function(){var e=o.props,t=e.editable,n=e.cmdName;if(t){var i=t.queryCommandState(n);o.setState({disabled:-1===i,selected:1===i})}},o.onExeCommand=function(){var e=o.props,t=e.editable,n=e.cmdName;t&&t.execCommand(n)},o.state={disabled:!0,selected:!1},o}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.editable;e&&e.on("selectionchange",this.onUpdateState)}},{key:"componentWillUnmount",value:function(){var e=this.props.editable;e&&e.off("selectionchange",this.onUpdateState)}},{key:"render",value:function(){var e=this.props,t=e.icon,n=e.wrapClassName,o=e.cmdName,a=this.state,r=a.disabled,s=a.selected,l=n?"".concat(n," geui-state-item"):"geui-state-item";return Object(i.jsx)(i.Fragment,{children:Object(i.jsx)(h.a,{tip:ye[o],placement:"left",wrapClassName:l,disabled:r,selected:s,icon:t,onClick:this.onExeCommand})})}}]),n}(c.Component);function _e(e,t,n){return function(o){Object(s.a)(d,o);var c=Object(l.a)(d);function d(){return Object(a.a)(this,d),c.apply(this,arguments)}return Object(r.a)(d,[{key:"render",value:function(){var o=this.props.editable;return Object(i.jsx)(i.Fragment,{children:!!o&&Object(i.jsx)(Ce,{wrapClassName:n,icon:e,cmdName:t,editable:o})})}}]),d}(c.Component)}var xe,Ee=_e(Object(i.jsx)("i",{className:"bei-redo"}),"redo","app-guide-redo"),Oe=_e(Object(i.jsx)("i",{className:"bei-undo"}),"undo","app-guide-undo"),Te=(n(835),function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"render",value:function(){return Object(i.jsx)("div",{className:"beui-seperator"})}}]),n}(c.Component)),we=n(54),Se=n(73),je=n(21),Be=n.n(je),Ne=n(32),Le=n(129),Ie=n(72),Ae=n(23),Re=n(22);!function(e){e[e.RangeContentsActionClone=0]="RangeContentsActionClone",e[e.RangeContentsActionDelete=1]="RangeContentsActionDelete",e[e.RangeContentsActionExtract=2]="RangeContentsActionExtract"}(xe||(xe={}));var Me,De=0,He=function(e,t){var n,o,i=e.startContainer,a=e.endContainer,r=e.startOffset,s=e.endOffset,l=e.document(),c=l.createDocumentFragment();if(i&&1===i.nodeType&&(i=i.childNodes[r]||(n=i.appendChild(l.createTextNode("")))),a&&1===a.nodeType&&(a=a.childNodes[s]||(o=a.appendChild(l.createTextNode("")))),i===a&&i&&3===i.nodeType)return c.appendChild(l.createTextNode(i.substringData(r,s-r))),t&&(i.deleteData(r,s-r),e.collapse(!0)),c;for(var d,u,h=c,p=Ie.a.findParents(i,!0),f=Ie.a.findParents(a,!0),v=0;p[v]===f[v];)v++;for(var b,m=v;b=p[m];m++){for(d=b.nextSibling,b===i&&i?n||(e.startContainer&&3===e.startContainer.nodeType&&i.nodeValue?(h.appendChild(l.createTextNode(i.nodeValue.slice(r))),t&&i.deleteData(r,i.nodeValue.length-r)):h.appendChild(t?i:i.cloneNode(!0))):(u=b.cloneNode(!1),h.appendChild(u));d&&d!==a&&d!==f[m];)b=d.nextSibling,h.appendChild(t?d:d.cloneNode(!0)),d=b;h=u}h=c,p[v]||(h.appendChild(p[v-1].cloneNode(!1)),h=h.firstChild);for(var g,k=v;g=f[k];k++){if(d=g.previousSibling,g===a?!o&&e.endContainer&&3===e.endContainer.nodeType&&(h.appendChild(l.createTextNode(a.substringData(0,s))),t&&a.deleteData(0,s)):(u=g.cloneNode(!1),h.appendChild(u)),k!==v||!p[v])for(;d&&d!==i;)g=d.previousSibling,h.insertBefore(t?d:d.cloneNode(!0),h.firstChild),d=g;h=u}return t&&e.setStartBefore(f[v]?p[v]?f[v]:p[v-1]:f[v-1]).collapse(!0),n&&Ie.a.remove(n),o&&Ie.a.remove(o),c},Pe=function(e,t,n,o){var i=function(e){return e?e.tagName:""}(t);return t&&1===t.nodeType&&(Re.a.$empty[i]||Re.a.$nonChild[i])&&(n=Ie.a.getNodeIndex(t)+(e?0:1),t=t.parentNode),e?(o.startContainer=t,o.startOffset=n,o.endContainer||o.collapse(!0)):(o.endContainer=t,o.endOffset=n,o.startContainer||o.collapse(!1)),Fe(o),o},Fe=function(e){e.collapsed=!!e.startContainer&&!!e.endContainer&&e.startContainer===e.endContainer&&e.startOffset===e.endOffset},ze=function(e){return!e.collapsed&&!!e.startContainer&&1===e.startContainer.nodeType&&e.startContainer===e.endContainer&&e.endOffset-e.startOffset===1},qe=function(e,t){try{if(Me&&Ie.a.inDoc(Me,e))if(Me.nodeValue&&!Me.nodeValue.replace(Ie.a.fillCharReg,"").length){var n=Me.parentNode;for(Ie.a.remove(Me);n&&(Ie.a.isEmptyInlineElement(n)&&Ae.a.safari?!(Ie.a.getPosition(n,t)&Ie.a.POSITION_CONTAINS):!n.contains(t));)Me=n.parentNode,Ie.a.remove(n),n=Me}else Me.nodeValue&&(Me.nodeValue=Me.nodeValue.replace(Ie.a.fillCharReg,""))}catch(o){console.log(o)}},$e=function(e,t){var n;for(e=e[t];e&&Ie.a.isFillChar(e);)n=e[t],Ie.a.remove(e),e=n},Ve=function(){function e(t,n,o){Object(a.a)(this,e),this._document=void 0,this._root=void 0,this._selection=void 0,this.collapsed=void 0,this.startContainer=void 0,this.endContainer=void 0,this.startOffset=void 0,this.endOffset=void 0,this._document=t,this._root=n,this._selection=o,this.collapsed=!0,this.startContainer=this.endContainer=null,this.startOffset=this.endOffset=0}return Object(r.a)(e,[{key:"document",value:function(){return this._document}},{key:"cloneRange",value:function(){return new e(this._document,this._root,this._selection).setStart(this.startContainer,this.startOffset).setEnd(this.endContainer,this.endOffset)}},{key:"cloneContents",value:function(){return this.collapsed?null:He(this,xe.RangeContentsActionClone)}},{key:"deleteContents",value:function(){if(this.collapsed||He(this,xe.RangeContentsActionDelete),Ae.a.webkit){var e=this.startContainer;e&&3===e.nodeType&&!e.nodeValue&&(this.setStartBefore(e).collapse(!0),Ie.a.remove(e))}return this}},{key:"extractContents",value:function(){return this.collapsed?null:He(this,xe.RangeContentsActionExtract)}},{key:"setStart",value:function(e,t){return Pe(!0,e,t,this)}},{key:"setEnd",value:function(e,t){return Pe(!1,e,t,this)}},{key:"setStartAfter",value:function(e){return e.parentNode?this.setStart(e.parentNode,Ie.a.getNodeIndex(e)+1):this}},{key:"setStartBefore",value:function(e){return e.parentNode?this.setStart(e.parentNode,Ie.a.getNodeIndex(e)):this}},{key:"setEndAfter",value:function(e){return e.parentNode?this.setEnd(e.parentNode,Ie.a.getNodeIndex(e)+1):this}},{key:"setEndBefore",value:function(e){return e.parentNode?this.setEnd(e.parentNode,Ie.a.getNodeIndex(e)):this}},{key:"setStartAtFirst",value:function(e){return e.parentNode?this.setStart(e,0):this}},{key:"setStartAtLast",value:function(e){return this.setStart(e,3===e.nodeType?e.nodeValue?e.nodeValue.length:0:e.childNodes.length)}},{key:"setEndAtFirst",value:function(e){return this.setEnd(e,0)}},{key:"setEndAtLast",value:function(e){return this.setEnd(e,3===e.nodeType?e.nodeValue?e.nodeValue.length:0:e.childNodes.length)}},{key:"selectNode",value:function(e){return this.setStartBefore(e).setEndAfter(e)}},{key:"selectNodeContents",value:function(e){return this.setStartAtFirst(e).setEndAtLast(e)}},{key:"getCommonAncestor",value:function(e,t){var n=this.startContainer,o=this.endContainer;return n&&n===o?e&&ze(this)&&1===(n=n.childNodes[this.startOffset]).nodeType?n:t&&3===n.nodeType?n.parentNode:n:n&&o?Ie.a.getCommonAncestor(n,o):null}},{key:"enlargeBoundarySuitably",value:function(){for(var e=this.collapsed;this.startContainer&&(3===this.startContainer.nodeType||!Ie.a.isBlockElm(this.startContainer));){var t;if(0===this.startOffset)this.setStartBefore(this.startContainer);else{if(this.startOffset!==(3===this.startContainer.nodeType?null===(t=this.startContainer.nodeValue)||void 0===t?void 0:t.length:this.startContainer.childNodes.length))break;this.setStartAfter(this.startContainer)}}if(e)return this.collapse(!0);for(;this.endContainer&&(3===this.endContainer.nodeType||!Ie.a.isBlockElm(this.endContainer));){var n;if(0===this.endOffset)this.setEndBefore(this.endContainer);else{if(this.endOffset!==(3===this.endContainer.nodeType?null===(n=this.endContainer.nodeValue)||void 0===n?void 0:n.length:this.endContainer.childNodes.length))break;this.setEndAfter(this.endContainer)}}return this}},{key:"shrinkBoundaryMinimality",value:function(e){var t,n=this.collapsed;function o(e){return 1===e.nodeType&&!Ie.a.isBookmarkNode(e)&&!Re.a.$empty[e.tagName]&&!Re.a.$nonChild[e.tagName]}for(;this.startContainer&&1===this.startContainer.nodeType&&(t=this.startContainer.childNodes[this.startOffset])&&o(t);)this.setStart(t,0);if(n)return this.collapse(!0);if(!e)for(;this.endContainer&&1===this.endContainer.nodeType&&this.endOffset>0&&(t=this.endContainer.childNodes[this.endOffset-1])&&o(t);)this.setEnd(t,t.childNodes.length);return this}},{key:"shrinkBoundarySuitably",value:function(){if(!this.collapsed){for(;this.startContainer&&this.startOffset&&!Ie.a.isRoot(this.startContainer)&&this.startOffset===(3===this.startContainer.nodeType?null===(e=this.startContainer.nodeValue)||void 0===e?void 0:e.length:this.startContainer.childNodes.length);){var e;this.setStartAfter(this.startContainer)}for(;!this.endOffset&&this.endContainer&&!Ie.a.isRoot(this.endContainer)&&(3===this.endContainer.nodeType?null===(t=this.endContainer.nodeValue)||void 0===t?void 0:t.length:this.endContainer.childNodes.length);){var t;this.setEndBefore(this.endContainer)}}return this}},{key:"txtToElmBoundary",value:function(e){function t(e,t){var n="start"===t,o=n?e.startContainer:e.endContainer,i=n?e.startOffset:e.endOffset,a=n?e.setStartBefore.bind(e):e.setEndBefore.bind(e),r=n?e.setStartAfter.bind(e):e.setEndAfter.bind(e);o&&3===o.nodeType&&(i?o.nodeValue&&i>=o.nodeValue.length&&r(o):a(o))}return!e&&this.collapsed||(t(this,"start"),t(this,"end")),this}},{key:"trimBoundary",value:function(e){this.txtToElmBoundary();var t=this.startContainer,n=this.startOffset,o=this.collapsed,i=this.endContainer;if(t&&3===t.nodeType){if(0===n)this.setStartBefore(t);else if(t.nodeValue&&n>=t.nodeValue.length)this.setStartAfter(t);else{var a=Ie.a.split(t,n);t===i&&a?this.setEnd(a,this.endOffset-n):t.parentNode===i&&(this.endOffset+=1),a&&this.setStartBefore(a)}if(o)return this.collapse(!0)}return e||(n=this.endOffset,(i=this.endContainer)&&3===i.nodeType&&(0===n?this.setEndBefore(i):(i.nodeValue&&n<i.nodeValue.length&&Ie.a.split(i,n),this.setEndAfter(i)))),this}},{key:"enlargeBoundary",value:function(e,t){var n,o,i=this._document.createTextNode("");if(e&&this.startContainer){for(1===(o=this.startContainer).nodeType?o.childNodes[this.startOffset]?n=o=o.childNodes[this.startOffset]:(o.appendChild(i),n=o=i):n=o;o;){if(Ie.a.isBlockElm(o)){for(o=n;(n=o.previousSibling)&&!Ie.a.isBlockElm(n);)o=n;this.setStartBefore(o);break}n=o,o=o.parentNode}for((o=this.endContainer)&&1===o.nodeType?((n=o.childNodes[this.endOffset])?o.insertBefore(i,n):o.appendChild(i),n=o=i):n=o;o;){if(Ie.a.isBlockElm(o)){for(o=n;o&&(n=o.nextSibling)&&!Ie.a.isBlockElm(n);)o=n;o&&this.setEndAfter(o);break}n=o,o=o.parentNode}i.parentNode===this.endContainer&&this.endOffset--,Ie.a.remove(i)}if(!this.collapsed){for(;0===this.startOffset&&this.startContainer&&(!t||!t(this.startContainer))&&!Ie.a.isRoot(this.startContainer);)this.setStartBefore(this.startContainer);for(;this.endContainer&&this.endOffset===(3===this.endContainer.nodeType?null===(a=this.endContainer.nodeValue)||void 0===a?void 0:a.length:this.endContainer.childNodes.length);){var a;if(t&&t(this.endContainer))break;if(Ie.a.isRoot(this.endContainer))break;this.setEndAfter(this.endContainer)}}return this}},{key:"enlargeToBlockElm",value:function(e){for(;this.startContainer&&!Ie.a.isBlockElm(this.startContainer);)this.setStartBefore(this.startContainer);if(!e)for(;this.endContainer&&!Ie.a.isBlockElm(this.endContainer);)this.setEndAfter(this.endContainer);return this}},{key:"insertNode",value:function(e){var t=e,n=1;11===e.nodeType&&e.firstChild&&(t=e.firstChild,n=e.childNodes.length),this.trimBoundary(!0);var o=this.startContainer,i=this.startOffset;if(o){var a=o.childNodes[i];a?o.insertBefore(e,a):o.appendChild(e)}return t.parentNode===this.endContainer&&(this.endOffset=this.endOffset+n),this.setStartBefore(t)}},{key:"applyInlineStyle",value:function(e,t,n){if(this.collapsed)return this;this.trimBoundary().enlargeBoundary(!1,(function(e){return 1===e.nodeType&&Ie.a.isBlockElm(e)})).shrinkBoundarySuitably();for(var o,i,a,r=this.createBookmark(),s=r.end,l=function(e){return 1===e.nodeType?"br"!==e.tagName.toLowerCase():!Ie.a.isWhitespace(e)},c=Ie.a.getNextDomNode(r.start,!1,l),d=this.cloneRange();c&&Ie.a.getPosition(c,s)&Ie.a.POSITION_PRECEDING;)if(3===c.nodeType||Re.a[e][c.tagName]){for(d.setStartBefore(c),o=c;o&&(3===o.nodeType||Re.a[e][o.tagName])&&o!==s;)i=o,o=Ie.a.getNextDomNode(o,1===o.nodeType,null,(function(t){return Re.a[e][t.tagName]}));var u=d.setEndAfter(i).extractContents(),h=void 0;if(n&&n.length>0){var p=void 0;a=p=n[0].cloneNode(!1);for(var f,v=1;f=n[v++];)p&&(p.appendChild(f.cloneNode(!1)),p=p.firstChild);h=p}else h=d._document.createElement(e);if(t&&Ie.a.setAttributes(h,t),h)if(h.appendChild(u),"SPAN"===h.tagName&&t&&t.style)h.querySelectorAll("span").forEach((function(e){e.style.cssText=e.style.cssText+";"+t.style}));(n&&a||h)&&d.insertNode(n?a:h);var b=void 0;if("span"===e&&t.style&&/text-decoration/.test(t.start)&&(b=Ie.a.findParentByTagName(h,"a",!0))?(Ie.a.setAttributes(b,t),Ie.a.remove(h,!0),h=b):(Ie.a.mergeSibling(h),Ie.a.clearEmptySibling(h)),Ie.a.mergeChild(h,t),Ie.a.mergeToParent(h),o===s)break;c=Ie.a.getNextDomNode(h,!1,l)}else c=Ie.a.getNextDomNode(c,!0,l);return this.moveToBookmark(r)}},{key:"removeInlineStyle",value:function(e){if(this.collapsed)return this;e=Array.isArray(e)?e:[e],this.shrinkBoundaryMinimality().shrinkBoundarySuitably();for(var t=this.startContainer,n=this.endContainer;t;){if(1===t.nodeType)if("break"===function(){var n=t.tagName.toLowerCase();return e.findIndex((function(e){return e.toLowerCase()===n}))>-1?"break":Ie.a.isRoot(t)?(t=null,"break"):void 0}())break;t=t.parentNode}for(;n;){if(1===n.nodeType)if("break"===function(){var t=n.tagName.toLowerCase();return e.findIndex((function(e){return e.toLowerCase()===t}))>-1?"break":Ie.a.isRoot(n)?(n=null,"break"):void 0}())break;n=n.parentNode}var o,i,a=this.createBookmark();t&&(o=(i=this.cloneRange().setEndBefore(a.start).setStartBefore(t)).extractContents(),i.insertNode(o),Ie.a.clearEmptySibling(t,!0),t.parentNode&&t.parentNode.insertBefore(a.start,t)),n&&a.end&&(o=(i=this.cloneRange().setStartAfter(a.end).setEndAfter(n)).extractContents(),i.insertNode(o),Ie.a.clearEmptySibling(n,!1,!0),n.parentNode&&n.parentNode.insertBefore(a.end,n.nextSibling));for(var r,s=Ie.a.getNextDomNode(a.start,!1,(function(e){return 1===e.nodeType}));s&&s!==a.end;)r=Ie.a.getNextDomNode(s,!0,(function(e){return 1===e.nodeType})),e.findIndex((function(e){return e.toLowerCase()===s.tagName.toLowerCase()}))>-1&&Ie.a.remove(s,!0),s=r;return this.moveToBookmark(a)}},{key:"applyParagraphStyle",value:function(e,t,n){var o,i=this;if(this.collapsed&&(o=this._document.createTextNode("p"),this.insertNode(o),Ae.a.ie)){var a=o.previousSibling;a&&Ie.a.isWhitespace(a)&&Ie.a.remove(a),(a=o.nextSibling)&&Ie.a.isWhitespace(a)&&Ie.a.remove(a)}var r=["TD","LI","PRE"],s=this.createBookmark(),l=function(e){return 1===e.nodeType?"br"!==e.tagName.toLowerCase()&&!Ie.a.isBookmarkNode(e):!Ie.a.isWhitespace(e)};this.enlargeBoundary(!0);for(var c,d,u=this.createBookmark(),h=Ie.a.getNextDomNode(u.start,!1,l),p=this.cloneRange();h&&!(Ie.a.getPosition(h,u.end)&Ie.a.POSITION_FOLLOWING);)3!==h.nodeType&&Ie.a.isBlockElm(h)?h=Ie.a.getNextDomNode(h,!0,l):function(){for(p.setStartBefore(h);h&&h!==u.end&&!Ie.a.isBlockElm(h);)d=h,h=Ie.a.getNextDomNode(h,!1,null,(function(e){return!Ie.a.isBlockElm(e)}));p.setEndAfter(d),c=i._document.createElement(e),t&&(Ie.a.setAttributes(c,t),n&&t.style&&(c.style.cssText=t.style));var o=p.extractContents();o&&c.appendChild(o),Ie.a.isEmptyNode(c)&&Ie.a.fillNode(i._document,c),p.insertNode(c);var a=c.parentNode;a&&Ie.a.isBlockElm(a)&&!Ie.a.isRoot(a)&&-1===r.findIndex((function(e){return e.toLowerCase()===a.tagName}))&&(n||(a.getAttribute("dir")&&c.setAttribute("dir",a.getAttribute("dir")||""),a.style.cssText&&(c.style.cssText=a.style.cssText+";"+c.style.cssText),a.style.textAlign&&!c.style.textAlign&&(c.style.textAlign=a.style.textAlign),a.style.textIndent&&!c.style.textIndent&&(c.style.textIndent=a.style.textIndent),a.style.padding&&!c.style.padding&&(c.style.padding=a.style.padding)),t&&/h\d/i.test(a.tagName)&&!/h\d/i.test(c.tagName)?(Ie.a.setAttributes(a,t),t.style&&n&&(a.style.cssText=t.style),Ie.a.remove(c,!0),c=a):c.parentNode&&Ie.a.remove(c.parentNode,!0)),h=-1!==r.findIndex((function(e){return e.toLowerCase()===a.tagName}))?a:c,h=Ie.a.getNextDomNode(h,!1,l)}();if(this.moveToBookmark(u).moveToBookmark(s),o){this.setStartBefore(o).collapse(!0);var f=o.parentNode;Ie.a.remove(o),f&&Ie.a.isBlockElm(f)&&Ie.a.isEmptyNode(f)&&Ie.a.fillNode(this._document,f)}if(Ae.a.gecko&&this.collapsed&&this.startContainer&&1===this.startContainer.nodeType){var v=this.startContainer.childNodes[this.startOffset];v&&1===v.nodeType&&v.tagName.toLowerCase()===e.toLowerCase()&&this.setStart(v,0).collapse(!0)}return this}},{key:"applyJustify",value:function(e){var t;this.collapsed&&(t=this._document.createTextNode("p"),this.insertNode(t));var n=this.createBookmark(),o=function(e){return 1===e.nodeType?"br"!==e.tagName.toLowerCase()&&!Ie.a.isBookmarkNode(e):!Ie.a.isWhitespace(e)};this.enlargeBoundary(!0);for(var i,a=this.createBookmark(),r=Ie.a.getNextDomNode(a.start,!1,o),s=this.cloneRange();r&&!(Ie.a.getPosition(r,a.end)&Ie.a.POSITION_FOLLOWING);)if(3!==r.nodeType&&Ie.a.isBlockElm(r))r=Ie.a.getNextDomNode(r,!0,o);else{for(s.setStartBefore(r);r&&r!==a.end&&!Ie.a.isBlockElm(r);)i=r,r=Ie.a.getNextDomNode(r,!1,null,(function(e){return!Ie.a.isBlockElm(e)}));s.setEndAfter(i);var l=s.getCommonAncestor();if(l&&!Ie.a.isRoot(l)&&Ie.a.isBlockElm(l))Ie.a.setStyles(l,"string"===typeof e?{"text-align":e}:e),r=l;else{var c=this._document.createElement("p");Ie.a.setStyles(c,"string"===typeof e?{"text-align":e}:e);var d=s.extractContents();c.appendChild(d),s.insertNode(c),r=c}r=Ie.a.getNextDomNode(r,!1,o)}return this.moveToBookmark(a).moveToBookmark(n),t&&(this.setStartBefore(t).collapse(!0),Ie.a.remove(t)),this}},{key:"collapse",value:function(e){return e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset):(this.startContainer=this.endContainer,this.startOffset=this.endOffset),this.collapsed=!0,this}},{key:"getClosedNode",value:function(){var e;if(!this.collapsed){var t=this.cloneRange().shrinkBoundarySuitably().shrinkBoundaryMinimality();if(ze(t)&&t.startContainer){var n=t.startContainer.childNodes[t.startOffset];n&&1===n.nodeType&&(Re.a.$empty[n.tagName]||Re.a.$nonChild[n.tagName])&&(e=n)}}return e}},{key:"scrollToView",value:function(e,t){e=e||Ie.a.getWindow(this._document);var n=this._document.createElement("span");return n.innerHTML="&nbsp;",this.cloneRange().insertNode(n),Ie.a.scrollToView(n,e,t),Ie.a.remove(n),this}},{key:"inFillChar",value:function(){var e=this.startContainer;return this.collapsed&&e&&3===e.nodeType&&e.nodeValue&&e.nodeValue.replace(new RegExp("^"+Ie.a.fillChar),"").length+1===e.nodeValue.length}},{key:"createBookmark",value:function(e,t){var n=null,o=this._document.createElement("span");return o.style.cssText="display:none;line-height:0px;",o.appendChild(this._document.createTextNode("\u200d")),o.id="_ge_bookmark_start_"+(t?"":De++),this.collapsed||((n=o.cloneNode(!0)).id="_ge_bookmark_end_"+(t?"":De++)),this.insertNode(o),n&&this.collapse(!1).insertNode(n).setEndBefore(n),this.setStartAfter(o),{start:e?o.id:o,end:n?e?n.id:n:null,id:e}}},{key:"moveToBookmark",value:function(e){var t=this._root.getRootNode(),n=e.id?t.getElementById(e.start):e.start,o=e.end&&e.id?t.getElementById(e.end):e.end;return n&&(this.setStartBefore(n),Ie.a.remove(n)),o?(this.setEndBefore(o),Ie.a.remove(o)):this.collapse(!0),this}},{key:"createAddress",value:function(e,t){var n=this,o={collapsed:!!this.collapsed,startAddress:[]},i=function(e){for(var o,i=e?n.startContainer:n.endContainer,a=Ie.a.findParents(i,!0,(function(e){return!Ie.a.isRoot(e)})),r=[],s=0;o=a[s++];)r.push(Ie.a.getNodeIndex(o,t));var l=0;if(t&&i){if(3===i.nodeType){for(var c=i.previousSibling;c&&3===c.nodeType;)l+=c.nodeValue?c.nodeValue.replace(Ie.a.fillCharReg,"").length:0,c=c.previousSibling;l+=e?n.startOffset:n.endOffset}else if(i=i.childNodes[e?n.startOffset:n.endOffset])l=Ie.a.getNodeIndex(i,t);else if(i=e?n.startContainer:n.endContainer)for(var d=i.firstChild;d;)if(Ie.a.isFillChar(d))d=d.nextSibling;else if(l++,3===d.nodeType)for(;d&&3===d.nodeType;)d=d.nextSibling;else d=d.nextSibling}else l=e?i&&Ie.a.isFillChar(i)?0:n.startOffset:n.endOffset;return l<0&&(l=0),r.push(l),r};return o.startAddress=i(!0),e||(o.endAddress=this.collapsed?Array.from(o.startAddress):i()),o}},{key:"moveToAddress",value:function(e,t){var n=this,o=function(e,t){for(var o,i,a=n._root,r=0,s=0;s<e.length;s++)if(o=a,i=e[s],!(a=a.childNodes[i])){r=i;break}t?a?n.setStartBefore(a):n.setStart(o,r):a?n.setEndAfter(a):n.setEnd(o,r)};return o(e.startAddress,!0),!t&&e.endAddress&&o(e.endAddress),this}},{key:"equals",value:function(e){return this.startContainer===e.startContainer&&this.startOffset===e.startOffset&&this.endContainer===e.endContainer&&this.endOffset===e.endOffset}},{key:"traversal",value:function(e,t){if(this.collapsed)return this;for(var n=this.createBookmark(),o=n.end,i=Ie.a.getNextDomNode(n.start,!1,t);i&&o&&i!==o&&Ie.a.getPosition(i,o)&Ie.a.POSITION_PRECEDING;){var a=Ie.a.getNextDomNode(i,!1,t);e(i),i=a}return this.moveToBookmark(n)}},{key:"setCursor",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.collapse(!e).select(t)}},{key:"select",value:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=function(e){var t=function(t,n,o){3===t.nodeType&&t.nodeValue&&t.nodeValue.length<n&&("start"===o?e.startOffset=t.nodeValue.length:e.endOffset=t.nodeValue.length)};e.startContainer&&t(e.startContainer,e.startOffset,"start"),e.endContainer&&t(e.endContainer,e.endOffset,"end")},o=Ie.a.getWindow(this._document),i=this._selection;if(Ae.a.gecko?this._document.body.focus():o.focus(),i){if(i.removeAllRanges(),this.collapsed&&!t){var a=this.startContainer,r=a;a&&1===a.nodeType&&(r=a.childNodes[this.startOffset]),!a||3===a.nodeType&&this.startOffset||(r?r.previousSibling&&3===r.previousSibling.nodeType:a.lastChild&&3===a.lastChild.nodeType)||(e=this._document.createTextNode(Ie.a.fillChar),this.insertNode(e),qe(this._document,e),$e(e,"previousSibling"),$e(e,"nextSibling"),Me=e,this.setStart(e,Ae.a.webkit?1:0).collapse(!0))}if(this.collapsed&&Ae.a.opera&&this.startContainer&&1===this.startContainer.nodeType){var s=this.startContainer.childNodes[this.startOffset];if(s){for(;s&&Ie.a.isBlockElm(s)&&1===s.nodeType&&s.childNodes[0];)s=s.childNodes[0];this.setStartBefore(s).collapse(!0)}else(s=this.startContainer.lastChild)&&Ie.a.isBr(s)&&this.setStartBefore(s).collapse(!0)}n(this),i.addRange(this)}return this}},{key:"getBoundingClientRect",value:function(){var e=document.createRange();return e.setStart(this.startContainer,this.startOffset),e.setEnd(this.endContainer,this.endOffset),e.getBoundingClientRect()}}]),e}(),Ue=function(){function e(t,n,o){Object(a.a)(this,e),this._document=void 0,this._root=void 0,this._nativeSelection=void 0,this._ranges=void 0,this._cachedRange=void 0,this._cachedStartElement=void 0,this._cachedStartElementPath=void 0,this._bakRange=void 0,this.commandBackground="backColor",this.commandRemoveFormat="removeFormat",this._isFakeBackgroundEnabled=void 0,this._document=t,this._root=n,this._nativeSelection=o||t.getSelection(),this._ranges=[],this._cachedRange=null}return Object(r.a)(e,[{key:"getCacheNativeRange",value:function(){if(this._cachedRange)return this._cachedRange;var e=this.getNativeRange();return this._bakRange=this._ranges[0]=e}},{key:"getNativeRange",value:function(){var e=this,t=function(t){for(var n=e._root.firstChild,o=t.collapsed;n&&n.firstChild;)t.setStart(n,0),n=n.firstChild;t.startContainer||t.setStart(e._root,0),o&&t.collapse(!0)},n=new Ve(this._document,this._root,this);if(Ae.a.ie9below);else{var o=this._nativeSelection;if(o&&o.rangeCount){var i=o.getRangeAt(0),a=o.getRangeAt(o.rangeCount-1);n.setStart(i.startContainer,i.startOffset).setEnd(a.endContainer,a.endOffset),n.collapsed&&n.startContainer&&Ie.a.isRoot(n.startContainer)&&!n.startOffset&&t(n)}else{if(this._bakRange&&this._bakRange.startContainer&&Ie.a.inDoc(this._bakRange.startContainer,this._root))return this._bakRange;t(n)}}return n}},{key:"cache",value:function(){this.clearCache(),this._cachedRange=this.getNativeRange(),this._cachedStartElement=this.getStart(),this._cachedStartElementPath=this.getStartElementPath()}},{key:"restore",value:function(){this._cachedRange&&this._cachedRange.select(!0)}},{key:"clearCache",value:function(){this._cachedRange=this._cachedStartElement=this._cachedStartElementPath=null}},{key:"cachedRange",value:function(){return this._cachedRange}},{key:"cachedStartElement",value:function(){return this._cachedStartElement}},{key:"getStart",value:function(){if(this._cachedStartElement)return this._cachedStartElement;var e=this.getNativeRange();e.shrinkBoundaryMinimality();var t=e.startContainer;return t&&1===t.nodeType&&t.hasChildNodes()&&(t=t.childNodes[Math.min(t.childNodes.length-1,e.startOffset)]),t&&3===t.nodeType?t.parentNode:t}},{key:"getStartElementPath",value:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var e=this.getStart();return e?Ie.a.findParents(e,!0,null,!0):[]}},{key:"getRangeAt",value:function(e){return this.getCacheNativeRange()}},{key:"addRange",value:function(e){var t,n=this._document.createRange();e.startContainer&&n.setStart(e.startContainer,e.startOffset),e.endContainer&&n.setEnd(e.endContainer,e.endOffset),null===(t=this._nativeSelection)||void 0===t||t.addRange(n)}},{key:"removeAllRanges",value:function(){this.clearCache(),this._nativeSelection&&this._nativeSelection.removeAllRanges(),this._ranges=[]}},{key:"setCursor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.getRangeAt(0);if(Ie.a.isNativeInput(e)){if(!Ie.a.canSetCursor(e))return;return e.focus(),e.selectionStart=e.selectionEnd=t,e.getBoundingClientRect()}return n.setStart(e,t).collapse(!0),n.setCursor(!0,!0),n.getBoundingClientRect()}},{key:"select",value:function(e){var t=this.getRangeAt(0);return t.selectNode(e).select(!0),t.getBoundingClientRect()}},{key:"isCollapsed",get:function(){return this.getRangeAt(0).collapsed}},{key:"rangeCount",get:function(){var e;return null===(e=this._nativeSelection)||void 0===e?void 0:e.rangeCount}},{key:"exists",get:function(){var e=this._nativeSelection;return!!e&&!!e.anchorNode}},{key:"anchorNode",get:function(){var e;return null===(e=this._nativeSelection)||void 0===e?void 0:e.anchorNode}},{key:"focusNode",get:function(){var e;return null===(e=this._nativeSelection)||void 0===e?void 0:e.focusNode}},{key:"anchorElement",get:function(){var e=this.anchorNode;return e?1!==e.nodeType?e.parentElement:e:null}},{key:"focusOffset",get:function(){var e;return null===(e=this._nativeSelection)||void 0===e?void 0:e.focusOffset}},{key:"rangeRect",get:function(){var e,t=this._nativeSelection,n={x:0,y:0,width:0,height:0};if(void 0===this.rangeCount)return n;if(0===t.rangeCount)return n;if((e=this.getRangeAt(0).cloneRange()).getBoundingClientRect&&(n=e.getBoundingClientRect()),0===n.x&&0===n.y){var o=document.createElement("span");if(o.getBoundingClientRect){o.appendChild(document.createTextNode("\u200b")),e.insertNode(o),n=o.getBoundingClientRect();var i=o.parentNode;i&&(i.removeChild(o),i.normalize())}}return n}},{key:"textContent",get:function(){var e;return(null===(e=this._nativeSelection)||void 0===e?void 0:e.toString())||""}}]),e}(),We={table:1,tbody:1,tr:1,ol:1,ul:1},Ke={bold:"strong",italic:"em",underline:"u",strikethrough:"del",inlinecode:"code",kbd:"kbd",subscript:"sub",superscript:"sup",mark:"mark"};function Xe(e){return e?((3===e.nodeType?e.nodeValue:e.textContent)||"").replace(Ie.a.fillCharReg,""):""}function Ye(e,t,n){var o=t.searchKey,i=new RegExp(o,"g"+(t.caseSensitive?"":"i"));if(-1===t.dir){e=(e=e.substr(0,n)).split("").reverse().join(""),o=o.split("").reverse().join("");var a=i.exec(e);if(a)return n-a.index-o.length}else{e=e.substr(n);var r=i.exec(e);if(r)return r.index+n}return-1}function Ge(e,t,n){for(var o,i=0,a=e.firstChild,r=0;a;){if(3==a.nodeType){if((i+=r=Xe(a).replace(/(^[\t\r\n]+)|([\t\r\n]+$)/,"").length)>=t)return{node:a,index:r-(i-t)}}else if(!Re.a.$empty[a.nodeName]&&(i+=r=Xe(a).replace(/(^[\t\r\n]+)|([\t\r\n]+$)/,"").length)>=t&&(o=Ge(a,r-(i-t),n)))return o;a=Ie.a.getNextDomNode(a)}}function Ze(e,t,n){n=n||e.selection.getRangeAt(0).cloneRange();var o,i=t.searchKey,a=e.document.createElement("span");a.innerHTML="$$searchreplace_key$$",n.shrinkBoundaryMinimality(!0),n.insertNode(a),n.enlargeToBlockElm(!0);var r=Xe(o=n.startContainer).indexOf("$$searchreplace_key$$");n.setStartBefore(a),Ie.a.remove(a);var s=o&&function(e,t,n){var o,i=n.all||1==n.dir?Ie.a.getNextDomNode:Ie.a.getPreDomNode;for(Ie.a.isRoot(e)&&(e=e.firstChild);e;){if(-1!=(o=Ye(Xe(e),n,t)))return{node:e,index:o};for(e=i(e);e&&We[e.nodeName.toLowerCase()];)e=i(e,!0);e&&(t=-1==n.dir?Xe(e).length:0)}}(o,r,t);if(s){var l=Ge(s.node,s.index,i),c=Ge(s.node,s.index+i.length,i);return l&&n.setStart(l.node,l.index),c&&n.setEnd(c.node,c.index),void 0!==t.replaceKey&&t.replace&&Je(e,n,t),!0}}function Je(e,t,n){if(n.replaceType&&"text"!==n.replaceType){if(n.replaceFormat){var o=t.extractContents();if(o){var i=Ke[n.replaceFormat],a=e.document.createElement(i);a.innerText=o.textContent||"",t.insertNode(a)}}}else{var r=e.document.createTextNode(n.replaceKey||"");t.deleteContents().insertNode(r)}}var Qe=function(){function e(t){var n=this,o=t.editor;Object(a.a)(this,e),this._resultList=[],this._currentIndex=0,this._editor=void 0,this._canvas=void 0,this._holder=void 0,this._editor=o,this._editor.ready((function(){n.makeHighlightCanvas()}))}return Object(r.a)(e,[{key:"search",value:function(e){return this._editor.trigger("beforesearch"),this._resultList=this.doSearch(e),this._editor.trigger("aftersearch"),this._currentIndex=0,this.update()}},{key:"replace",value:function(e){if(("format"===e.replaceType||e.replaceKey)&&this._resultList.length)if(e.all)e.replace=!0,this.doReplace(e),"format"===e.replaceType?this._resultList=this.doSearch(e):this._resultList=[],this._currentIndex=0;else{this._currentIndex=this._currentIndex%this._resultList.length;var t=this._resultList[this._currentIndex];Je(this._editor,t,e),e.all=!0,this._resultList=this.doSearch(e),this._currentIndex=this._currentIndex%this._resultList.length}return this.update()}},{key:"jumpNext",value:function(){var e=this._currentIndex%this._resultList.length;return this._currentIndex=++this._currentIndex%this._resultList.length,this.update(e)}},{key:"jumpPrev",value:function(){var e=this._currentIndex%this._resultList.length;return this._currentIndex=(--this._currentIndex+this._resultList.length)%this._resultList.length,this.update(e)}},{key:"jumpIndex",value:function(e){if(e<0||e>=this._resultList.length)return{index:this._currentIndex,list:this._resultList};var t=this._currentIndex%this._resultList.length;return this._currentIndex=e,this.update(t)}},{key:"clear",value:function(){return this._resultList=[],this._currentIndex=0,this.update()}},{key:"update",value:function(e){var t=this._editor.holder.getBoundingClientRect(),n=t.top,o=t.left;function i(e,t,i,a){e.fillStyle=i;for(var r,s=0;r=t[s];s++){var l=r.left-o,c=r.top-n;a&&e.clearRect(l,c,r.width,r.height),e.fillRect(l,c,r.width,r.height)}}var a=this._editor.document.createRange(),r=this._canvas.getContext("2d");if(r){if(e){var s=this._resultList[e];a.setStart(s.startContainer,s.startOffset),a.setEnd(s.endContainer,s.endOffset);var l=a.getClientRects();i(r,l,"rgba(244,206,94,0.3)",!0),s=this._resultList[this._currentIndex],a.setStart(s.startContainer,s.startOffset),a.setEnd(s.endContainer,s.endOffset),i(r,l=a.getClientRects(),"rgba(166,210,252,0.3)",!0)}else{this._canvas.height=this._holder.offsetHeight,this._canvas.width=this._holder.offsetWidth,r.clearRect(0,0,this._canvas.width,this._canvas.height);for(var c,d=0;c=this._resultList[d];d++){a.setStart(c.startContainer,c.startOffset),a.setEnd(c.endContainer,c.endOffset),i(r,a.getClientRects(),d===this._currentIndex?"rgba(166,210,252,0.3)":"rgba(244,206,94,0.3)")}}if(this._resultList.length){var u=this._resultList[this._currentIndex],h=Ie.a.findParent(u.startContainer,(function(e){return 1==e.nodeType}),!0);h&&h.scrollIntoView({block:"center",behavior:"smooth"})}return{list:this._resultList,index:this._currentIndex}}}},{key:"doSearch",value:function(e){return e.replace=!1,this.searchReplace(e)}},{key:"doReplace",value:function(e){return e.replace=!0,this.searchReplace(e)}},{key:"searchReplace",value:function(e){var t=this._editor.selection.getRangeAt(0).cloneRange(),n=this._editor.holder.firstChild;n&&1==n.nodeType?(t.setStart(n,0),t.shrinkBoundaryMinimality(!0)):n&&3==n.nodeType&&t.setStartBefore(n),t.collapse(!0);for(var o=[];Ze(this._editor,e,t)&&(o.push(t.cloneRange()),e.all);)t.collapse(!1);return o}},{key:"makeHighlightCanvas",value:function(){var e=this._editor.holder.parentNode;if(e){var t=this._editor.document.createElement("div");t.setAttribute("id","search-highlight"),t.setAttribute("class","search-highlight"),t.style.cssText="position: absolute;pointer-events: none;top: 0;bottom: 0;right: 0;left: 0",e.appendChild(t),this._holder=t;var n=this._editor.document.createElement("canvas");n.style.maxWidth="100%",t.appendChild(n),this._canvas=n}}}]),e}(),et=n(130),tt=function(){function e(){Object(a.a)(this,e),this.listeners=void 0}return Object(r.a)(e,[{key:"getListener",value:function(e){return this.listeners=this.listeners||{},this.listeners[e]||(this.listeners[e]=[])}},{key:"on",value:function(e,t){"string"===typeof e&&(e=e.trim().split(/\s+/));var n,o=Object(et.a)(e);try{for(o.s();!(n=o.n()).done;){var i=n.value,a=this.getListener(i);-1===a.findIndex((function(e){return e===t}))&&a.push(t)}}catch(r){o.e(r)}finally{o.f()}}},{key:"off",value:function(e,t){"string"===typeof e&&(e=e.trim().split(/\s+/));var n,o=Object(et.a)(e);try{for(o.s();!(n=o.n()).done;){var i=n.value,a=this.getListener(i),r=a.findIndex((function(e){return e===t}));-1!==r&&a.splice(r,1)}}catch(s){o.e(s)}finally{o.f()}}},{key:"trigger",value:function(e){var t=this;"string"===typeof e&&(e=e.trim().split(/\s+/));for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];var a,r=Object(et.a)(e);try{var s=function(){var e=a.value,n=t.getListener(e),i=[e].concat(o);n.forEach((function(e){e.apply(t,i)}))};for(r.s();!(a=r.n()).done;)s()}catch(l){r.e(l)}finally{r.f()}}}]),e}();var nt,ot=function(){function e(){Object(a.a)(this,e),this.commands=void 0,this.options=void 0}return Object(r.a)(e,[{key:"registerCommand",value:function(e){var t=this;return"function"===typeof e&&(e=e.apply(this)),!!e&&(this.commands=this.commands||{},Array.isArray(e)||(e=[e]),e.forEach((function(e){t.commands[e.cmdName.toLowerCase()]=e,e.defaultOptions&&t.setOpt(e.defaultOptions)})),!0)}},{key:"setOpt",value:function(e,t){var n={};"string"===typeof e&&t?n[e]=t:"object"===typeof e&&(n=e),this.options||(this.options={}),Object.assign(this.options,n)}},{key:"getOpt",value:function(e){return e&&this.options&&this.options[e]}},{key:"command",value:function(e){return this.commands[e]}},{key:"execCommand",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if(e)return this.callCmdFn("execCommand",arguments)}},{key:"queryCommandValue",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return this.callCmdFn("queryCommandValue",arguments)}},{key:"queryCommandState",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return this.callCmdFn("queryCommandState",arguments)}},{key:"queryCommandEnabled",value:function(e){return this.callCmdFn("queryCommandEnabled",arguments)}},{key:"queryCommandSupported",value:function(e){return!!this.commands[e]}},{key:"callCmdFn",value:function(e,t){var n=t[0].toLowerCase(),o=this.commands[n],i=o&&o[e];return t[0]=n,!!(o&&i||"queryCommandState"!==e)&&(i?i.apply(this,t):void 0)}}]),e}(),it=function(){function e(){Object(a.a)(this,e),this.commands=void 0,this.listeners=void 0,this.options=void 0}return Object(r.a)(e,[{key:"registerCommand",value:function(e){return!1}},{key:"command",value:function(e){}},{key:"setOpt",value:function(e,t){}},{key:"getOpt",value:function(e){}},{key:"execCommand",value:function(e){return!1}},{key:"queryCommandValue",value:function(e){}},{key:"queryCommandState",value:function(e){return 0}},{key:"queryCommandEnabled",value:function(e){return!1}},{key:"queryCommandSupported",value:function(e){return!1}},{key:"callCmdFn",value:function(e,t){}},{key:"getListener",value:function(e){return[]}},{key:"on",value:function(e,t){}},{key:"off",value:function(e,t){}},{key:"trigger",value:function(e){}}]),e}();nt=it,[ot,tt].forEach((function(e){Object.getOwnPropertyNames(e.prototype).forEach((function(t){nt.prototype[t]=e.prototype[t]}))}));var at={Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Alt:18,CapsLock:20,Esc:27,Spacebar:32,PageUp:33,PageDown:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Insert:45,Del:46,NumLock:144,Cmd:91,"=":187,"-":189,".":190,",":188,"'":222,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90},rt=["strong","b","del","s","strike","em","i","mark","u","code","sup","sub","math","kbd"],st=function(e,t,n){return{cmdName:e,execCommand:function(e){var n=this,o=n.selection.getRangeAt(0),i=n.$dom.filterNodeList(n.selection.getStartElementPath(),t);if(o.collapsed){if(i){var a=o.document().createTextNode("");o.insertNode(a).removeInlineStyle(t),o.setStartBefore(a),n.$dom.remove(a)}else{if("sup"===e||"sub"===e){var r=n.document.createTextNode("");o.insertNode(r).removeInlineStyle(rt).setStartBefore(r).collapse(!0)}var s=o.document().createElement(t[0]);o.insertNode(s).setStart(s,0)}o.collapse(!0)}else"sup"!==e&&"sub"!==e||i&&i.tagName.toLowerCase()===e||o.removeInlineStyle(["sub","sup"]),i?o.removeInlineStyle(t):o.applyInlineStyle(t[0]);o.select(!1)},queryCommandState:function(){return this.$dom.filterNodeList(this.selection.getStartElementPath(),t)?1:0},shortcutKeys:n}},lt=st("bold",["strong","b"],{"Ctrl+B":{}}),ct=st("italic",["em","i"],{"Ctrl+I":{}}),dt=st("subscript",["sub"],{"Ctrl+Shift+,":{}}),ut=st("superscript",["sup"],{"Ctrl+Shift+.":{}}),ht=st("underline",["u"],{"Ctrl+U":{}}),pt=st("strikethrough",["del","s","strike"],{"Ctrl+D":{}}),ft=st("mark",["mark"],{"Ctrl+H":{}}),vt=st("inlinecode",["code"],{"Ctrl+E":{}}),bt=st("kbd",["kbd"],{"Ctrl+'":{}}),mt={cmdName:"indent",execCommand:function(e){var t=this.queryCommandState(e)?"0em":"2em";return this.selection.getRangeAt(0).applyParagraphStyle("p",{style:"text-indent:"+t}).select(),!0},queryCommandState:function(){var e=this.$dom.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return e&&e.style.textIndent&&parseInt(e.style.textIndent)?1:0}},gt={cmdName:"lineheight",execCommand:function(e,t){return this.selection.getRangeAt(0).applyParagraphStyle("p",{style:"line-height:"+("1"===t?"normal":t+"em")}).select(),!0},queryCommandValue:function(){var e=this,t=this,n=t.$dom.filterNodeList(t.selection.getStartElementPath(),(function(t){return e.$dom.isBlockElm(t)}));if(n){var o=t.$dom.getComputedStyle(n,"line-height");return o="normal"===o?"1":o.indexOf("px")>=0&&n.parentNode?Math.round(parseFloat(o.replace(/[^\d.]*/gi,""))/parseFloat(this.$dom.getComputedStyle(n.parentNode,"font-size"))*10)/10+"":o.replace(/[^\d.]*/gi,"")}}},kt={cmdName:"rowspacing",execCommand:function(e,t,n){return this.selection.getRangeAt(0).applyParagraphStyle("p",{style:"margin-"+n+":"+t+"px"}).select(),!0},queryCommandValue:function(e,t){var n=this,o=this,i=o.$dom.filterNodeList(o.selection.getStartElementPath(),(function(e){return n.$dom.isBlockElm(e)}));if(i){var a=o.$dom.getComputedStyle(i,"margin-"+t).replace(/[^\d]/g,"");return a?parseFloat(a):0}return 0}},yt={left:1,right:1,center:1,justify:1},Ct={cmdName:"justify",execCommand:function(e,t){return this.selection.getRangeAt(0).applyJustify(t).select(),!0},queryCommandValue:function(){var e=this.selection.getStart(),t=this.$dom.getComputedStyle(e,"text-align");return yt[t]?t:"left"},queryCommandState:function(){return 0}},_t=Ie.a,xt={fontcolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",fontborder:"border"},Et={fontborder:1},Ot={fontcolor:1,backcolor:1,fontsize:1,fontfamily:1},Tt={fontborder:"1px solid #000"},wt=function(e,t,n){var o,i=e.createBookmark();if(e.collapsed)for(o=i.start.parentNode;o&&Re.a.$inline[o.tagName];)o=o.parentNode;else o=_t.getCommonAncestor(i.start,i.end);_t.getElementsByTagName(o,"span").forEach((function(e){if(e.parentNode&&!_t.isBookmarkNode(e))if(/\s*border\s*:\s*none;?\s*/i.test(e.style.cssText))/^\s*border\s*:\s*none;?\s*$/.test(e.style.cssText)?_t.remove(e,!0):_t.removeStyle(e,"border");else{if(/border/i.test(e.style.cssText)&&"SPAN"===e.parentNode.tagName&&/border/i.test(e.parentNode.style.cssText)&&(e.style.cssText=e.style.cssText.replace(/border[^:]*:[^;]+;?/gi,"")),"fontborder"!==t||"none"!==n)for(var o=e.nextSibling;o&&1===o.nodeType&&"SPAN"===o.tagName;)if(_t.isBookmarkNode(o)&&"fontborder"===t)e.appendChild(o),o=e.nextSibling;else{if(o.style.cssText===e.style.cssText&&(_t.moveChild(o,e),_t.remove(o)),e.nextSibling===o)break;o=e.nextSibling}if(function(e){for(var t;(t=e.parentNode)&&"SPAN"===t.tagName&&1===_t.getChildCount(t,(function(e){return!_t.isBookmarkNode(e)&&!_t.isBr(e)}));)t.style.cssText+=e.style.cssText,_t.remove(e,!0),e=t}(e),Ae.a.ie&&Ae.a.version>8){var i=_t.findParent(e,(function(e){return"SPAN"===e.tagName&&/background-color/.test(e.style.cssText)}));i&&!/background-color/.test(e.style.cssText)&&(e.style.backgroundColor=i.style.backgroundColor)}}})),e.moveToBookmark(i),function(e,t,n){if(Ot[t]&&(e.shrinkBoundarySuitably(),!e.collapsed&&e.startContainer&&1===e.startContainer.nodeType)){var o=e.startContainer.childNodes[e.startOffset];if(o&&_t.isTagNode(o,"span")){var i=e.createBookmark();_t.getElementsByTagName(o,"span").forEach((function(e){e.parentNode&&!_t.isBookmarkNode(e)&&("backcolor"===t&&_t.getComputedStyle(e,"background-color").toLowerCase()===n||(_t.removeStyle(e,xt[t]),0===e.style.cssText.replace(/^\s+$/,"").length&&_t.remove(e,!0)))})),e.moveToBookmark(i)}}}(e,t,n)},St=function(e){var t=xt[e];return{cmdName:e,execCommand:function(e,n){var o,i=this,a=i.selection.getRangeAt(0);if("default"!==(n=n||(i.queryCommandState(e)?"none":Tt[e]))&&n)if(a.collapsed){var r=_t.findParentByTagName(a.startContainer,"span",!0);if(o=i.document.createTextNode("font"),!r||r.children.length||(r[Ae.a.ie?"innerText":"textContent"]||"").replace(_t.fillCharReg,"").length){if(a.insertNode(o),a.selectNode(o).select(),r=i.document.createElement("span"),Ot[e]){if(_t.findParentByTagName(o,"a",!0))return a.setStartBefore(o).setCursor(),void _t.remove(o);i.execCommand("removeformat","span a",t)}if(r.style.cssText=t+":"+n,o.parentNode&&o.parentNode.insertBefore(r,o),!Ae.a.ie||Ae.a.ie&&9===Ae.a.version)for(var s=r.parentNode;s&&!_t.isBlockElm(s);)"SPAN"===s.tagName&&(r.style.cssText=s.style.cssText+";"+r.style.cssText),s=s.parentNode;Ae.a.opera?setTimeout((function(){a.setStart(r,0).collapse(!0),wt(a,e,n),a.select()})):(a.setStart(r,0).collapse(!0),wt(a,e,n),a.select())}else a.insertNode(o),Et[e]&&(a.selectNode(o).select(),i.execCommand("removeformat","span a",t),r=_t.findParentByTagName(o,"span",!0),a.setStartBefore(o)),r&&(r.style.cssText+=";"+t+":"+n),a.collapse(!0).select();_t.remove(o)}else Et[e]&&i.queryCommandValue(e)&&i.execCommand("removeformat","span a",t),(a=i.selection.getRangeAt(0)).applyInlineStyle("span",{style:t+":"+n}),wt(a,e,n),a.select();else a.collapsed&&(o=i.document.createTextNode("font"),a.insertNode(o).select()),i.execCommand("removeformat","span a",t),o&&(a.setStartBefore(o).collapse(!0),_t.remove(o)),a.select();return!0},queryCommandValue:function(e){var n=this.selection.getStart();if("fontborder"===e)for(var o,i=n;i&&Re.a.$inline[i.tagName];){if((o=_t.getComputedStyle(i,"border"))&&/1px/.test(o)&&/solid/.test(o))return o;i=i.parentNode}else if("fontsize"===e){var a=_t.getComputedStyle(n,t),r=/^([\d\.]+)(\w+)$/.exec(a);return r?Math.floor(parseFloat(r[1]))+r[2]:a}return _t.getComputedStyle(n,t)},queryCommandState:function(e){if(!Ot[e])return 0;var t=this.queryCommandValue(e);return"fontborder"===e&&/1px/.test(t)&&/solid/.test(t)?1:0}}},jt=St("fontcolor"),Bt=St("backcolor"),Nt=St("fontsize"),Lt=St("fontfamily"),It=St("fontborder"),At={cmdName:"removeformat",execCommand:function(e,t){var n=t||{},o=n.tags,i=n.style,a=n.attrs,r=n.notIncludeA,s=this,l=function(e){return 1===e.nodeType},c=function(e){return 3!==e.nodeType&&"span"===e.tagName.toLowerCase()&&(s.$env.ie?!Array.from(e.attributes).some((function(e){return e.specified})):!e.attributes.length)},d=s.selection.getRangeAt(0);return function(e){var t=new RegExp("^(?:"+(o||s.getOpt("removeFormatTags")).replace(/,/g,"|")+")$","i"),n=i?[]:a||s.getOpt("removeFormatAttributes").split(","),d=e.createBookmark();if(e.collapsed&&e.enlargeBoundary(!0),!r){var u=e.startContainer&&s.$dom.findParentByTagName(e.startContainer,"a",!0);u&&e.setStartBefore(u),(u=e.endContainer&&s.$dom.findParentByTagName(e.endContainer,"a",!0))&&e.setEndAfter(u)}var h,p=e.createBookmark(),f=p.start;if(p.end)for(var v,b=s.$dom.getNextDomNode(p.start,!1,l);b&&b!==p.end;)v=s.$dom.getNextDomNode(b,!0,l),s.$dtd.$empty[b.tagName]||s.$dom.isBookmarkNode(b)||(t.test(b.tagName)?i?(s.$dom.removeStyle(b,i),c(b)&&"text-decoration"!==i&&s.$dom.remove(b,!0)):s.$dom.remove(b,!0):s.$dtd.$tableContent[b.tagName]||s.$dtd.$list[b.tagName]||(s.$dom.removeAttributes(b,n),c(b)&&s.$dom.remove(b,!0))),b=v;if((h=p.start.parentNode)&&!s.$dtd.$tableContent[h.tagName]&&!s.$dtd.$list[h.tagName]){var m=h;t.test(m.tagName)?i?(s.$dom.removeStyle(m,i),c(m)&&"text-decoration"!==i&&s.$dom.remove(m,!0)):s.$dom.remove(m,!0):(s.$dom.removeAttributes(m,n),c(m)&&s.$dom.remove(m,!0))}if(p.end&&(h=p.end.parentNode)&&!s.$dtd.$tableContent[h.tagName]&&!s.$dtd.$list[h.tagName]){var g=h;t.test(g.tagName)?i?(s.$dom.removeStyle(g,i),c(g)&&"text-decoration"!==i&&s.$dom.remove(g,!0)):s.$dom.remove(g,!0):(s.$dom.removeAttributes(g,n),c(g)&&s.$dom.remove(g,!0))}e.moveToBookmark(p).moveToBookmark(d),f=e.startContainer;for(var k=e.collapsed;f&&1===f.nodeType&&s.$dom.isEmptyNode(f)&&s.$dtd.$removeEmpty[f.tagName];){var y=f.parentNode;e.setStartBefore(f),e.startContainer===e.endContainer&&e.endOffset--,s.$dom.remove(f),f=y}if(!k)for(f=e.endContainer;f&&1===f.nodeType&&s.$dom.isEmptyNode(f)&&s.$dtd.$removeEmpty[f.tagName];){var C=f.parentNode;e.setEndBefore(f),s.$dom.remove(f),f=C}}(d),d.select(),!0},defaultOptions:{removeFormatTags:"b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,s,mark,sub,sup,tt,u,var,footnote",removeFormatAttributes:"class,style,lang,width,height,align,hspace,valign"}},Rt=n(575),Mt={bold:lt,italic:ct,subscript:dt,supscript:ut,underline:ht,strikethrough:pt,mark:ft,code:vt,kbd:bt,indent:mt,letterspacing:{cmdName:"letterspacing",execCommand:function(e,t){return this.selection.getRangeAt(0).applyParagraphStyle("p",{style:"letter-spacing:"+t+"px"}).select(),!0},queryCommandValue:function(){var e=this,t=e.$dom.filterNodeList(e.selection.getStartElementPath(),(function(t){return e.$dom.isBlockElm(t)}));if(t)return e.$dom.getComputedStyle(t,"letter-spacing").replace(/[^\d.]*/gi,"")}},lineheight:gt,rowspacing:kt,justify:Ct,fontcolor:jt,backcolor:Bt,fontsize:Nt,fontfamily:Lt,fontborder:It,removeformat:At,math:{cmdName:"math",execCommand:function(e){var t=this.selection.getRangeAt(0);if(!t.collapsed){var n=t.extractContents(),o=(null===n||void 0===n?void 0:n.textContent)||"";o&&Object(Rt.b)(o).then((function(e){if(e){var n=document.createElement("div");n.innerHTML='<span class="inline-math" data-tex="'.concat(o,'">').concat(Object(Rt.a)(e),"</span>"),t.insertNode(n.firstChild),t.setCursor(!0,!1)}}))}},queryCommandState:function(){return 0},shortcutKeys:{"Ctrl+M":{}}}};function Dt(e,t){if(e===t)return!0;if(!e||!t)return!1;if(e.length!==t.length)return!0;for(var n=0,o=e.length;n<o;n++)if(e[n]!==t[n])return!1;return!0}var Ht={16:1,17:1,18:1,37:1,38:1,39:1,40:1},Pt=function(){function e(t){var n=this;Object(a.a)(this,e),this._list=void 0,this._index=void 0,this._canUndo=void 0,this._canRedo=void 0,this._editable=void 0,this._maxStackCount=void 0,this._maxInputCount=void 0,this._keyCount=void 0,this._compositing=void 0,this._isCollapsed=void 0,this._saveFn=void 0,this._mutationObserver=void 0,this._editable=t.editable,this._maxStackCount=t.maxStackCount||20,this._maxInputCount=t.maxInputCount||20,this._keyCount=0,this._compositing=!1,this._isCollapsed=!0,this._saveFn=Object(M.a)(this.save,200),this._mutationObserver=new MutationObserver((function(){n._saveFn(!0)})),this.reset(),this.bindEvents()}return Object(r.a)(e,[{key:"bindEvents",value:function(){var e=this,t=this._editable;t.on("compositionstart",(function(t,n){e._compositing=!0})),t.on("compositionend",(function(t,n){e._compositing=!1,e._saveFn(!1)})),t.on("keydown",(function(n,o){var i=o.keyCode||o.which;if(!Ht[i]&&!o.ctrlKey&&!o.metaKey&&!o.shiftKey&&!o.altKey){if(e._compositing)return;if(!t.selection.getRangeAt(0).collapsed)return e._saveFn(!0),void(e._isCollapsed=!1);0===e._list.length&&e.save(!0),e._saveFn(!0),e._keyCount++,e._keyCount>=e._maxInputCount&&e.save(!0)}})),t.on("keyup",(function(t,n){var o=n.keyCode||n.which;if(!Ht[o]&&!n.ctrlKey&&!n.metaKey&&!n.shiftKey&&!n.altKey){if(e._compositing)return;e._isCollapsed||(e.save(!0),e._isCollapsed=!0)}})),t.on("mouseup",(function(t,n){e.save(!0)})),t.on("beforeexeccommand",(function(t,n){e.saveForCmd(n)})),t.on("afterexeccommand",(function(t,n){e.saveForCmd(n)})),t.on("saveScence",(function(t){e.save(!0)})),t.ready((function(){e._mutationObserver.observe(t.holder,{childList:!0,subtree:!0,characterData:!0,attributes:!0})}))}},{key:"saveForCmd",value:function(e){var t=this._editable.command(e);t&&!t.notNeedUndo&&this.save(!0)}},{key:"undo",value:function(){if(this._canUndo){if(!this._list[this._index-1]&&1==this._list.length)return void this.reset();for(;this._list[this._index].content===this._list[this._index-1].content;)if(this._index--,0===this._index)return this.restore(0);this.restore(--this._index)}}},{key:"redo",value:function(){if(this._canRedo){for(;this._list[this._index].content===this._list[this._index+1].content;)if(this._index++,this._index===this._list.length-1)return this.restore(this._index);this.restore(++this._index)}}},{key:"restore",value:function(e){var t=this._editable,n=this._list[e];t.setScene(n.content);try{var o=new Ve(t.document,t.holder,t.selection).moveToAddress(n.address);o.select(!!o.startContainer)}catch(i){}this.update(),this.clearKey()}},{key:"getScene",value:function(){var e=this._editable;return{address:e.selection.getRangeAt(0).createAddress(!1,!0),content:e.getScene()}}},{key:"save",value:function(e){var t,n,o=this._editable,i=this.getScene(),a=this._list[this._index];(a&&a.content!==i.content&&o.trigger("contentchange"),!a||a.content!==i.content||e&&(t=a.address,n=i.address,t.collapsed!==n.collapsed||!Dt(t.startAddress,n.startAddress)||!Dt(t.endAddress,n.endAddress)))&&(this._list=this._list.slice(0,this._index+1),this._list.push(i),this._list.length>this._maxStackCount&&this._list.shift(),this._index=this._list.length-1,this.update(),this.clearKey())}},{key:"update",value:function(){this._canRedo=!!this._list[this._index+1],this._canUndo=!!this._list[this._index-1]}},{key:"reset",value:function(){this._list=[],this._index=0,this._canRedo=!1,this._canUndo=!1}},{key:"clearKey",value:function(){this._keyCount=0}},{key:"canUndo",value:function(){return this._canUndo}},{key:"canRedo",value:function(){return this._canRedo}}]),e}();var Ft={stack:function(){var e=new Pt({editable:this,maxStackCount:20}),t=[];return t.push({cmdName:"undo",notNeedUndo:!0,execCommand:function(t){e.undo()},queryCommandState:function(){return e.canUndo()?0:-1},shortcutKeys:{"Ctrl+Z":{}}}),t.push({cmdName:"redo",notNeedUndo:!0,execCommand:function(t){e.redo()},queryCommandState:function(){return e.canRedo()?0:-1},shortcutKeys:{"Ctrl+Shift+Z":{}}}),t}},zt=n(118);var qt={link:function(){var e=this,t=e.$dom;function n(e){var n=e.startContainer,o=e.endContainer;(n=t.findParentByTagName(n,"a",!0))&&e.setStartBefore(n),(o=t.findParentByTagName(o,"a",!0))&&e.setEndAfter(o)}function o(o,i){var a=o.cloneRange(),r=e.queryCommandValue("link");n.call(this,o=o.shrinkBoundarySuitably());var s=o.startContainer;if(s&&1===s.nodeType&&r&&(s=s.childNodes[o.startOffset])&&1===s.nodeType&&"A"===s.tagName&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(s.textContent||"")&&(s.textContent=Object(zt.b)(i.textValue||i.href)),a.collapsed&&!r||(o.removeInlineStyle("a"),a=o.cloneRange()),a.collapsed){var l,c=o.document().createElement("a");i.textValue?(l=Object(zt.b)(i.textValue),delete i.textValue):l=Object(zt.b)(i.href),t.setAttributes(c,i),(s=t.findParentByTagName(a.startContainer,"a",!0))&&t.isInNodeEndBoundary(a,s)&&o.setStartAfter(s).collapse(!0),c.textContent=l,o.insertNode(c).selectNode(c)}else o.applyInlineStyle("a",i)}return e.$env,[{cmdName:"link",execCommand:function(e,t){this.$util;var n=this.selection.getRangeAt(0);t.href&&(t.href=Object(zt.c)(t.href,/[<">]/g)),t.textValue&&(t.textValue=Object(zt.c)(t.textValue,/[<">]/g)),o.call(this,n,t),n.collapse().select(!0)},queryCommandValue:function(){var e=this.$dom,t=this.selection.getRangeAt(0);if(!t.collapsed){t.shrinkBoundaryMinimality();var n=3!==t.startContainer.nodeType&&t.startContainer.childNodes[t.startOffset]?t.startContainer[t.startOffset]:t.startContainer,o=3===t.endContainer.nodeType||0===t.endOffset?t.endContainer:t.endContainer.childNodes[t.endOffset-1],i=t.getCommonAncestor(),a=e.findParentByTagName(i,"a",!0);if(!a&&1===i.nodeType)for(var r,s,l,c=i.getElementsByTagName("a"),d=0;l=c[d++];)if(r=e.getPosition(l,n),s=e.getPosition(l,o),(r&e.POSITION_FOLLOWING||r&e.POSITION_CONTAINS)&&(s&e.POSITION_PRECEDING||s&e.POSITION_CONTAINS)){a=l;break}return a}var u=t.startContainer;if((u=1===u.nodeType?u:u.parentNode)&&(u=e.findParentByTagName(u,"a",!0))&&!e.isInNodeEndBoundary(t,u))return u},queryCommandState:function(){return 0},shortcutKeys:{"Ctrl+K":{}}},{cmdName:"unlink",execCommand:function(){var e=this.selection.getRangeAt(0),t=this.$dom;if(!e.collapsed||t.findParentByTagName(e.startContainer,"a",!0)){var o=e.createBookmark();n.call(this,e),e.removeInlineStyle("a").moveToBookmark(o).select()}},queryCommandState:function(){return this.queryCommandValue("link")?0:-1}}]}},$t=["footnote"],Vt={footnote:{cmdName:"footnote",execCommand:function(e,t){var n=this,o=n.selection.getRangeAt(0),i=n.$dom.filterNodeList(n.selection.getStartElementPath(),$t);if(!o.collapsed){var a=o.createBookmark();i&&o.selectNode(i),o.removeInlineStyle($t),o.moveToBookmark(a),t&&t["data-note"]&&o.applyInlineStyle($t[0],t)}o.collapse().select(!0)},queryCommandState:function(){return this.$dom.filterNodeList(this.selection.getStartElementPath(),$t)?1:0},queryCommandValue:function(){return this.$dom.filterNodeList(this.selection.getStartElementPath(),$t)},shortcutKeys:{"Ctrl+N":{}}}};var Ut={inserthtml:{cmdName:"inserthtml",execCommand:function(e,t){var n=t.html,o=t.notNeedFilter,i=this;if(n){var a=i.selection.getRangeAt(0),r=i.document.createElement("div");if(r.style.display="inline",o||(n=i.filterInputRule(n)),r.innerHTML=n.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,""),!a.collapsed){var s,l=a.startContainer;if(l&&i.$dom.isFillChar(l)&&a.setStartBefore(l),(l=a.endContainer)&&i.$dom.isFillChar(l)&&a.setEndAfter(l),a.txtToElmBoundary(),a.endContainer&&1===a.endContainer.nodeType&&(l=a.endContainer.childNodes[a.endOffset])&&i.$dom.isBr(l)&&a.setEndAfter(l),0===a.startOffset)if((l=a.startContainer)&&i.$dom.isBoundaryNode(l,"firstChild"))(l=a.endContainer)&&a.endOffset===(3===l.nodeType?null===(s=l.nodeValue)||void 0===s?void 0:s.length:l.childNodes.length)&&i.$dom.isBoundaryNode(l,"lastChild")&&a.setStart(i.holder.firstChild,0).collapse(!0);if(!a.collapsed&&a.deleteContents(),a.startContainer&&1===a.startContainer.nodeType){var c,d=a.startContainer.childNodes[a.startOffset];if(d&&i.$dom.isBlockElm(d)&&(c=d.previousSibling)&&i.$dom.isBlockElm(c)){for(a.setEnd(c,c.childNodes.length).collapse();d.firstChild;)c.appendChild(d.firstChild);i.$dom.remove(d)}}}if(a.inFillChar()){var u=a.startContainer;if(u&&i.$dom.isFillChar(u))a.setStartBefore(u).collapse(!0),i.$dom.remove(u);else if(u&&i.$dom.isFillChar(u,!0)){var h;u.nodeValue=(null===(h=u.nodeValue)||void 0===h?void 0:h.replace(i.$dom.fillCharReg,""))||null,a.startOffset--,a.collapsed&&a.collapse(!0)}}var p=a.startContainer&&i.$dom.findParentByTagName(a.startContainer,"li",!0);if(p){for(var f,v,b;b=r.firstChild;){for(;b&&(3===b.nodeType||!i.$dom.isBlockElm(b)||"HR"===b.nodeName);)f=b.nextSibling,a.insertNode(b).collapse(),v=b,b=f;if(b)if(/^(ol|ul)$/i.test(b.nodeName)){for(;b.firstChild&&p;)v=b.firstChild,i.$dom.insertAfter(p,b.firstChild),p=p.nextSibling;i.$dom.remove(b)}else if(p){var m=void 0;f=b.nextSibling,m=i.document.createElement("li"),i.$dom.insertAfter(p,m),m.appendChild(b),v=b,b=f,p=m}}(p=a.startContainer&&i.$dom.findParentByTagName(a.startContainer,"li",!0))&&i.$dom.isEmptyBlock(p)&&i.$dom.remove(p),v&&a.setStartAfter(v).collapse(!0).select(!0)}else{for(var g,k,y,C,_=!1;g=r.firstChild;){if(a.insertNode(g),k=g.nextSibling,!_&&g.nodeType===i.$dom.NODE_ELEMENT&&i.$dom.isBlockElm(g)&&(C=i.$dom.findParent(g,(function(e){return i.$dom.isBlockElm(e)})))&&!i.$dom.isRoot(C)&&(!i.$dtd[C.nodeName][g.nodeName]||g.parentNode!==C)){var x=void 0;if(i.$dtd[C.nodeName][g.nodeName])for(x=g.parentNode;x&&x!==C;)y=x,x=x.parentNode;else y=C;(y=y||x)&&i.$dom.breakParent(g,y),(y=g.previousSibling)&&i.$dom.trimWhiteTextNode(y),y&&!y.childNodes.length&&i.$dom.remove(y),i.$env.ie&&(k=g.nextSibling)&&i.$dom.isBlockElm(k)&&k.lastChild&&!i.$dom.isBr(k.lastChild)&&k.appendChild(i.document.createElement("br")),_=!0}if(k=g.nextSibling,!r.firstChild&&k&&i.$dom.isBlockElm(k)){a.setStart(k,0).collapse(!0);break}a.setEndAfter(g).collapse()}if(g=a.startContainer,k&&i.$dom.isBr(k)&&i.$dom.remove(k),g&&i.$dom.isBlockElm(g)&&i.$dom.isEmptyNode(g))if(k=g.nextSibling)i.$dom.remove(g),1===k.nodeType&&i.$dtd.$block[k.nodeName]&&a.setStart(k,0).collapse(!0).shrinkBoundaryMinimality();else try{g.innerHTML=i.$env.ie?i.$dom.fillChar:"<br/>"}catch(E){a.setStartBefore(g),i.$dom.remove(g)}try{a.select(!0)}catch(E){console.log(E)}}setTimeout((function(){i.selection.getRangeAt(0).scrollToView(window,0),i.trigger("afterinserthtml",n)}),200)}}}};var Wt={wrap:{cmdName:"wrap",execCommand:function(e,t){var n=t.left,o=t.right,i=this.selection.getRangeAt(0);if(!i.collapsed){var a=i.extractContents();if(a){var r=a.textContent||"",s=document.createTextNode(n+r+o);i.insertNode(s).collapse().select()}}}}},Kt=function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var o=t[n];e.registerCommand(o)}};var Xt=function(){function e(t){var n=t.editor;Object(a.a)(this,e),this._editor=void 0,this._catalogID=void 0,this._editor=n,this._catalogID=Date.now()}return Object(r.a)(e,[{key:"getCatalogDatas",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(){var t,n,o=this;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._editor.holder.querySelectorAll("h1,h2,h3,h4,h5,h6"),n=Array.from(t).map((function(e){var t=e.textContent||"",n=parseInt(e.tagName.replace(/[^\d]*/,"")),i=e;return i.dataset.id||(i.dataset.id="".concat(o._catalogID++)),{title:t,level:n,el:i}})),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"jumpTo",value:function(e){e.el&&e.el.scrollIntoView()}},{key:"insertAfter",value:function(e,t){if(t.el){var n=e.el||this._editor.document.createElement("h".concat(e.level));n.dataset.id||(n.dataset.id="".concat(this._catalogID++)),n.innerText=e.title,t.el.insertAdjacentElement("afterend",n),e.el=n}return e}},{key:"insertBefore",value:function(e,t){if(t.el){var n=e.el||this._editor.document.createElement("h".concat(e.level));n.dataset.id||(n.dataset.id="".concat(this._catalogID++)),n.innerText=e.title,t.el.insertAdjacentElement("beforebegin",n),e.el=n}return e}},{key:"append",value:function(e){var t=e.el||this._editor.document.createElement("h".concat(e.level));return t.dataset.id||(t.dataset.id="".concat(this._catalogID++)),t.innerText=e.title,this._editor.holder.appendChild(t),e.el=t,e}}]),e}();function Yt(e,t,n){var o=e.getAttribute("style");return o&&n&&(o=o.replace("&amp;","&"),e.setAttribute("style",o.replace(n,t))),""}var Gt=function(){function e(t){var n=this,o=t.editor;Object(a.a)(this,e),this._editor=void 0,this._isCatching=void 0,this._sectionMap=new Map,this._editor=o,this._editor.ready((function(){})),this._editor.registerCommand({cmdName:"unmatchedimagecount",notNeedUndo:!0,ignoreContentChange:!0,execCommand:function(e){return n.unmatchedImages.length},queryCommandState:function(e){return 0},shortcutKeys:{}})}return Object(r.a)(e,[{key:"cache",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(){var t,n,o,i=this;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isCatching){e.next=2;break}return e.abrupt("return");case 2:return this._isCatching=!0,t=this.unmatchedImages,n=this._editor.getOpt("uploadImageByUrl"),o=t.map((function(e){var t=e instanceof HTMLImageElement?e.src:i._sectionMap.get(e);return n(t||"")})),e.abrupt("return",Promise.all(o).then((function(e){return e.forEach((function(e,n){if(e){var o=t[n];o instanceof HTMLImageElement?o.src=e.url:(Yt(o,e.url,i._sectionMap.get(o)),i._sectionMap.delete(o))}})),i._isCatching=!1,e.length})));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isCatching",get:function(){return this._isCatching}},{key:"unmatchedImages",get:function(){var e=this,t=this._editor.getOpt("checkImageHostMatched");if(t){var n=this._editor.holder.querySelectorAll("img"),o=Array.from(n).filter((function(e){return!!e.src&&!t(e.src)})),i=this._editor.holder.querySelectorAll("section");this._sectionMap.clear();var a=Array.from(i).filter((function(t){var n=function(e){var t=e.getAttribute("style");if(t){t=t.replace("&amp;","&");var n=new RegExp("['|\"]\\s*(http[s]?://[^;\\)]+?)['|\"]","i"),o=t.match(n);if(o&&o[0])return o[1];var i=new RegExp("\\(\\s*(http[s]?://[^;\\)\\s]+?)\\)","i"),a=t.match(i);if(a&&a[0])return a[1]}return""}(t),o=!!n;return o&&e._sectionMap.set(t,n),o}));return o.concat(a)}return[]}}]),e}(),Zt=0,Jt=[],Qt=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var o,i;return Object(a.a)(this,n),(o=t.call(this))._holder=void 0,o._rootDocNode=void 0,o._head=void 0,o._id=void 0,o._isReady=void 0,o._hasEnterExecCommand=void 0,o._actived=void 0,o._darkmode=void 0,o.$dom=Ie.a,o.$dtd=Re.a,o.$env=Ae.a,o.$keymap=at,o.selection=void 0,o.search=void 0,o.catalog=void 0,o.image=void 0,o.document=void 0,o.window=void 0,i=Object(Le.a)(o),Kt(i,Mt),Kt(i,Ft),Kt(i,qt),Kt(i,Vt),Kt(i,Ut),Kt(i,Wt),e&&o.setOpt(e),Jt.forEach((function(e){e.install(Object(Le.a)(o))})),o.search=new Qe({editor:Object(Le.a)(o)}),o.catalog=new Xt({editor:Object(Le.a)(o)}),o.image=new Gt({editor:Object(Le.a)(o)}),o._darkmode=!!(null===e||void 0===e?void 0:e.darkmode),o}return Object(r.a)(n,null,[{key:"use",value:function(e){Jt.push(e)}}]),Object(r.a)(n,[{key:"initDomEvents",value:function(){var e=this;this.proxyDomEvent=this.proxyDomEvent.bind(this),this.selectionChange=Object(M.a)(this.selectionChange,20),this.$dom.on(this._holder,["click","contextmenu","keydown","keyup","keypress","mousedown","mouseup","mouseover","mouseout","selectstart","focus","blur","compositionstart","compositionend"],this.proxyDomEvent),this.$dom.on(this._holder,"drop",(function(t){e.$env.gecko&&t.stopPropagation&&t.stopPropagation(),e.trigger("contentchange")}));var t=function(t){e._actived&&2!==t.button&&e.selectionChange(t)};this.$dom.on(this._holder,["mouseup","keydown"],t),this.$dom.on(this.document,["mouseup"],t),this.$dom.on(this._rootDocNode,["selectionchange"],t)}},{key:"proxyDomEvent",value:function(e){var t=e.type.replace(/^on/,"").toLowerCase();this.trigger(t,e)}},{key:"selectionChange",value:function(e){var t=!!e;this.selection.cache(),this.selection.cachedRange()&&this.selection.cachedStartElement()&&(this.trigger("beforeselectionchange"),this.trigger("selectionchange",t),this.trigger("afterselectionchange"),this.selection.clearCache())}},{key:"bindShortcutKeys",value:function(){var e=this;this.$dom.on(this.document,"keydown",(function(t){if(e._actived){var n=t.keyCode||t.which;if(n)for(var o in e.commands)if(e.commands.hasOwnProperty(o)){var i=e.commands[o].shortcutKeys;if(i)for(var a in i)if(i.hasOwnProperty(a)){var r=i[a];(/^(ctrl)(\+shift)?\+(.+)$/.test(a.toLowerCase())||/^(\w+)$/.test(a.toLowerCase()))&&("ctrl"===RegExp.$1&&(t.ctrlKey||t.metaKey)&&(""!==RegExp.$2?t.shiftKey:!t.shiftKey)&&n===e.$keymap[RegExp.$3]||n===e.$keymap[RegExp.$1])&&(r.handler?r.handler.apply(e,[t,r.data]):(-1!==e.queryCommandState(o,r.data)&&e.execCommand(o,r.data),e.$dom.preventDefault(t)))}}}}))}},{key:"mount",value:function(e,t){if(this._rootDocNode=e.getRootNode(),1!==e.nodeType||!e.ownerDocument||!this._rootDocNode||9!==this._rootDocNode.nodeType&&11!==this._rootDocNode.nodeType)throw"el is invalid!";this._holder=e,this._holder.setAttribute("contenteditable","true"),this._holder.setAttribute("spellcheck","false"),this._holder.style.cursor="text",this._holder.classList.toggle("dark-mode",this._darkmode),this.document=e.ownerDocument,this.window=this.document.defaultView,11===this._rootDocNode.nodeType?(this._head=this._rootDocNode.querySelector("head")||this.document.createElement("head"),this._head.parentNode||this._rootDocNode.insertBefore(this._head,this._holder)):(this._head=this.document.head||this.document.createElement("head"),this._head.parentNode||this.document.appendChild(this._head));var n=this._rootDocNode;return t=t||(n.getSelection?n.getSelection():this.document.getSelection()),this.selection=new Ue(e.ownerDocument,this._holder,t),this.initDomEvents(),this.bindShortcutKeys(),this._id=Zt++,this._isReady=!0,this._actived=!0,this.trigger("ready",this),this.trigger("contentchange"),this}},{key:"filterInputRule",value:function(e){var t=Object(zt.a)(e);return t.traversal((function(e){if("element"===e.type())switch(e.removeAttr("class"),e.removeAttr("draggable"),e.removeAttr("contenteditable"),e.tagName()){case"div":case"p":e.setTagName("section")}})),t.outerHTML()}},{key:"destory",value:function(){}},{key:"ready",value:function(e){this._isReady?e.apply(this):this.on("ready",e)}},{key:"appendCSS",value:function(e,t){var n=document.createElement("style");for(var o in n.textContent="\n".concat(e),t=t||{},Object.assign(t,{type:"text/css"}),t)if(t.hasOwnProperty(o)){var i=t[o];n.setAttribute(o,i)}return this._head.appendChild(n),n}},{key:"removeCSS",value:function(e){this._head.querySelectorAll(e).forEach((function(e){e.remove()}))}},{key:"hasCSS",value:function(e){return this._head.querySelectorAll(e).length>0}},{key:"getCSS",value:function(e){return this._head.querySelector(e)}},{key:"execCommand",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if(!e)return!1;var i;e=e.toLowerCase();var a=this.commands[e];return!!a&&(this._hasEnterExecCommand?i=this.callCmdFn("execCommand",arguments):(this._hasEnterExecCommand=!0,-1!==this.queryCommandState.apply(this,[e].concat(n))&&(this.trigger.apply(this,["beforeexeccommand",e].concat(n)),i=this.callCmdFn("execCommand",arguments),this.trigger.apply(this,["afterexeccommand",e].concat(n))),this._hasEnterExecCommand=!1),!this._hasEnterExecCommand&&!a.ignoreContentChange&&this.trigger("contentchange"),!this._hasEnterExecCommand&&!a.ignoreContentChange&&this.selectionChange(),i)}},{key:"getContent",value:function(){return this._holder.innerHTML}},{key:"setContent",value:function(e){}},{key:"getScene",value:function(){return this._holder.innerHTML}},{key:"setScene",value:function(e){}},{key:"clear",value:function(){this._holder.innerHTML="<p><br></p>"}},{key:"getSelection",value:function(){return this.selection}},{key:"actived",get:function(){return this._actived},set:function(e){this._actived=e,e?this.trigger("actived"):this.trigger("deactived")}},{key:"darkmode",get:function(){return this._actived},set:function(e){this._darkmode=e,this._holder&&this._holder.classList.toggle("dark-mode",e)}},{key:"holder",get:function(){return this._holder}},{key:"rootNode",get:function(){return this._rootDocNode}},{key:"id",get:function(){return this._id}},{key:"isReady",get:function(){return this._isReady}}]),n}(it),en=n(529),tn=function(){function e(){Object(a.a)(this,e),this.allListeners=[]}return Object(r.a)(e,[{key:"on",value:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=Object(en.f)("l"),a={id:i,element:e,eventType:t,handler:n,options:o},r=this.findOne(e,t,n);return r?"":(this.allListeners.push(a),e.addEventListener(t,n,o),i)}},{key:"off",value:function(e,t,n,o){var i=this,a=this.findAll(e,t,n);a.forEach((function(e,t){var n=i.allListeners.indexOf(a[t]);n>-1&&(i.allListeners.splice(n,1),e.element.removeEventListener(e.eventType,e.handler,e.options))}))}},{key:"offById",value:function(e){var t=this.findById(e);t&&t.element.removeEventListener(t.eventType,t.handler,t.options)}},{key:"findOne",value:function(e,t,n){var o=this.findAll(e,t,n);return o.length>0?o[0]:null}},{key:"findAll",value:function(e,t,n){var o=e?this.findByEventTarget(e):[];return e&&t&&n?o.filter((function(e){return e.eventType===t&&e.handler===n})):e&&t?o.filter((function(e){return e.eventType===t})):o}},{key:"removeAll",value:function(){this.allListeners.map((function(e){e.element.removeEventListener(e.eventType,e.handler,e.options)})),this.allListeners=[]}},{key:"destroy",value:function(){this.removeAll()}},{key:"findByEventTarget",value:function(e){return this.allListeners.filter((function(t){if(t.element===e)return t}))}},{key:"findByType",value:function(e){return this.allListeners.filter((function(t){if(t.eventType===e)return t}))}},{key:"findByHandler",value:function(e){return this.allListeners.filter((function(t){if(t.handler===e)return t}))}},{key:"findById",value:function(e){return this.allListeners.find((function(t){return t.id===e}))}}]),e}(),nn=function(){function e(t){var n=this,o=t.blockEditable;if(Object(a.a)(this,e),this.nodes={},this.listeners=new tn,this.readOnlyMutableListeners={on:function(e,t,o){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n._mutableListenerIds.push(n.listeners.on(e,t,(function(e){n.blockEditable.editable.actived&&o(e)}),i))},clearAll:function(){var e,t=Object(et.a)(n._mutableListenerIds);try{for(t.s();!(e=t.n()).done;){var o=e.value;n.listeners.offById(o)}}catch(i){t.e(i)}finally{t.f()}n._mutableListenerIds=[]}},this.blockEditable=void 0,this._mutableListenerIds=[],(this instanceof e?this.constructor:void 0)===e)throw new TypeError("Constructors for abstract class Module are not allowed.");this.blockEditable=o}return Object(r.a)(e,[{key:"removeAllNodes",value:function(){for(var e in this.nodes){var t=this.nodes[e];t instanceof HTMLElement&&t.remove()}}},{key:"state",get:function(){return this.blockEditable.state}},{key:"isRtl",get:function(){return!1}}]),e}(),on=n(527),an=n(531),rn=n(837),sn=n(839).default,ln=function(){function e(t){Object(a.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._nodes={},this._title=void 0,this._subtitle=void 0,this._blockEditable=t.blockEditable,this._title="Error",this._subtitle="The block can not be displayed correctly.",this._data=t.data||{key:"",data:{}}}return Object(r.a)(e,null,[{key:"validData",value:function(e){return e}},{key:"toHtml",value:function(e){return""}},{key:"toData",value:function(e){var t=document.createElement("div");return t.innerHTML=e,{content:t.textContent||""}}},{key:"Class",get:function(){return{target:"be-stub",icon:"be-stub__icon",info:"be-stub__info",title:"be-stub__title",subtitle:"be-stub__subtitle"}}},{key:"toolbox",get:function(){return{icon:sn,title:"Stub"}}},{key:"acceptConversionComps",get:function(){return!1}},{key:"inlineTools",get:function(){return!1}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{content:""}}},{key:"builtinTypesets",get:function(){return{default:""}}},{key:"CSS",get:function(){return rn}},{key:"pasteConfig",get:function(){return{tags:["P"]}}}]),Object(r.a)(e,[{key:"renderBlock",value:function(e){this._data;return this._nodes.target=this.make(),this._nodes.target}},{key:"renderSettings",value:function(e){return null}},{key:"save",value:function(){return this._data.data}},{key:"destroy",value:function(){}},{key:"make",value:function(){var t=Object(an.make)("div",e.Class.target),n=Object(an.make)("i",e.Class.icon);n.innerHTML=sn;var o=Object(an.make)("div",e.Class.info),i=Object(an.make)("div",e.Class.title,{});i.textContent=this._title;var a=Object(an.make)("div",e.Class.subtitle,{});return a.textContent=this._subtitle,t.appendChild(n),o.appendChild(i),o.appendChild(a),t.appendChild(o),t}},{key:"key",get:function(){return this._data.key}}]),e}();ln.key="";var cn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e,o){var i;return Object(a.a)(this,n),(i=t.call(this,{blockEditable:o}))._firstSelectedInput=void 0,i._lastSelectedInput=void 0,i._block=void 0,i._anyInputSelectedCache=null,i._multiInputsSelectedCache=null,i.onMouseUp=function(){i.state.ui;var e=i.blockEditable.editable.document;i.listeners.off(i._block.content,"mousemove",i.onMouseMove),i.listeners.off(e,"mouseup",i.onMouseUp);var t=i.inputs;i.selectedInputs.length===t.length&&t.length>0&&(i._block.selected=!0)},i.onMouseMove=function(e){var t=i.state,n=(t.content,t.blockSelection,t.ui,i.getInput(e.target));n&&i._firstSelectedInput&&(i.state.inlineToolbar.close(),i.resetInputsSelectedState(i._firstSelectedInput||n,n),i._lastSelectedInput=n,n===i._firstSelectedInput?i.toggleInputSelectedBy(n,!1):i.blockEditable.selection.removeAllRanges())},i._block=e,i}return Object(r.a)(n,[{key:"bindEvents",value:function(){var e=this;this.listeners.on(this._block.content,"mousedown",(function(t){e.enableCrossInputSelection(t)}))}},{key:"watchSelection",value:function(e){if(e.button===en.r.LEFT){this._block.currentInput=e.target;var t=this.blockEditable.editable.document;this._firstSelectedInput=this._block.currentInput,this._lastSelectedInput=this._firstSelectedInput,this.listeners.on(this._block.content,"mousemove",this.onMouseMove),this.listeners.on(t,"mouseup",this.onMouseUp)}}},{key:"toggleInputSelectedState",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.state;t.content,t.blockSelection;if(this._lastSelectedInput||(this._lastSelectedInput=this._firstSelectedInput=this._block.currentInput),this._lastSelectedInput&&this._firstSelectedInput){this._firstSelectedInput===this._lastSelectedInput&&(this.toggleInputSelectedBy(this._firstSelectedInput,!0),this.blockEditable.selection.removeAllRanges());var n=this.indexOfInput(this._lastSelectedInput)+(e?1:-1),o=this.inputs[n];o&&(this.inputSelected(this._lastSelectedInput)!==this.inputSelected(o)?this.toggleInputSelectedBy(o,!0):this.toggleInputSelectedBy(this._lastSelectedInput,!1),this._lastSelectedInput=o,this.state.inlineToolbar.close(),o.scrollIntoView({block:"nearest"}))}}},{key:"clear",value:function(e){var t=this.state.cursor,n=this._firstSelectedInput?this.indexOfInput(this._firstSelectedInput):-1,o=this._lastSelectedInput?this.indexOfInput(this._lastSelectedInput):-1;if(this.anyInputSelected&&n>-1&&o>-1)if(e&&e instanceof KeyboardEvent)switch(e.keyCode){case en.q.DOWN:case en.q.RIGHT:t.setToInput(this.inputs[Math.max(n,o)],t.positions.END);break;case en.q.UP:case en.q.LEFT:t.setToInput(this.inputs[Math.min(n,o)],t.positions.START);break;default:t.setToInput(this.inputs[Math.max(n,o)],t.positions.END)}else t.setToInput(this.inputs[Math.max(n,o)],t.positions.END);this._firstSelectedInput=this._lastSelectedInput=void 0}},{key:"enableCrossInputSelection",value:function(e){this.blockEditable.selection.isCollapsed||this.clearInputsSelection(),this._block.content.contains(e.target)?this.watchSelection(e):this.clearInputsSelection()}},{key:"toggleInputSelectedByIndex",value:function(e,t){var n=this.inputs[e];n&&n.classList.toggle(un.Class.inputSelected,t),this.clearSelectionCache()}},{key:"toggleInputSelectedBy",value:function(e,t){if(e){var n=e.closest('[contenteditable="true"]')||e.closest(".".concat(un.Class.fakeInput));n&&n.classList.toggle(un.Class.inputSelected,t),this.clearSelectionCache()}}},{key:"inputSelected",value:function(e){return e.closest(".".concat(un.Class.inputSelected))}},{key:"getInput",value:function(e){if(!e)return null;var t=1===e.nodeType?e:e.parentNode;return t.closest('[contenteditable="true"]')||t.closest(".".concat(un.Class.fakeInput))}},{key:"indexOfInput",value:function(e){return e?this.inputs.findIndex((function(t){return t===e||t.contains(e)})):-1}},{key:"clearInputsSelection",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.state.cursor,o=this.blockEditable.selection;t&&this.blockEditable.selection.cache();var i=e&&e instanceof KeyboardEvent,a=i&&en.n(e.keyCode);this.anyInputSelected&&i&&a&&!o.exists&&(n.setToBlock(this._block),en.e((function(){var t=e.key;n.insertContentAtCursorPosition(t.length>1?"":t)}),20)()),this.clear(e),t&&this.blockEditable.selection.restore(),this.allInputsSelected=!1}},{key:"copySelectedInputs",value:function(e){e.preventDefault();var t=this.inputs,n=this.selectedInputs.map((function(e){return t[e]})).filter(Boolean),o=this._block.componentInstance.extractInputs?this._block.componentInstance.extractInputs(n):{},i=[{key:this._block.component.key,data:o}],a={clearEmpty:ce.d,inlineContent:ce.h,type:"html"},r=this._block.component,s=r.toHtml(o,a),l=this.blockEditable.utils.makeMarkdown,c=r.toMarkdown?r.toMarkdown(o,l):l(s);e.clipboardData&&(e.clipboardData.setData("text/plain",c),e.clipboardData.setData("text/html",s),e.clipboardData.setData(this.state.paste.MIME_TYPE,JSON.stringify(i)))}},{key:"removeSelectedInputs",value:function(){var e=this.inputs,t=this.selectedInputs.map((function(t){return e[t]})).filter(Boolean);if(this._block.componentInstance.removeInputs){this.allInputsSelected=!1;var n=this._block.componentInstance.removeInputs(t);n&&(this._block.currentInput=n)}}},{key:"clearSelectionCache",value:function(){this._anyInputSelectedCache=null,this._multiInputsSelectedCache=null}},{key:"resetInputsSelectedState",value:function(e,t){var n=this,o=this.indexOfInput(e),i=this.indexOfInput(t);this.selectedInputs.forEach((function(e){n.toggleInputSelectedByIndex(e,!1)}));for(var a=Math.min(o,i);a<=Math.max(o,i);a++)this.toggleInputSelectedByIndex(a,!0)}},{key:"inputs",get:function(){return this._block.inputs}},{key:"isCrossInputSelectionStarted",get:function(){return!!this._firstSelectedInput&&!!this._lastSelectedInput}},{key:"allInputsSelected",set:function(e){var t=this;this.inputs.forEach((function(n,o){t.toggleInputSelectedByIndex(o,e)}))}},{key:"anyInputSelected",get:function(){if(null===this._anyInputSelectedCache){var e=this.inputs;this._anyInputSelectedCache=e.some((function(e){return e.classList.contains(un.Class.inputSelected)}))}return this._anyInputSelectedCache}},{key:"multiInputsSelected",get:function(){if(null===this._multiInputsSelectedCache){var e=this.inputs;this._multiInputsSelectedCache=e.filter((function(e){return e.classList.contains(un.Class.inputSelected)})).length>1}return this._multiInputsSelectedCache}},{key:"selectedInputs",get:function(){var e=this.inputs,t=[];return e.forEach((function(e,n){e.classList.contains(un.Class.inputSelected)&&t.push(n)})),t}}]),n}(nn);var dn=Date.now(),un=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var o;Object(a.a)(this,n),(o=t.call(this,{blockEditable:e.blockEditable}))._componentKey=void 0,o._componentInstance=void 0,o._holder=void 0,o._content=void 0,o._common=void 0,o._isStretching=void 0,o._inputSelection=void 0,o._cachedInputs=[],o._cachedAllInputs=[],o._inputIndex=0,o._mutationObserver=void 0,o._modificationDebounceTimer=450,o._didMutated=en.d((function(){o._cachedInputs=[],o._cachedAllInputs=[],o.updateCurrentInput(),o.onUpdated()}),o._modificationDebounceTimer),o.handleFocus=function(){o._cachedInputs=[],o._cachedAllInputs=[],setTimeout((function(){o.updateCurrentInput()}),100)},o._componentKey=e.data.key;var i=o.component;return o._componentInstance=i?new i({blockEditable:e.blockEditable,data:e.data.data}):new ln({blockEditable:e.blockEditable,data:e.data}),o._common=e.data.common||{},o._mutationObserver=new MutationObserver(o._didMutated),o._inputSelection=new cn(Object(Le.a)(o),e.blockEditable),o.compose(),o}return Object(r.a)(n,null,[{key:"isFakeInput",value:function(e){if(e){var t=e.nodeType===Node.ELEMENT_NODE?e:e.parentElement;if(t&&t.closest(".".concat(n.Class.fakeInput)))return!0}return!1}},{key:"isLinesInput",value:function(e){if(e){var t=e.nodeType===Node.ELEMENT_NODE?e:e.parentElement;if(t&&t.closest(".".concat(n.Class.linesInput)))return!0}return!1}},{key:"getFakeInput",value:function(e){if(e){var t=e.nodeType===Node.ELEMENT_NODE?e:e.parentElement;return t&&t.closest(".".concat(n.Class.fakeInput))}}},{key:"Class",get:function(){return{block:"beui-block",blockStretched:"beui-block--stretched",content:"beui-block__content",contentStretched:"beui-block__content--stretched",prefix:"beui-block__prefix",subfix:"beui-block__subfix",focused:"beui-block--focused",inputFocused:"beui-block__input--focused",inputSelected:"beui-block__input--selected",selected:"beui-block--selected",dropTarget:"beui-block--drop-target",button:"beui-block__button",input:"beui-block__input",loader:"beui-block__loader",fakeInput:"beui-block__fakeinput",linesInput:"beui-block__lineinput"}}}]),Object(r.a)(n,[{key:"leafInputsAndReturnIndex",value:function(e){if(0===this.inputs.length)return this._inputIndex;var t=this._inputIndex,o=null;return-1===t?t=e===n.directions.RIGHT||e===n.directions.DOWN||e===n.directions.NEXT?-1:0:o=this.inputs[t],e!==n.directions.NEXT&&(o||e!==n.directions.RIGHT&&e!==n.directions.DOWN)?e!==n.directions.PREVIOUS&&(o||e!==n.directions.LEFT&&e!==n.directions.UP)?o&&(t=this.findNextIndex(t,e)):t-=1:t+=1,t}},{key:"findNextIndex",value:function(e,t){var o=this.inputs.map((function(e,t){var n=e.getBoundingClientRect();return{index:t,x:Math.floor(n.x),y:Math.floor(n.y)}})),i=o[e],a=function(e){var t,n=Number.POSITIVE_INFINITY;return o.forEach((function(o){if(e(o)){var a=(s=i,((r=o).x-s.x)*(r.x-s.x)+(r.y-s.y)*(r.y-s.y));a<n&&(t=o,n=a)}var r,s})),t},r=0;if(t===n.directions.RIGHT){var s=a((function(e){return e.x>i.x}));r=s?s.index:i.index+1}else if(t===n.directions.DOWN){var l=a((function(e){return e.y>i.y}));r=l?l.index:i.index+1}else if(t===n.directions.LEFT){var c=a((function(e){return e.x<i.x}));r=c?c.index:i.index-1}else{var d=a((function(e){return e.y<i.y}));r=d?d.index:i.index-1}return r}},{key:"updateCurrentInput",value:function(){var e=this.blockEditable.editable,t=e.document,n=e.selection;this.currentInput=on.a.isNativeInput(t.activeElement)||!n.anchorNode?t.activeElement:n.anchorNode}},{key:"willSelect",value:function(){this.holder&&this._mutationObserver.observe(this.holder,{childList:!0,subtree:!0,characterData:!0,attributes:!0}),this.addInputEvents()}},{key:"willUnselect",value:function(){this._mutationObserver.disconnect(),this.removeInputEvents(),this._cachedInputs=[],this._cachedAllInputs=[]}},{key:"renderSettings",value:function(e){if(en.k(this._componentInstance.renderSettings))return this._componentInstance.renderSettings(e)}},{key:"destroy",value:function(){en.k(this._componentInstance.destroy)&&this._componentInstance.destroy()}},{key:"mergeWith",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(t){return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._componentInstance.merge||!this.mergeable){e.next=3;break}return e.next=3,this._componentInstance.merge(t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=this._componentInstance.save();return{key:this.component.key||this._componentInstance.key||"",data:e,common:this._common}}},{key:"canBackspaceRemove",value:function(){return this.selected||(this.isEmpty||this._componentInstance.backspaceRemovable)&&this.currentInput===this.firstInput}},{key:"onRendered",value:function(){this._componentInstance.onRendered&&this._componentInstance.onRendered()}},{key:"onRemoved",value:function(){this._componentInstance.onRemoved&&this._componentInstance.onRemoved()}},{key:"onUpdated",value:function(){this._componentInstance.onUpdated&&this._componentInstance.onUpdated()}},{key:"onMoved",value:function(){this._componentInstance.onMoved&&this._componentInstance.onMoved()}},{key:"onAdded",value:function(){this._componentInstance.onAdded&&this._componentInstance.onAdded()}},{key:"onPaste",value:function(e){this._componentInstance.onPaste&&this._componentInstance.onPaste(e)}},{key:"onEditFakeInput",value:function(e){return!!this._componentInstance.onEditFakeInput&&(this._componentInstance.onEditFakeInput(e),!0)}},{key:"compose",value:function(){var e=on.a.make("div",[n.Class.block,"beui-block--".concat(this.component.key)]),t=on.a.make("span",[n.Class.prefix]),o=on.a.make("div",[n.Class.content]),i=on.a.make("span",[n.Class.subfix]);if(e.appendChild(t),e.appendChild(o),e.appendChild(i),this._componentInstance){var a=this._componentInstance.renderBlock(n.Class);if(e.dataset.id||(e.dataset.id="".concat(dn++)),this._componentInstance.key&&(e.dataset.key=this._componentInstance.key),this._common.quote){var r=this.blockEditable.editable.document.createElement("blockquote");r.appendChild(a),o.appendChild(r)}else o.appendChild(a);this._common.align&&(o.style.textAlign=this._common.align)}this._holder=e,this._content=o,this._inputSelection.bindEvents()}},{key:"addInputEvents",value:function(){var e=this;this.inputs.forEach((function(t){t.addEventListener("focus",e.handleFocus)}))}},{key:"removeInputEvents",value:function(){var e=this;this.inputs.forEach((function(t){t.removeEventListener("focus",e.handleFocus)}))}},{key:"enableEventsStopPropagation",value:function(){var e=this;this.readOnlyMutableListeners.on(this._content,"click",(function(e){e.stopPropagation()}),!1),this.readOnlyMutableListeners.on(this._content,"mousedown",(function(e){e.stopPropagation()}),!0),this.readOnlyMutableListeners.on(this._content,"mouseup",(function(e){e.stopPropagation()}),!0),this.readOnlyMutableListeners.on(this._content,"touchstart",(function(e){e.stopPropagation()}),!0),this.readOnlyMutableListeners.on(this._content,"keydown",(function(e){e.stopPropagation()}),!0),this.readOnlyMutableListeners.on(this._content,"keydown",(function(t){switch(t.stopPropagation(),t.keyCode){case en.q.ESC:e.stretched=!1}}),!1),this.readOnlyMutableListeners.on(this._content,"click",(function(e){e.stopPropagation()}),!0)}},{key:"disableEventsStopPropagation",value:function(){this.readOnlyMutableListeners.clearAll()}},{key:"inputSelection",get:function(){return this._inputSelection}},{key:"inputs",get:function(){if(0!==this._cachedInputs.length)return this._cachedInputs;var e=on.a.findVisibleInputs(this.holder,[".".concat(n.Class.fakeInput)]);return this._inputIndex>e.length-1&&(this._inputIndex=e.length-1),this._cachedInputs=e,e}},{key:"allInputs",get:function(){if(0!==this._cachedAllInputs.length)return this._cachedAllInputs;var e=on.a.findAllInputs(this.holder,[".".concat(n.Class.fakeInput)]);return this._cachedAllInputs=e,e}},{key:"currentInput",get:function(){return this.inputs[this._inputIndex]},set:function(e){var t=this;if(e){var o=this.inputs.findIndex((function(t){return t===e||t.contains(e)}));if(-1!==o){this._inputIndex=o;var i=this.holder.classList.contains(n.Class.focused);this.inputs.forEach((function(e,o){e.classList.toggle(n.Class.inputFocused,t._inputIndex===o&&i)}))}}}},{key:"currentInputFocused",get:function(){var e=this.currentInput;return!!e&&e.classList.contains(n.Class.inputFocused)}},{key:"firstInput",get:function(){return this.inputs[0]}},{key:"lastInput",get:function(){var e=this.inputs;return e[e.length-1]}},{key:"nextInput",get:function(){return this.inputs[this.leafInputsAndReturnIndex(n.directions.NEXT)]}},{key:"previousInput",get:function(){return this.inputs[this.leafInputsAndReturnIndex(n.directions.PREVIOUS)]}},{key:"upInput",get:function(){return this.inputs[this.leafInputsAndReturnIndex(n.directions.UP)]}},{key:"downInput",get:function(){return this.inputs[this.leafInputsAndReturnIndex(n.directions.DOWN)]}},{key:"leftInput",get:function(){return this.inputs[this.leafInputsAndReturnIndex(n.directions.LEFT)]}},{key:"rightInput",get:function(){return this.inputs[this.leafInputsAndReturnIndex(n.directions.RIGHT)]}},{key:"component",get:function(){return le.a.component(this._componentKey)||ln}},{key:"componentInstance",get:function(){return this._componentInstance}},{key:"componentContent",get:function(){var e=this.holder.querySelector(".".concat(n.Class.content));if(e&&e.childNodes.length)for(var t=e.childNodes.length-1;t>=0;t--){var o=e.childNodes[t];if(!on.a.isExtensionNode(o))return o}return null}},{key:"textContent",get:function(){return this._holder.textContent}},{key:"data",get:function(){return this._componentInstance.save()}},{key:"isDefault",get:function(){return this.blockEditable.defaultBlockComp.key===this.component.key}},{key:"isEmpty",get:function(){if(this._componentInstance.isEmptyContent)return!0;var e=!this.componentContent||on.a.isEmpty(this.componentContent),t=!this.hasMedia;return e&&t}},{key:"hasMedia",get:function(){return!!this.holder.querySelector(["img","iframe","video","audio","source","input","textarea","twitterwidget"].join(","))}},{key:"holder",get:function(){return this._holder}},{key:"content",get:function(){return this._content}},{key:"focused",set:function(e){var t=this;this.holder.classList.toggle(n.Class.focused,e),this.inputs.forEach((function(o,i){o.classList.toggle(n.Class.inputFocused,t._inputIndex===i&&e)}))},get:function(){return this.holder.classList.contains(n.Class.focused)}},{key:"selected",set:function(e){e?this.holder.classList.add(n.Class.selected):this.holder.classList.remove(n.Class.selected),this._inputSelection.allInputsSelected=!1},get:function(){return this.holder.classList.contains(n.Class.selected)}},{key:"stretched",set:function(e){var t=this;this._isStretching||(this._isStretching=!0,this._componentInstance.onWillChangeStreched?this._componentInstance.onWillChangeStreched(e).then((function(){t._isStretching=!1,t.holder.classList.toggle(n.Class.blockStretched,e),Promise.resolve().then((function(){e?t.enableEventsStopPropagation():t.disableEventsStopPropagation()}))})):(this.holder.classList.toggle(n.Class.blockStretched,e),Promise.resolve().then((function(){e?t.enableEventsStopPropagation():t.disableEventsStopPropagation()})),this._isStretching=!1))},get:function(){return this.holder.classList.contains(n.Class.blockStretched)}},{key:"align",set:function(e){this._content.style.textAlign=e,this._common.align=e},get:function(){return this._common.align||this.blockEditable.editable.$dom.getComputedStyle(this._content,"text-align")}},{key:"quoted",set:function(e){var t=this.holder.querySelector("blockquote");if(e!==!!t){var n=this.blockEditable.editable,o=n.document,i=n.$dom;n.selection;if(e){for(var a=this._content,r=o.createElement("blockquote");a&&a.firstChild;)r.appendChild(a.firstChild);a&&a.appendChild(r)}else t&&i.remove(t,!0);this._common.quote=e}},get:function(){return!!this._common.quote}},{key:"dropTarget",set:function(e){this.holder.classList.toggle(n.Class.dropTarget,e)},get:function(){return this.holder.classList.contains(n.Class.dropTarget)}},{key:"mergeable",get:function(){return en.k(this._componentInstance.merge)}}]),n}(nn);un.directions={PREVIOUS:"previous",NEXT:"next",RIGHT:"right",LEFT:"left",UP:"up",DOWN:"down"};var hn=function(){function e(t,n,o){Object(a.a)(this,e),this.focusedCssClass=void 0,this.defaultFocusedClass=void 0,this.cursor=-1,this.items=[],this.items=t||[],this.focusedCssClass=n,this.defaultFocusedClass=o}return Object(r.a)(e,[{key:"setItems",value:function(e){this.items=e}},{key:"next",value:function(){this.cursor=this.leafNodesAndReturnIndex(e.directions.NEXT)}},{key:"previous",value:function(){this.cursor=this.leafNodesAndReturnIndex(e.directions.PREVIOUS)}},{key:"left",value:function(){this.cursor=this.leafNodesAndReturnIndex(e.directions.LEFT)}},{key:"up",value:function(){this.cursor=this.leafNodesAndReturnIndex(e.directions.UP)}},{key:"right",value:function(){this.cursor=this.leafNodesAndReturnIndex(e.directions.RIGHT)}},{key:"down",value:function(){this.cursor=this.leafNodesAndReturnIndex(e.directions.DOWN)}},{key:"dropCursor",value:function(){-1!==this.cursor&&(this.items[this.cursor].classList.remove(this.focusedCssClass),this.cursor=-1)}},{key:"focus",value:function(){var e=this;if(this.dropCursor(),this.defaultFocusedClass){var t=this.items.findIndex((function(t){return t.classList.contains(e.defaultFocusedClass||"")}));-1!==t?(this.items[t].classList.add(this.focusedCssClass),this.cursor=t):0<this.items.length&&(this.items[0].classList.add(this.focusedCssClass),this.cursor=0)}}},{key:"leafNodesAndReturnIndex",value:function(t){if(0===this.items.length)return this.cursor;var n=this.cursor,o=null;return-1===n?n=t===e.directions.RIGHT||t===e.directions.DOWN||t===e.directions.NEXT?-1:0:o=this.items[n],o&&o.classList.remove(this.focusedCssClass),t!==e.directions.NEXT&&(o||t!==e.directions.RIGHT&&t!==e.directions.DOWN)?t!==e.directions.PREVIOUS&&(o||t!==e.directions.LEFT&&t!==e.directions.UP)?o&&(n=this.findNextIndex(n,t)):n=(this.items.length+n-1)%this.items.length:n=(n+1)%this.items.length,on.a.canSetCursor(this.items[n]),this.items[n].classList.add(this.focusedCssClass),n}},{key:"findNextIndex",value:function(t,n){var o=this.items.map((function(e,t){var n=e.getBoundingClientRect();return{index:t,x:Math.floor(n.x),y:Math.floor(n.y)}})),i=o[t],a=function(e){var t,n=Number.POSITIVE_INFINITY;return o.forEach((function(o){if(e(o)){var a=(s=i,((r=o).x-s.x)*(r.x-s.x)+(r.y-s.y)*(r.y-s.y));a<n&&(t=o,n=a)}var r,s})),t},r=0;if(n===e.directions.RIGHT){var s=a((function(e){return e.x>i.x}));r=s?s.index:i.index+1}else if(n===e.directions.DOWN){var l=a((function(e){return e.y>i.y}));r=l?l.index:i.index+1}else if(n===e.directions.LEFT){var c=a((function(e){return e.x<i.x}));r=c?c.index:i.index-1}else{var d=a((function(e){return e.y<i.y}));r=d?d.index:i.index-1}return r=(r+o.length)%o.length}},{key:"currentItem",get:function(){return-1===this.cursor?null:this.items[this.cursor]}}]),e}();hn.directions={PREVIOUS:"previous",NEXT:"next",RIGHT:"right",LEFT:"left",UP:"up",DOWN:"down"};var pn=function(){function e(t){var n=this;Object(a.a)(this,e),this._iterator=void 0,this.activated=!1,this.allowArrows=!0,this.allowShiftArrows=!0,this.activateCallback=void 0,this.keydownHanlder=void 0,this.onKeyDown=function(t){if(n.isEventReadyForHandling(t)&&!(n.keydownHanlder&&n.keydownHanlder(t,n._iterator.currentItem)))switch(e.usedKeys.includes(t.keyCode)&&t.preventDefault(),t.keyCode){case en.q.TAB:n.handleTabPress(t);break;case en.q.LEFT:n.flipLeft();break;case en.q.UP:n.flipUp();break;case en.q.RIGHT:n.flipRight();break;case en.q.DOWN:n.flipDown();break;case en.q.ENTER:n.handleEnterPress(t)}},this.allowArrows=!en.i(t.allowArrows)||t.allowArrows,this.allowShiftArrows=!en.i(t.allowShiftArrows)||t.allowShiftArrows,this._iterator=new hn(t.items||[],t.focusedItemClass||"",t.defaultFocusedItemClass),this.activateCallback=t.activateCallback,this.keydownHanlder=t.keydownHanlder}return Object(r.a)(e,[{key:"activate",value:function(e){this.activated=!0,e&&this._iterator.setItems(e),document.addEventListener("keydown",this.onKeyDown)}},{key:"deactivate",value:function(){this.activated=!1,this.dropCursor(),document.removeEventListener("keydown",this.onKeyDown)}},{key:"focusFirst",value:function(){this.dropCursor(),this.flipRight()}},{key:"focus",value:function(){this._iterator.focus()}},{key:"flipLeft",value:function(){this._iterator.previous()}},{key:"flipRight",value:function(){this._iterator.next()}},{key:"flipUp",value:function(){this._iterator.up()}},{key:"flipDown",value:function(){this._iterator.down()}},{key:"dropCursor",value:function(){this._iterator.dropCursor()}},{key:"isEventReadyForHandling",value:function(e){var t=[en.q.TAB,en.q.ENTER],n=this._iterator.currentItem==document.activeElement;return this.allowArrows&&!n&&(!this.allowShiftArrows&&e.shiftKey||t.push(en.q.LEFT,en.q.RIGHT,en.q.UP,en.q.DOWN)),this.activated&&-1!==t.indexOf(e.keyCode)}},{key:"handleTabPress",value:function(e){switch(e.shiftKey?hn.directions.LEFT:hn.directions.RIGHT){case hn.directions.RIGHT:this.flipRight();break;case hn.directions.LEFT:this.flipLeft()}}},{key:"handleEnterPress",value:function(e){this.activated&&(this._iterator.currentItem&&this._iterator.currentItem.click(),en.k(this.activateCallback)&&this._iterator.currentItem&&this.activateCallback(this._iterator.currentItem),e.preventDefault(),e.stopPropagation())}},{key:"currentItem",get:function(){return this._iterator.currentItem}}],[{key:"usedKeys",get:function(){return[en.q.TAB,en.q.LEFT,en.q.RIGHT,en.q.ENTER,en.q.UP,en.q.DOWN]}}]),e}(),fn=(n(840),n(841),function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).opened=!1,e._toolbarVerticalMargin=5,e._toolsInstances=void 0,e._buttonsList=null,e._width=0,e._flipper=null,e}return Object(r.a)(n,[{key:"toggleReadOnly",value:function(e){e?this.destroy():this.make()}},{key:"tryToShow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.allowedToShow()?(this.move(),this.open(),this.state.toolbar.close()):e&&this.close()}},{key:"move",value:function(){var e=this.blockEditable.selection.rangeRect,t=this.state.ui.nodes.wrapper.getBoundingClientRect(),n=this.state.ui.nodes.holder.getBoundingClientRect(),o={x:e.x-t.left,y:e.y+e.height-t.top+this._toolbarVerticalMargin};e.width&&(o.x+=Math.floor(e.width/2)),this.nodes.wrapper.style.left=Math.floor(o.x)+"px",this.nodes.wrapper.style.top=Math.floor(o.y)+"px";var i=e.x+Math.floor(e.width/2),a=i-this._width/2,r=i+this._width/2,s=-50;a<n.left?s-=100*(a-n.left)/this._width:r>n.right&&(s-=100*(r-n.right)/this._width),this.nodes.wrapper.style.transform="translateX(".concat(s,"%)")}},{key:"close",value:function(){if(this.opened){this.nodes.wrapper.classList.remove(n.Class.inlineToolbarShowed),Array.from(this._toolsInstances.entries()).forEach((function(e){var t=Object(Se.a)(e,2),n=(t[0],t[1]);n.shortcut;en.k(n.destroy)&&n.destroy()})),this.opened=!1,this._flipper&&this._flipper.deactivate();var e=this.blockEditable.selection;e.isCollapsed||e.removeAllRanges()}}},{key:"open",value:function(){if(!this.opened){this.addToolsFiltered(),this.nodes.wrapper.classList.add(n.Class.inlineToolbarShowed),this._buttonsList=this.nodes.buttons.querySelectorAll(".".concat(n.Class.inlineToolButton)),this.opened=!0;var e=Array.from(this._buttonsList);e=e.filter((function(e){return!e.hidden})),this._flipper&&(this._flipper.activate(e),this._flipper.focus())}}},{key:"containsNode",value:function(e){return this.nodes.wrapper.contains(e)}},{key:"destroy",value:function(){this._flipper&&(this._flipper.deactivate(),this._flipper=null),this.removeAllNodes()}},{key:"getInlineToolbarSettings",value:function(e){var t=e.enabledInlineTools;return!0===t||Array.isArray(t)?Array.isArray(t)?t:le.b.indexes:[]}},{key:"make",value:function(){var e=this;this.nodes.wrapper=on.a.make("div",[n.Class.inlineToolbar].concat(Object(p.a)(this.isRtl?[mn.Class.editorRtlFix]:[]))),this.nodes.togglerAndButtonsWrapper=on.a.make("div",n.Class.togglerAndButtonsWrapper),this.nodes.buttons=on.a.make("div",n.Class.buttonsWrapper),this.nodes.actions=on.a.make("div",n.Class.actionsWrapper),this.listeners.on(this.nodes.wrapper,"mousedown",(function(e){e.target.closest(".".concat(n.Class.actionsWrapper))||e.preventDefault()})),on.a.append(this.nodes.wrapper,[this.nodes.togglerAndButtonsWrapper,this.nodes.actions]),on.a.append(this.state.ui.nodes.wrapper,this.nodes.wrapper),on.a.append(this.nodes.togglerAndButtonsWrapper,this.nodes.buttons),this.recalculateWidth(),this.enableFlipper(),this.blockEditable.editable.on("selectionchange",(function(){e.checkToolsState()}))}},{key:"allowedToShow",value:function(){var e=this.blockEditable.selection,t=e.textContent;if(!e||!e.anchorNode)return!1;if(e.isCollapsed||t.length<1)return!1;var n=on.a.isElement(e.anchorNode)?e.anchorNode:e.anchorNode.parentElement;if(!n)return!1;if(e&&["IMG","INPUT"].includes(n.tagName))return!1;if(null===n.closest('[contenteditable="true"]'))return!1;var o=this.state.content.getBlock(e.anchorNode);return!!o&&this.getInlineToolbarSettings(o.component).length>0}},{key:"recalculateWidth",value:function(){this._width=this.nodes.wrapper.offsetWidth}},{key:"addToolsFiltered",value:function(){var e=this,t=this.blockEditable.selection,n=this.state.content.getBlock(t.anchorNode);n&&(this.nodes.buttons.innerHTML="",this.nodes.actions.innerHTML="",this._toolsInstances=new Map,this.getInlineToolbarSettings(null===n||void 0===n?void 0:n.component).forEach((function(t){e.addTool(le.b.tool(t))})),this.recalculateWidth())}},{key:"addTool",value:function(e){var t=this,o=this.state.tooltip,i=new e({blockEditable:this.blockEditable}),a=i.render();if(a){if(a.dataset.key=e.key,this.nodes.buttons.appendChild(a),this._toolsInstances.set(e.key,i),en.k(i.renderActions)){var r=i.renderActions();this.nodes.actions.appendChild(r)}this.listeners.on(a,"click",(function(e){t.toolClicked(i),e.preventDefault()}));var s=i.shortcut,l=on.a.make("div"),c=this.blockEditable.getLang("toolbar.inline.".concat(e.key));l.appendChild(on.a.text(c)),s&&l.appendChild(on.a.make("div",n.Class.inlineToolbarShortcut,{textContent:en.b(s)})),o.onHover(a,l,{placement:"top",hidingDelay:100}),i.selectionChange(this.blockEditable.selection,this.blockEditable.editable)}}},{key:"toolClicked",value:function(e){e.surround(this.blockEditable.selection.getRangeAt(0),this.blockEditable.editable)}},{key:"checkToolsState",value:function(){var e=this;this._toolsInstances&&this._toolsInstances.forEach((function(t){t.selectionChange(e.blockEditable.selection,e.blockEditable.editable)}))}},{key:"enableFlipper",value:function(){var e=this;this._flipper=new pn({focusedItemClass:n.Class.focusedButton,defaultFocusedItemClass:n.Class.activeButton,allowArrows:!0,allowShiftArrows:!1,keydownHanlder:function(t,n){var o=t.keyCode;if(!(t.altKey||t.ctrlKey||t.metaKey||t.shiftKey)&&(o===en.q.DOWN||o===en.q.UP)&&n){var i=n.offsetTop;if(o===en.q.UP&&i<1||o===en.q.DOWN&&i>29)return Promise.resolve().then((function(){var t=e.blockEditable.selection.getRangeAt(0);e.close(),t.setCursor(o===en.q.DOWN,!0)})),t.preventDefault(),!0}return!1}})}},{key:"flipper",get:function(){return this._flipper}}]),n}(nn));fn.Class={inlineToolbar:"beui-inline-toolbar",inlineToolbarShowed:"beui-inline-toolbar--showed",inlineToolbarLeftOriented:"beui-inline-toolbar--left-oriented",inlineToolbarRightOriented:"beui-inline-toolbar--right-oriented",inlineToolbarShortcut:"beui-inline-toolbar__shortcut",buttonsWrapper:"beui-inline-toolbar__buttons",actionsWrapper:"beui-inline-toolbar__actions",inlineToolButton:"beui-inline-tool",focusedButton:"beui-inline-tool--focused",activeButton:"beui-inline-tool--active",dropdown:"beui-inline-toolbar__dropdown",dropdownHidden:"beui-inline-toolbar__dropdown--hidden",dropdownContent:"beui-inline-toolbar__dropdown-content",togglerAndButtonsWrapper:"beui-inline-toolbar__toggler-and-button-wrapper"};var vn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"toggleReadOnly",value:function(e){e?(this.destroy(),this.state.toolbox.destroy(),this.state.blockSettings.destroy(),this.disableModuleBindings()):(this.drawUI(),this.enableModuleBindings())}},{key:"move",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&(this.state.toolbox.close(),this.state.blockSettings.close());var t=this.state.content.activeBlock;if(t){var n=t.holder,o=(this.state.ui.isMobile,n.offsetHeight),i=n.offsetTop,a=Math.floor(o/2);this.nodes.plusButton.style.transform="translate3d(0, calc(".concat(a,"px - 50%), 0)"),this.adjustToolbox(),this.nodes.wrapper.style.transform="translate3D(0, ".concat(Math.floor(i),"px, 0)")}}},{key:"adjustToolbox",value:function(){var e=this.state.content.activeBlock;if(e){var t=e.holder,n=t.offsetHeight,o=Math.floor(n/2),i=this.blockEditable.selection;i.cache();var a=i.getRangeAt(0).getBoundingClientRect(),r=t.getBoundingClientRect();this.state.toolbox.nodes.toolbox.style.transform="translate3d(".concat(Math.max(a.x-r.x+10,0),"px, calc(").concat(o,"px - 50%), 0)")}}},{key:"open",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];en.e((function(){e.move(o),e.nodes.wrapper.classList.add(n.Class.toolbarOpened),t?e.blockActions.show():e.blockActions.hide()}),50)()}},{key:"close",value:function(){this.nodes.wrapper.classList.remove(n.Class.toolbarOpened),this.blockActions.hide(),this.state.toolbox.close(),this.state.blockSettings.close()}},{key:"make",value:function(){var e=this;this.nodes.wrapper=on.a.make("div",n.Class.toolbar),this.nodes.content=on.a.make("div",n.Class.content),this.nodes.actions=on.a.make("div",n.Class.actions),on.a.append(this.nodes.wrapper,this.nodes.content),on.a.append(this.nodes.content,this.nodes.actions),this.nodes.plusButton=on.a.make("div",n.Class.plusButton),on.a.append(this.nodes.plusButton,on.a.icon("plus",14,14)),on.a.append(this.nodes.content,this.nodes.plusButton),this.readOnlyMutableListeners.on(this.nodes.plusButton,"click",(function(){e.plusButtonClicked()}),!1);var t=on.a.make("div");t.appendChild(document.createTextNode(this.blockEditable.getLang("toolbar.toolbox.insert"))),t.appendChild(on.a.make("div",n.Class.plusButtonShortcut,{textContent:"\u21e5 Tab"})),this.state.tooltip.onHover(this.nodes.plusButton,t),this.nodes.blockActionsButtons=on.a.make("div",n.Class.blockActionsButtons),this.nodes.settingsToggler=on.a.make("span",n.Class.settingsToggler);var o=on.a.icon("dots",8,8);on.a.append(this.nodes.settingsToggler,o),on.a.append(this.nodes.blockActionsButtons,this.nodes.settingsToggler),on.a.append(this.nodes.actions,this.nodes.blockActionsButtons),this.state.tooltip.onHover(this.nodes.settingsToggler,this.blockEditable.getLang("toolbar.settings.toggler"),{placement:"top"}),on.a.append(this.nodes.content,this.state.toolbox.nodes.toolbox),on.a.append(this.nodes.actions,this.state.blockSettings.nodes.wrapper),on.a.append(this.state.ui.nodes.wrapper,this.nodes.wrapper)}},{key:"plusButtonClicked",value:function(){this.state.toolbox.toggle()}},{key:"enableModuleBindings",value:function(){var e=this;this.readOnlyMutableListeners.on(this.nodes.settingsToggler,"click",(function(){e.settingsTogglerClicked()}))}},{key:"disableModuleBindings",value:function(){this.readOnlyMutableListeners.clearAll()}},{key:"settingsTogglerClicked",value:function(){this.state.blockSettings.opened?this.state.blockSettings.close():this.state.blockSettings.open()}},{key:"drawUI",value:function(){this.state.blockSettings.make(),this.state.toolbox.make(),this.make()}},{key:"destroy",value:function(){this.removeAllNodes()}},{key:"opened",get:function(){return this.nodes.wrapper.classList.contains(n.Class.toolbarOpened)}},{key:"plusButton",get:function(){var e=this;return{hide:function(){e.nodes.plusButton.classList.add(n.Class.plusButtonHidden)},show:function(){e.state.toolbox.isEmpty||e.nodes.plusButton.classList.remove(n.Class.plusButtonHidden)}}}},{key:"blockActions",get:function(){var e=this;return{hide:function(){e.nodes.actions.classList.remove(n.Class.actionsOpened)},show:function(){e.nodes.actions.classList.add(n.Class.actionsOpened)}}}}],[{key:"Class",get:function(){return{toolbar:"beui-toolbar",content:"beui-toolbar__content",actions:"beui-toolbar__actions",actionsOpened:"beui-toolbar__actions--opened",toolbarOpened:"beui-toolbar--opened",plusButton:"beui-toolbar__plus",plusButtonShortcut:"beui-toolbar__plus-shortcut",plusButtonHidden:"beui-toolbar__plus--hidden",blockActionsButtons:"beui-toolbar__actions-buttons",settingsToggler:"beui-toolbar__settings-btn"}}}]),n}(nn),bn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).opened=!1,e._toolbarVerticalMargin=5,e._toolsInstances=void 0,e._buttonsList=null,e._actionsList=null,e._width=0,e._flipper=null,e._cacheRange=null,e}return Object(r.a)(n,[{key:"toggleReadOnly",value:function(e){e?this.destroy():this.make()}},{key:"tryToShow",value:function(e){var t=this.allowedToShow(e);t.length?(this.move(),this.open(t,e),this.state.toolbar.close()):this.close()}},{key:"move",value:function(){var e=this.blockEditable.selection.rangeRect,t=this.state.ui.nodes.wrapper.getBoundingClientRect(),n=this.state.ui.nodes.holder.getBoundingClientRect(),o={x:e.x-t.left,y:e.y+e.height-t.top+this._toolbarVerticalMargin};e.width&&(o.x+=Math.floor(e.width/2)),this.nodes.wrapper.style.left=Math.floor(o.x)+"px",this.nodes.wrapper.style.top=Math.floor(o.y)+"px";var i=e.x+Math.floor(e.width/2),a=i-this._width/2,r=i+this._width/2,s=-50;a<n.left?s-=100*(a-n.left)/this._width:r>n.right&&(s-=100*(r-n.right)/this._width),this.nodes.wrapper.style.transform="translateX(".concat(s,"%)")}},{key:"close",value:function(){if(this.opened){this.nodes.wrapper.classList.remove(n.Class.insertToolbarShowed),Array.from(this._toolsInstances.entries()).forEach((function(e){var t=Object(Se.a)(e,2),n=(t[0],t[1]);en.k(n.destroy)&&n.destroy()})),this.opened=!1,this._flipper&&this._flipper.deactivate();var e=this.blockEditable.selection;e.isCollapsed||e.removeAllRanges(),this._cacheRange=null,this.nodes.wrapper.style.top="0px"}}},{key:"open",value:function(e,t){if(!this.opened){this.addToolsFiltered(e,t),this.nodes.wrapper.classList.add(n.Class.insertToolbarShowed),this._buttonsList=this.nodes.buttons.querySelectorAll(".".concat(n.Class.button)),this._actionsList=this.nodes.actions.querySelectorAll(".".concat(n.Class.actions)),this._buttonsList.length&&this.activeTool(this._buttonsList[0].dataset.key),this.opened=!0;var o=Array.from(this._buttonsList);o=o.filter((function(e){return!e.hidden})),this._flipper&&(this._flipper.activate(o),this._flipper.focus());var i=this.blockEditable.selection;this._cacheRange=i.getRangeAt(0).cloneRange()}}},{key:"containsNode",value:function(e){return this.nodes.wrapper.contains(e)}},{key:"destroy",value:function(){this._flipper&&(this._flipper.deactivate(),this._flipper=null),this.removeAllNodes()}},{key:"make",value:function(){var e=this;this.nodes.wrapper=on.a.make("div",[n.Class.insertToolbar].concat(Object(p.a)(this.isRtl?[mn.Class.editorRtlFix]:[]))),this.nodes.togglerAndButtonsWrapper=on.a.make("div",n.Class.togglerAndButtonsWrapper),this.nodes.close=on.a.make("div",[n.Class.close,"bei-cross"]),this.nodes.buttons=on.a.make("div",n.Class.buttonsWrapper),this.nodes.actions=on.a.make("div",n.Class.actionsWrapper),on.a.append(this.nodes.wrapper,[this.nodes.togglerAndButtonsWrapper,this.nodes.actions]),on.a.append(this.state.ui.nodes.wrapper,this.nodes.wrapper),on.a.append(this.nodes.togglerAndButtonsWrapper,[this.nodes.close,this.nodes.buttons]),this.recalculateWidth(),this.enableFlipper(),this.nodes.close.addEventListener("click",(function(){e.close()}))}},{key:"allowedToShow",value:function(e){if(e)return le.c.indexes.filter((function(t){return!!le.c.tool(t).checkTarget(e)}));var t=this.blockEditable.selection,n=t.textContent;if(!t||!t.anchorNode)return[];if(!t.isCollapsed||n.length>0)return[];var o=on.a.isElement(t.anchorNode)?t.anchorNode:t.anchorNode.parentElement;return o?t&&["IMG","INPUT"].includes(o.tagName)||null===o.closest('[contenteditable="true"]')?[]:this.state.content.getBlock(t.anchorNode)?le.c.indexes:[]:[]}},{key:"recalculateWidth",value:function(){this._width=this.nodes.wrapper.offsetWidth}},{key:"addToolsFiltered",value:function(e,t){var n=this,o=this.blockEditable.selection;this.state.content.getBlock(o.anchorNode)&&(this.nodes.buttons.innerHTML="",this.nodes.actions.innerHTML="",this._toolsInstances=new Map,e.forEach((function(e){n.addTool(le.c.tool(e),t)})),this.recalculateWidth())}},{key:"addTool",value:function(e,t){var o=this,i=(this.state.tooltip,new e({blockEditable:this.blockEditable,target:t,insertHTML:function(e){o.insertHTML(e)}})),a=this.blockEditable.getLang("toolbar.insert.".concat(e.key)),r=on.a.make("div",[n.Class.button]);if(r.innerHTML=a,r){r.dataset.key=e.key,this.nodes.buttons.appendChild(r);var s=i.renderActions();s.classList.add(n.Class.actions),s.dataset.key=e.key,this.nodes.actions.appendChild(s),this._toolsInstances.set(e.key,i),this.listeners.on(r,"click",(function(t){o.activeTool(e.key),o.toolClicked(i),t.preventDefault()}))}}},{key:"activeTool",value:function(e){this._buttonsList&&this._buttonsList.forEach((function(t){t.classList.toggle(n.Class.activeButton,t.dataset.key===e)})),this._actionsList&&this._actionsList.forEach((function(t){t.classList.toggle(n.Class.activeActions,t.dataset.key===e)}))}},{key:"insertHTML",value:function(e){var t=this,n=this.blockEditable,o=n.editable,i=n.selection;this.restoreCursor()&&(o.document.execCommand("insertHTML",!1,e),setTimeout((function(){t._cacheRange=i.getRangeAt(0).cloneRange()}),250))}},{key:"restoreCursor",value:function(){var e=this.blockEditable.selection,t=e.anchorElement;return t&&t.closest('input,textarea,[contenteditable="true"]')||this._cacheRange&&this._cacheRange.setCursor(!0,!0),(t=e.anchorElement)&&t.closest('input,textarea,[contenteditable="true"]')}},{key:"toolClicked",value:function(e){}},{key:"enableFlipper",value:function(){var e=this;this._flipper=new pn({focusedItemClass:n.Class.focusedButton,defaultFocusedItemClass:n.Class.activeButton,allowArrows:!0,allowShiftArrows:!1,keydownHanlder:function(t){var n=t.keyCode;return!(t.altKey||t.ctrlKey||t.metaKey||t.shiftKey||n!==en.q.DOWN&&n!==en.q.UP)&&(Promise.resolve().then((function(){var t=e.blockEditable.selection.getRangeAt(0);e.close(),t.setCursor(n===en.q.DOWN,!0)})),t.preventDefault(),!0)}})}},{key:"flipper",get:function(){return this._flipper}}]),n}(nn);bn.Class={insertToolbar:"beui-insert-toolbar",insertToolbarShowed:"beui-insert-toolbar--showed",close:"beui-insert-toolbar__close",actionsWrapper:"beui-insert-toolbar__actions",buttonsWrapper:"beui-insert-toolbar__buttons",button:"beui-insert-tool",focusedButton:"beui-insert-tool--focused",activeButton:"beui-insert-tool--active",actions:"beui-insert-tool__actions",activeActions:"beui-insert-tool__actions--active",togglerAndButtonsWrapper:"beui-insert-toolbar__toggler-and-button-wrapper"};var mn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).isMobile=!1,e._contentRectCache=void 0,e.resizeDebouncer=en.d((function(){e.windowResize()}),200),e}return Object(r.a)(n,[{key:"addLoader",value:function(){this.nodes.loader=on.a.make("div",n.Class.editorLoader),this.nodes.wrapper.prepend(this.nodes.loader),this.nodes.redactor.classList.add(n.Class.editorZoneHidden)}},{key:"removeLoader",value:function(){this.nodes.loader.remove(),this.nodes.redactor.classList.remove(n.Class.editorZoneHidden)}},{key:"prepare",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(){return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.checkIsMobile(),this.make(),this.addLoader(),this.appendSVGSprite();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toggleReadOnly",value:function(e){e?this.disableModuleBindings():this.enableModuleBindings()}},{key:"checkEmptiness",value:function(){var e=this.state.content;this.nodes.wrapper.classList.toggle(n.Class.editorEmpty,e.isEmpty)}},{key:"destroy",value:function(){this.nodes.holder.innerHTML=""}},{key:"closeAllToolbars",value:function(){var e=this.state,t=e.toolbox,n=e.blockSettings,o=e.inlineToolbar,i=e.conversionToolbar;n.close(),o.close(),i.close(),t.close()}},{key:"elementFromPoint",value:function(e,t){return this.nodes.refactorDocumentOrShadowRoot?this.nodes.refactorDocumentOrShadowRoot.elementFromPoint(e,t):document.elementFromPoint(e,t)}},{key:"checkIsMobile",value:function(){this.isMobile=window.innerWidth<650}},{key:"make",value:function(){if(this.nodes.holder=this.blockEditable.holder,this.nodes.scroller=this.nodes.holder.closest(".editor-canvas"),this.nodes.wrapper=on.a.make("div",[n.Class.editorWrapper]),this.nodes.redactor=on.a.make("div",n.Class.editorZone),this.nodes.wrapper.appendChild(this.nodes.redactor),this.nodes.holder.appendChild(this.nodes.wrapper),this.nodes.content=on.a.make("div",[n.Class.editorZoneContent,n.Class.editorContent]),Ae.a.chrome){var e=this.nodes.redactor.attachShadow({mode:"open"});e.appendChild(this.nodes.content),this.nodes.refactorDocumentOrShadowRoot=e,this.blockEditable.editable.mount(this.nodes.content,e.getSelection?e.getSelection():document.getSelection())}else this.nodes.redactor.appendChild(this.nodes.content),this.blockEditable.editable.mount(this.nodes.content,document.getSelection())}},{key:"loadStyles",value:function(){}},{key:"enableModuleBindings",value:function(){var e=this;this.blockEditable.editable;this.readOnlyMutableListeners.on(this.nodes.content,"click",(function(t){e.contentClicked(t)}),!1),this.readOnlyMutableListeners.on(this.nodes.wrapper,"mousedown",(function(t){e.documentTouched(t)}),!0),this.readOnlyMutableListeners.on(this.nodes.wrapper,"mouseup",(function(t){e.documentMouseUp(t)}),!0),this.readOnlyMutableListeners.on(this.nodes.wrapper,"touchstart",(function(t){e.documentTouched(t)}),!0),this.readOnlyMutableListeners.on(document,"keydown",(function(t){e.documentKeydown(t)}),!0),this.readOnlyMutableListeners.on(document,"click",(function(t){e.documentClicked(t)}),!0),this.blockEditable.editable.on("selectionchange",(function(){e.selectionChanged()})),this.readOnlyMutableListeners.on(window,"resize",(function(){e.resizeDebouncer()}),{passive:!0})}},{key:"disableModuleBindings",value:function(){this.readOnlyMutableListeners.clearAll()}},{key:"windowResize",value:function(){this._contentRectCache=null,this.checkIsMobile()}},{key:"documentKeydown",value:function(e){switch(e.keyCode){case en.q.ENTER:this.enterPressed(e);break;case en.q.BACKSPACE:this.backspacePressed(e);break;case en.q.ESC:this.escapePressed(e);break;case en.q.INSERT:this.insertPressed(e);break;default:this.defaultBehaviour(e)}}},{key:"defaultBehaviour",value:function(e){var t=this.state.content.activeBlock,o=e.target.closest(".".concat(n.Class.editorWrapper)),i=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;void 0===t||null!==o?o||t&&i&&!en.n(e.keyCode)||(this.state.content.dropPointer(),this.state.toolbar.close()):this.state.events.keydown(e)}},{key:"backspacePressed",value:function(e){var t=this.state,n=t.content,o=t.blockSelection,i=t.cursor,a=this.blockEditable.selection,r=n.activeBlock;if((o.anyBlockSelected||r&&r.inputSelection.anyInputSelected)&&!a.anchorNode){if(o.anyBlockSelected){var s=n.removeSelectedBlocks();i.setToBlock(n.insertDefaultBlockAtIndex(s||n.activeBlockIndex,!0),i.positions.START)}else r.inputSelection.removeSelectedInputs(),i.setToBlock(r);o.clearSelection(e),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()}else this.defaultBehaviour(e)}},{key:"escapePressed",value:function(e){var t=this.state,n=t.toolbox,o=t.blockSettings,i=t.inlineToolbar,a=t.toolbar,r=t.conversionToolbar,s=t.blockSelection,l=t.content,c=t.insertToolbar,d=this.blockEditable.selection.getRangeAt(0);s.clearSelection(e),n.opened?n.close():r.opened?r.close():o.opened?o.close():i.opened?(i.close(),d.setCursor(!0,!0)):l.activeBlock&&l.activeBlock.stretched?l.activeBlock.stretched=!1:(a.close(),c.close())}},{key:"enterPressed",value:function(e){var t=this.state,n=t.content,o=t.blockSelection,i=t.cursor,a=t.toolbar,r=this.blockEditable.selection,s=n.activeBlockIndex>=0;if(o.anyBlockSelected&&!r.anchorNode)return o.clearSelection(e),e.preventDefault(),e.stopImmediatePropagation(),void e.stopPropagation();if(!this.someToolbarOpened&&s&&"BODY"===e.target.tagName)if(n.activeBlock)this.state.events.keydown(e);else{var l=n.insert();i.setToBlock(l),n.highlightCurrentNode(),a.move(),a.plusButton.show()}o.clearSelection(e)}},{key:"insertPressed",value:function(e){var t=this.state,n=t.blockSelection,o=t.insertToolbar;n.clearSelection(e),this.blockEditable.selection.getRangeAt(0).setCursor(!0,!0),o.tryToShow(),e.preventDefault()}},{key:"documentClicked",value:function(e){var t=this.state,o=t.content,i=t.blockSelection,a=t.conversionToolbar,r=t.crossSelection,s=t.toolbar,l=t.inlineToolbar;this.blockEditable.selection;if(e.isTrusted){var c=e.target;c&&1===c.nodeType&&c.closest(".".concat(n.Class.editorWrapper))||!!c.parentElement&&!!c.parentElement.closest(".".concat(n.Class.editorWrapper))||(o.dropPointer(),l.close(),s.close(),a.close());var d=e.metaKey||e.ctrlKey;r.isCrossBlockSelectionStarted||d||i.clearSelection(e)}}},{key:"documentMouseUp",value:function(e){var t=e.target;(t.closest(".".concat(fn.Class.inlineToolbar))||t.closest(".".concat(vn.Class.toolbar)))&&e.stopPropagation()}},{key:"documentTouched",value:function(e){var t=e.target;if(t.closest(".".concat(fn.Class.inlineToolbar))||t.closest(".".concat(vn.Class.toolbar))||t.closest(".".concat(bn.Class.insertToolbar)))return e.stopPropagation(),void(t.closest('input,textarea,[contenteditable="true"]')||e.preventDefault());if(t===this.nodes.redactor||t===this.nodes.wrapper){var n=this.nodes.content.getBoundingClientRect(),o=n.x+n.width/2,i=e instanceof MouseEvent?e.clientY:e.touches[0].clientY;t=this.elementFromPoint(o,i)}if(t&&t!==this.nodes.redactor&&t!==this.nodes.wrapper)try{this.state.content.setActiveBlockBy(t)||this.state.cursor.setToBlock(this.state.content.activeBlock,this.state.cursor.positions.END),this.state.content.highlightCurrentNode()}catch(a){this.state.rectangleSelection.isRectActivated()}else this.state.rectangleSelection.isRectActivated()||(this.state.cursor.setToTheLastBlock(),e.preventDefault());this.state.toolbar.open(),this.state.toolbar.plusButton.hide()}},{key:"contentClicked",value:function(e){if(this.blockEditable.selection.isCollapsed){var t=function(){e.stopImmediatePropagation(),e.stopPropagation()},n=e.target,o=e.metaKey||e.ctrlKey;if(on.a.isAnchor(n)&&o){t();var i=n.getAttribute("href")||"",a=en.h(i);en.s(a)}else{var r=this.state,s=r.content,l=r.blockSelection;if(!s.activeBlock){if(s.blocks.length)return;t(),s.insert()}if(o&&(s.activeBlock.selected=!0,l.clearCache()),s.activeBlock.isDefault)t(),s.activeBlock.isEmpty&&this.state.toolbar.plusButton.show();this.state.insertToolbar.tryToShow(e.target)}}}},{key:"selectionChanged",value:function(e){var t=this.state,n=t.crossSelection,o=t.blockSelection,i=t.inlineToolbar,a=t.content,r=this.blockEditable.selection,s=r.anchorElement;n.isCrossBlockSelectionStarted&&o.anyBlockSelected&&r.removeAllRanges(),s&&s.closest(".".concat(un.Class.content))?(a.activeBlock||a.setActiveBlockBy(s),i.tryToShow(!0)):i.containsNode(s)||i.close()}},{key:"appendSVGSprite",value:function(){var e=on.a.make("div");e.hidden=!0,e.style.display="none",on.a.append(this.nodes.wrapper,e)}},{key:"contentRect",get:function(){if(this._contentRectCache)return this._contentRectCache;var e=this.nodes.wrapper.querySelector(".".concat(un.Class.content));return e?(this._contentRectCache=e.getBoundingClientRect(),this._contentRectCache):{width:650,left:0,right:0}}},{key:"layout",set:function(e){"print"===e?(this.nodes.wrapper.classList.toggle(n.Class.editorWrapperMobile,!1),this.nodes.wrapper.classList.toggle(n.Class.editorWrapperPrint,!0)):"mobile"===e?(this.nodes.wrapper.classList.toggle(n.Class.editorWrapperMobile,!0),this.nodes.wrapper.classList.toggle(n.Class.editorWrapperPrint,!1)):(this.nodes.wrapper.classList.toggle(n.Class.editorWrapperMobile,!1),this.nodes.wrapper.classList.toggle(n.Class.editorWrapperPrint,!1)),this._contentRectCache=null},get:function(){var e=this.nodes.wrapper.classList.contains(n.Class.editorWrapperMobile),t=this.nodes.wrapper.classList.contains(n.Class.editorWrapperPrint);return e?"mobile":t?"print":"web"}},{key:"someToolbarOpened",get:function(){var e=this.state,t=e.toolbox,n=e.blockSettings,o=e.inlineToolbar,i=e.conversionToolbar;return n.opened||o.opened||i.opened||t.opened}},{key:"someFlipperButtonFocused",get:function(){return Object.entries(this.state).filter((function(e){var t=Object(Se.a)(e,2);t[0];return t[1].flipper instanceof pn})).some((function(e){var t=Object(Se.a)(e,2);t[0];return t[1].flipper.currentItem}))}},{key:"isAtEditor",get:function(){var e=this.blockEditable.selection,t=e.anchorNode||e.focusNode;t&&t.nodeType===Node.TEXT_NODE&&(t=t.parentNode);var o=null;return t&&(o=t.closest(".".concat(n.Class.editorZoneContent))),o&&o.nodeType===Node.ELEMENT_NODE}}],[{key:"Class",get:function(){return{editorWrapper:"beui-editor",editorWrapperWeb:"beui-editor--web",editorWrapperPrint:"beui-editor--print",editorWrapperMobile:"beui-editor--mobile",editorZone:"beui-editor__redactor",editorZoneHidden:"beui-editor__redactor--hidden",editorZoneContent:"beui-editor__content",editorContent:"be-content",editorLoader:"beui-editor__loader",editorEmpty:"beui-editor--empty",editorRtlFix:"beui-editor--rtl"}}}]),n}(nn),gn=n(185),kn=n.n(gn),yn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).lib=new kn.a,e}return Object(r.a)(n,[{key:"show",value:function(e,t,n){this.lib.show(e,t,n)}},{key:"hide",value:function(){this.lib.hide()}},{key:"onHover",value:function(e,t,n){this.lib.onHover(e,t,n)}}]),n}(nn),Cn={img:{src:!0,alt:!0},taskinput:{type:!0,checked:!0}},_n=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).MIME_TYPE="application/block-editable",e.componentsTags={},e.tagsByPlugin={},e.typesByPlugin={},e.hooksByPlugin={},e.componentsPatterns=[],e.componentsFiles={},e.exceptionList=[],e.processPlugin=function(t){try{var n=new t({blockEditable:e.blockEditable});if(!t.pasteConfig)return void e.exceptionList.push(t.name);if(!en.k(n.onPaste))return;e.getTypesConfig(t),e.getHooksConfig(t),e.getTagsConfig(t),e.getFilesConfig(t),e.getPatternsConfig(t)}catch(o){}},e.handlePasteEvent=function(){var t=Object(Ne.a)(Be.a.mark((function t(n){var o,i,a,r,s;return Be.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=n,i=e.state,a=i.content,r=i.toolbar,a.removeSelectedBlocks(),o.target&&o.clipboardData){t.next=5;break}return t.abrupt("return");case 5:if((s=a.activeBlock)&&(!e.isNativeBehaviour(o.target)||o.clipboardData.types.includes("Files"))){t.next=8;break}return t.abrupt("return");case 8:if(!s||!e.exceptionList.includes(a.activeBlock.component.key)){t.next=10;break}return t.abrupt("return");case 10:if(!s||!s.stretched){t.next=12;break}return t.abrupt("return");case 12:n.preventDefault(),e.processDataTransfer(o.clipboardData),a.clearFocused(),r.close();case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(r.a)(n,[{key:"prepare",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(){return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.processPlugins();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toggleReadOnly",value:function(e){e?this.unsetCallback():this.setCallback()}},{key:"processDataTransfer",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(t){var n,o,i,a,r,s,l,c,d,u,h,p,f,v,b,m,g,k,y=arguments;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=y.length>1&&void 0!==y[1]&&y[1],o=this.state.sanitizer,t){e.next=4;break}return e.abrupt("return");case 4:i="",e.t0=Be.a.keys(this.hooksByPlugin);case 6:if((e.t1=e.t0()).done){e.next=14;break}if(a=e.t1.value,!(r=this.hooksByPlugin[a])||!r(t)){e.next=12;break}return i=a,e.abrupt("break",14);case 12:e.next=6;break;case 14:if(!i){e.next=19;break}return s={component:i,isBlock:!0,event:this.composePasteEvent("hook",{data:t}),common:{quote:!1}},e.next=18,this.processData(s);case 18:return e.abrupt("return");case 19:l=t.types,c=0;case 21:if(!(c<l.length)){e.next=38;break}d=l[c].toLowerCase(),e.t2=Be.a.keys(this.typesByPlugin);case 24:if((e.t3=e.t2()).done){e.next=33;break}if(u=e.t3.value,!Object.prototype.hasOwnProperty.call(this.typesByPlugin,u)){e.next=31;break}if(!this.typesByPlugin[u].includes(d)){e.next=31;break}return i=u,e.abrupt("break",33);case 31:e.next=24;break;case 33:if(!i){e.next=35;break}return e.abrupt("break",38);case 35:c++,e.next=21;break;case 38:if(!i){e.next=43;break}return h={component:i,isBlock:!0,event:this.composePasteEvent("type",{data:t}),common:{quote:!1}},e.next=42,this.processData(h);case 42:return e.abrupt("return");case 43:if(!(l.includes?l.includes("Files"):l.contains("Files"))){e.next=48;break}return e.next=47,this.processFiles(t.files);case 47:return e.abrupt("return");case 48:if(p=t.getData(this.MIME_TYPE),f=t.getData("text/plain"),v=t.getData("text/html"),/class="CodeMirror-lines"/.test(v)&&((b=document.createElement("div")).innerHTML=v,b.querySelectorAll(".CodeMirror-lines").forEach((function(e){e.innerHTML="<pre>".concat(Array.from(e.querySelectorAll("pre")).map((function(e){return"".concat(e.textContent,"\n")})).join(""),"</pre>")})),v=b.innerHTML),!p){e.next=60;break}return e.prev=53,this.insertEditorJSData(JSON.parse(p)),e.abrupt("return");case 58:e.prev=58,e.t4=e.catch(53);case 60:if(n&&f.trim()&&v.trim()&&(v="<p>"+(v.trim()?v:f)+"</p>"),!v.trim()&&f.trim()&&(v=this.blockEditable.utils.makeHtml(f)),m=Object.keys(this.componentsTags).reduce((function(e,t){return e[t.toLowerCase()]=!0,e}),{}),g=Object.assign({},m,o.getAllInlineToolsConfig(),{br:{},blockquote:!0}),(k=o.clean(v,g)).trim()&&k.trim()!==f&&on.a.isHTMLString(k)){e.next=70;break}return e.next=68,this.processText(f);case 68:e.next=72;break;case 70:return e.next=72,this.processText(k,!0);case 72:case"end":return e.stop()}}),e,this,[[53,58]])})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceWithHTML",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(t){var n,o,i,a;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.state.sanitizer,o=Object.keys(this.componentsTags).reduce((function(e,t){return e[t.toLowerCase()]=!0,e}),{}),i=Object.assign({},o,n.getAllInlineToolsConfig(),{br:{},blockquote:!0}),a=n.clean(t,i),e.next=6,this.processText(a,!0,!0);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processText",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(t){var n,o,i,a,r,s,l,c,d=this,u=arguments;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u.length>1&&void 0!==u[1]&&u[1],o=u.length>2&&void 0!==u[2]&&u[2],i=this.state,a=i.cursor,r=i.content,(s=n?this.processHTML(t):this.processPlain(t)).length){e.next=6;break}return e.abrupt("return");case 6:if(1!==s.length){e.next=9;break}return s[0].isBlock?this.processSingleBlock(s.pop(),o):this.processInlinePaste(s.pop(),o),e.abrupt("return");case 9:l=r.activeBlock&&r.activeBlock.isDefault,c=o||l&&r.activeBlock.isEmpty,s.map(function(){var e=Object(Ne.a)(Be.a.mark((function e(t,n){return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",d.insertBlock(t,0===n&&c));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),r.activeBlock&&a.setToBlock(r.activeBlock,a.positions.END);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setCallback",value:function(){this.readOnlyMutableListeners.on(document,"paste",this.handlePasteEvent)}},{key:"unsetCallback",value:function(){this.readOnlyMutableListeners.clearAll()}},{key:"processPlugins",value:function(){var e=le.a.components;Array.from(Object.values(e)).forEach(this.processPlugin)}},{key:"getTypesConfig",value:function(e){var t,n=(null===(t=e.pasteConfig)||void 0===t?void 0:t.types)||[];this.typesByPlugin[e.key]=n.map((function(e){return e.toLowerCase()}))}},{key:"getHooksConfig",value:function(e){var t,n,o;null===(t=e.pasteConfig)||void 0===t||t.types;(null===(n=e.pasteConfig)||void 0===n?void 0:n.hookPaste)&&(this.hooksByPlugin[e.key]=null===(o=e.pasteConfig)||void 0===o?void 0:o.hookPaste)}},{key:"getTagsConfig",value:function(e){var t,n=this,o=(null===(t=e.pasteConfig)||void 0===t?void 0:t.tags)||[];o.forEach((function(t){Object.prototype.hasOwnProperty.call(n.componentsTags,t)||(n.componentsTags[t.toUpperCase()]={component:e})})),this.tagsByPlugin[e.key]=o.map((function(e){return e.toUpperCase()}))}},{key:"getFilesConfig",value:function(e){var t=(e.pasteConfig||{}).files,n=void 0===t?{}:t,o=n.extensions,i=n.mimeTypes;(o||i)&&(o&&!Array.isArray(o)&&(o=[]),i&&!Array.isArray(i)&&(i=[]),i&&(i=i.filter((function(e){return!!en.p(e)}))),this.componentsFiles[e.key]={extensions:o||[],mimeTypes:i||[]})}},{key:"getPatternsConfig",value:function(e){var t=this;e.pasteConfig&&e.pasteConfig.patterns&&!en.j(e.pasteConfig.patterns)&&Object.entries(e.pasteConfig.patterns).forEach((function(n){var o=Object(Se.a)(n,2),i=o[0],a=o[1];RegExp,t.componentsPatterns.push({key:i,pattern:a,component:e})}))}},{key:"isNativeBehaviour",value:function(e){return on.a.isNativeInput(e)}},{key:"processData",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(t){var n,o,i;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.state.content,o=n.activeBlock&&n.activeBlock.isDefault,i=o&&n.activeBlock.isEmpty,this.insertBlock(t,i);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processFiles",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(t){var n,o,i,a,r,s=this;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.state.content,e.next=3,Promise.all(Array.from(t).map((function(e){return s.processFile(e)})));case 3:i=e.sent,i=null===(n=i)||void 0===n?void 0:n.filter((function(e){return!!e})),a=o.activeBlock.isDefault,r=a&&o.activeBlock.isEmpty,i.forEach((function(e,t){e&&o.paste(e.type,e.event,{},0===t&&r)}));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processFile",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(t){var n,o,i,a,r;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=en.g(t),o=Object.entries(this.componentsFiles).find((function(e){var o=Object(Se.a)(e,2),i=(o[0],o[1]),a=i.mimeTypes,r=i.extensions,s=t.type.split("/"),l=Object(Se.a)(s,2),c=l[0],d=l[1],u=r.find((function(e){return e.toLowerCase()===n.toLowerCase()})),h=a.find((function(e){var t=e.split("/"),n=Object(Se.a)(t,2),o=n[0],i=n[1];return o===c&&(i===d||"*"===i)}));return!!u||!!h}))){e.next=4;break}return e.abrupt("return");case 4:return i=Object(Se.a)(o,1),a=i[0],r=this.composePasteEvent("file",{file:t}),e.abrupt("return",{event:r,type:a});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processHTML",value:function(e){var t=this,n=this.state.sanitizer,o=on.a.make("DIV");o.innerHTML=e;var i=this.getNodes(o);return i.forEach((function(e){on.a.removeNodeStyle(e)})),i.map((function(e){var o,i,a,r=t.blockEditable.defaultBlockComp,s=!1;switch(e.nodeType){case Node.DOCUMENT_FRAGMENT_NODE:(a=on.a.make("div")).appendChild(e);break;case Node.ELEMENT_NODE:a=e,s=!0,t.componentsTags[a.tagName]&&(r=t.componentsTags[a.tagName].component)}var l=((null===(o=r.pasteConfig)||void 0===o?void 0:o.tags)||[]).reduce((function(e,t){return e[t.toLowerCase()]=Cn[t.toLowerCase()]||{},e}),{}),c=Object.assign({},l,n.getInlineToolsConfig(r));a&&(a.closest("table")||(a.innerHTML=n.clean(a.innerHTML,c)));var d=t.composePasteEvent("tag",{data:a});return{content:a,isBlock:s,component:r.key,event:d,common:{quote:!!(null===(i=a)||void 0===i?void 0:i.closest("blockquote"))}}})).filter((function(e){return!on.a.isNodeEmpty(e.content)||on.a.isSingleTag(e.content)}))}},{key:"processPlain",value:function(e){var t=this;if(!e)return[];var n=this.blockEditable.defaultBlockComp;return e.split(/\r?\n/).filter((function(e){return e.trim()})).map((function(e){var o=on.a.make("div");o.textContent=e;var i=t.composePasteEvent("tag",{data:o});return{content:o,component:n.key,isBlock:!1,event:i,common:{quote:!1}}}))}},{key:"processSingleBlock",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(t){var n,o,i,a,r,s,l,c=arguments;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=c.length>1&&void 0!==c[1]&&c[1],a=this.state,r=a.cursor,s=a.content,(l=s.activeBlock)&&t.component===l.component.key&&on.a.containsOnlyInlineElements((null===(n=t.content)||void 0===n?void 0:n.outerHTML)||"")){e.next=6;break}return this.insertBlock(t,i||(null===l||void 0===l?void 0:l.isDefault)&&l.isEmpty),e.abrupt("return");case 6:r.insertContentAtCursorPosition((null===(o=t.content)||void 0===o?void 0:o.innerHTML)||"");case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processInlinePaste",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(t){var o,i,a,r,s,l,c,d,u,h,p,f,v=arguments;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=v.length>1&&void 0!==v[1]&&v[1],i=this.state,a=i.content,r=i.cursor,s=i.sanitizer,l=t.content){e.next=5;break}return e.abrupt("return");case 5:if(c=this.blockEditable.editable,!o){e.next=10;break}return d=a.paste(t.component,t.event,t.common,o),r.setToBlock(d,r.positions.END),e.abrupt("return");case 10:if(!(a.activeBlock&&a.activeBlock.isDefault&&l.textContent&&l.textContent.length<n.PATTERN_PROCESSING_MAX_LENGTH)){e.next=20;break}return e.next=14,this.processPattern(l.textContent);case 14:if(!(u=e.sent)){e.next=20;break}return h=a.activeBlock&&a.activeBlock.isDefault&&a.activeBlock.isEmpty,p=a.paste(u.component,u.event,{},h),r.setToBlock(p,r.positions.END),e.abrupt("return");case 20:a.activeBlock&&a.activeBlock.currentInput?(f=s.getInlineToolsConfig(a.activeBlock.component),c.document.execCommand("insertHTML",!1,s.clean(l.innerHTML,f))):this.insertBlock(t);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processPattern",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(t){var n,o;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.componentsPatterns.find((function(e){var n=e.pattern.exec(t);return!!n&&t===n.shift()}))){e.next=3;break}return e.abrupt("return");case 3:return o=this.composePasteEvent("pattern",{key:n.key,data:t}),e.abrupt("return",{event:o,component:n.component.key});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"insertBlock",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.state,i=o.content,a=o.cursor,r=i.activeBlock;n&&r?(t=i.paste(e.component,e.event,e.common,!0))&&a.setToBlock(t,a.positions.END):(t=i.paste(e.component,e.event,e.common))&&a.setToBlock(t,a.positions.END)}},{key:"insertEditorJSData",value:function(e){var t=this.state,n=t.content,o=t.cursor;t.sanitizer.sanitizeBlocks(e).forEach((function(e,t){var i=e.key,a=e.data,r=e.common,s=!1;0===t&&(s=n.activeBlock&&n.activeBlock.isDefault&&n.activeBlock.isEmpty);var l=n.insert({data:{key:i,data:a,common:r},replace:s});o.setToBlock(l,o.positions.END)}))}},{key:"processElementNode",value:function(e,t,n){var o=Object.keys(this.componentsTags),i=e,a=(this.componentsTags[i.tagName]||{}).component,r=this.tagsByPlugin[null===a||void 0===a?void 0:a.key]||[],s=o.includes(i.tagName),l=on.a.blockElements.includes(i.tagName.toLowerCase()),c=Array.from(i.children).some((function(e){var t=e.tagName;return o.includes(t)&&!r.includes(t)})),d=Array.from(i.children).some((function(e){var t=e.tagName;return on.a.blockElements.includes(t.toLowerCase())}));return l||s||c?s&&!c||l&&!d&&!c?[].concat(Object(p.a)(t),[n,i]):void 0:(n.appendChild(i),[].concat(Object(p.a)(t),[n]))}},{key:"getNodes",value:function(e){var t,n=this;return Array.from(e.childNodes).reduce((function e(o,i){if(on.a.isEmpty(i)&&!on.a.isSingleTag(i))return o;var a=o[o.length-1],r=new DocumentFragment;switch(a&&on.a.isFragment(a)&&(r=o.pop()),i.nodeType){case Node.ELEMENT_NODE:if(t=n.processElementNode(i,o,r))return t;break;case Node.TEXT_NODE:return r.appendChild(i),[].concat(Object(p.a)(o),[r]);default:return[].concat(Object(p.a)(o),[r])}return[].concat(Object(p.a)(o),Object(p.a)(Array.from(i.childNodes).reduce(e,[])))}),[])}},{key:"composePasteEvent",value:function(e,t){return new CustomEvent(e,{detail:t})}}]),n}(nn);_n.PATTERN_PROCESSING_MAX_LENGTH=450;var xn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"prepare",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(){var t=this;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.blockEditable.editable.ready((function(){t.readOnlyMutableListeners.on(document,"copy",(function(e){t.handleCopyEvent(e)})),t.readOnlyMutableListeners.on(document,"cut",(function(e){t.handleCutEvent(e)}))}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleCopyEvent",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(t){var n,o,i,a,r,s,l,c;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t,o=this.state,i=o.blockSelection,a=o.content,r=this.blockEditable.selection,!(s=a.activeBlock)||!s.stretched){e.next=6;break}return e.abrupt("return");case 6:if(!i.anyBlockSelected){e.next=10;break}return e.abrupt("return",i.copySelectedBlocks(n));case 10:if(!a.activeBlock||!a.activeBlock.inputSelection.anyInputSelected){e.next=14;break}return e.abrupt("return",a.activeBlock.inputSelection.copySelectedInputs(n));case 14:(l=r.anchorNode||r.focusNode)&&((c=1===l.nodeType?l:l.parentElement)&&c.closest("[contenteditable]")||t.preventDefault());case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleCutEvent",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(t){var n,o,i,a,r,s,l,c,d,u;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t,o=this.state,i=o.blockSelection,a=o.content,r=o.cursor,s=this.blockEditable.selection,!(l=a.activeBlock)||!l.stretched){e.next=6;break}return e.abrupt("return");case 6:if(!i.anyBlockSelected){e.next=14;break}return e.next=9,i.copySelectedBlocks(n);case 9:void 0!==(c=a.removeSelectedBlocks())&&r.setToBlock(a.insertDefaultBlockAtIndex(c,!0),r.positions.START),i.clearSelection(t),e.next=23;break;case 14:if(!a.activeBlock||!a.activeBlock.inputSelection.anyInputSelected){e.next=20;break}a.activeBlock.inputSelection.copySelectedInputs(n),a.activeBlock.inputSelection.removeSelectedInputs(),r.setToBlock(a.activeBlock),e.next=23;break;case 20:return(d=s.anchorNode||s.focusNode)&&((u=1===d.nodeType?d:d.parentElement)&&u.closest("[contenteditable]")||t.preventDefault()),e.abrupt("return");case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(nn),En=n(842),On=n.n(En),Tn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"show",value:function(e){On.a.show(e)}}]),n}(nn),wn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).markdownKeyDebounce=Object(en.d)(e.markdownKey,100),e}return Object(r.a)(n,[{key:"dblclick",value:function(e){var t=this.state.content,n=un.getFakeInput(e.target),o=t.activeBlock;n&&o&&o.currentInput===n&&o.currentInputFocused&&o.onEditFakeInput(n)}},{key:"mousedown",value:function(e){var t=this.state.content,n=this.blockEditable.selection,o=un.getFakeInput(e.target),i=t.activeBlock;o&&i&&(i.currentInput=o,n.select(o),e.preventDefault())}},{key:"keydown",value:function(e){this.beforeKeydownProcessing(e);var t=at.Enter,n=at.Backspace,o=at.Down,i=at.Right,a=at.Up,r=at.Left,s=at.Tab,l=at.Spacebar;switch(e.keyCode){case t:this.enter(e);break;case n:this.backspace(e);break;case o:case i:this.arrowRightAndDown(e,e.keyCode===o);break;case a:case r:this.arrowLeftAndUp(e,e.keyCode===a);break;case l:if(e.ctrlKey||e.shiftKey||e.metaKey)return;this.convertMarkdown(e);break;case s:this.tabPressed(e)}}},{key:"beforeKeydownProcessing",value:function(e){if(this.needToolbarClosing(e)){var t=this.state,n=t.toolbar,o=t.conversionToolbar,i=t.insertToolbar,a=t.content,r=t.blockSelection;if(en.n(e.keyCode))e.ctrlKey||e.metaKey||e.altKey||e.shiftKey||(n.close(),o.close(),i.close(),a.clearFocused(),r.clearSelection(e))}}},{key:"keyup",value:function(e){switch(e.key){case"*":case"~":case"_":case"`":this.markdownKeyDebounce()}e.shiftKey||this.state.ui.checkEmptiness()}},{key:"tabPressed",value:function(e){this.state.blockSelection.clearSelection(e);var t=this.state,n=t.content,o=t.inlineToolbar,i=t.conversionToolbar,a=(t.toolbox,this.blockEditable.selection),r=n.activeBlock;if(r){var s=r.isDefault&&r.isEmpty,l=!r.isEmpty&&i.opened,c=!r.isEmpty&&!a.isCollapsed&&o.opened;s?this.activateToolbox():l||c||this.activateBlockSettings()}}},{key:"convertMarkdown",value:function(e){this.state.blockSelection.clearSelection(e);var t=this.state,n=t.content,o=t.toolbox,i=t.toolbar,a=n.activeBlock;if(!a||!a.isDefault)return 0;var r=(a.save().data.content||"").replace(/<strong[^>]*>(.*?)<\/strong[^>]*>/g,"**$1**").replace(/<em[^>]*>(.*?)<\/em[^>]*>/g,"*$1*").replace(/<u[^>]*>(.*?)<\/u[^>]*>/g,"__$1__").replace(/<del[^>]*>(.*?)<\/del[^>]*>/g,"~~$1~~").trim(),s=o.matchCommand(r);return s?(i.close(),i.plusButton.hide(),this.activateToolbox(s),e.stopPropagation(),e.preventDefault(),Object.keys(s).length):0}},{key:"dragOver",value:function(e){var t=this.state.content.getBlock(e.target);t&&(t.dropTarget=!0)}},{key:"dragLeave",value:function(e){var t=this.state.content.getBlock(e.target);t&&(t.dropTarget=!1)}},{key:"handleCommandC",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(t){var n;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=this.state.blockSelection).anyBlockSelected){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",n.copySelectedBlocks(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleCommandX",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(t){var n,o,i,a,r;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.state,o=n.blockSelection,i=n.content,a=n.cursor,o.anyBlockSelected){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,o.copySelectedBlocks(t);case 5:void 0!==(r=i.removeSelectedBlocks())&&a.setToBlock(i.insertDefaultBlockAtIndex(r,!0),a.positions.START),o.clearSelection(t);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"markdownKey",value:function(){var e=this.state,t=e.content,n=(e.toolbox,e.toolbar,this.blockEditable.selection),o=t.activeBlock;if(o&&o.currentInput&&!un.isFakeInput(o.currentInput)&&n.anchorNode){var i=o.currentInput,a=n.getRangeAt(0);a.enlargeBoundarySuitably();var r=a.createBookmark("".concat(Date.now())),s=(i.innerHTML||"").replace(/<strong[^>]*>(.*?)<\/strong[^>]*>/g,"**$1**").replace(/<em[^>]*>(.*?)<\/em[^>]*>/g,"*$1*").replace(/<u[^>]*>(.*?)<\/u[^>]*>/g,"__$1__").replace(/<del[^>]*>(.*?)<\/del[^>]*>/g,"~~$1~~"),l=this.blockEditable.utils.makeHtml(s)||"";l=l.replace(/<p[^>]*>(.*?)<\/p[^>]*>/g,"$1"),i.innerHTML=l,a.moveToBookmark(r).enlargeBoundarySuitably().select(!1)}}},{key:"enter",value:function(e){var t=this.state,n=t.content,o=t.ui,i=t.cursor,a=n.activeBlock;if(a&&(!o.someToolbarOpened||!o.someFlipperButtonFocused)&&!e.shiftKey){if(e.ctrlKey||e.metaKey){var r=a.currentInput;if(r&&un.isFakeInput(r)&&r instanceof HTMLElement&&a.onEditFakeInput(r))return e.stopPropagation(),void e.preventDefault()}if(!a.component.isLineBreaksEnabled){if(i.isAtEnd){var s=this.convertMarkdown(e);if(s>0&&(!(a=n.activeBlock)||s>1||!a.isDefault&&a.isEmpty||a.component.isLineBreaksEnabled||un.isFakeInput(a.currentInput)))return}var l=a;if(!i.isAtStart||!un.isFakeInput(a.currentInput)&&a.hasMedia)l=n.split();else{var c=n.activeBlockIndex,d=c+(i.isAtEnd?1:0);l=n.insertDefaultBlockAtIndex(d),c===d&&(l=a)}l&&(i.setToBlock(l),l.isDefault&&l.isEmpty&&(this.state.toolbar.open(!1),this.state.toolbar.plusButton.show()),e.preventDefault())}}}},{key:"backspace",value:function(e){var t=this.state,n=t.content,o=t.blockSelection,i=t.cursor,a=this.blockEditable.selection,r=n.activeBlock,s=r.component;if(r.canBackspaceRemove()){e.preventDefault();var l=n.activeBlockIndex;return n.previousBlock&&0===n.previousBlock.inputs.length?n.removeBlock(l-1):n.removeBlock(),i.setToBlock(n.activeBlock,l?i.positions.END:i.positions.START),this.state.toolbar.close(),void o.clearSelection(e)}if(!s.isLineBreaksEnabled||i.isAtStart){var c=0===n.activeBlockIndex;i.isAtStart&&a.isCollapsed&&r.currentInput===r.firstInput&&!c&&(e.preventDefault(),this.mergeBlocks())}}},{key:"mergeBlocks",value:function(){var e=this.state,t=e.content,n=e.cursor,o=e.toolbar,i=t.previousBlock,a=t.activeBlock;if(i)return a.component.key===i.component.key&&i.mergeable?void(i.lastInput&&(n.createShadow(i.lastInput),t.mergeBlocks(i,a).then((function(){i.componentContent&&(n.restoreCursor(i.componentContent),i.componentContent.normalize()),o.close()})))):0===i.inputs.length||i.isEmpty?(t.removeBlock(t.activeBlockIndex-1),n.setToBlock(t.activeBlock),void o.close()):void(n.navigatePrevious()&&o.close())}},{key:"arrowRightAndDown",value:function(e,t){var n=this.state,o=n.content,i=n.cursor,a=n.toolbar,r=n.ui,s=n.blockSelection,l=n.crossSelection,c=pn.usedKeys.includes(e.keyCode)&&(!e.shiftKey||e.keyCode===en.q.TAB);if(!r.someToolbarOpened||!c){o.clearFocused(),a.close();var d=t&&i.isAtEnd||i.isAtBottom||s.anyBlockSelected;if(e.shiftKey&&e.keyCode===en.q.DOWN&&d)l.toggleBlockSelectedState();else(e.keyCode===en.q.DOWN||e.keyCode===en.q.RIGHT&&!this.isRtl?i.navigateNext(e.keyCode===en.q.DOWN):i.navigatePrevious())?e.preventDefault():en.e((function(){o.activeBlock?(o.activeBlock.updateCurrentInput(),o.highlightCurrentNode()):i.setToTheLastBlock()}),20)(),s.clearSelection(e)}}},{key:"arrowLeftAndUp",value:function(e,t){var n=this.state,o=n.content,i=n.cursor,a=n.toolbar,r=n.ui,s=n.blockSelection,l=n.crossSelection,c=(n.inlineToolbar,t&&i.isAtTop||i.isAtStart||s.anyBlockSelected);if(r.someToolbarOpened){if(pn.usedKeys.includes(e.keyCode)&&(!e.shiftKey||e.keyCode===en.q.TAB))return;if(!c&&e.shiftKey&&e.keyCode>=en.q.LEFT&&e.keyCode<=en.q.DOWN)return;r.closeAllToolbars()}(o.clearFocused(),a.close(),e.shiftKey&&e.keyCode===en.q.UP&&c)?l.toggleBlockSelectedState(!1):((e.keyCode===en.q.UP||e.keyCode===en.q.LEFT&&!this.isRtl?i.navigatePrevious(e.keyCode===en.q.UP):i.navigateNext())?e.preventDefault():en.e((function(){o.activeBlock?(o.activeBlock.updateCurrentInput(),o.highlightCurrentNode()):i.setToTheLastBlock()}),20)(),s.clearSelection(e))}},{key:"needToolbarClosing",value:function(e){var t=e.keyCode===en.q.ENTER&&this.state.toolbox.opened,n=e.keyCode===en.q.ENTER&&this.state.blockSettings.opened,o=e.keyCode===en.q.ENTER&&this.state.inlineToolbar.opened,i=e.keyCode===en.q.ENTER&&this.state.conversionToolbar.opened,a=e.keyCode===en.q.TAB;return!(e.shiftKey&&!en.n(e.keyCode)||a||t||n||o||i)}},{key:"activateToolbox",value:function(e){this.state.toolbar.opened||(this.state.toolbar.open(!1,!1),!e&&this.state.toolbar.plusButton.show()),this.state.toolbar.adjustToolbox(),this.state.toolbox.open(e)}},{key:"activateBlockSettings",value:function(){this.state.toolbar.opened||(this.state.content.activeBlock.focused=!0,this.state.toolbar.open(!0,!1),this.state.toolbar.plusButton.hide()),this.state.blockSettings.opened||this.state.blockSettings.open()}}]),n}(nn),Sn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).isStartedAtEditor=!1,e}return Object(r.a)(n,[{key:"toggleReadOnly",value:function(e){e?this.disableModuleBindings():this.enableModuleBindings()}},{key:"enableModuleBindings",value:function(){var e=this,t=this.state.ui;this.readOnlyMutableListeners.on(t.nodes.wrapper,"drop",function(){var t=Object(Ne.a)(Be.a.mark((function t(n){return Be.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.processDrop(n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),!0),this.readOnlyMutableListeners.on(t.nodes.wrapper,"dragstart",(function(){e.processDragStart()})),this.readOnlyMutableListeners.on(t.nodes.wrapper,"dragover",(function(t){e.processDragOver(t)}),!0)}},{key:"disableModuleBindings",value:function(){this.readOnlyMutableListeners.clearAll()}},{key:"processDrop",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(t){var n,o,i,a,r,s,l,c;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.state,o=n.content,i=n.cursor,a=n.paste,r=n.ui,s=this.blockEditable.selection,t.preventDefault(),l=o.dropTargetBlock,o.blocks.forEach((function(e){e.dropTarget=!1})),r.isAtEditor&&!s.isCollapsed&&this.isStartedAtEditor&&document.execCommand("delete"),this.isStartedAtEditor=!1,l?i.setToBlock(l,i.positions.END):(c=o.setActiveBlockBy(o.lastBlock.holder))&&i.setToBlock(c,i.positions.END),e.next=10,a.processDataTransfer(t.dataTransfer,!0);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processDragStart",value:function(){var e=this.blockEditable.selection;this.state.ui.isAtEditor&&!e.isCollapsed&&(this.isStartedAtEditor=!0),this.state.inlineToolbar.close()}},{key:"processDragOver",value:function(e){e.preventDefault()}}]),n}(nn),jn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"setToBlock",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.positions.DEFAULT,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(e){var o,i=this.state.content;switch(t){case this.positions.START:o=e.firstInput;break;case this.positions.END:o=e.lastInput;break;default:o=e.currentInput}if(o){var a=on.a.getDeepestNode(o,t===this.positions.END||-1===n),r=on.a.getContentLength(a);switch(!0){case t===this.positions.START:-1===n&&(n=r);break;case t===this.positions.END:case-1===n:case n>r:n=r}this.set(a,n),i.setActiveBlockBy(e.holder),i.activeBlock.currentInput=o}}}},{key:"setToInput",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.positions.DEFAULT,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=this.state.content.activeBlock,i=on.a.getDeepestNode(e);switch(t){case this.positions.START:this.set(i,0);break;case this.positions.END:this.set(i,on.a.getContentLength(i));break;default:n&&this.set(i,n)}o.currentInput=e,this.state.content.highlightCurrentNode()}},{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.blockEditable.editable.selection,o=un.getFakeInput(e);o?n.select(o):n.setCursor(e,t),this.scrollToView()}},{key:"scrollToView",value:function(){var e=this.blockEditable.editable.selection,t=this.state.ui,n=e.rangeRect;if(n&&t.nodes.scroller){var o=t.nodes.scroller.getBoundingClientRect(),i=n.top,a=n.bottom;0===i&&0===a||(i<o.top&&t.nodes.scroller.scrollBy(0,i-o.top),a>o.bottom&&t.nodes.scroller.scrollBy(0,a-o.bottom+20))}}},{key:"setToTheLastBlock",value:function(){var e=this.state.content.lastBlock;if(e)if(e.isDefault&&e.isEmpty)this.setToBlock(e);else{var t=this.state.content.insertAtEnd();t&&this.setToBlock(t)}}},{key:"extractFragmentFromCursorPosition",value:function(){var e=this.blockEditable.editable,t=e.selection,n=e.document;if(t.rangeCount){var o=t.getRangeAt(0),i=this.state.content.activeBlock.currentInput;if(o.deleteContents(),i){if(on.a.isNativeInput(i)){var a=i,r=n.createDocumentFragment(),s=a.value.substring(0,a.selectionStart||0),l=a.value.substring(a.selectionStart||0);return r.textContent=l,a.value=s,r}var c=o.cloneRange();return c.selectNodeContents(i),c.setStart(o.endContainer,o.endOffset),c.extractContents()}}}},{key:"navigateNext",value:function(e){var t=this.state.content,n=t.activeBlock,o=t.nextContentfulBlock;if(!n)return!1;var i=e?n.downInput:n.rightInput,a=this.isAtEnd,r=o;if(!r&&!i){if(n.isDefault||!a)return!1;if(r=t.insertAtEnd())return this.setToBlock(r,this.positions.START),!0}return!!(e?this.isAtBottom:this.isAtEnd)&&(i?this.setToInput(i,this.positions.START):r&&this.setToBlock(r,this.positions.START),!0)}},{key:"navigatePrevious",value:function(e){var t=this.state.content,n=t.activeBlock,o=t.previousContentfulBlock;if(!n)return!1;var i=e?n.upInput:n.leftInput;return!(!o&&!i)&&(!!(e?this.isAtTop:this.isAtStart)&&(i?this.setToInput(i,this.positions.END):o&&this.setToBlock(o,this.positions.END),!0))}},{key:"createShadow",value:function(e){var t=document.createElement("span");t.classList.add(n.Class.shadowCursor),e.insertAdjacentElement("beforeend",t)}},{key:"restoreCursor",value:function(e){var t=e.querySelector(".".concat(n.Class.shadowCursor));if(t){var o=this.blockEditable.selection;setTimeout((function(){o.getRangeAt(0).setStartAfter(t).setCursor(!1,!0),t.remove()}),50)}}},{key:"insertContentAtCursorPosition",value:function(e){var t,n=this.blockEditable.editable,o=n.selection,i=n.document,a=i.createDocumentFragment(),r=i.createElement("div"),s=o.getRangeAt(0);r.innerHTML=e,Array.from(r.childNodes).forEach((function(e){return a.appendChild(e)})),0===a.childNodes.length&&a.appendChild(new Text(""));var l=a.lastChild;s.deleteContents(),s.insertNode(a),s.setStart(l,(null===l||void 0===l||null===(t=l.textContent)||void 0===t?void 0:t.length)||0).collapse(!0).setCursor()}},{key:"getHigherLevelSiblings",value:function(e,t){for(var n=e,o=[];n.parentNode&&"true"!==n.parentNode.contentEditable;)n=n.parentNode;for(var i="left"===t?"previousSibling":"nextSibling";n[i];)n=n[i],o.push(n);return o}},{key:"positions",get:function(){return{START:"start",END:"end",DEFAULT:"default"}}},{key:"isAtStart",get:function(){var e=this.blockEditable.editable.selection,t=this.state.content.activeBlock&&this.state.content.activeBlock.currentInput?on.a.getDeepestNode(this.state.content.activeBlock.currentInput):null,n=e.focusNode;if(un.isFakeInput(t))return!0;if(on.a.isNativeInput(t))return 0===t.selectionEnd;if(!e.anchorNode)return!1;var o=n&&n.textContent?n.textContent.search(/\S/):0;-1===o&&(o=0);var i=e.focusOffset||0;if((n&&n.nodeType!==Node.TEXT_NODE&&n.childNodes.length&&(n.childNodes[i]?(n=n.childNodes[i],i=0):i=(n=n.childNodes[i-1]).textContent?n.textContent.length:0),t&&(on.a.isLineBreakTag(t)||on.a.isEmpty(t)))&&(this.getHigherLevelSiblings(n,"left").every((function(e){var t=on.a.isLineBreakTag(e),n=e.children&&1===e.children.length&&on.a.isLineBreakTag(e.children[0]),o=t||n;return on.a.isEmpty(e)&&!o}))&&i===o))return!0;return null===t||n===t&&i<=o}},{key:"isAtEnd",get:function(){var e=this.blockEditable.editable.selection,t=e.focusNode,n=this.state.content.activeBlock&&this.state.content.activeBlock.currentInput?on.a.getDeepestNode(this.state.content.activeBlock.currentInput,!0):null;if(un.isFakeInput(n))return!0;if(on.a.isNativeInput(n))return n.selectionEnd===n.value.length;if(!e.focusNode)return!1;var o=e.focusOffset||0;if(t&&t.nodeType!==Node.TEXT_NODE&&t.childNodes.length&&(t.childNodes[o-1]?o=(t=t.childNodes[o-1]).textContent?t.textContent.length:0:(t=t.childNodes[0],o=0)),n&&(on.a.isLineBreakTag(n)||on.a.isEmpty(n))){var i=this.getHigherLevelSiblings(t,"right");if(i.every((function(e,t){return t===i.length-1&&on.a.isLineBreakTag(e)||on.a.isEmpty(e)&&!on.a.isLineBreakTag(e)}))&&o===(t&&t.textContent?t.textContent.length:0))return!0}var a=n&&n.textContent?n.textContent.replace(/\s+$/,""):"";return t===n&&o>=a.length}},{key:"isAtTop",get:function(){var e=this.blockEditable.editable.selection,t=this.state.content.activeBlock&&this.state.content.activeBlock.currentInput;if(!t)return!1;if(un.isFakeInput(t))return!0;var n,o=e.rangeRect,i=o.top+o.height/2;if(un.isLinesInput(t))return t.children.length<=1||i<(null===(n=t.firstChild)||void 0===n?void 0:n.nextSibling).getBoundingClientRect().y;var a=t.getBoundingClientRect(),r=window.getComputedStyle(t),s=parseFloat(r.paddingTop)||0,l=parseFloat(r.lineHeight)||0,c=i-a.top-s;return Math.ceil(c/l)<=1}},{key:"isAtBottom",get:function(){var e=this.blockEditable.editable.selection,t=this.state.content.activeBlock&&this.state.content.activeBlock.currentInput;if(!t)return!1;if(un.isFakeInput(t))return!0;var n=e.rangeRect,o=n.top+n.height/2;if(un.isLinesInput(t))return t.children.length<=1||o>t.lastChild.getBoundingClientRect().y;var i=t.getBoundingClientRect(),a=window.getComputedStyle(t),r=parseFloat(a.paddingTop)||0,s=parseFloat(a.paddingBottom)||0,l=parseFloat(a.lineHeight)||0,c=Math.round((i.height-r-s)/l),d=o-i.top-r;return Math.ceil(d/l)>=c}}],[{key:"Class",get:function(){return{shadowCursor:"beui-shadow-cursor"}}}]),n}(nn),Bn=n(563),Nn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,{blockEditable:e.blockEditable}))._datas=void 0,o._blocks=[],o._activeBlockIndex=-1,o._basic={title:"",cover:"",summary:""},o._datas=e.datas?e.datas.filter((function(e){return!!e.key})):[e.blockEditable.defaultBlockCompInitData],o.hookEditable(),0===o._datas.length&&o._datas.push(o.blockEditable.defaultBlockCompInitData),o}return Object(r.a)(n,[{key:"getBlockByIndex",value:function(e){if(e>=0&&e<this._blocks.length)return this._blocks[e]}},{key:"getBlock",value:function(e){if(e){on.a.isElement(e)||(e=e.parentNode);var t=e.closest(".".concat(un.Class.block));return this._blocks.find((function(e){return e.holder===t}))}}},{key:"setActiveBlockBy",value:function(e){if(e){on.a.isElement(e)||(e=e.parentNode);var t=e.closest(".".concat(un.Class.block));if(t){var n=t.closest(".".concat(mn.Class.editorZoneContent));if(null===n||void 0===n?void 0:n.isEqualNode(this.state.ui.nodes.content))return this.activeBlockIndex=this.blockNodes.indexOf(t),this.activeBlock.updateCurrentInput(),this.highlightCurrentNode(),this.activeBlock}}}},{key:"compose",value:function(){var e=this,t=this.holder;if(t){t.removeAttribute("contenteditable");var n=[],o=document.createDocumentFragment();this._datas.forEach((function(t){var i=e.composeBlock(t);n.push(i),o.appendChild(i.holder)})),t.innerHTML="",t.appendChild(o),this._blocks=n,n.forEach((function(e){e.onRendered()}))}}},{key:"insert",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,n=void 0===t?this.blockEditable.defaultBlockCompInitData:t,o=e.index,i=e.needToFocus,a=void 0===i||i,r=e.replace,s=void 0!==r&&r;if(!this.holder)return null;var l=o;void 0===l&&(l=this.activeBlockIndex+(s?0:1)),l>this._blocks.length&&(l=this._blocks.length);var c=this.composeBlock(n);if(!this._blocks.length||l>=this._blocks.length)this._blocks.push(c),this.insertToDOM(c);else{if(s){var d=this._blocks[l];d.holder.remove(),d.onRemoved(),this._blocks.splice(l,1,c)}else this._blocks.splice(l,0,c);if(l>0){var u=this._blocks[l-1];this.insertToDOM(c,"afterend",u)}else{var h=this._blocks[l+1];h?this.insertToDOM(c,"beforebegin",h):this.insertToDOM(c)}}return a?this.activeBlockIndex=l:l<=this._activeBlockIndex&&this.activeBlockIndex++,c}},{key:"insertDefaultBlockAtIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.insert({index:e,needToFocus:t});return n}},{key:"replace",value:function(e){var t=e.data,n=void 0===t?this.blockEditable.defaultBlockCompInitData:t;return this.insert({data:n,index:this.activeBlockIndex,replace:!0})}},{key:"paste",value:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.insert({data:{key:e,data:le.a.component(e).defaultData,common:n},replace:o});try{i&&i.onPaste(t)}catch(a){}return i}},{key:"insertAtEnd",value:function(){return this.activeBlockIndex=this.blocks.length-1,this.insert()}},{key:"removeSelectedBlocks",value:function(){for(var e,t=this._blocks.length-1;t>=0;t--)this._blocks[t].selected&&(this.removeBlock(t),e=t);var n=this.state,o=n.toolbar,i=n.conversionToolbar;return o.close(),i.close(),e}},{key:"removeBlock",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeBlockIndex;if(!this.validateIndex(e))throw new Error("Can't find a Block to remove");this._blocks[e].holder.remove(),this._blocks[e].onRemoved(),this._blocks.splice(e,1),this._activeBlockIndex>=e&&this._activeBlockIndex--,this._blocks.length?0===e&&(this.activeBlockIndex=0):(this.activeBlockIndex=-1,this.insert())}},{key:"clearFocused",value:function(){this._blocks.forEach((function(e){e.focused=!1}))}},{key:"move",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeBlockIndex;if(!isNaN(e)&&!isNaN(t)&&this.validateIndex(e)&&this.validateIndex(t)){var n=this._blocks.splice(t,1)[0],o=e-1,i=Math.max(0,o),a=this._blocks[i];e>0?this.insertToDOM(n,"afterend",a):this.insertToDOM(n,"beforebegin",a),this._blocks.splice(e,0,n),n.onMoved(),this.activeBlockIndex=e}}},{key:"delete",value:function(e){try{this.removeBlock(e)}catch(t){return}0===this._blocks.length&&this.insert(),this.activeBlock&&this.state.cursor.setToBlock(this.activeBlock,this.state.cursor.positions.END),this.state.toolbar.close()}},{key:"split",value:function(){var e=this.state.cursor.extractFragmentFromCursorPosition(),t=on.a.make("div");e&&t.appendChild(e);var n=this.blockEditable.defaultBlockComp.toData(on.a.isEmpty(t)?"":t.innerHTML);return this.insert({data:{key:this.blockEditable.defaultBlockComp.key,data:n}})}},{key:"highlightCurrentNode",value:function(){this.clearFocused(),this.activeBlock&&(this.activeBlock.focused=!0)}},{key:"mergeBlocks",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(t,n){var o,i;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this._blocks.indexOf(n),!n.isEmpty){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,n.data;case 5:if(i=e.sent,en.j(i)){e.next=9;break}return e.next=9,t.mergeWith(i);case 9:this.removeBlock(o),this.activeBlockIndex=this._blocks.indexOf(t);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"dropPointer",value:function(){this.activeBlockIndex=-1,this.clearFocused()}},{key:"stretchBlock",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getBlockByIndex(e);n&&(this.clearFocused(),n.stretched=t)}},{key:"getContentHTML",value:function(e,t){var n=this.state.blockSelection,o={clearEmpty:ce.d,inlineContent:ce.h,type:e},i=(t?n.selectedBlocks:this.blocks).reduce((function(e,t){var n=t.save(),i=t.component.toHtml(n.data,o);t.quoted&&(i="<blockquote>".concat(i,"</blockquote>"));var a=t.align,r=a?'style="text-align: '.concat(a,'"'):"";return e+'<section class="'.concat(un.Class.block," ").concat(un.Class.block,"--").concat(t.component.key,'" data-editor="\u6781\u5ba2\u7f16\u8f91\u5668" data-key="').concat(t.componentInstance.key||"",'"><span class="').concat(un.Class.prefix,'"></span><section class="').concat(un.Class.content,'" ').concat(r,">").concat(i,'</section><span class="').concat(un.Class.subfix,'"></span></section>')}),"");Object.entries(le.c.tools).forEach((function(e){var t=Object(Se.a)(e,2)[1];t.checkHTML&&(i=t.checkHTML(i,o))}));var a=this.blockEditable.editable.$dom;return i=i.replace(a.fillCharReg,""),'<section class="'.concat(mn.Class.editorContent,'" data-editor="\u6781\u5ba2\u7f16\u8f91\u5668">').concat(i,"</section>")}},{key:"getContentMarkdown",value:function(e){var t=this.state.blockSelection,n=e?t.selectedBlocks:this.blocks,o=this.blockEditable.utils.makeMarkdown,i=n.reduce((function(e,t){var n,i=t.save().data;return e+(t.component.toMarkdown?function(e){return/\\n\\n$/.test(e)?e:/\\n$/.test(e)?"".concat(e,"\n"):"".concat(e,"\n\n")}((n=t.component.toMarkdown(i,o),t.quoted?n.split("\n").map((function(e){return"> "+e})).join("\n"):n)):o(function(e,t){return t?"<blockquote>".concat(e,"</blockquote>"):e}(t.component.toHtml(i,{clearEmpty:ce.d,inlineContent:ce.h}),t.quoted)))}),"");Object.entries(le.c.tools).forEach((function(e){var t=Object(Se.a)(e,2)[1];t.checkMarkdown&&(i=t.checkMarkdown(i))}));var a=this.blockEditable.editable.$dom;return i=(i=i.replace(a.fillCharReg,"")).replace(/<!--\s-->\n/g,"")}},{key:"getContentText",value:function(e){var t=this.blockEditable.editable,n=t.$dom,o=t.document,i=this.getContentHTML(void 0,e),a=o.createElement("div");return a.innerHTML=i,(a.textContent||a.innerText).replace(n.fillCharReg,"").replace(/\u00a0/g," ")}},{key:"getWordCount",value:function(e){var t=this.getContentText(e).match(/[a-zA-Z0-9_\u0392-\u03c9]+|[\u4E00-\u9FFF\u3400-\u4dbf\uf900-\ufaff\u3040-\u309f\uac00-\ud7af]+/g),n=0;if(null==t)return n;for(var o=0;o<t.length;o++)t[o].charCodeAt(0)>=19968?n+=t[o].length:n+=1;return n}},{key:"hookEditable",value:function(){var e=this,t=this.blockEditable.editable;this.updateActiveBlock=this.updateActiveBlock.bind(this),t.getContent=function(n){var o=e.blocks;try{var i=o.map((function(e){return e.save()})),a=i;if(n)a=e.state.sanitizer.sanitizeBlocks(i);return JSON.stringify({content:a,typeset:t.queryCommandValue("typeset")||"default",layout:t.queryCommandValue("layout")||"web",basic:e._basic})}catch(r){}return""},t.setContent=function(n,o){var i=e.state.ui,a=i.nodes.scroller.scrollTop;t.on("selectionchange",e.updateActiveBlock);try{var r=JSON.parse(n),s=r.content||[];if(o)s=e.state.sanitizer.sanitizeBlocks(s);var l=s,c=r.typeset||"default",d=r.layout||"web",u=r.basic||{};e._basic.title=u.title||"",e._basic.cover=u.cover||"",e._basic.summary=u.summary||"",e.blockEditable.setTypeset(c),e.state.ui.layout=d,e.datas=l}catch(h){e.blockEditable.setTypeset("default"),e.state.ui.layout="web",e.datas=e._datas}e.setDefaultCursor(),setTimeout((function(){t.off("selectionchange",e.updateActiveBlock)}),100),t.trigger("aftersetcontent"),i.nodes.scroller.scrollTop=a},t.getScene=function(t){var n=e.blocks;try{var o=n.map((function(e){return e.save()})),i=o;if(t)i=e.state.sanitizer.sanitizeBlocks(o);return JSON.stringify({content:i})}catch(a){}return""},t.setScene=function(n,o){var i=e.state.ui,a=i.nodes.scroller.scrollTop;t.on("selectionchange",e.updateActiveBlock);try{var r=JSON.parse(n).content||[];if(o)r=e.state.sanitizer.sanitizeBlocks(r);var s=r;e.datas=s}catch(l){e.datas=e._datas}e.setDefaultCursor(),setTimeout((function(){t.off("selectionchange",e.updateActiveBlock)}),100),i.nodes.scroller.scrollTop=a},t.clear=function(){e.datas=[]},t.catalog.insertAfter=function(t,n){var o=t.el||e.blockEditable.editable.document.createElement("h".concat(t.level));o.innerText=t.title;var i=Bn.default.toData(o.outerHTML);if(n.el){var a=e._blocks.findIndex((function(e){var t;return e.componentContent&&e.componentContent.dataset.id===(null===(t=n.el)||void 0===t?void 0:t.dataset.id)}));if(-1!==a){var r=e.insert({data:{key:Bn.default.key,data:i},index:a+1});r&&r.componentContent&&(t.el=r.componentContent)}}else{var s=e.insert({data:{key:Bn.default.key,data:i},index:0});s&&s.componentContent&&(t.el=s.componentContent)}return t},t.catalog.insertBefore=function(t,n){if(n.el){var o=e._blocks.findIndex((function(e){var t;return e.componentContent&&e.componentContent.dataset.id===(null===(t=n.el)||void 0===t?void 0:t.dataset.id)}));if(-1!==o){var i=t.el||e.blockEditable.editable.document.createElement("h".concat(t.level));i.innerText=t.title;var a=Bn.default.toData(i.outerHTML),r=e.insert({data:{key:Bn.default.key,data:a},index:o});r&&r.componentContent&&(t.el=r.componentContent)}}return t},t.catalog.append=function(t){var n=t.el||e.blockEditable.editable.document.createElement("h".concat(t.level));n.innerText=t.title;var o=Bn.default.toData(n.outerHTML),i=e.insert({data:{key:Bn.default.key,data:o},index:e._blocks.length});return i&&i.componentContent&&(t.el=i.componentContent),t},t.on("actived",(function(){e.updateActiveBlock()}))}},{key:"updateActiveBlock",value:function(){var e=this.blockEditable.selection,t=(this.state.cursor,e.focusNode||e.anchorNode);t&&(this.setActiveBlockBy(t),this.state.toolbar.move())}},{key:"bindBlockEvents",value:function(e){var t=this.state.events;this.readOnlyMutableListeners.on(e.holder,"keydown",(function(e){t.keydown(e)})),this.readOnlyMutableListeners.on(e.holder,"keyup",(function(e){t.keyup(e)})),this.readOnlyMutableListeners.on(e.holder,"dragover",(function(e){t.dragOver(e)})),this.readOnlyMutableListeners.on(e.holder,"dragleave",(function(e){t.dragLeave(e)})),this.readOnlyMutableListeners.on(e.holder,"mousedown",(function(e){t.mousedown(e)})),this.readOnlyMutableListeners.on(e.holder,"dblclick",(function(e){t.dblclick(e)}))}},{key:"validateIndex",value:function(e){return!(e<0||e>=this._blocks.length)}},{key:"composeBlock",value:function(e){var t=new un({data:e,blockEditable:this.blockEditable});return this.bindBlockEvents(t),t}},{key:"insertToDOM",value:function(e,t,n){t&&n?n.holder.insertAdjacentElement(t,e.holder):this.holder.appendChild(e.holder),e.onRendered()}},{key:"setDefaultCursor",value:function(){var e=this.state.cursor;this._blocks.length&&(e.setToBlock(this._blocks[0],e.positions.START),this.highlightCurrentNode())}},{key:"basic",get:function(){return this._basic},set:function(e){this._basic.title=e.title,this._basic.cover=e.cover,this._basic.summary=e.summary}},{key:"blocks",get:function(){return this._blocks}},{key:"blockNodes",get:function(){return en.a(this.holder.children)}},{key:"activeBlock",get:function(){return this._blocks[this._activeBlockIndex]}},{key:"activeBlockIndex",get:function(){return this._activeBlockIndex},set:function(e){this._blocks[this._activeBlockIndex]&&this._blocks[this._activeBlockIndex].willUnselect(),this._blocks[e]&&this._blocks[e].willSelect(),this._activeBlockIndex=e}},{key:"isEmpty",get:function(){return 0===this._blocks.length}},{key:"holder",get:function(){return this.blockEditable.editable.holder}},{key:"firstBlock",get:function(){return this._blocks[0]}},{key:"lastBlock",get:function(){return this._blocks[this._blocks.length-1]}},{key:"nextBlock",get:function(){if(!(this._activeBlockIndex===this._blocks.length-1))return this._blocks[this._activeBlockIndex+1]}},{key:"nextContentfulBlock",get:function(){return this.blocks.slice(this._activeBlockIndex+1).find((function(e){return!!e.inputs.length}))}},{key:"previousContentfulBlock",get:function(){return this.blocks.slice(0,this._activeBlockIndex).reverse().find((function(e){return!!e.inputs.length}))}},{key:"previousBlock",get:function(){if(!(0===this._activeBlockIndex))return this._blocks[this._activeBlockIndex-1]}},{key:"dropTargetBlock",get:function(){return this.blocks.find((function(e){return e.dropTarget}))}},{key:"datas",set:function(e){e&&0!==e.length||(e=[this.blockEditable.defaultBlockCompInitData]),this._datas=e.map((function(e){var t=le.a.component(e.key);if(!t)return e;var n=!t.validData||t.validData(e.data);return n?"boolean"===typeof n?e:Object(W.a)(Object(W.a)({},e),{},{data:n}):{key:"",data:{}}})).filter((function(e){return!!e.key})),this.compose()}}]),n}(nn),Ln=n(179),In=n(14),An=n.n(In),Rn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).opened=!1,e._displayedToolsCount=0,e._flipper=void 0,e._cacheTools={},e}return Object(r.a)(n,[{key:"make",value:function(){this.nodes.toolbox=on.a.make("div",n.Class.toolbox),this.addPluginToolboxes(),this.enableFlipper()}},{key:"destroy",value:function(){this._flipper&&(this._flipper.deactivate(),this._flipper=null),this.removeAllNodes(),this.removeAllShortcuts()}},{key:"toolButtonActivate",value:function(e,t){this.insertNewBlock(t)}},{key:"matchCommand",value:function(e){var t=this,n=le.a.components,o={},i=new An.a.Converter,a=i.makeHtml.bind(i);if(Array.from(Object.values(n)).forEach((function(n){if(n.key!==t.blockEditable.defaultBlockComp.key){var i=(n.toolbox.commands||[]).find((function(t){return t.regex.test(e)}));i&&(o[n.key]=i.data?i.data(e,a):void 0)}})),0===Object.keys(o).length){var r=this.blockEditable.defaultBlockComp,s=(r.toolbox.commands||[]).find((function(t){return t.regex.test(e)}));s&&(o[r.key]=s.data?s.data(e,a):void 0)}return Object.keys(o).length?o:void 0}},{key:"open",value:function(e){if(!this.isEmpty&&!this.opened){this.state.ui.nodes.wrapper.classList.add(n.Class.openedToolbarHolderModifier),this._cacheTools=e||{};var t=Object.keys(this._cacheTools);if(t.length&&e){if(1===t.length)return void this.insertNewBlock(t[0]);this.nodes.buttons.forEach((function(t){var n=le.a.component(t.dataset.key||"");if(t.dataset.key&&e.hasOwnProperty(t.dataset.key)){t.style.display="";var o=e[t.dataset.key],i=(null===o||void 0===o?void 0:o.icon)||n.toolbox.icon;i&&(t.innerHTML=i)}else t.style.display="none"}))}else this.nodes.buttons.forEach((function(e){e.style.display="";var t=le.a.component(e.dataset.key||"");t&&(e.innerHTML=t.toolbox.icon)}));this.nodes.toolbox.classList.add(n.Class.toolboxOpened),this.opened=!0,this.activeFlipper()}}},{key:"close",value:function(){this.nodes.toolbox.classList.remove(n.Class.toolboxOpened),this.state.ui.nodes.wrapper.classList.remove(n.Class.openedToolbarHolderModifier),this.opened=!1,this.deactiveFlipper()}},{key:"toggle",value:function(){this.opened?this.close():this.open()}},{key:"addPluginToolboxes",value:function(){var e=this,t=this.blockEditable.defaultBlockComp.key;le.a.indexes.forEach((function(n){if(t!==n){var o=le.a.component(n);e.addPluginToolbox(o)}}))}},{key:"addPluginToolbox",value:function(e){var t=this,o=e.toolbox;if(o&&(!o||o.icon)){var i=on.a.make("li",[n.Class.toolboxButton]);i.dataset.key=e.key,i.innerHTML=o.icon,on.a.append(this.nodes.toolbox,i),this.nodes.toolbox.appendChild(i),this.nodes.buttons||(this.nodes.buttons=[]),this.nodes.buttons.push(i),this.listeners.on(i,"click",(function(n){t.toolButtonActivate(n,e.key)}));var a=this.drawTooltip(e);this.state.tooltip.onHover(i,a,{placement:"top",hidingDelay:200});var r=e.shortcut;r&&this.enableShortcut(e.key,r),this._displayedToolsCount++}}},{key:"drawTooltip",value:function(e){e.toolbox;var t=this.blockEditable.getLang("components.".concat(e.key)),o=e.shortcut,i=on.a.make("div",n.Class.buttonTooltip),a=document.createTextNode(en.c(t));return i.appendChild(a),o&&(o=en.b(o),i.appendChild(on.a.make("div",n.Class.buttonShortcut,{textContent:o}))),i}},{key:"enableShortcut",value:function(e,t){var n=this;Ln.a.add({name:t,handler:function(t){t.preventDefault(),n.insertNewBlock(e)},on:this.state.ui.nodes.redactor})}},{key:"removeAllShortcuts",value:function(){var e=this,t=le.a.components;Array.from(Object.values(t)).forEach((function(t){var n=t.shortcut;n&&Ln.a.remove(e.state.ui.nodes.redactor,n)}))}},{key:"enableFlipper",value:function(){var e=this,t=Array.from(this.nodes.toolbox.childNodes).filter((function(e){return"none"!==e.style.display}));this._flipper=new pn({items:t,focusedItemClass:n.Class.toolboxButtonActive,keydownHanlder:function(t){var n=t.keyCode;return(n===en.q.DOWN||n===en.q.UP)&&(Promise.resolve().then((function(){e.close()})),t.preventDefault(),!0)}})}},{key:"activeFlipper",value:function(){var e=this;if(this._flipper){var t=Array.from(this.nodes.toolbox.childNodes).filter((function(e){return"none"!==e.style.display}));this._flipper.activate(t),setTimeout((function(){e._flipper&&e._flipper.focusFirst()}))}}},{key:"deactiveFlipper",value:function(){this._flipper&&this._flipper.deactivate()}},{key:"insertNewBlock",value:function(e){var t,n=this.state,o=n.content,i=n.cursor,a=this._cacheTools[e],r=i.isAtEnd,s=o.insert({data:{key:e,data:(null===a||void 0===a?void 0:a.data)||le.a.component(e).defaultData,common:null===(t=o.activeBlock)||void 0===t?void 0:t.save().common},replace:!0});s&&(s.onAdded(),i.setToBlock(s,"start",r?-1:0),0===s.inputs.length&&(s===o.lastBlock?(o.insertAtEnd(),i.setToBlock(o.lastBlock)):i.setToBlock(o.nextBlock)),this.state.toolbar.close())}},{key:"isEmpty",get:function(){return 0===this._displayedToolsCount}},{key:"flipper",get:function(){return this._flipper}}],[{key:"Class",get:function(){return{toolbox:"beui-toolbox",toolboxButton:"beui-toolbox__button",toolboxButtonActive:"beui-toolbox__button--active",toolboxOpened:"beui-toolbox--opened",openedToolbarHolderModifier:"beui-editor--toolbox-opened",buttonTooltip:"beui-toolbox-button-tooltip",buttonShortcut:"beui-toolbox-button-tooltip__shortcut"}}}]),n}(nn),Mn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).opened=!1,e._tools={},e._flipper=void 0,e.togglingCallback=void 0,e}return Object(r.a)(n,[{key:"make",value:function(){this.nodes.wrapper=on.a.make("div",[n.Class.conversionToolbarWrapper].concat(Object(p.a)(this.isRtl?[mn.Class.editorRtlFix]:[]))),this.nodes.tools=on.a.make("div",n.Class.conversionToolbarTools);var e=on.a.make("div",n.Class.conversionToolbarLabel,{textContent:this.blockEditable.getLang("toolbar.converter.convertTo")});return this.addPluginToolboxs(),this.enableFlipper(),on.a.append(this.nodes.wrapper,e),on.a.append(this.nodes.wrapper,this.nodes.tools),this.nodes.wrapper}},{key:"destroy",value:function(){this._flipper&&(this._flipper.deactivate(),this._flipper=null),this.removeAllNodes()}},{key:"toggle",value:function(e){this.opened?this.close():this.open(),en.k(e)&&(this.togglingCallback=e)}},{key:"open",value:function(){var e=this;this.filterTools(),this.opened=!0,this.nodes.wrapper.classList.add(n.Class.conversionToolbarShowed),setTimeout((function(){e._flipper&&(e._flipper.activate(Object.values(e._tools).filter((function(e){return!e.classList.contains(n.Class.conversionToolHidden)}))),e._flipper.focusFirst()),en.k(e.togglingCallback)&&e.togglingCallback(!0)}),50)}},{key:"close",value:function(){this.opened=!1,this._flipper&&this._flipper.deactivate(),this.nodes.wrapper.classList.remove(n.Class.conversionToolbarShowed),en.k(this.togglingCallback)&&this.togglingCallback(!1)}},{key:"hasTools",value:function(){var e=Object.keys(this._tools);return!(1===e.length&&e.shift()===this.blockEditable.defaultBlockComp.key)}},{key:"replaceWithBlock",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(t){var n,o,i,a,r,s,l,c,d,u,h=this;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.state,o=n.content,i=n.cursor,a=this.state.content.activeBlock){e.next=4;break}return e.abrupt("return");case 4:r=a.component,s=r.key,l=a.data,s===t.key&&(t=this.blockEditable.defaultBlockComp),c=this.state.sanitizer,d=c.clean.bind(c),u={key:s,data:l},o.setActiveBlockBy(a.holder),(t.convertData&&t.convertData(u,d)||[t.toData(c.clean(r.toHtml(l,{clearEmpty:ce.d,inlineContent:ce.h}),t.sanitize))]).forEach((function(e,n){var a=o.insert({data:{key:t.key,data:e},replace:0===n});a&&i.setToBlock(a,i.positions.END)})),this.state.blockSelection.clearSelection(),this.close(),this.state.blockSettings.close(),en.e((function(){h.state.cursor.setToBlock(h.state.content.activeBlock,"end")}),10)();case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addPluginToolboxs",value:function(){var e=this,t=le.a.components;le.a.indexes.forEach((function(n){var o=t[n],i=o.toolbox;!en.j(i)&&i.icon&&o.acceptConversionComps&&e.addPluginToolbox(o,i.icon,i.title)}))}},{key:"addPluginToolbox",value:function(e,t,o){var i=this,a=on.a.make("div",[n.Class.conversionTool]),r=on.a.make("div",[n.Class.conversionToolIcon]);a.dataset.key=e.key,r.innerHTML=t,on.a.append(a,r),on.a.append(a,on.a.text(this.blockEditable.getLang("components.".concat(e.key)))),on.a.append(this.nodes.tools,a),this._tools[e.key]=a,this.listeners.on(a,"click",Object(Ne.a)(Be.a.mark((function t(){return Be.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.replaceWithBlock(e);case 2:case"end":return t.stop()}}),t)}))))}},{key:"filterTools",value:function(){var e=this.state.content.activeBlock;if(e){var t=e.component.key,o=le.a.components;Object.entries(this._tools).forEach((function(e){var i=Object(Se.a)(e,2),a=i[0],r=i[1],s=o[a].acceptConversionComps;r.hidden=!1,r.classList.toggle(n.Class.conversionToolHidden,a===t||!s||Array.isArray(s)&&!s.includes(t))}))}}},{key:"enableFlipper",value:function(){this._flipper=new pn({focusedItemClass:n.Class.conversionToolFocused})}},{key:"flipper",get:function(){return this._flipper}}],[{key:"Class",get:function(){return{conversionToolbarWrapper:"beui-conversion-toolbar",conversionToolbarShowed:"beui-conversion-toolbar--showed",conversionToolbarTools:"beui-conversion-toolbar__tools",conversionToolbarLabel:"beui-conversion-toolbar__label",conversionTool:"beui-conversion-tool",conversionToolHidden:"beui-conversion-tool--hidden",conversionToolIcon:"beui-conversion-tool__icon",conversionToolFocused:"beui-conversion-tool--focused",conversionToolActive:"beui-conversion-tool--active"}}}]),n}(nn),Dn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i)))._buttons=[],e._flipper=null,e._tunes=void 0,e}return Object(r.a)(n,[{key:"make",value:function(){this.nodes.wrapper=on.a.make("div",n.Class.wrapper),this.nodes.componentSettings=on.a.make("div",n.Class.componentSettings),this.nodes.defaultSettings=on.a.make("div",n.Class.defaultSettings),on.a.append(this.nodes.wrapper,[this.nodes.componentSettings,this.nodes.defaultSettings]),this._tunes=this.makeTunes(),this.prepareConversionToolbar(),this.enableFlipper()}},{key:"destroy",value:function(){this._flipper&&(this._flipper.deactivate(),this._flipper=null),this.removeAllNodes()}},{key:"open",value:function(){this.nodes.wrapper.classList.add(n.Class.wrapperOpened),this.blockEditable.selection.cache(),this.state.content.activeBlock.selected=!0,this.state.blockSelection.clearCache(),this.addToolSettings(),this.addDefaultSettings(),this.blockEditable.eventsDispatcher.emit(this.events.opened),this._flipper&&this._flipper.activate(this.blockTunesButtons)}},{key:"close",value:function(){this.nodes.wrapper.classList.remove(n.Class.wrapperOpened);var e=this.blockEditable.selection;this.state.ui.isAtEditor||e.restore(),e.clearCache(),!this.state.crossSelection.isCrossBlockSelectionStarted&&this.state.content.activeBlock&&(this.state.content.activeBlock.selected=!1),this.nodes.componentSettings.innerHTML="",this.nodes.defaultSettings.innerHTML="",this.blockEditable.eventsDispatcher.emit(this.events.closed),this._buttons=[],this._flipper&&this._flipper.deactivate(),this.state.conversionToolbar.close()}},{key:"addToolSettings",value:function(){var e=this.state.content.activeBlock.renderSettings(n.Class);e&&on.a.append(this.nodes.componentSettings,e)}},{key:"addDefaultSettings",value:function(){on.a.append(this.nodes.defaultSettings,this.renderTunes())}},{key:"renderConversion",value:function(){var e=this,t=on.a.icon("toggler-down");return this.nodes.conversion=on.a.make("div",[n.Class.button,n.Class.buttonConversion],{}),this.nodes.conversionContent=on.a.make("div",n.Class.buttonContent),this.nodes.conversion.appendChild(this.nodes.conversionContent),this.nodes.conversion.appendChild(t),this.nodes.conversion.dataset.forbidSetCursor="true",this.state.conversionToolbar.hasTools()?this.setConversionContent():this.nodes.conversion.hidden=!0,this.listeners.on(this.nodes.conversion,"click",(function(){e.state.conversionToolbar.toggle((function(t){var n=!t&&e.opened;e._flipper&&(n?e._flipper.activate():e.opened&&e._flipper.deactivate())}))})),this.state.tooltip.onHover(this.nodes.conversion,this.blockEditable.getLang("toolbar.converter.conversion")),this.nodes.conversion}},{key:"setConversionContent",value:function(){var e=this.state.content.activeBlock,t=e.component.key,o=le.a.components,i=Object.entries(o).some((function(e){var n=Object(Se.a)(e,2),o=(n[0],n[1].acceptConversionComps);return o&&(!Array.isArray(o)||o.includes(t))}));this.nodes.conversion.hidden=!i,this.nodes.conversion.classList.toggle(n.Class.buttonHidden,!i);var a=e.component.toolbox||{};this.nodes.conversionContent.innerHTML=a.icon||a.title||en.c(t)}},{key:"renderTunes",value:function(){var e=document.createDocumentFragment();return this._tunes.forEach((function(t){on.a.append(e,t.render(n.Class))})),on.a.append(e,this.renderConversion()),e}},{key:"makeTunes",value:function(){var e=this;return le.d.indexes.map((function(e){return le.d.tunes[e]})).map((function(t){return new t({blockEditable:e.blockEditable})}))}},{key:"prepareConversionToolbar",value:function(){var e=this.state.conversionToolbar.make();on.a.append(this.nodes.wrapper,e)}},{key:"enableFlipper",value:function(){var e=this;this._flipper=new pn({focusedItemClass:n.Class.focusedButton,activateCallback:function(t){t&&on.a.canSetCursor(t)?e.close():t.dataset.forbidSetCursor||en.e((function(){e.state.cursor.setToBlock(e.state.content.activeBlock)}),50)()}})}},{key:"events",get:function(){return{opened:"block-settings-opened",closed:"block-settings-closed"}}},{key:"flipper",get:function(){return this._flipper}},{key:"opened",get:function(){return this.nodes.wrapper.classList.contains(n.Class.wrapperOpened)}},{key:"blockTunesButtons",get:function(){var e=this;if(0!==this._buttons.length)return this._buttons;var t=this.nodes.componentSettings.querySelectorAll(".".concat(n.Class.settingsButton,", ").concat(on.a.allInputsSelector)),o=this.nodes.defaultSettings.querySelectorAll(".".concat(n.Class.button));return t.forEach((function(t){!t.hidden&&e._buttons.push(t)})),o.forEach((function(t){!t.hidden&&e._buttons.push(t)})),this._buttons}}],[{key:"Class",get:function(){return{wrapper:"beui-settings",wrapperOpened:"beui-settings--opened",componentSettings:"beui-settings__component-zone",defaultSettings:"beui-settings__default-zone",button:"beui-settings__button",buttonConversion:"beui-settings__button--conversion",buttonHidden:"beui-settings__button--hidden",buttonContent:"beui-settings__button---content",focusedButton:"beui-settings__button--focused",focusedButtonAnimated:"beui-settings__button--focused-animated",settingsButton:"beui-settings-button",settingsButtonActive:"beui-settings-button--active"}}}]),n}(nn),Hn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).anyBlockSelectedCache=null,e.multiBlocksSelectedCache=null,e.needToSelectAll=!1,e.nativeInputSelected=!1,e.readyToBlockSelection=!1,e}return Object(r.a)(n,[{key:"prepare",value:function(){}},{key:"toggleReadOnly",value:function(e){this.blockEditable.selection.removeAllRanges(),this.allBlocksSelected=!1}},{key:"unSelectBlockByIndex",value:function(e){var t,n=this.state.content;void 0===e||isNaN(e)?t=n.activeBlock:void 0!==e&&(t=n.getBlockByIndex(e)),t&&(t.selected=!1),this.clearCache()}},{key:"clearSelection",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.state,o=n.content,i=n.cursor,a=n.crossSelection,r=n.rectangleSelection,s=this.blockEditable.selection;t&&this.blockEditable.selection.cache(),o.activeBlock&&o.activeBlock.inputSelection.clearInputsSelection(e),this.needToSelectAll=!1,this.nativeInputSelected=!1,this.readyToBlockSelection=!1;var l=e&&e instanceof KeyboardEvent,c=l&&en.n(e.keyCode);if(this.anyBlockSelected&&l&&c&&!s.exists){var d=o.removeSelectedBlocks();o.insertDefaultBlockAtIndex(d||0,!0),i.setToBlock(o.activeBlock),en.e((function(){var t=e.key;i.insertContentAtCursorPosition(t.length>1?"":t)}),20)()}a.clear(e),this.anyBlockSelected&&!r.isRectActivated()?(t&&this.blockEditable.selection.restore(),this.allBlocksSelected=!1):r.clearSelection()}},{key:"copySelectedBlocks",value:function(e){e.preventDefault();var t=this.state.exporter,n=this.selectedBlocks.map((function(e){return e.save()})),o=t.export("html",!0),i=t.export("markdown",!0);e.clipboardData&&(e.clipboardData.setData("text/plain",i),e.clipboardData.setData("text/html",o),e.clipboardData.setData(this.state.paste.MIME_TYPE,JSON.stringify(n)))}},{key:"selectBlockByIndex",value:function(e){var t,n=this.state,o=n.content,i=n.inlineToolbar;o.clearFocused(),t=void 0===e?o.activeBlock:o.getBlockByIndex(e),this.blockEditable.selection.cache(),this.blockEditable.selection.removeAllRanges(),t&&(t.selected=!0),this.clearCache(),i.close()}},{key:"clearCache",value:function(){this.anyBlockSelectedCache=null,this.multiBlocksSelectedCache=null}},{key:"destroy",value:function(){}},{key:"handleCommandA",value:function(e){if(this.state.rectangleSelection.clearSelection(),e){if(on.a.isNativeInput(e.target)&&!this.readyToBlockSelection)return void(this.readyToBlockSelection=!0);var t=this.state.content.getBlock(e.target);if(t){var n=t.inputs;if(n.length>1&&!this.readyToBlockSelection)return void(this.readyToBlockSelection=!0);if(1===n.length&&!this.needToSelectAll)return void(this.needToSelectAll=!0)}}else this.needToSelectAll=!0;this.needToSelectAll?(null===e||void 0===e||e.preventDefault(),this.selectAllBlocks(),this.needToSelectAll=!1,this.readyToBlockSelection=!1,this.state.conversionToolbar.close()):this.readyToBlockSelection&&(null===e||void 0===e||e.preventDefault(),this.selectBlockByIndex(),this.needToSelectAll=!0)}},{key:"selectAllBlocks",value:function(){this.blockEditable.selection.cache(),this.blockEditable.selection.removeAllRanges(),this.allBlocksSelected=!0,this.state.inlineToolbar.close()}},{key:"allBlocksSelected",get:function(){return this.state.content.blocks.every((function(e){return!0===e.selected}))},set:function(e){this.state.content.blocks.forEach((function(t){t.selected=e})),this.clearCache()}},{key:"anyBlockSelected",get:function(){var e=this.state.content;return null===this.anyBlockSelectedCache&&(this.anyBlockSelectedCache=e.blocks.some((function(e){return!0===e.selected}))),this.anyBlockSelectedCache}},{key:"multiBlocksSelected",get:function(){var e=this.state.content;return null===this.multiBlocksSelectedCache&&(this.multiBlocksSelectedCache=e.blocks.filter((function(e){return e.selected})).length>1),this.multiBlocksSelectedCache}},{key:"selectedBlocks",get:function(){return this.state.content.blocks.filter((function(e){return e.selected}))}}]),n}(nn),Pn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).firstSelectedBlock=void 0,e.lastSelectedBlock=void 0,e.onMouseUp=function(){var t=e.state.ui,n=e.blockEditable.editable.document;e.listeners.off(t.nodes.content,"mouseover",e.onMouseOver),e.listeners.off(n,"mouseup",e.onMouseUp)},e.onMouseOver=function(t){var n=e.state,o=n.content,i=n.blockSelection,a=o.getBlock(t.relatedTarget)||e.lastSelectedBlock,r=o.getBlock(t.target);if(a&&r&&r!==a){if(a===e.firstSelectedBlock)return e.blockEditable.selection.removeAllRanges(),a.selected=!0,r.selected=!0,i.clearCache(),void(e.lastSelectedBlock=r);if(r===e.firstSelectedBlock)return a.selected=!1,r.selected=!1,void i.clearCache();e.state.inlineToolbar.close(),e.resetBlocksSelectedState(e.firstSelectedBlock||r,r),e.lastSelectedBlock=r}},e}return Object(r.a)(n,[{key:"prepare",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(){var t,n=this;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.state.ui,this.listeners.on(t.nodes.content,"mousedown",(function(e){n.enableCrossBlockSelection(e)}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"watchSelection",value:function(e){if(e.button===en.r.LEFT){var t=this.state,n=t.content,o=t.ui,i=this.blockEditable.editable.document;this.firstSelectedBlock=n.getBlock(e.target),this.lastSelectedBlock=this.firstSelectedBlock,this.listeners.on(o.nodes.content,"mouseover",this.onMouseOver),this.listeners.on(i,"mouseup",this.onMouseUp)}}},{key:"toggleBlockSelectedState",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.state,n=t.content,o=t.blockSelection;this.lastSelectedBlock||(this.lastSelectedBlock=this.firstSelectedBlock=n.activeBlock),this.firstSelectedBlock===this.lastSelectedBlock&&(this.firstSelectedBlock.selected=!0,o.clearCache(),this.blockEditable.selection.removeAllRanges());var i=n.blocks.indexOf(this.lastSelectedBlock)+(e?1:-1),a=n.blocks[i];a&&(this.lastSelectedBlock.selected!==a.selected?(a.selected=!0,o.clearCache()):(this.lastSelectedBlock.selected=!1,o.clearCache()),this.lastSelectedBlock=a,this.state.inlineToolbar.close(),a.holder.scrollIntoView({block:"nearest"}))}},{key:"clear",value:function(e){var t=this.state,n=t.content,o=t.blockSelection,i=t.cursor,a=this.firstSelectedBlock?n.blocks.indexOf(this.firstSelectedBlock):-1,r=this.lastSelectedBlock?n.blocks.indexOf(this.lastSelectedBlock):-1;if(o.anyBlockSelected&&a>-1&&r>-1)if(e&&e instanceof KeyboardEvent)switch(e.keyCode){case en.q.DOWN:case en.q.RIGHT:i.setToBlock(n.blocks[Math.max(a,r)],i.positions.END);break;case en.q.UP:case en.q.LEFT:i.setToBlock(n.blocks[Math.min(a,r)],i.positions.START);break;default:i.setToBlock(n.blocks[Math.max(a,r)],i.positions.END)}else i.setToBlock(n.blocks[Math.max(a,r)],i.positions.END);this.firstSelectedBlock=this.lastSelectedBlock=void 0}},{key:"enableCrossBlockSelection",value:function(e){var t=this.state.ui;this.blockEditable.selection.isCollapsed||this.state.blockSelection.clearSelection(e),t.nodes.content.contains(e.target)?this.watchSelection(e):this.state.blockSelection.clearSelection(e)}},{key:"toggleBlocksSelectedState",value:function(e,t){for(var n=this.state,o=n.content,i=n.blockSelection,a=o.blocks.indexOf(e),r=o.blocks.indexOf(t),s=e.selected!==t.selected,l=Math.min(a,r);l<=Math.max(a,r);l++){var c=o.blocks[l];c!==this.firstSelectedBlock&&c!==(s?e:t)&&(o.blocks[l].selected=!o.blocks[l].selected,i.clearCache())}}},{key:"resetBlocksSelectedState",value:function(e,t){var n=this.state,o=n.content,i=n.blockSelection,a=o.blocks.indexOf(e),r=o.blocks.indexOf(t);i.selectedBlocks.forEach((function(e){e.selected=!1}));for(var s=Math.min(a,r);s<=Math.max(a,r);s++){o.blocks[s].selected=!0}i.clearCache()}},{key:"isCrossBlockSelectionStarted",get:function(){return!!this.firstSelectedBlock&&!!this.lastSelectedBlock}}]),n}(nn),Fn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).isRectSelectionActivated=!1,e.SCROLL_SPEED=3,e.HEIGHT_OF_SCROLL_ZONE=40,e.BOTTOM_SCROLL_ZONE=1,e.TOP_SCROLL_ZONE=2,e.MAIN_MOUSE_BUTTON=0,e.mousedown=!1,e.isScrolling=!1,e.inScrollZone=null,e.startX=0,e.startY=0,e.mouseX=0,e.mouseY=0,e.stackOfSelected=[],e.rectCrossesBlocks=void 0,e.overlayRectangle=void 0,e.listenerIds=[],e}return Object(r.a)(n,[{key:"prepare",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(){return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.enableModuleBindings();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"startSelection",value:function(e,t){var n=this.state.ui.elementFromPoint(e-window.pageXOffset,t-window.pageYOffset);if(n){n.closest(".".concat(vn.Class.toolbar))||(this.state.blockSelection.allBlocksSelected=!1,this.clearSelection(),this.stackOfSelected=[]);var o=[".".concat(un.Class.content),".".concat(vn.Class.toolbar),".".concat(fn.Class.inlineToolbar)],i=n.closest("."+mn.Class.editorZoneContent),a=o.some((function(e){return!!n.closest(e)}));if(!i||a)return}this.mousedown=!0,this.startX=e,this.startY=t}},{key:"endSelection",value:function(){this.mousedown=!1,this.startX=0,this.startY=0,this.overlayRectangle.style.display="none"}},{key:"isRectActivated",value:function(){return this.isRectSelectionActivated}},{key:"clearSelection",value:function(){this.isRectSelectionActivated=!1}},{key:"enableModuleBindings",value:function(){var e=this,t=this.genHTML().content,n=this.blockEditable.editable,o=n.document,i=n.window;this.listeners.on(t,"mousedown",(function(t){e.processMouseDown(t)}),!1),this.listeners.on(o.body,"mousemove",(function(t){e.processMouseMove(t)}),!1),this.listeners.on(o.body,"mouseleave",(function(){e.processMouseLeave()})),this.listeners.on(i,"scroll",(function(t){e.processScroll(t)}),!1),this.listeners.on(o.body,"mouseup",(function(){e.processMouseUp()}),!1)}},{key:"processMouseDown",value:function(e){e.button===this.MAIN_MOUSE_BUTTON&&(e.metaKey||e.ctrlKey||this.startSelection(e.pageX,e.pageY))}},{key:"processMouseMove",value:function(e){this.changingRectangle(e),this.scrollByZones(e.clientY)}},{key:"processMouseLeave",value:function(){this.clearSelection(),this.endSelection()}},{key:"processScroll",value:function(e){this.changingRectangle(e)}},{key:"processMouseUp",value:function(){this.endSelection()}},{key:"scrollByZones",value:function(e){var t=this.blockEditable.editable.document;this.inScrollZone=null,e<=this.HEIGHT_OF_SCROLL_ZONE&&(this.inScrollZone=this.TOP_SCROLL_ZONE),t.documentElement.clientHeight-e<=this.HEIGHT_OF_SCROLL_ZONE&&(this.inScrollZone=this.BOTTOM_SCROLL_ZONE),this.inScrollZone?this.isScrolling||(this.scrollVertical(this.inScrollZone===this.TOP_SCROLL_ZONE?-this.SCROLL_SPEED:this.SCROLL_SPEED),this.isScrolling=!0):this.isScrolling=!1}},{key:"genHTML",value:function(){var e=this.state.ui,t=e.nodes.holder.querySelector("."+mn.Class.editorWrapper),o=e.nodes.content,i=on.a.make("div",n.Class.overlay,{}),a=on.a.make("div",n.Class.overlayContainer,{}),r=on.a.make("div",n.Class.rect,{});return a.appendChild(r),i.appendChild(a),null===t||void 0===t||t.appendChild(i),this.overlayRectangle=r,{content:o,overlay:i}}},{key:"scrollVertical",value:function(e){var t=this,n=this.blockEditable.editable.window;if(this.inScrollZone&&this.mousedown){var o=n.pageYOffset;n.scrollBy(0,e),this.mouseY+=n.pageYOffset-o,setTimeout((function(){t.scrollVertical(e)}),0)}}},{key:"changingRectangle",value:function(e){if(this.mousedown){void 0!==e.pageY&&(this.mouseX=e.pageX,this.mouseY=e.pageY);var t=this.genInfoForMouseSelection(),n=t.rightPos,o=t.leftPos,i=t.index,a=this.startX>n&&this.mouseX>n,r=this.startX<o&&this.mouseX<o;this.rectCrossesBlocks=!(a||r),this.isRectSelectionActivated||(this.rectCrossesBlocks=!1,this.isRectSelectionActivated=!0,this.shrinkRectangleToPoint(),this.overlayRectangle.style.display="block"),this.updateRectangleSize(),-1!==i&&(this.trySelectNextBlock(i),this.inverseSelection(),this.blockEditable.selection.removeAllRanges(),e.preventDefault())}}},{key:"shrinkRectangleToPoint",value:function(){this.overlayRectangle.style.left="".concat(this.startX-window.pageXOffset,"px"),this.overlayRectangle.style.top="".concat(this.startY-window.pageYOffset,"px"),this.overlayRectangle.style.bottom="calc(100% - ".concat(this.startY-window.pageYOffset,"px"),this.overlayRectangle.style.right="calc(100% - ".concat(this.startX-window.pageXOffset,"px")}},{key:"inverseSelection",value:function(){var e=this.state.content.getBlockByIndex(this.stackOfSelected[0]),t=!!e&&e.selected;if(this.rectCrossesBlocks&&!t){var n,o=Object(et.a)(this.stackOfSelected);try{for(o.s();!(n=o.n()).done;){var i=n.value;this.state.blockSelection.selectBlockByIndex(i)}}catch(l){o.e(l)}finally{o.f()}}if(!this.rectCrossesBlocks&&t){var a,r=Object(et.a)(this.stackOfSelected);try{for(r.s();!(a=r.n()).done;){var s=a.value;this.state.blockSelection.unSelectBlockByIndex(s)}}catch(l){r.e(l)}finally{r.f()}}}},{key:"updateRectangleSize",value:function(){this.mouseY>=this.startY?(this.overlayRectangle.style.top="".concat(this.startY-window.pageYOffset,"px"),this.overlayRectangle.style.bottom="calc(100% - ".concat(this.mouseY-window.pageYOffset,"px")):(this.overlayRectangle.style.bottom="calc(100% - ".concat(this.startY-window.pageYOffset,"px"),this.overlayRectangle.style.top="".concat(this.mouseY-window.pageYOffset,"px")),this.mouseX>=this.startX?(this.overlayRectangle.style.left="".concat(this.startX-window.pageXOffset,"px"),this.overlayRectangle.style.right="calc(100% - ".concat(this.mouseX-window.pageXOffset,"px")):(this.overlayRectangle.style.right="calc(100% - ".concat(this.startX-window.pageXOffset,"px"),this.overlayRectangle.style.left="".concat(this.mouseX-window.pageXOffset,"px"))}},{key:"genInfoForMouseSelection",value:function(){var e=this.blockEditable.editable,t=e.document,n=e.window,o=t.body.offsetWidth/2,i=this.mouseY-n.pageYOffset,a=this.state.ui.elementFromPoint(o,i);if(!a)return{index:-1,leftPos:0,rightPos:0};var r=this.state.content.getBlock(a),s=-1;void 0!==r&&(s=this.state.content.blocks.findIndex((function(e){return e.holder===r.holder})));var l=this.state.content.lastBlock.holder.querySelector("."+un.Class.content),c=Number.parseInt(n.getComputedStyle(l).width,10)/2;return{index:s,leftPos:o-c,rightPos:o+c}}},{key:"addBlockInSelection",value:function(e){this.rectCrossesBlocks&&this.state.blockSelection.selectBlockByIndex(e),this.stackOfSelected.push(e)}},{key:"trySelectNextBlock",value:function(e){var t=this,n=this.stackOfSelected[this.stackOfSelected.length-1]===e,o=this.stackOfSelected.length;if(!n){var i=this.stackOfSelected[o-1]-this.stackOfSelected[o-2]>0,a=0;o>1&&(a=i?1:-1);var r=e>this.stackOfSelected[o-1]&&1===a,s=e<this.stackOfSelected[o-1]&&-1===a,l=!(r||s||0===a);if(l||!(e>this.stackOfSelected[o-1]||void 0===this.stackOfSelected[o-1])){if(!l&&e<this.stackOfSelected[o-1])for(var c=this.stackOfSelected[o-1]-1;c>=e;c--)this.addBlockInSelection(c);else if(l){var d,u=o-1;for(d=e>this.stackOfSelected[o-1]?function(){return e>t.stackOfSelected[u]}:function(){return e<t.stackOfSelected[u]};d();)this.rectCrossesBlocks&&this.state.blockSelection.unSelectBlockByIndex(this.stackOfSelected[u]),this.stackOfSelected.pop(),u--}}else for(var h=this.stackOfSelected[o-1]+1||e;h<=e;h++)this.addBlockInSelection(h)}}}],[{key:"Class",get:function(){return{overlay:"beui-editor-overlay",overlayContainer:"beui-editor-overlay__container",rect:"beui-editor-overlay__rectangle",topScrollZone:"beui-editor-overlay__scroll-zone--top",bottomScrollZone:"beui-editor-overlay__scroll-zone--bottom"}}}]),n}(nn),zn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).toolsDontSupportReadOnly=[],e.readOnlyEnabled=!1,e}return Object(r.a)(n,[{key:"prepare",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(){return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.toggle(!1);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toggle",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(){var t,n,o,i=arguments;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=i.length>0&&void 0!==i[0]?i[0]:!this.readOnlyEnabled)&&this.toolsDontSupportReadOnly.length>0&&this.throwCriticalError(),n=this.readOnlyEnabled,this.readOnlyEnabled=t,e.t0=Be.a.keys(this.state);case 5:if((e.t1=e.t0()).done){e.next=12;break}if(o=e.t1.value,this.state[o].toggleReadOnly){e.next=9;break}return e.abrupt("continue",5);case 9:this.state[o].toggleReadOnly(t),e.next=5;break;case 12:if(n!==t){e.next=14;break}return e.abrupt("return",this.readOnlyEnabled);case 14:return e.abrupt("return",this.readOnlyEnabled);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"throwCriticalError",value:function(){}},{key:"isEnabled",get:function(){return this.readOnlyEnabled}}]),n}(nn),qn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"export",value:function(e,t){return"markdown"===e?this.state.content.getContentMarkdown(t):"plain"===e?this.state.content.getContentText(t):"juejin"===e?"---\ntheme: "+this.blockEditable.getTypesetId()+"\n---\n\n"+this.state.content.getContentMarkdown(t):this.renderContentRichHTML(e,t)}},{key:"renderContentRichHTML",value:function(e,t){var n=this.state.content.getContentHTML(e,t),o=this.blockEditable.getTypesetCSSText(),i=Object(ce.h)(n,o),a=0;i=i.replace(/\scounter\(footnote\)\s/g,(function(e){return"".concat(++a)}));var r=0;return i=i.replace(/\scounter\(footnotelist\)\s/g,(function(e){return r%=a,"".concat(++r)}))}}]),n}(nn),$n=["web","print","mobile"],Vn=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"prepare",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(){var t,n,o,i,a,r,s;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.blockEditable.editable,n=this.state,o=n.ui,i=n.toolbar,a=n.exporter,r=n.blockSelection,s=n.content,t.registerCommand((function(){return{cmdName:"basic",notNeedUndo:!0,execCommand:function(e,n){s.basic=n,t.trigger("contentchange")},queryCommandState:function(){return o.nodes.wrapper?0:-1},queryCommandValue:function(){return Object(W.a)({},s.basic)},shortcutKeys:{}}})),t.registerCommand((function(){return{cmdName:"layout",notNeedUndo:!0,execCommand:function(e,n){o.layout=n||$n[($n.indexOf(o.layout)+1)%3],i.move(),t.trigger("contentchange")},queryCommandState:function(){return o.nodes.wrapper?0:-1},queryCommandValue:function(){return o.layout},shortcutKeys:{"Ctrl+L":{}}}})),t.registerCommand((function(){return{cmdName:"export",ignoreContentChange:!0,notNeedUndo:!0,execCommand:function(e,t){var n=["text/plain"];return-1!==["wechat","zhihu","html"].indexOf(t)&&n.push("text/html"),Object(ce.e)(a.export(t),n)},queryCommandState:function(){return t.isReady?0:-1}}})),t.registerCommand((function(){return{cmdName:"content",ignoreContentChange:!0,notNeedUndo:!0,execCommand:function(e,t){return a.export(t)},queryCommandState:function(){return t.isReady?0:-1}}})),t.registerCommand((function(){return t.ready((function(){var e="Ctrl+A";t.$dom.on(t.holder,"keydown",(function(n){var o=n.keyCode||n.which;(/^(ctrl)(\+shift)?\+(\w+)$/.test(e.toLowerCase())||/^(\w+)$/.test(e.toLowerCase()))&&("ctrl"===RegExp.$1&&(n.ctrlKey||n.metaKey)&&(""===RegExp.$2||n[RegExp.$2.slice(1)+"Key"])&&o===t.$keymap[RegExp.$3]||o===t.$keymap[RegExp.$1])&&r.handleCommandA(n)}))})),{cmdName:"selectall",ignoreContentChange:!0,notNeedUndo:!0,execCommand:function(e,t){s.activeBlock&&r.handleCommandA()},queryCommandState:function(){return t.isReady?0:-1}}})),t.registerCommand({cmdName:"fullscreen",notNeedUndo:!0,ignoreContentChange:!0,execCommand:function(e){t.trigger("fullscreen")},queryCommandState:function(e){return 0},shortcutKeys:{"Ctrl+Shift+F":{}}}),t.registerCommand({cmdName:"save",notNeedUndo:!0,ignoreContentChange:!0,execCommand:function(e){t.trigger("save")},queryCommandState:function(e){return 0},shortcutKeys:{"Ctrl+S":{}}}),t.registerCommand({cmdName:"search",notNeedUndo:!0,ignoreContentChange:!0,execCommand:function(e){t.trigger("search")},queryCommandState:function(e){return 0},shortcutKeys:{"Ctrl+F":{}}}),t.registerCommand({cmdName:"tab",notNeedUndo:!0,ignoreContentChange:!0,execCommand:function(e){t.trigger("tab")},queryCommandState:function(e){return 0},shortcutKeys:{"Ctrl+T":{}}}),t.registerCommand({cmdName:"wordcount",notNeedUndo:!0,ignoreContentChange:!0,execCommand:function(e){return s.getWordCount()},queryCommandState:function(e){return 0},shortcutKeys:{}});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(nn),Un=n(845),Wn=n.n(Un),Kn={ui:mn,tooltip:yn,paste:_n,copy:xn,notifier:Tn,events:wn,dragdrop:Sn,cursor:jn,content:Nn,toolbox:Rn,toolbar:vn,conversionToolbar:Mn,inlineToolbar:fn,insertToolbar:bn,blockSettings:Dn,blockSelection:Hn,crossSelection:Pn,rectangleSelection:Fn,readOnly:zn,exporter:qn,commands:Vn,sanitizer:function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).configCache={},e.inlineToolsConfigCache=null,e.insertToolsConfigCache=null,e}return Object(r.a)(n,[{key:"sanitizeBlocks",value:function(e){var t=this;return e.map((function(e){var n=t.composeComponentConfig(e.key);return en.j(n)||(e.data=t.deepSanitize(e.data,n)),e}))}},{key:"deepSanitize",value:function(e,t){return Array.isArray(e)?this.cleanArray(e,t):en.m(e)?this.cleanObject(e,t):en.o(e)?this.cleanOneItem(e,t):e}},{key:"clean",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={tags:t},o=this.createHTMLJanitorInstance(n);return o.clean(e)}},{key:"composeComponentConfig",value:function(e){if(this.configCache[e])return this.configCache[e];var t=le.a.component(e),n=Object.assign({},this.getInlineToolsConfig(t),this.getAllInsertToolsConfig());if(!t.sanitize||t.sanitize&&en.j(t.sanitize))return n;var o=t.sanitize,i={};for(var a in o)if(Object.prototype.hasOwnProperty.call(o,a)){var r=o[a];en.m(r)?i[a]=Object.assign({},n,r):i[a]=r}return this.configCache[e]=i,i}},{key:"getInlineToolsConfig",value:function(e){var t=e.enabledInlineTools||[],n={};return en.i(t)&&t?n=this.getAllInlineToolsConfig():t.map((function(e){n=Object.assign(n,le.b.tool(e).sanitize)})),n.br=!0,n.wbr=!0,n}},{key:"getAllInlineToolsConfig",value:function(){if(this.inlineToolsConfigCache)return this.inlineToolsConfigCache;var e={};return Object.entries(le.b.tools).forEach((function(t){var n=Object(Se.a)(t,2)[1];Object.assign(e,n.sanitize)})),this.inlineToolsConfigCache=e,this.inlineToolsConfigCache}},{key:"getAllInsertToolsConfig",value:function(){if(this.insertToolsConfigCache)return this.insertToolsConfigCache;var e={};return Object.entries(le.c.tools).forEach((function(t){var n=Object(Se.a)(t,2)[1];Object.assign(e,n.sanitize)})),this.insertToolsConfigCache=e,this.insertToolsConfigCache}},{key:"cleanArray",value:function(e,t){var n=this;return e.map((function(e){return n.deepSanitize(e,t)}))}},{key:"cleanObject",value:function(e,t){var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=e[o],a=this.isRule(t[o])?t[o]:t;n[o]=this.deepSanitize(i,a)}return n}},{key:"cleanOneItem",value:function(e,t){return en.m(t)?this.clean(e,t):!1===t?this.clean(e,{}):e}},{key:"isRule",value:function(e){return en.m(e)||en.i(e)||en.k(e)}},{key:"createHTMLJanitorInstance",value:function(e){return e?new Wn.a(e):null}}]),n}(nn)},Xn=n(564),Yn=function(){function e(){Object(a.a)(this,e),this.subscribers={}}return Object(r.a)(e,[{key:"on",value:function(e,t){e in this.subscribers||(this.subscribers[e]=[]),this.subscribers[e].push(t)}},{key:"once",value:function(e,t){var n=this;e in this.subscribers||(this.subscribers[e]=[]);this.subscribers[e].push((function o(i){var a=t(i),r=n.subscribers[e].indexOf(o);return-1!==r&&n.subscribers[e].splice(r,1),a}))}},{key:"emit",value:function(e,t){this.subscribers[e]&&this.subscribers[e].reduce((function(e,t){return t(e)||e}),t)}},{key:"off",value:function(e,t){for(var n=0;n<this.subscribers[e].length;n++)if(this.subscribers[e][n]===t){delete this.subscribers[e][n];break}}},{key:"destroy",value:function(){this.subscribers={}}}]),e}(),Gn=n(28),Zn=n(848),Jn=[];Zn.keys().forEach((function(e){e.match(/^\.\/.*\/index\.([tj])s$/)&&Jn.push(Zn(e))}));var Qn=function(){function e(t){var n,o,i=this;Object(a.a)(this,e),this._editable=void 0,this._defaultBlockComp=void 0,this._state={},this._utils={clearEmpty:ce.d,inlineContent:ce.h,svgToBlob:ce.r,makeMarkdown:ce.m,makeHtml:ce.l,Base64:Gn.a},this._holder=void 0,this._eventsDispatcher=void 0,this._mutationObserver=void 0,this.isReady=void 0,this._defaultBlockComp=(null===t||void 0===t?void 0:t.defaultBlockComp)||Xn.default,this._holder=t.holder,this.isReady=new Promise((function(e,t){n=e,o=t})),le.a.indexes=["header","image","list","todolist","delimiter","table","code","math","diagram","draw","drawio","footnote","richtext","paragraph"],le.d.indexes=["moveup","movedown","delete","quote","insert-line-before","insert-line-after","align-left","align-center","align-right","align-justify"],le.b.indexes=["bold","italic","underline","strikethrough","math","inlinecode","kbd","superscript","subscript","mark","link","footnote","fontsize","fontcolor","backcolor","wrap","removeformat"],Promise.resolve().then(Object(Ne.a)(Be.a.mark((function e(){return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.init();case 2:return e.next=4,i.start();case 4:return e.next=6,i.render();case 6:i.state.ui.removeLoader(),n();case 9:case"end":return e.stop()}}),e)})))).catch((function(e){o(e)}))}return Object(r.a)(e,[{key:"mount",value:function(e){return this._holder=e,this._editable}},{key:"destroy",value:function(){}},{key:"setTypeset",value:function(e){G.a.setTypeset(this.editable,e)}},{key:"getTypesetCSSText",value:function(){return G.a.getTypesetCSSText(this.editable)}},{key:"getTypesetId",value:function(){return this.editable.queryCommandValue("typeset")||""}},{key:"getLang",value:function(e,t){return ke.a.getLang(e)||t||""}},{key:"init",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(){var t=this;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._editable=new Qt({darkmode:document.documentElement.classList.contains("dark-mode")}),this._editable.ready((function(){var e=n(1144),o="beui-content";e&&!t._editable.hasCSS("#"+o)&&t._editable.appendCSS(e,{id:o});var i=n(268),a="be-common-typeset-basic";i&&!t._editable.hasCSS("#"+a)&&t._editable.appendCSS(i,{id:a});var r=le.a.components;for(var s in r){var l=r[s];t.injectPluginCSSAndCommonTypeset(l)}})),this._mutationObserver=this._mutationObserver=new MutationObserver((function(){t._editable.darkmode=document.documentElement.classList.contains("dark-mode")})),this._mutationObserver.observe(document.documentElement,{attributes:!0}),G.a.registerCommand(this._editable),this._eventsDispatcher=new Yn,Object.entries(Kn).forEach((function(e){var n=Object(Se.a)(e,2),o=n[0],i=n[1];t._state[o]=new i({blockEditable:t})}));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"start",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(){var t,n=this;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=["ui","paste","copy","blockSelection","rectangleSelection","crossSelection","readOnly","commands"],e.next=3,t.reduce((function(e,t){return e.then(Object(Ne.a)(Be.a.mark((function e(){var o;return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(o=n._state[t]).prepare){e.next=5;break}return e.next=5,o.prepare();case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])}))))}),Promise.resolve());case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=Object(Ne.a)(Be.a.mark((function e(){return Be.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.state.ui.checkEmptiness();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"injectPluginCSSAndCommonTypeset",value:function(e){var t="beui-".concat(e.key),n=e.CSS;n&&!this._editable.hasCSS("#"+t)&&this._editable.appendCSS(n,{id:t});var o="be-common-typeset-".concat(e.key),i=e.builtinTypesets;i&&i.common&&!this._editable.hasCSS("#"+o)&&this._editable.appendCSS(i.common,{id:o})}},{key:"defaultBlockComp",get:function(){return this._defaultBlockComp}},{key:"defaultBlockCompInitData",get:function(){return{key:this.defaultBlockComp.key,data:this.defaultBlockComp.defaultData}}},{key:"editable",get:function(){return this._editable}},{key:"state",get:function(){return this._state}},{key:"utils",get:function(){return this._utils}},{key:"holder",get:function(){return this._holder}},{key:"selection",get:function(){return this._editable.selection}},{key:"eventsDispatcher",get:function(){return this._eventsDispatcher}}]),e}(),eo=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var o;return Object(a.a)(this,n),(o=t.call(this,e)).content=void 0,o.blockEditable=void 0,o.onUpdateContent=function(){var e=o.props.onEditable;o.content&&(o.blockEditable=new Qn({holder:o.content}),o.blockEditable.isReady.then((function(){o.setState({editable:o.blockEditable.editable}),o.blockEditable.editable.on("contentchange aftersetcontent",(function(){o.onContentChange()})),e(o.blockEditable.editable),o.blockEditable.editable.on("fullscreen",(function(){o.onTriggerFullscreen()}))})))},o.onContentChange=function(){var e=o.blockEditable.editable;if(e){var t=e.execCommand("wordcount"),n=e.execCommand("unmatchedimagecount");o.setState({wordCount:t,unmatchedImageCount:n})}},o.onTriggerFullscreen=function(e){if(e){var t=e.target.parentElement;if((null===t||void 0===t?void 0:t.closest(".beui-toolbar"))||(null===t||void 0===t?void 0:t.closest(".beui-inline-toolbar")))return}o.setState({fullscreen:!o.state.fullscreen},(function(){setTimeout((function(){we.a.trigger("onTriggerFullscreen",o.state.fullscreen)}),100)}))},o.onExitFullscreen=function(){o.setState({fullscreen:!1})},o.onTypesetEditing=function(e){o.setState({isTypesetEditing:e})},o.onProfileEditing=function(e){o.setState({isProfileEditing:e})},o.onShowingCatalog=function(e){o.setState({isCatalogShowing:e})},o.state={editable:null,fullscreen:!1,isTypesetEditing:!1,isCatalogShowing:!1,isProfileEditing:!1,wordCount:0,unmatchedImageCount:0},o.onContentChange=Object(en.d)(o.onContentChange,500),o}return Object(r.a)(n,[{key:"componentDidMount",value:function(){this.onUpdateContent(),we.a.on("onAppSideBarTabOpen onOpen",this.onExitFullscreen)}},{key:"componentWillUnmount",value:function(){we.a.off("onAppSideBarTabOpen onOpen",this.onExitFullscreen)}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var e=this,t=(this.props.customToolbar,this.state),n=t.fullscreen,o=t.editable,a=t.isTypesetEditing,r=t.isCatalogShowing,s=t.isProfileEditing,l=t.wordCount,c=t.unmatchedImageCount;return Object(i.jsx)("div",{className:"editor",style:{top:n?"-31px":"31px"},children:Object(i.jsx)("div",{className:"editor-inner",children:Object(i.jsxs)("div",{className:"editor-main",children:[Object(i.jsxs)("div",{className:["editor-core",a||r||s?"editor-core--card":""].join(" "),children:[Object(i.jsx)("div",{className:"editor-canvas",ref:function(t){e.content=t}}),Object(i.jsx)("div",{className:"editor-status-bar",children:o&&Object(i.jsx)("div",{className:"editor-word-count",children:Object(i.jsxs)("span",{children:["\u6b63\u6587\u5b57\u6570 ",l," \u4e2a\uff0c\u9884\u8ba1\u9605\u8bfb\u9700 ",Math.ceil(l/300)," \u5206\u949f"]})})})]}),Object(i.jsx)("div",{className:"editor-side-bar",children:Object(i.jsx)("div",{className:"editor-side-bar-nav",children:Object(i.jsxs)("div",{className:"editor-side-bar-nav__top",children:[Object(i.jsx)(h.a,{tip:"\u5c55\u5f00/\u6536\u8d77",placement:"left",wrapClassName:"editor-side-bar-item app-guide-fullscreen",onClick:this.onTriggerFullscreen,icon:n?Object(i.jsx)(d.a,{}):Object(i.jsx)(u.a,{})}),Object(i.jsx)(Te,{}),Object(i.jsx)(y,{editable:o,onShowingCatalog:this.onShowingCatalog}),Object(i.jsx)(z,{editable:o}),Object(i.jsx)(Te,{}),Object(i.jsx)(S,{editable:o}),Object(i.jsx)(Te,{}),Object(i.jsx)(Oe,{editable:o}),Object(i.jsx)(Ee,{editable:o}),Object(i.jsx)(Te,{}),Object(i.jsx)(ge,{editable:o,unmatchedImageCount:c}),Object(i.jsx)(Te,{}),Object(i.jsx)(Z,{editable:o,onTypesetEditing:this.onTypesetEditing}),Object(i.jsx)(ve,{editable:o,onProfileEditing:this.onProfileEditing}),Object(i.jsx)(Te,{}),Object(i.jsx)(re,{editable:o})]})})})]})})})}}]),n}(c.Component);t.default=eo},183:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var o=n(1),i=n(7),a=n(6),r=n(10),s=n(9),l=n(0),c=n.n(l),d=n(239),u=n.n(d),h=n(17),p=(n(264),n(272),n(273),{Apply:"\u5e94\u7528",Arrow:"\u7bad\u5934","Arrow-2":"\u7bad\u5934-2","Arrow-3":"\u7bad\u5934-3",Blend:"\u7740\u8272",Blur:"\u6a21\u7cca",Bold:"\u52a0\u7c97",Brightness:"\u66dd\u5149\u5ea6",Bubble:"\u6c14\u6ce1",Cancel:"\u53d6\u6d88",Center:"\u5c45\u4e2d",Circle:"\u5706",Color:"\u989c\u8272","Color Filter":"\u989c\u8272\u6ee4\u955c",Crop:"\u88c1\u5207",Custom:"\u81ea\u5b9a\u4e49","Custom icon":"\u81ea\u5b9a\u4e49\u56fe\u6807",Delete:"\u5220\u9664",DeleteAll:"\u5220\u9664\u5168\u90e8","Delete-all":"\u5168\u90e8\u5220\u9664",Distance:"\u5f3a\u5ea6",Download:"\u4fdd\u5b58\u5e76\u9000\u51fa",Draw:"\u753b",Emboss:"\u6d6e\u96d5",Fill:"\u586b\u5145",Filter:"\u66f4\u591a\u8bbe\u7f6e",Flip:"\u7ffb\u8f6c","Flip X":"\u6c34\u5e73\u7ffb\u8f6c","Flip Y":"\u5782\u76f4\u7ffb\u8f6c",Free:"\u66f2\u7ebf",Grayscale:"\u7070\u9636",Heart:"\u5fc3",Icon:"\u56fe\u6807",Invert:"\u53cd\u76f8",Italic:"\u659c\u4f53",Left:"\u5de6\u5bf9\u9f50",Load:"\u6253\u5f00\u56fe\u7247","Load Mask Image":"\u52a0\u8f7d\u8499\u7248\u56fe\u50cf",Location:"\u4f4d\u7f6e",Mask:"\u906e\u7f69",Multiply:"\u989c\u8272\u52a0\u6df1",Noise:"\u566a\u70b9",Pixelate:"\u50cf\u7d20\u5316",Polygon:"\u591a\u8fb9\u5f62",Range:"\u8303\u56f4",Rectangle:"\u957f\u65b9\u5f62",Redo:"\u91cd\u505a","Remove White":"\u53bb\u9664\u767d\u8272",Reset:"\u91cd\u7f6e",Right:"\u53f3\u5bf9\u9f50",Rotate:"\u65cb\u8f6c",Sepia:"\u68d5\u8910\u8272",Sepia2:"\u68d5\u8910\u82722",Shape:"\u5f62\u72b6",Sharpen:"\u9510\u5316",Square:"\u6b63\u65b9\u5f62","Star-1":"\u661f\u661f-1","Star-2":"\u661f\u661f-2",Straight:"\u76f4\u7ebf",Stroke:"\u63cf\u8fb9",Text:"\u6587\u672c","Text size":"\u5b57\u4f53\u5927\u5c0f",Threshold:"\u9608\u503c",Tint:"\u6df7\u5408\u989c\u8272",Triangle:"\u4e09\u89d2\u5f62",Underline:"\u4e0b\u5212\u7ebf",Undo:"\u64a4\u6d88",Value:"\u503c"}),f=function(e,t){window.parent&&window.parent.postMessage({event:"image-".concat(e),data:t},"*")},v=function(e){Object(r.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(i.a)(this,n);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a)))._root=void 0,e._editor=void 0,e.onLoadImage=function(t){if(e._root){var n=(t=t||"").split("/");e.createEditor(t,n[n.length-1]),window.saveAs=function(e,t){f("save",{blob:e})}}},e.onExit=function(){f("exit",{})},e}return Object(a.a)(n,[{key:"componentDidMount",value:function(){var e=Object(h.g)(window.location.href).url;this.onLoadImage(e)}},{key:"createEditor",value:function(e,t){var n=this;this._editor&&this._editor.destroy(),this._editor=new u.a(this._root,{cssMaxWidth:900,cssMaxHeight:500,selectionStyle:{cornerSize:20,rotatingPointOffset:70},includeUI:{loadImage:{path:e,name:t},locale:p,initMenu:"filter",menuBarPosition:"bottom"},usageStatistics:!1});var o=window.fabric;o&&o.util.loadImage(e,(function(o,i){i&&n.recreateEditor(e,t)}),null,"Anonymous")}},{key:"recreateEditor",value:function(e,t){var n=this,o=window.proxyManager;o&&o.download?o.download(e,(function(e){"string"===typeof e&&n.createEditor(e,t)})):f("error",{})}},{key:"render",value:function(){var e=this;return Object(o.jsxs)("div",{className:"image-editor-wraper",children:[Object(o.jsx)("div",{className:"image-editor",ref:function(t){e._root=t}}),Object(o.jsx)("button",{onClick:this.onExit,className:"tui-image-editor-exit-btn",children:"\u9000\u51fa"})]})}}]),n}(c.a.Component)},263:function(e,t,n){"use strict";n.r(t);var o=n(1),i=(n(0),n(35)),a=n.n(i),r=n(183);a.a.render(Object(o.jsx)(r.default,{}),document.getElementById("root"))},264:function(e,t,n){},269:function(e,t){},270:function(e,t){},271:function(e,t){},527:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n(44),i=n(7),a=n(6),r=n(529),s=function(){function e(){Object(i.a)(this,e)}return Object(a.a)(e,null,[{key:"isSingleTag",value:function(e){return!!e.tagName&&["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"].includes(e.tagName)}},{key:"isLineBreakTag",value:function(e){return!!e&&!!e.tagName&&["BR","WBR"].includes(e.tagName)}},{key:"make",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=document.createElement(e);Array.isArray(n)?(t=a.classList).add.apply(t,Object(o.a)(n)):n&&a.classList.add(n);for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&a.setAttribute(r,i[r]);return a}},{key:"text",value:function(e){return document.createTextNode(e)}},{key:"icon",value:function(e){var t=document.createElement("i");return t.classList.add("bei-".concat(e)),t.classList.add("icon--".concat(e)),t}},{key:"append",value:function(e,t){Array.isArray(t)?t.forEach((function(t){return e.appendChild(t)})):e.appendChild(t)}},{key:"prepend",value:function(e,t){Array.isArray(t)?(t=t.reverse()).forEach((function(t){return e.prepend(t)})):e.prepend(t)}},{key:"swap",value:function(e,t){var n=document.createElement("div"),o=e.parentNode;o&&(o.insertBefore(n,e),o.insertBefore(e,t),o.insertBefore(t,n),o.removeChild(n))}},{key:"find",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>1?arguments[1]:void 0;return e.querySelector(t)}},{key:"get",value:function(e){return document.getElementById(e)}},{key:"findAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>1?arguments[1]:void 0;return e.querySelectorAll(t)}},{key:"isVisible",value:function(e){for(var t=!0,n="none"!=getComputedStyle(e).display&&"hidden"!=getComputedStyle(e).visibility;t&&n;)(e=e.parentNode)&&e!==document.body&&11!==e.nodeType&&!e.classList.contains("beui-block__content")?n="none"!=getComputedStyle(e).display&&"hidden"!=getComputedStyle(e).visibility:t=!1;return n}},{key:"findAllInputs",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return r.a(t.querySelectorAll(e.allInputsSelector+","+n.join(","))).reduce((function(e,t){return[].concat(Object(o.a)(e),[t])}),[])}},{key:"findVisibleInputs",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return r.a(t.querySelectorAll(e.allInputsSelector+","+n.join(","))).reduce((function(t,n){return e.isVisible(n)?[].concat(Object(o.a)(t),[n]):Object(o.a)(t)}),[])}},{key:"getDeepestNode",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=n?"lastChild":"firstChild",i=n?"previousSibling":"nextSibling";if(t&&t.nodeType===Node.ELEMENT_NODE&&t[o]){var a=t[o];if(e.isSingleTag(a)&&!e.isNativeInput(a)&&!e.isLineBreakTag(a)){if(!a[i])return a.parentNode;a=a[i]}return this.getDeepestNode(a,n)}return t}},{key:"isElement",value:function(e){return!r.l(e)&&(e&&e.nodeType&&e.nodeType===Node.ELEMENT_NODE)}},{key:"isFragment",value:function(e){return!r.l(e)&&(e&&e.nodeType&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE)}},{key:"isContentEditable",value:function(e){return"true"===e.contentEditable}},{key:"isNativeInput",value:function(e){return!(!e||!e.tagName)&&["INPUT","TEXTAREA"].includes(e.tagName)}},{key:"canSetCursor",value:function(t){var n=!0;if(e.isNativeInput(t))switch(t.type){case"file":case"checkbox":case"radio":case"hidden":case"submit":case"button":case"image":case"reset":n=!1}else n=e.isContentEditable(t);return n}},{key:"isNodeEmpty",value:function(e){var t;return!(this.isSingleTag(e)&&!this.isLineBreakTag(e))&&(!(t=this.isElement(e)&&this.isNativeInput(e)?e.value:(t=e.textContent&&e.textContent.replace("\u200b",""))&&t.replace(/[\u200B-\u200D\uFEFF]/g,""))||0===t.trim().length)}},{key:"isLeaf",value:function(e){return!!e&&0===e.childNodes.length}},{key:"isEmpty",value:function(e){e.normalize();for(var t=[e];t.length>0;)if(e=t.shift()){if(this.isLeaf(e)&&!this.isNodeEmpty(e))return!1;e.childNodes&&t.push.apply(t,Object(o.a)(Array.from(e.childNodes)))}return!0}},{key:"isHTMLString",value:function(t){var n=e.make("div");return n.innerHTML=t,n.childElementCount>0}},{key:"getContentLength",value:function(t){return e.isNativeInput(t)?t.value.length:t.nodeType===Node.TEXT_NODE?t.length:t.textContent?t.textContent.length:0}},{key:"containsOnlyInlineElements",value:function(t){var n;r.o(t)?(n=document.createElement("div")).innerHTML=t:n=t;return Array.from(n.children).every((function t(n){var o=n.tagName.toLowerCase();return!e.inlineBlockElements.includes(o)&&!e.blockElements.includes(o)&&Array.from(n.children).every(t)}))}},{key:"getDeepestBlockElements",value:function(t){return e.containsOnlyInlineElements(t)?[t]:Array.from(t.children).reduce((function(t,n){return[].concat(Object(o.a)(t),Object(o.a)(e.getDeepestBlockElements(n)))}),[])}},{key:"getHolder",value:function(e){return r.o(e)?document.getElementById(e):e}},{key:"isExtensionNode",value:function(e){return e&&["GRAMMARLY-EXTENSION"].includes(e.nodeName)}},{key:"isAnchor",value:function(e){return"a"===e.tagName.toLowerCase()}},{key:"removeNodeStyle",value:function(t){t.nodeType===Node.ELEMENT_NODE&&(t.removeAttribute("style"),t.childNodes.forEach((function(t){e.removeNodeStyle(t)})))}},{key:"allInputsSelector",get:function(){return"[contenteditable], textarea, input:not([type]), "+["text","password","email","number","search","tel","url"].map((function(e){return'input[type="'.concat(e,'"]')})).join(", ")}},{key:"blockElements",get:function(){return["address","article","aside","blockquote","canvas","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","noscript","ol","output","p","pre","ruby","section","table","tr","tfoot","ul","video","tasklist","taskli"]}},{key:"inlineBlockElements",get:function(){return["img"]}}]),e}()},529:function(e,t,n){"use strict";n.d(t,"q",(function(){return i})),n.d(t,"r",(function(){return a})),n.d(t,"k",(function(){return s})),n.d(t,"m",(function(){return l})),n.d(t,"o",(function(){return c})),n.d(t,"i",(function(){return d})),n.d(t,"l",(function(){return u})),n.d(t,"j",(function(){return h})),n.d(t,"n",(function(){return p})),n.d(t,"a",(function(){return f})),n.d(t,"e",(function(){return v})),n.d(t,"g",(function(){return b})),n.d(t,"p",(function(){return m})),n.d(t,"d",(function(){return g})),n.d(t,"c",(function(){return k})),n.d(t,"b",(function(){return y})),n.d(t,"h",(function(){return C})),n.d(t,"s",(function(){return _})),n.d(t,"f",(function(){return x}));var o;n(21),n(32);!function(e){e.VERBOSE="VERBOSE",e.INFO="INFO",e.WARN="WARN",e.ERROR="ERROR"}(o||(o={}));var i={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,LEFT:37,UP:38,DOWN:40,RIGHT:39,INSERT:45,DELETE:46,META:91},a={LEFT:0,WHEEL:1,RIGHT:2,BACKWARD:3,FORWARD:4};function r(e){var t=Object.prototype.toString.call(e).match(/\s([a-zA-Z]+)/);return t?t[1].toLowerCase():""}function s(e){return"function"===r(e)||"asyncfunction"===r(e)}function l(e){return"object"===r(e)}function c(e){return"string"===r(e)}function d(e){return"boolean"===r(e)}function u(e){return"number"===r(e)}function h(e){return!e||0===Object.keys(e).length&&e.constructor===Object}function p(e){return e>47&&e<58||32===e||13===e||229===e||8===e||e>64&&e<91||e>95&&e<112||e>185&&e<193||e>218&&e<223}function f(e){return Array.prototype.slice.call(e)}function v(e,t){return function(){var n=this,o=arguments;window.setTimeout((function(){return e.apply(n,o)}),t)}}function b(e){return e.name.split(".").pop()||""}function m(e){return/^[-\w]+\/([-+\w]+|\*)$/.test(e)}function g(e,t,n){var o;return function(){var i=this,a=arguments,r=function(){o=null,n||e.apply(i,a)},s=n&&!o;window.clearTimeout(o),o=window.setTimeout(r,t),s&&e.apply(i,a)}}function k(e){return e[0].toUpperCase()+e.slice(1)}document.documentElement;function y(e){var t=function(){var e={win:!1,mac:!1,x11:!1,linux:!1},t=Object.keys(e).find((function(e){return-1!==navigator.appVersion.toLowerCase().indexOf(e)}));return t?(e[t]=!0,e):e}();return e=e.replace(/shift/gi,"\u21e7").replace(/backspace/gi,"\u232b").replace(/enter/gi,"\u23ce").replace(/up/gi,"\u2191").replace(/left/gi,"\u2192").replace(/down/gi,"\u2193").replace(/right/gi,"\u2190").replace(/escape/gi,"\u238b").replace(/insert/gi,"Ins").replace(/delete/gi,"\u2421").replace(/\+/gi," + "),e=t.mac?e.replace(/ctrl|cmd/gi,"\u2318").replace(/alt/gi,"\u2325"):e.replace(/cmd/gi,"Ctrl").replace(/windows/gi,"WIN")}function C(e){try{return new URL(e).href}catch(t){}return"//"===e.substring(0,2)?window.location.protocol+e:window.location.origin+e}function _(e){window.open(e,"_blank")}function x(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"".concat(e).concat(Math.floor(1e8*Math.random()).toString(16))}},531:function(e,t,n){"use strict";n.r(t),n.d(t,"make",(function(){return i})),n.d(t,"fragmentToString",(function(){return a})),n.d(t,"moveCaretToEnd",(function(){return r})),n.d(t,"moveCaretToStart",(function(){return s})),n.d(t,"isEmpty",(function(){return l})),n.d(t,"getHigherLevelSiblings",(function(){return c})),n.d(t,"extractFragmentFromCaretPositionTillTheEnd",(function(){return d})),n.d(t,"focus",(function(){return u})),n.d(t,"isAtStart",(function(){return h})),n.d(t,"isMac",(function(){return p}));var o=n(44);function i(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=document.createElement(e);Array.isArray(n)?(t=a.classList).add.apply(t,Object(o.a)(n)):n&&a.classList.add(n);for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&a.setAttribute(r,i[r]);return a}function a(e){var t=i("div");return t.appendChild(e),l(t)?"":t.innerHTML}function r(e,t){var n=t.getRangeAt(0);e&&(n.setStartAtLast(e),n.collapse(!0).select(!0))}function s(e,t){var n=t.getRangeAt(0);e&&(n.setStartAtFirst(e),n.collapse(!0).select(!0))}function l(e){return 0===(e.textContent||"").trim().length}function c(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"left",n=e,o=[];n.parentNode&&"true"!==n.parentNode.contentEditable;)n=n.parentNode;for(var i="left"===t?"previousSibling":"nextSibling";n[i];)n=n[i],o.push(n);return o}function d(e){if(e.rangeCount){var t=e.getRangeAt(0),n=t.startContainer;n&&n.nodeType!==Node.ELEMENT_NODE&&(n=n.parentNode);var o=n&&n.closest("[contenteditable]");if(o){t.deleteContents();var i=t.cloneRange();return i.selectNodeContents(o),i.setStart(t.endContainer,t.endOffset),i.extractContents()}}}function u(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(n)e.setCursor(t,0);else{var o=e.getRangeAt(0);o.setStartAtLast(t).setCursor(!1,!0)}}function h(e){if(e.focusOffset)return!1;var t=e.focusNode;return!!t&&c(t,"left").every((function(e){return l(e)}))}var p=/macintosh|mac os x/i.test(navigator.userAgent)},534:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var o=n(7),i=n(6),a=n(527),r=function(){function e(t){Object(o.a)(this,e),this._cmdName=void 0,this._shortcut=void 0,this._title=void 0,this.blockEditable=void 0,this.nodes={button:void 0},this._cmdName=t.cmdName,this._shortcut=t.shortcut,this._title=t.title,this.blockEditable=t.blockEditable}return Object(i.a)(e,[{key:"render",value:function(){return this.nodes.button=document.createElement("button"),this.nodes.button.type="button",this.nodes.button.classList.add(this.Class.button,this.Class.buttonModifier),this.nodes.icon=a.a.icon(this._cmdName,12,14),this.nodes.button.appendChild(this.nodes.icon),this.nodes.button}},{key:"surround",value:function(e,t){t.execCommand(this.cmdName)}},{key:"selectionChange",value:function(e,t){var n=1===t.queryCommandState(this.cmdName);return this.nodes.button&&this.nodes.button.classList.toggle(this.Class.buttonActive,n),n}},{key:"destroy",value:function(){}},{key:"title",get:function(){return this._title}},{key:"cmdName",get:function(){return this._cmdName}},{key:"shortcut",get:function(){return this._shortcut}},{key:"Class",get:function(){return{button:"beui-inline-tool",buttonActive:"beui-inline-tool--active",buttonModifier:"beui-inline-tool--".concat(this._cmdName),buttonBottomColor:"beui-inline-tool__color",actions:"beui-inline-tool-actions",actionsShowed:"beui-inline-tool-actions--showed"}}}]),e}()},552:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return u}));var o=n(7),i=n(6),a=n(573),r=n(160),s=n(10),l=n(9),c=n(534),d=n(527),u=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(i.a)(n,[{key:"render",value:function(){var e=this,t=Object(a.a)(Object(r.a)(n.prototype),"render",this).call(this),o=d.a.icon("arrow",12,14);return this.nodes.toggler=o,o.addEventListener("click",(function(t){t.stopPropagation(),t.preventDefault(),e.toggleActions()})),t.appendChild(o),t}},{key:"hideActions",value:function(){var e=this;if(this.nodes.actions){var t,n=null===(t=this.nodes.actions.parentElement)||void 0===t?void 0:t.querySelectorAll(".".concat(this.Class.actionsShowed));n&&n.forEach((function(t){t!==e.nodes.actions&&t.classList.toggle(e.Class.actionsShowed,!1)}))}}},{key:"toggleActions",value:function(){var e,t,n=!(null===(e=this.nodes.actions)||void 0===e?void 0:e.classList.contains(this.Class.actionsShowed));n&&this.hideActions(),null===(t=this.nodes.actions)||void 0===t||t.classList.toggle(this.Class.actionsShowed,n)}}]),n}(c.default)},553:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return l}));var o=n(7),i=n(6),a=n(527),r=n(115),s=n(17),l=function(){function e(t){var n=this;Object(o.a)(this,e),this._blockEditable=void 0,this._nodes={},this._settingsButtonActive="",this._cmdName="align-left",this._blockEditable=t.blockEditable,this._cmdName=t.cmdName||this._cmdName,this._blockEditable.editable.registerCommand((function(){return{cmdName:n._cmdName,execCommand:function(e){var t=n._cmdName.match(/align-(.*)/);t&&n.align(t[1])},queryCommandState:function(){var e=n.api.content.activeBlock;return e&&"align-".concat(e.align)===n._cmdName?1:0}}})),this._blockEditable.editable.on("selectionchange",(function(){n.updateAlignButtonState()}))}return Object(i.a)(e,null,[{key:"key",get:function(){return"align-left"}}]),Object(i.a)(e,[{key:"render",value:function(t){var n=this,o=a.a.make("div",[e.Class.button,e.Class.wrapper],{});o.appendChild(a.a.icon(this._cmdName,14,14)),this.api.content.readOnlyMutableListeners.on(o,"click",(function(e){return n.handleClick(e,o)}),!1),this._settingsButtonActive=t.settingsButtonActive;var i=this._blockEditable.getLang("toolbar.settings.".concat(Object(s.q)(this._cmdName)));return this.api.tooltip.onHover(o,i),this._nodes.button=o,this.updateAlignButtonState(),o}},{key:"handleClick",value:function(e,t){this._blockEditable.editable.execCommand(this._cmdName)}},{key:"align",value:function(e){var t=this.api.content.activeBlock;t&&(t.align=e)}},{key:"updateAlignButtonState",value:function(){var e=this.api.content.activeBlock;e&&this._nodes.button&&this._nodes.button.classList.toggle(this._settingsButtonActive,e&&"align-".concat(e.align)===this._cmdName)}},{key:"api",get:function(){return this._blockEditable.state}}]),e}();l.Class={button:"beui-settings__button",wrapper:"beui-tune-align"},r.d.regiester(l)},562:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return l}));var o=n(7),i=n(6),a=n(633),r=n(251),s=n(17),l=function(){function e(t){Object(o.a)(this,e),this._editable=void 0,this._imageEditor=void 0,this._editable=t.editable}return Object(i.a)(e,[{key:"edit",value:function(e,t){var n=this;if(!this._imageEditor){var o=this._editable.getOpt("uploadImage");this._imageEditor=new a.default((function(e){var i="".concat(Date.now());r.b.loading({content:"\u4fdd\u5b58\u56fe\u7247\u4e2d...",duration:0,key:i}),o(e).then((function(e){r.b.destroy(i),e?(t(e.url),n._imageEditor.stopEditing()):r.b.error("\u4fdd\u5b58\u56fe\u7247\u5931\u8d25")}))}),(function(){s.i||r.b.error("\u56fe\u7247\u53ef\u80fd\u56e0\u6e90\u7ad9\u7981\u6b62\u8de8\u57df\u8bbf\u95ee\u4e0d\u80fd\u7f16\u8f91\uff0c\u8bf7\u4e0b\u8f7d\u300c\u684c\u9762\u8f6f\u4ef6\u7aef\u300d\u8fdb\u884c\u7f16\u8f91")}))}var i="".concat(Date.now());r.b.loading({content:"\u52a0\u8f7d\u4e2d...",duration:3,key:i}),this._imageEditor.startEditing(e).then((function(){r.b.destroy(i)})).catch((function(){r.b.destroy(i),r.b.error("\u52a0\u8f7d\u51fa\u9519\u4e86"),n._imageEditor.stopEditing()}))}}]),e}()},563:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return j}));var o=n(21),i=n.n(o),a=n(32),r=n(11),s=n(7),l=n(6),c=n(44),d=n(115),u=n(72),h=n(669),p=n(670),f=n(671).default,v=n(672).default,b=n(673).default,m=n(674).default,g=n(675).default,k=n(676).default,y=n(677).default;function C(e,t,n){return{regex:e,data:function(o,i){var a=o.match(e),r="";if(a){var s=(r=i(a[1])).match(/<p>(.*)<\/p>/);s&&(r=s[1])}return{data:{level:t,content:r},icon:n}}}}var _=C(/^#\s*(([^#|$].*)|$)/,1,v),x=C(/^##\s*(([^#|$].*)|$)/,2,b),E=C(/^###\s*(([^#|$].*)|$)/,3,m),O=C(/^####\s*(([^#|$].*)|$)/,4,g),T=C(/^#####\s*(([^#|$].*)|$)/,5,k),w=C(/^######\s*(([^#|$].*)|$)/,6,y);function S(e,t){var n=[];return n.push({level:Math.min(6,t),content:e.content}),n=e.items.reduce((function(e,n){return[].concat(Object(c.a)(e),Object(c.a)(S(n,t+1)))}),n)}var j=function(){function e(t){Object(s.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._nodes={},this._settingsButtons=[],this._blockEditable=t.blockEditable,this._data=t.data||e.defaultData}return Object(l.a)(e,null,[{key:"convertData",value:function(e,t){if("list"===e.key){var n=e.data,o=1===n.items.length?1:2;return n.items.reduce((function(e,t){return[].concat(Object(c.a)(e),Object(c.a)(S(t,o)))}),[])}var i=e.data;return[Object(r.a)({level:2},i)]}},{key:"toHtml",value:function(t){return"<h".concat(t.level,' class="be-').concat(e.key,'">').concat(t.content||"","</h").concat(t.level,">")}},{key:"toData",value:function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.querySelector(["H1","H2","H3","H4","H5","H6"].join(","));return{content:u.a.removeBlockChildren(n||t).innerHTML||"",level:n?parseInt(n.tagName.replace(/[^\d]*/,"")):void 0}}},{key:"toolbox",get:function(){return{icon:f,title:"Header",commands:[_,x,E,O,T,w]}}},{key:"sanitize",get:function(){return{level:!1,content:{}}}},{key:"acceptConversionComps",get:function(){return["paragraph","list"]}},{key:"enabledInlineTools",get:function(){return!0}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{content:"",level:2}}},{key:"builtinTypesets",get:function(){return{default:p}}},{key:"pasteConfig",get:function(){return{tags:["H1","H2","H3","H4","H5","H6"]}}},{key:"CSS",get:function(){return h}}]),Object(l.a)(e,[{key:"renderBlock",value:function(e){var t=this._data;return this._nodes.target=this.make(),this._nodes.target.innerHTML=t.content||"",this._nodes.target}},{key:"renderSettings",value:function(e){var t=this,n=document.createElement("DIV");return this.levels.length<=1||this.levels.forEach((function(o){var i=document.createElement("SPAN");i.classList.add(e.settingsButton),t.currentLevel.number===o.number&&i.classList.add(e.settingsButtonActive),i.innerHTML=o.svg,i.dataset.level="".concat(o.number),i.addEventListener("click",(function(){t.setLevel(o.number,e)})),n.appendChild(i),t._settingsButtons.push(i)})),n}},{key:"save",value:function(){return this.data}},{key:"merge",value:function(){var e=Object(a.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={content:this.data.content+t.content,level:this.data.level},this.data=n;case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onPaste",value:function(e){var t=e.detail.data,n=this.defaultLevel.number;switch(t.tagName){case"H1":n=1;break;case"H2":n=2;break;case"H3":n=3;break;case"H4":n=4;break;case"H5":n=5;break;case"H6":n=6}this.data={level:n,content:t.innerHTML}}},{key:"destroy",value:function(){}},{key:"make",value:function(){var t=document.createElement(this.currentLevel.tag);return t.setAttribute("class","be-".concat(e.key)),t.setAttribute("contenteditable","true"),t.setAttribute("placeholder",this.currentLevel.tag.toUpperCase()),t}},{key:"normalizeData",value:function(e){var t={content:"",level:this.defaultLevel.number};return"object"!==typeof e&&(e={content:""}),t.content=e.content||"",t.level=parseInt(e.level)||this.defaultLevel.number,t}},{key:"setLevel",value:function(e,t){this.data={level:e,text:this.data.text},this._settingsButtons.forEach((function(n){n.classList.toggle(t.settingsButtonActive,parseInt(n.dataset.level||"1")===e)}));var n=this._blockEditable.state,o=n.content,i=n.cursor;n.toolbar.close(),o.setActiveBlockBy(this._nodes.target),i.setToBlock(o.activeBlock,i.positions.END)}},{key:"key",get:function(){return"H".concat(this._data.level)}},{key:"data",get:function(){return this._data.content=this._nodes.target.innerHTML,this._data.level=this.currentLevel.number,this._data},set:function(e){if(this._data=this.normalizeData(e),void 0!==e.level&&this._nodes.target.parentNode){var t=this.make();t.innerHTML=this._nodes.target.innerHTML,this._nodes.target.parentNode.replaceChild(t,this._nodes.target),this._nodes.target=t;var n=t.closest(".beui-block");n&&(n.dataset.key=this.key)}void 0!==e.content&&(this._nodes.target.innerHTML=this._data.content||"")}},{key:"currentLevel",get:function(){var e=this,t=this.levels.find((function(t){return t.number===e._data.level}));return t||(t=this.defaultLevel),t}},{key:"defaultLevel",get:function(){return this.levels[1]}},{key:"levels",get:function(){return[{number:1,tag:"H1",svg:v},{number:2,tag:"H2",svg:b},{number:3,tag:"H3",svg:m},{number:4,tag:"H4",svg:g},{number:5,tag:"H5",svg:k},{number:6,tag:"H6",svg:y}]}}]),e}();j.key="header",d.a.regiester(j)},564:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var o=n(21),i=n.n(o),a=n(32),r=n(7),s=n(6),l=n(44),c=n(115),d=n(72),u=n(678),h=n(679),p=n(680).default;/macintosh|mac os x/i.test(navigator.userAgent);function f(e){var t=[];return t.push({content:e.content}),t=e.items.reduce((function(e,t){return[].concat(Object(l.a)(e),Object(l.a)(f(t)))}),t)}var v=function(){function e(t){Object(r.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._nodes={},this._blockEditable=t.blockEditable,this._data=t.data||e.defaultData}return Object(s.a)(e,null,[{key:"toHtml",value:function(t){return'<p class="be-'.concat(e.key,'">').concat(t.content||"","</p>")}},{key:"toData",value:function(e){var t=document.createElement("div");return t.innerHTML=e,d.a.removeBlockChildren(t),{content:t.innerHTML||""}}},{key:"convertData",value:function(e,t){if("list"===e.key){var n=e.data;n.items.length;return n.items.reduce((function(e,t){return[].concat(Object(l.a)(e),Object(l.a)(f(t)))}),[])}if("todolist"===e.key)return e.data.items.reduce((function(e,t){return[].concat(Object(l.a)(e),[{content:t.content}])}),[])}},{key:"toolbox",get:function(){return{icon:p,title:"Text"}}},{key:"sanitize",get:function(){return{content:{br:!0}}}},{key:"acceptConversionComps",get:function(){return!0}},{key:"enabledInlineTools",get:function(){return!0}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{content:""}}},{key:"builtinTypesets",get:function(){return{default:h}}},{key:"CSS",get:function(){return u}},{key:"pasteConfig",get:function(){return{tags:["P"]}}}]),Object(s.a)(e,[{key:"renderBlock",value:function(e){var t=this._data;return this._nodes.target=this.make(),this._nodes.target.innerHTML=t.content||"",this._nodes.target}},{key:"renderSettings",value:function(e){return null}},{key:"save",value:function(){return this.data}},{key:"merge",value:function(){var e=Object(a.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={content:this.data.content+t.content},this.data=n;case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onPaste",value:function(e){var t=e.detail.data;this.data={content:t.innerHTML||""}}},{key:"destroy",value:function(){}},{key:"make",value:function(){var t=document.createElement("p");return t.setAttribute("class","be-".concat(e.key)),t.setAttribute("contenteditable","true"),t.setAttribute("placeholder","\u6309Tab\u952e\uff0c\u6216\u8f93\u5165Markdown\u540e\u6309Enter\u952e"),t}},{key:"normalizeData",value:function(e){var t={content:""};return"object"!==typeof e&&(e={content:""}),t.content=e.content||"",t}},{key:"data",get:function(){return this._data.content=this._nodes.target.innerHTML,this._data},set:function(e){this._data=this.normalizeData(e),void 0!==this._data.content&&(this._nodes.target.innerHTML=this._data.content)}}]),e}();v.key="paragraph",c.a.regiester(v)},570:function(e,t,n){"use strict";n.r(t),n.d(t,"create",(function(){return i})),n.d(t,"getCoords",(function(){return a})),n.d(t,"getSideByCoords",(function(){return r}));var o=n(531);function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=Object(o.make)(e,t,n);if(i)for(var r=0;r<i.length;r++)a.appendChild(i[r]);return a}function a(e){var t=e.getBoundingClientRect();return{y1:Math.floor(t.top+window.pageYOffset),x1:Math.floor(t.left+window.pageXOffset),x2:Math.floor(t.right+window.pageXOffset),y2:Math.floor(t.bottom+window.pageYOffset)}}function r(e,t,n){var o,i=Math.min(10,e.y2-e.y1);return t-e.x1>=-1&&t-e.x1<=i+1&&(o="left"),e.x2-t>=-1&&e.x2-t<=i+1&&(o="right"),n-e.y1>=-1&&n-e.y1<=i+1&&(o="top"),e.y2-n>=-1&&e.y2-n<=i+1&&(o="bottom"),o}},571:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var o=n(7),i=n(6),a=n(10),r=n(9),s=n(527),l=n(115),c=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){var i;return Object(o.a)(this,n),(i=t.call(this,{cmdName:e.cmdName||"link",shortcut:e.shortcut||"CMD+K",title:e.title||"Link",blockEditable:e.blockEditable})).ENTER_KEY=13,i.cacheRange=void 0,i._highligt=void 0,i}return Object(i.a)(n,null,[{key:"key",get:function(){return"link"}},{key:"sanitize",get:function(){return{a:{href:!0,target:"_blank",rel:"nofollow"}}}}]),Object(i.a)(n,[{key:"render",value:function(){var e=this;this.nodes.button=document.createElement("button"),this.nodes.button.type="button",this.nodes.button.classList.add(this.Class.button,this.Class.buttonModifier),this.nodes.button.appendChild(s.a.icon(this.cmdName,12,14)),this.nodes.button.appendChild(s.a.icon("unlink",12,14));var t=s.a.icon("arrow",12,14);return this.nodes.toggler=t,t.addEventListener("click",(function(t){t.stopPropagation(),t.preventDefault(),e.toggleActions()})),this.nodes.button.appendChild(t),this.nodes.button}},{key:"renderActions",value:function(){var e=this;return this.nodes.actions=document.createElement("input"),this.nodes.actions.setAttribute("placeholder",this.blockEditable.getLang("toolbar.inline.linkPlaceholder")),this.nodes.actions.classList.add(this.linkClass.link),this.nodes.actions.classList.add(this.Class.actions),this.nodes.actions.addEventListener("keydown",(function(t){t.keyCode===e.ENTER_KEY&&e.enterPressed(t),t.stopPropagation()})),this.nodes.actions.addEventListener("focus",(function(){e.setHighlightRange()})),this.nodes.actions}},{key:"surround",value:function(e,t){t.selection;if(e&&t.queryCommandValue(this.cmdName))return t.execCommand("unlink"),void this.closeActions();this.cacheRange=e?e.cloneRange():null,this.toggleActions()}},{key:"selectionChange",value:function(e,t){var n=t.queryCommandValue(this.cmdName);if(n){var o,i;null===(o=this.nodes.button)||void 0===o||o.classList.add(this.linkClass.buttonUnlink),null===(i=this.nodes.button)||void 0===i||i.classList.add(this.Class.buttonActive);var a=n.getAttribute("href");this.nodes.actions&&(this.nodes.actions.value="null"!==a?a:"")}else{var r,s;null===(r=this.nodes.button)||void 0===r||r.classList.remove(this.linkClass.buttonUnlink),null===(s=this.nodes.button)||void 0===s||s.classList.remove(this.Class.buttonActive)}return this.removeHighlightRange(),this.cacheRange=e.getRangeAt(0).cloneRange(),!!n}},{key:"clear",value:function(){this.closeActions()}},{key:"toggleActions",value:function(){var e;(null===(e=this.nodes.actions)||void 0===e?void 0:e.classList.contains(this.Class.actionsShowed))?this.closeActions(!1):(this.hideActions(),this.openActions(!0))}},{key:"openActions",value:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.blockEditable.editable.selection;null===(e=this.nodes.actions)||void 0===e||e.classList.add(this.Class.actionsShowed),n&&setTimeout((function(){var e;null===(e=t.nodes.actions)||void 0===e||e.focus()}),300)}},{key:"closeActions",value:function(){this.blockEditable.editable.selection;this.nodes.actions&&(this.nodes.actions.classList.remove(this.Class.actionsShowed),this.nodes.actions.value=""),this.removeHighlightRange()}},{key:"enterPressed",value:function(e){var t,n=this.blockEditable.editable,o=(null===(t=this.nodes.actions)||void 0===t?void 0:t.value)||"";if(!o.trim())return n.execCommand("unlink"),e.preventDefault(),void this.closeActions();this.validateURL(o)?(o=this.prepareLink(o),this.cacheRange&&this.cacheRange.select(!0),this.removeHighlightRange(),n.execCommand("link",{href:o}),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),this.blockEditable.state.inlineToolbar.close()):this.blockEditable.state.notifier.show({message:"Pasted link is not valid.",style:"error"})}},{key:"validateURL",value:function(e){return!/\s/.test(e)}},{key:"prepareLink",value:function(e){return e=e.trim(),e=this.addProtocol(e)}},{key:"addProtocol",value:function(e){if(/^(\w+):(\/\/)?/.test(e))return e;var t=/^\/[^/\s]/.test(e),n="#"===e.substring(0,1),o=/^\/\/[^/\s]/.test(e);return t||n||o||(e="http://"+e),e}},{key:"setHighlightRange",value:function(){var e=this.blockEditable.editable,t=e.holder.getBoundingClientRect(),n=t.top,o=t.left;if(this.cacheRange){var i=this.makeHighlightCanvas();if(i&&this._highligt){var a=e.document.createRange(),r=i.getContext("2d");if(!r)return;a.setStart(this.cacheRange.startContainer,this.cacheRange.startOffset),a.setEnd(this.cacheRange.endContainer,this.cacheRange.endOffset);var s=a.getClientRects();i.height=this._highligt.offsetHeight,i.width=this._highligt.offsetWidth,r.clearRect(0,0,i.width,i.height),function(e,t,i,a){e.fillStyle=i;for(var r,s=0;r=t[s];s++){var l=r.left-o,c=r.top-n;a&&e.clearRect(l,c,r.width,r.height),e.fillRect(l,c,r.width,r.height)}}(r,s,"rgba(166,210,252,0.3)")}}}},{key:"removeHighlightRange",value:function(){this._highligt&&(this._highligt.remove(),this._highligt=null)}},{key:"makeHighlightCanvas",value:function(){this.removeHighlightRange();var e=this.blockEditable.editable,t=e.holder.parentNode;if(t){var n=e.document.createElement("div");n.setAttribute("id","link-highlight"),n.setAttribute("class","search-highlight"),n.style.cssText="position: absolute;pointer-events: none;top: 0;bottom: 0;right: 0;left: 0",t.appendChild(n),this._highligt=n}var o=e.document.createElement("canvas");return o.style.maxWidth="100%",this._highligt&&this._highligt.appendChild(o),o}},{key:"destroy",value:function(){}},{key:"linkClass",get:function(){return{buttonUnlink:"beui-inline-tool--unlink",link:"beui-inline-tool-input"}}}]),n}(n(552).default);l.b.regiester(c)},572:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return l}));var o=n(7),i=n(6),a=n(527),r=n(115),s=n(17),l=function(){function e(t){var n=this;Object(o.a)(this,e),this._blockEditable=void 0,this._cmdName="insert-line-after",this._insertOffset=1,this._blockEditable=t.blockEditable,this._cmdName=t.cmdName||this._cmdName,this._insertOffset=void 0!==t.insertOffset?t.insertOffset:this._insertOffset,this._blockEditable.editable.registerCommand((function(){return{cmdName:n._cmdName,execCommand:function(e){n.insertLine()},queryCommandState:function(){return n.api.content.activeBlock?0:-1}}}))}return Object(i.a)(e,null,[{key:"key",get:function(){return"insert-line-after"}}]),Object(i.a)(e,[{key:"render",value:function(){var t=this,n=a.a.make("div",[e.Class.button,e.Class.wrapper],{});n.appendChild(a.a.icon(this._cmdName,14,14)),this.api.content.readOnlyMutableListeners.on(n,"click",(function(e){return t.handleClick(e,n)}),!1);var o=this._blockEditable.getLang("toolbar.settings.".concat(Object(s.q)(this._cmdName)));return this.api.tooltip.onHover(n,o),n}},{key:"handleClick",value:function(e,t){this._blockEditable.editable.execCommand(this._cmdName)}},{key:"insertLine",value:function(){var e=this.api.content.activeBlockIndex;if(this.api.content.getBlockByIndex(e)){var t=Math.max(e+this._insertOffset,0);this.api.content.insertDefaultBlockAtIndex(t)}}},{key:"api",get:function(){return this._blockEditable.state}}]),e}();l.Class={button:"beui-settings__button",wrapper:"beui-tune-insert-line"},r.d.regiester(l)},574:function(e,t,n){"use strict";function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((function(t,n){var o=document.createElement("INPUT");o.type="file",e.multiple&&o.setAttribute("multiple","multiple"),e.accept&&o.setAttribute("accept",e.accept),o.style.display="none",document.body.appendChild(o),o.addEventListener("change",(function(e){var n,i=null===(n=e.target)||void 0===n?void 0:n.files;t(i),document.body.removeChild(o)}),!1),o.click()}))}n.r(t),n.d(t,"selectFiles",(function(){return o})),t.default={}},575:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));n(836);var o=window.MathJax;function i(e){return o.tex2svgPromise(e).then((function(e){var t=e.outerHTML.match(/(<svg.*?>.*<\/?svg>)/);return t?t[1]:""}))}function a(e){var t,n=document.createElement("div");n.innerHTML=e;var o=null===(t=n.querySelector("svg"))||void 0===t?void 0:t.cloneNode(!0),i="";if(o){var a=o.getAttribute("width");o.style.width=a||"",o.querySelectorAll("use").forEach((function(e){var t=e.getAttribute("xlink:href");if(t){var n=o.querySelector(t);if(n){var i=n.cloneNode(!0);i.removeAttribute("id");var a=e.attributes,r=document.createElement("g");for(var s in a){var l=a[s];"xlink:href"!==l.name&&r.setAttribute(l.name,l.value)}r.appendChild(i),e.replaceWith(r)}}}));var r=o.querySelector("defs");r&&r.remove(),i=o.outerHTML}return i}},576:function(e,t,n){"use strict";n.r(t),n.d(t,"getHigherLevelSiblings",(function(){return b})),n.d(t,"isAtStart",(function(){return m})),n.d(t,"extractFragmentFromCaretPositionTillTheEnd",(function(){return g})),n.d(t,"default",(function(){return k}));var o=n(21),i=n.n(o),a=n(32),r=n(7),s=n(6),l=n(115),c=n(531),d=n(634),u=n(529),h=n(681),p=n(682),f=n(683),v=n(684).default;function b(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"left",n=e,o=[];n.parentNode&&n.parentNode.classList.contains(d.Constant.text);)n=n.parentNode;for(var i="left"===t?"previousSibling":"nextSibling";n[i];)n=n[i],o.push(n);return o}function m(e){if(e.focusOffset)return!1;var t=e.focusNode;return!!t&&b(t,"left").every((function(e){return Object(u.j)(e)}))}function g(e){if(e.rangeCount){var t=e.getRangeAt(0),n=t.startContainer;n&&n.nodeType!==Node.ELEMENT_NODE&&(n=n.parentNode);var o=n&&n.closest(".".concat(d.Constant.text));if(o){t.deleteContents();var i=t.cloneRange();return i.selectNodeContents(o),i.setStart(t.endContainer,t.endOffset),i.extractContents()}}}var k=function(){function e(t){Object(r.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._nodes={},this._highlight=void 0,this._linesInput="",this._blockEditable=t.blockEditable,this._data=t.data||e.defaultData,this._highlight=new d.default(t.blockEditable)}return Object(s.a)(e,null,[{key:"toHtml",value:function(t,n){var o=n.type,i=t.lines||[];if("zhihu"===o)return'<section class="be-'.concat(e.key,'"><').concat(d.Constant.codeBlockTagName,">").concat(i.join("<br/>"),"</").concat(d.Constant.codeBlockTagName,"></section>");var a=i.map((function(e){return"<".concat(d.Constant.lineTagName,' class="').concat(d.Constant.line,'"><').concat(d.Constant.lineTextTagName,' class="').concat(d.Constant.text,'">').concat(e,"</").concat(d.Constant.lineTextTagName,"></").concat(d.Constant.lineTagName,">")}));return'<section class="be-'.concat(e.key,'"><').concat(d.Constant.codeBlockTagName,">").concat(a.join(""),"</").concat(d.Constant.codeBlockTagName,"></section>")}},{key:"toData",value:function(e){var t=document.createElement("div");return t.innerHTML=e,{lang:"",lines:(t.textContent||"").split("\n")}}},{key:"toMarkdown",value:function(e,t){var n=e.lines||[],o=document.createElement("div"),i=n.map((function(e){return o.innerHTML=e,o.textContent||""}));return"```".concat(e.lang||"","\n").concat(i.join("\n"),"\n```")}},{key:"toolbox",get:function(){return{icon:v,title:"Code",commands:[{regex:/^```.*/,data:function(e,t){return{data:{lang:"",lines:[]}}}}]}}},{key:"sanitize",get:function(){return{lang:!0,lines:!0}}},{key:"acceptConversionComps",get:function(){return!1}},{key:"isLineBreaksEnabled",get:function(){return!0}},{key:"enabledInlineTools",get:function(){return!1}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{lang:"",lines:[]}}},{key:"builtinTypesets",get:function(){return{default:p,common:f}}},{key:"CSS",get:function(){return h}},{key:"pasteConfig",get:function(){return{tags:["PRE"],types:["vscode-editor-data"]}}}]),Object(s.a)(e,[{key:"renderBlock",value:function(e){this._data;return this._linesInput=e.linesInput,this._nodes.target=this.make(),this._nodes.lines=Array.from(this._nodes.target.querySelectorAll(".".concat(d.Constant.line))),this._nodes.target}},{key:"renderSettings",value:function(e){return null}},{key:"save",value:function(){return this.data}},{key:"onPaste",value:function(){var e=Object(a.a)(i.a.mark((function e(t){var n,o,a,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next="tag"===e.t0?3:"type"===e.t0?7:11;break;case 3:return n=t.detail.data,(o=n.textContent||"")&&(this.data=this.getData(o)),e.abrupt("break",11);case 7:return a=t.detail.data,(r=this.getText(a))&&(this.data=this.getData(r)),e.abrupt("break",11);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){}},{key:"make",value:function(){var e=this,t=Object(c.make)("div",[d.Constant.block,this._linesInput]),n=Object(c.make)("pre");if(n.setAttribute("contenteditable","true"),n.setAttribute(d.Constant.langAttr,this._data.lang||""),this._data.lines.length)this._data.lines.forEach((function(t){var o=e.createCodeLine(t);n.appendChild(o)}));else{var o=this.createCodeLine();n.appendChild(o)}return n.addEventListener("keydown",(function(t){switch(t.keyCode){case 13:e.enter(t);break;case 8:e.backspace(t);break;case 46:e.del(t);break;case 9:e.tab(t)}}),!1),n.addEventListener("keyup",(function(t){switch(t.keyCode){case 32:e.spacebar(t)}}),!1),n.addEventListener("blur",(function(t){e._highlight.blur(t)}),!1),n.addEventListener("paste",(function(t){var n=e.getText(t.clipboardData);if(n){var o=e._blockEditable.editable.selection;e._highlight.insertHighlight2Range(n,o.getRangeAt(0)),t.stopPropagation(),t.preventDefault()}})),n.addEventListener("mousedown",(function(t){var n=t.target;if(n&&"CODE"===n.tagName){var o=n.querySelector(".".concat(d.Constant.text));if(o)e._blockEditable.editable.selection.getRangeAt(0).setStartAtLast(o).collapse(!0).select(),t.preventDefault()}})),t.appendChild(n),this._nodes.pre=n,t}},{key:"createCodeLine",value:function(e){e=e||"";var t=Object(c.make)(d.Constant.lineTagName,d.Constant.line),n=Object(c.make)(d.Constant.lineTextTagName,d.Constant.text);return n.innerHTML=e,t.appendChild(n),t}},{key:"spacebar",value:function(e){var t=this._blockEditable.editable.selection,n=this._highlight.getCurrentLine();if(n){var o=t.getRangeAt(0),i=o.createBookmark();this._highlight.mergeCommentLine(n),o.moveToBookmark(i),this._highlight.highlightCurrentLine()}}},{key:"backspace",value:function(e){this._highlight.backspace(e)&&e.stopPropagation()}},{key:"enter",value:function(e){var t,n,o,i=this._blockEditable.state.ui;if(!i.someToolbarOpened||!i.someFlipperButtonFocused){e.preventDefault();var a=this._blockEditable.editable,r=a.selection,s=a.$dom,l=this._blockEditable.state,c=l.content,u=l.cursor,h=l.toolbar,p=r.anchorNode,f=p&&(1!==p.nodeType?null===(t=p.parentElement)||void 0===t?void 0:t.closest(".".concat(d.Constant.line)):p.closest(".".concat(d.Constant.line)));this._nodes.lines=Array.from(this._nodes.target.querySelectorAll(".".concat(d.Constant.line)));var v=this._nodes.lines[this._nodes.lines.length-1],b=null===v||void 0===v||null===(n=v.querySelector(".".concat(d.Constant.text)))||void 0===n?void 0:n.innerHTML.replace("<br>"," ").replace(s.fillCharReg,"").trim(),m=null===v||void 0===v?void 0:v.previousSibling,g=m&&(null===(o=m.querySelector(".".concat(d.Constant.text)))||void 0===o?void 0:o.innerHTML.replace("<br>"," ").replace(s.fillCharReg,"").trim());if(f&&f===v&&!b&&m&&!g){var k=this._nodes.lines.indexOf(f);f&&-1!==k&&(f.remove(),this._nodes.lines.splice(k,1));var y=c.insert();return y&&u.setToBlock(y),h.move(),void e.stopPropagation()}p&&p.parentNode&&this._highlight.splitCodeLine()}}},{key:"del",value:function(e){this._highlight.del(e)&&e.stopPropagation()}},{key:"tab",value:function(e){e.stopPropagation(),e.preventDefault(),this._highlight.tab(e)}},{key:"getData",value:function(e){var t=this._highlight.highlightText(e,""),n=Object(c.make)("pre",[]);n.innerHTML=t.result.value;for(var o=Array.from(n.querySelectorAll(".".concat(d.Constant.line))),i=[],a=0;a<o.length;a++){var r=o[a].querySelector(".".concat(d.Constant.text));if(r){var s=r.innerHTML;i.push(s)}}return{lang:t.result.language||"",lines:i}}},{key:"getText",value:function(e){var t=null===e||void 0===e?void 0:e.types,n="";if(t){var o={};if(t.forEach((function(t){o[t]=(null===e||void 0===e?void 0:e.getData(t))||""})),!(n=o["text/plain"])&&(n=o["text/html"])){var i=document.createElement("div");i.innerHTML=n,n=i.textContent||""}}return n}},{key:"data",get:function(){this._blockEditable.editable.$dom;this._data.lines=[],this._nodes.lines=Array.from(this._nodes.target.querySelectorAll(".".concat(d.Constant.line)));for(var e=0;e<this._nodes.lines.length;e++){var t=this._nodes.lines[e].querySelector(".".concat(d.Constant.text));if(t){var n=t.innerHTML.replace(/<br>/g,"");this._data.lines.push(n)}}return this._data.lang=this._nodes.target.getAttribute(d.Constant.langAttr)||"",this._data},set:function(e){this._data.lines=e.lines||[];var t=this._nodes.target;if(t&&t.parentNode){var n=this.make();t.parentNode.replaceChild(n,t),this._nodes.target=n}}}]),e}();k.key="code",l.a.regiester(k)},577:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return u}));var o=n(7),i=n(6),a=n(115),r=n(531),s=n(687),l=n(688),c=n(689),d=n(690).default,u=function(){function e(t){Object(o.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._nodes={},this._blockEditable=t.blockEditable,this._data=t.data||e.defaultData}return Object(i.a)(e,null,[{key:"toHtml",value:function(t){return'<section class="be-'.concat(e.key,'"><hr/></section>')}},{key:"toData",value:function(e){return{}}},{key:"toolbox",get:function(){return{icon:d,title:"Delimiter",commands:[{regex:/^---?$/,data:function(e,t){return{data:{}}}}]}}},{key:"enabledInlineTools",get:function(){return!1}},{key:"acceptTags",get:function(){return["hr"]}},{key:"defaultData",get:function(){return{}}},{key:"builtinTypesets",get:function(){return{default:l,common:c}}},{key:"CSS",get:function(){return s}},{key:"pasteConfig",get:function(){return{tags:["hr"]}}}]),Object(i.a)(e,[{key:"renderBlock",value:function(e){this._data;return this._nodes.target=this.make(e),this._nodes.target}},{key:"renderSettings",value:function(e){return null}},{key:"save",value:function(){return this.data}},{key:"onPaste",value:function(e){this.data={}}},{key:"destroy",value:function(){}},{key:"make",value:function(t){var n=Object(r.make)("div",["be-".concat(e.key),t.fakeInput]),o=document.createElement("hr");return n.appendChild(o),n}},{key:"backspaceRemovable",get:function(){return!0}},{key:"data",get:function(){return this._data},set:function(e){this._data={}}}]),e}();u.key="delimiter",a.a.regiester(u)},578:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return b}));var o=n(21),i=n.n(o),a=n(11),r=n(32),s=n(7),l=n(6),c=n(115),d=n(531),u=n(636),h=n(763),p=n(764),f=n(765),v=n(766).default,b=function(){function e(t){Object(s.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._editData=void 0,this._nodes={},this._diagramInput=void 0,this._blockEditable=t.blockEditable,this._data=t.data||e.defaultData,this._diagramInput=new u.default(this._blockEditable)}return Object(l.a)(e,null,[{key:"toHtml",value:function(t,n){n.inlineContent;var o=n.type,i=t.html||"";return!t.url||"wechat"!==o&&"zhihu"!==o||(i='<img style="max-width: 100%" src="'.concat(t.url,'" />')),'<section class="'.concat(e.Class.target,'"><section class="').concat(e.Class.preview,'">').concat(i,"</section>")}},{key:"toMarkdown",value:function(e,t){return"```mermaid\n".concat(e.mermaid||"","\n```")}},{key:"toData",value:function(e){return{mermaid:"",html:e}}},{key:"toolbox",get:function(){var t=/^`mermaid\s*/;return{icon:v,title:"Diagram",commands:[{regex:t,data:function(n,o){n.match(t);var i=e.defaultData;return{data:i}}}]}}},{key:"Class",get:function(){return{target:"be-diagram",preview:"be-diagram__preview",input:"be-diagram__input"}}},{key:"sanitize",get:function(){return{mermaid:!0,html:!0}}},{key:"isLineBreaksEnabled",get:function(){return!1}},{key:"enabledInlineTools",get:function(){return!1}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{mermaid:"",html:""}}},{key:"builtinTypesets",get:function(){return{default:p,common:f}}},{key:"CSS",get:function(){return h}}]),Object(l.a)(e,[{key:"renderBlock",value:function(e){return this.make(e)}},{key:"renderSettings",value:function(e){return null}},{key:"save",value:function(){return this.data}},{key:"onEditFakeInput",value:function(e){if(e===this._nodes.preview){var t=this._blockEditable.state.content;t.stretchBlock(t.activeBlockIndex)}}},{key:"onAdded",value:function(){var e=this;setTimeout((function(){var t=e._blockEditable.state.content;t.stretchBlock(t.activeBlockIndex)}),200)}},{key:"onWillChangeStreched",value:function(){var e=Object(r.a)(i.a.mark((function e(t){var n,o,r=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}this._diagramInput.mount(this._nodes.input,this._data.mermaid||"graph TD\nStart --\x3e Stop",(function(e){var t=e.mermaid,n=e.html;r._editData={mermaid:t,html:n}})),e.next=9;break;case 4:return n=this._editData.mermaid!==this._data.mermaid,e.next=7,this._diagramInput.unmount(n);case 7:o=e.sent,this.data=o?Object(a.a)(Object(a.a)({},this._editData),{},{url:o.url}):n?{mermaid:this._editData.mermaid}:Object(a.a)(Object(a.a)({},this._data),{},{mermaid:this._editData.mermaid});case 9:return e.abrupt("return",!0);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){}},{key:"make",value:function(t){var n=Object(d.make)("div",["be-".concat(e.key)]),o=Object(d.make)("div",[e.Class.preview,t.fakeInput],{placeholder:"\u6309".concat(d.isMac?"Command":"Ctrl","+Enter\u952e\u6216\u53cc\u51fb\u9f20\u6807\u8fdb\u5165\u7f16\u8f91"),empty:"Mermaid \u56fe\u8868"}),i=Object(d.make)("div",[e.Class.input]);return n.appendChild(i),n.appendChild(o),this._nodes.target=n,this._nodes.preview=o,this._nodes.input=i,this.renderDiagram(),n}},{key:"renderDiagram",value:function(){this._nodes.preview&&(this._nodes.preview.innerHTML=this._data.html||"")}},{key:"backspaceRemovable",get:function(){return!0}},{key:"data",get:function(){return this._data.html=this._nodes.preview.innerHTML,this._data},set:function(e){this._data={mermaid:e.mermaid||"",html:e.html||"",url:e.url||""},this.renderDiagram()}}]),e}();b.key="diagram",c.a.regiester(b)},599:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return h}));var o=n(7),i=n(6),a=n(115),r=n(531),s=n(660),l=n(767),c=n(768),d=n(769),u=n(770).default,h=function(){function e(t){Object(o.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._nodes={},this._drawioInput=void 0,this._blockEditable=t.blockEditable,this._data=t.data||e.defaultData,this._drawioInput=new s.default(this._blockEditable)}return Object(i.a)(e,null,[{key:"toHtml",value:function(t,n){n.inlineContent;var o=n.type,i=t.html||"";return!t.url||"wechat"!==o&&"zhihu"!==o||(i='<img style="max-width: 100%" src="'.concat(t.url,'" />')),'<section class="'.concat(e.Class.target,'"><section class="').concat(e.Class.preview,'">').concat(i,"</section>")}},{key:"toMarkdown",value:function(e,t){return"![](".concat(e.url||"",")")}},{key:"toData",value:function(e){return{html:e,url:""}}},{key:"toolbox",get:function(){var t=/^`drawio\s*/;return{icon:u,title:"Drawio",commands:[{regex:t,data:function(n,o){n.match(t);var i=e.defaultData;return{data:i}}}]}}},{key:"Class",get:function(){return{target:"be-drawio",preview:"be-drawio__preview",input:"be-drawio__input"}}},{key:"sanitize",get:function(){return{url:!0,html:!0}}},{key:"isLineBreaksEnabled",get:function(){return!1}},{key:"enabledInlineTools",get:function(){return!1}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{html:"",url:""}}},{key:"builtinTypesets",get:function(){return{default:c,common:d}}},{key:"CSS",get:function(){return l}}]),Object(i.a)(e,[{key:"renderBlock",value:function(e){return this.make(e)}},{key:"renderSettings",value:function(e){return null}},{key:"save",value:function(){return this.data}},{key:"onEditFakeInput",value:function(e){e===this._nodes.preview&&this.editDraw()}},{key:"onAdded",value:function(){this.editDraw()}},{key:"destroy",value:function(){}},{key:"editDraw",value:function(){var e=this;this._drawioInput.edit(this._data.html,(function(t){var n=t.html,o=t.url;e.data={html:n,url:o}}))}},{key:"make",value:function(t){var n=Object(r.make)("div",["be-".concat(e.key)]),o=Object(r.make)("div",[e.Class.preview,t.fakeInput],{placeholder:"\u6309".concat(r.isMac?"Command":"Ctrl","+Enter\u952e\u6216\u53cc\u51fb\u9f20\u6807\u8fdb\u5165\u7f16\u8f91"),empty:"Drawio \u5236\u56fe"}),i=Object(r.make)("div",[e.Class.input]);return n.appendChild(i),n.appendChild(o),this._nodes.target=n,this._nodes.preview=o,this._nodes.input=i,this.renderDrawio(),n}},{key:"renderDrawio",value:function(){this._nodes.preview&&(this._nodes.preview.innerHTML=this._data.html||"")}},{key:"backspaceRemovable",get:function(){return!0}},{key:"data",get:function(){return this._data},set:function(e){this._data={html:e.html||"",url:e.url||""},this.renderDrawio()}}]),e}();h.key="drawio",a.a.regiester(h)},600:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return h}));var o=n(7),i=n(6),a=n(115),r=n(531),s=n(771),l=n(772),c=n(773),d=n(774).default;function u(e){var t=e.querySelectorAll(".".concat(h.Class.item));return{items:Array.from(t).map((function(e){var t=e.querySelector(".".concat(h.Class.title)),n=e.querySelector(".".concat(h.Class.note));return{title:(null===t||void 0===t?void 0:t.textContent)||"",note:(null===n||void 0===n?void 0:n.textContent)||""}}))}}var h=function(){function e(t){Object(o.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._nodes={items:[]},this._blockEditable=t.blockEditable,this._data=t.data||e.defaultData,this.onUpdateFootnotes=this.onUpdateFootnotes.bind(this)}return Object(i.a)(e,null,[{key:"toHtml",value:function(t){var n=t.items.map((function(t,n){return'<section class="'.concat(e.Class.item,'"><span class="').concat(e.Class.title,'">').concat(t.title,'</span><span class="').concat(e.Class.note,'">').concat(t.note,"</span></section>")}));return n.length?'<section class="be-'.concat(e.key,'">').concat(n.join("\n"),"</section>"):""}},{key:"toMarkdown",value:function(e,t){return""}},{key:"toData",value:function(e){var t=document.createElement("div");return t.innerHTML=e,u(t)}},{key:"Class",get:function(){return{target:"be-footnote",item:"be-footnote__item",title:"be-footnote__item-title",note:"be-footnote__item-note"}}},{key:"toolbox",get:function(){var t=/^`footnote\s*/;return{icon:d,title:"Footnote",commands:[{regex:t,data:function(n,o){n.match(t);var i=e.defaultData;return{data:i}}}]}}},{key:"isLineBreaksEnabled",get:function(){return!1}},{key:"enabledInlineTools",get:function(){return!0}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{items:[]}}},{key:"builtinTypesets",get:function(){return{default:l,common:c}}},{key:"CSS",get:function(){return s}}]),Object(i.a)(e,[{key:"renderBlock",value:function(e){return this._nodes.target=this.make(),this._nodes.target.classList.add(e.fakeInput),this._nodes.target}},{key:"renderSettings",value:function(e){return null}},{key:"save",value:function(){return this.data}},{key:"onRendered",value:function(){this._blockEditable.editable.on("afterexeccommand",this.onUpdateFootnotes),this.onUpdateFootnotes("","footnote")}},{key:"onRemoved",value:function(){this._blockEditable.editable.off("afterexeccommand",this.onUpdateFootnotes)}},{key:"onUpdateFootnotes",value:function(e,t){if("footnote"===t||"removeformat"===t){var n=this._blockEditable.editable.holder.querySelectorAll("footnote"),o=Array.from(n).map((function(e){return{title:e.getAttribute("data-title")||"",note:e.getAttribute("data-note")||""}}));this.data={items:o}}}},{key:"destroy",value:function(){}},{key:"make",value:function(){var t=this,n=Object(r.make)("div",[e.Class.target]);return this._data.items.length&&this._data.items.forEach((function(e,o){var i=t.createFootnoteItem(e,o);n.appendChild(i)})),this._nodes.target=n,n}},{key:"createFootnoteItem",value:function(t,n){t=t||{content:"",checked:!1};var o=Object(r.make)("div",e.Class.item),i=Object(r.make)("span",e.Class.title);i.innerText=t.title;var a=Object(r.make)("span",e.Class.note);return a.innerText=t.note,o.appendChild(i),o.appendChild(a),o}},{key:"data",get:function(){return this._data=u(this._nodes.target),this._data},set:function(e){this._data.items=e.items||[];var t=this._nodes.target;if(t&&t.parentNode){var n=this.make();t.parentNode.replaceChild(n,t),n.className=t.className}}},{key:"backspaceRemovable",get:function(){return!0}}]),e}();h.key="footnote",a.a.regiester(h)},601:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return b}));var o=n(21),i=n.n(o),a=n(32),r=n(7),s=n(6),l=n(115),c=n(662),d=n(663),u=n(664),h=n(562),p=n(780),f=n(781),v=n(782).default,b=function(){function e(t){var n=this;Object(r.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._ui=void 0,this._settings=void 0,this._uploader=void 0,this._imageEditor=void 0,this._blockEditable=t.blockEditable,this._uploader=new u.default({config:{types:"image/*",uploadImage:function(){var e=Object(a.a)(i.a.mark((function e(t){var o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o=n._blockEditable.editable.getOpt("uploadImage"))){e.next=3;break}return e.abrupt("return",o(t));case 3:return e.abrupt("return",void 0);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},onUpload:function(e){return n.onUpload(e)},onError:function(){return n.uploadFailded()}}),this._imageEditor=new h.default({editable:this._blockEditable.editable}),this._ui=new c.default({blockEditable:t.blockEditable,onSelectFile:function(){n.onSelectFile()}}),this._settings=new d.default({blockEditable:t.blockEditable,onChange:function(e){return n.settingToggled(e)}}),this._data={},this.data=t.data||e.defaultData}return Object(s.a)(e,null,[{key:"toHtml",value:function(e,t){var n=t.clearEmpty,o=e.image&&e.image.url||"",i=e.withCaption,a=e.caption,r=document.createElement("div");r.innerHTML=a;var s=o.match(/\/file\?path=(.*)/);return s&&(o="file://"+decodeURIComponent(s[1])),n(o?'<figure class="be-image">\n                        <img src="'.concat(o,'" alt="').concat(r.textContent||"",'"/>\n                    ').concat(i?'<figcaption class="be-image__caption">'.concat(a,"</figcaption>"):"","\n                </figure>"):"")}},{key:"toMarkdown",value:function(e,t){var n=e.image&&e.image.url,o=e.withCaption,i=e.caption,a=document.createElement("div");a.innerHTML=i;var r=n.match(/\/file\?path=(.*)/);return r&&(n="file://"+decodeURIComponent(r[1])),n?"![".concat(o?a.textContent:"","](").concat(n,")"):""}},{key:"toData",value:function(e){return{content:e}}},{key:"toolbox",get:function(){var e=/^(!)(\[(.*)\])?(\((https?:\/\/\S+\.(gif|jpe?g|tiff|png))\))?/i;return{icon:v,title:"Image",commands:[{regex:e,data:function(t,n){var o=t.match(e),i={caption:o?o[3]:"",withCaption:!0};return o&&o[5]&&(i.image={url:o[5]}),{data:i}}}]}}},{key:"acceptConversionComps",get:function(){return!1}},{key:"enabledInlineTools",get:function(){return!1}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{caption:"",withCaption:!0}}},{key:"builtinTypesets",get:function(){return{default:f}}},{key:"CSS",get:function(){return p}},{key:"pasteConfig",get:function(){return{tags:["img","figure","figcaption"],files:{mimeTypes:["image/*"]}}}}]),Object(s.a)(e,[{key:"renderBlock",value:function(e){return this._ui.render(this._data,e)}},{key:"renderSettings",value:function(e){return this._settings.render(this._data,e)}},{key:"onAdded",value:function(){this._data.image&&this._data.image.url||this._ui.nodes.fileButton.click()}},{key:"save",value:function(){return this.data}},{key:"onPaste",value:function(){var e=Object(a.a)(i.a.mark((function e(t){var n,o,a,r,s,l,c,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next="tag"===e.t0?3:"pattern"===e.t0?20:"file"===e.t0?23:27;break;case 3:if(n=t.detail.data,a="","figure"===n.tagName.toLowerCase()?(o=n.querySelector("img"),(r=n.querySelector("figcaption"))&&(a=r.textContent||"")):o=n,!o){e.next=19;break}if(a=a||o.getAttribute("alt")||"",!/^blob:/.test(o.src)){e.next=17;break}return e.next=11,fetch(o.src);case 11:return s=e.sent,e.next=14,s.blob();case 14:return l=e.sent,this.uploadFile(l),e.abrupt("break",27);case 17:this.uploadUrl(o.src),this._ui.fillCaption(a);case 19:return e.abrupt("break",27);case 20:return c=t.detail.data,this.uploadUrl(c),e.abrupt("break",27);case 23:return d=t.detail.file,this._ui.fillCaption(d.name),this.uploadFile(d),e.abrupt("break",27);case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onEditFakeInput",value:function(e){var t=this;e===this._ui.nodes.fileButton?this.onSelectFile():e===this._ui.nodes.imageContainer&&this._imageEditor.edit(this._data.image.url,(function(e){var n={url:e};n.url&&(t._ui.fillImage(n.url,!0),t._data.image=n)}))}},{key:"destroy",value:function(){}},{key:"settingToggled",value:function(e){this.setSetting(e,!this._data[e])}},{key:"setSetting",value:function(e,t){var n=this;this._data[e]=t,this._ui.applySetting(e,t),"stretched"===e&&Promise.resolve().then((function(){var e=n.api.content.activeBlockIndex;n.api.content.stretchBlock(e,t)})).catch((function(e){console.error(e)}))}},{key:"onSelectFile",value:function(){var e=this;this._uploader.uploadSelectedFile({onPreview:function(t){e._ui.showPreloader(t)}})}},{key:"onUpload",value:function(e){e.success&&e.file?(this.image=e.file,this._ui.fillCaption(e.file.name||"")):this.uploadFailded()}},{key:"uploadFailded",value:function(){this.api.notifier.show({message:"\u56fe\u7247\u4e0a\u4f20\u5931\u8d25",style:"error"}),this._ui.hidePreloader()}},{key:"uploadFile",value:function(e){var t=this;this._uploader.uploadByFile(e,{onPreview:function(e){t._ui.showPreloader(e)}})}},{key:"uploadUrl",value:function(e){this._ui.showPreloader(e),this._uploader.uploadByUrl(e)}},{key:"isEmptyContent",get:function(){var e=this.data.image;return!(e&&e.url)}},{key:"backspaceRemovable",get:function(){return!0}},{key:"data",get:function(){var e=this._ui.nodes.caption,t=this._ui.nodes.image;return this._data.caption=e.innerHTML,t&&(this._data.image.url=t.src.replace(/http:\/\/localhost:(3000|9070)/,"")),this._data},set:function(e){var t=this;this.image=e.image,this._data.caption=e.caption||"",this._ui.fillCaption(this._data.caption),d.default.settings.forEach((function(n){var o=n.name,i="undefined"!==typeof e[o]&&(!0===e[o]||"true"===e[o]);t.setSetting(o,i)}))}},{key:"image",set:function(e){if(this._data.image=e||{},e&&e.url){var t=e.url.match(/file:\/\/(.*)/)||e.url.match(/.+\/file\?path=(.*)/);t&&(e.url="/file?path=".concat(encodeURIComponent(t[1])),this._data.image=e),this._ui.fillImage(e.url)}}},{key:"api",get:function(){return this._blockEditable.state}}]),e}();b.key="image",l.a.regiester(b)},602:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return E}));var o=n(44),i=n(21),a=n.n(i),r=n(32),s=n(7),l=n(6),c=n(11),d=n(115),u=n(531),h=n(72),p=n(783),f=n(784),v=n(785).default,b=n(786).default,m=n(787).default;function g(e){var t="ordered"===e.style?"ol":"ul",n=e.items.map((function(e){return function(e){var t=g(Object(c.a)(Object(c.a)({},e),{},{style:e.style||"unordered"}));return'<li class="'.concat(E.Class.item,'"><p class="').concat(E.Class.itemContent,'">').concat(e.content,"</p>").concat(t,"</li>")}(e)}));return n.length?"<".concat(t,' class="be-').concat(E.key).concat("ordered"===e.style?" ".concat(E.Class.targetOrdered):" ".concat(E.Class.targetUnordered),'">').concat(n.join("\n"),"</").concat(t,">"):""}function k(e){var t=e.querySelector(".".concat(E.Class.itemContent));if(t)return Object(u.isEmpty)(t)?"":t.innerHTML;var n=e.cloneNode(!0);return n.querySelectorAll("ul,ol").forEach((function(e){e.remove()})),h.a.removeBlockChildren(n),n.innerHTML}function y(e){return e?Array.from(e.querySelectorAll(":scope > li")).map((function(e){var t=e.querySelector(".".concat(E.Class.itemChildren))||e.querySelector("ul,ol"),n=k(e),o="OL"===(null===t||void 0===t?void 0:t.tagName)?"ordered":"unordered",i=t?y(t):[];return{content:n,style:o,closed:e.classList.contains(E.Class.itemListClosed),items:i}})):[]}function C(e,t,n){return{regex:e,data:function(o,i){var a=o.match(e),r="";if(a){var s=(r=i(a[1])).match(/<p>(.*)<\/p>/);s&&(r=s[1])}return{data:{style:t,items:[{content:r,items:[]}]},icon:n}}}}var _=C(/^-\s*(([^-\[\]]*)|$)/,"unordered",b),x=C(/^\d+\.\s*(.*)/,"ordered",m),E=function(){function e(t){Object(s.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._nodes={},this._defaultListStyle="unordered",this._cacheCurrentItem=null,this._blockEditable=t.blockEditable,this._data=t.data||e.defaultData}return Object(l.a)(e,null,[{key:"convertData",value:function(e,t){var n=e.data;if("paragraph"===e.key||"header"===e.key)return[{style:"unordered",items:[{content:n.content,items:[]}]}];var o=[];return n.items.forEach((function(e){o.push({content:e.content,items:[]})})),[{style:"unordered",items:o}]}},{key:"toHtml",value:function(e){return g(e)}},{key:"toMarkdown",value:function(e,t){return t(g(e))}},{key:"toData",value:function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.querySelector("ol")||t.querySelector("ul"),o=[];return o=n?y(n):Array.from(t.children).map((function(e){return{content:e.textContent||"",items:[]}})),{style:"OL"===(null===n||void 0===n?void 0:n.tagName)?"ordered":"unordered",items:o}}},{key:"Class",get:function(){return{target:"be-list",targetOrdered:"be-list--ordered",targetUnordered:"be-list--unordered",item:"be-list__item",itemList:"be-list__item-list",itemListClosed:"be-list__item-list--closed",itemContent:"be-list__item-content",itemChildren:"be-list__item-children",settingsWrapper:"beui-list-settings"}}},{key:"toolbox",get:function(){return{icon:v,title:"List",commands:[_,x]}}},{key:"acceptConversionComps",get:function(){return["paragraph","header","todolist"]}},{key:"isLineBreaksEnabled",get:function(){return!0}},{key:"enabledInlineTools",get:function(){return!0}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{style:"unordered",items:[]}}},{key:"builtinTypesets",get:function(){return{default:f}}},{key:"CSS",get:function(){return p}},{key:"pasteConfig",get:function(){return{tags:["OL","UL","LI"]}}},{key:"settings",get:function(){return[{name:"unordered",icon:b,title:"Unordered",default:!0},{name:"ordered",icon:m,title:"Ordered",default:!1}]}}]),Object(l.a)(e,[{key:"renderBlock",value:function(e){return this.make()}},{key:"renderSettings",value:function(t){var n=this,o=Object(u.make)("div",[e.Class.settingsWrapper],{}),i=this.listStyle;return e.settings.forEach((function(e){var a=Object(u.make)("div",t.settingsButton,{});a.innerHTML=e.icon,a.dataset.forbidSetCursor="true",a.addEventListener("click",(function(){var o;n.listStyle=e.name;var i=null===(o=a.parentNode)||void 0===o?void 0:o.querySelectorAll("."+t.settingsButton);Array.from(i||[]).forEach((function(e){return e.classList.remove(t.settingsButtonActive)})),a.classList.toggle(t.settingsButtonActive)})),n._blockEditable.state.tooltip.onHover(a,e.title,{placement:"top",hidingDelay:500}),i===e.name&&a.classList.add(t.settingsButtonActive),o.appendChild(a)})),this._cacheCurrentItem=this.currentItem,o}},{key:"save",value:function(){return this.data}},{key:"merge",value:function(){var e=Object(r.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={items:this.data.items.concat(t.items)},this.data=n;case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"extractInputs",value:function(t){var n,i;return 0===t.length?{style:"unordered",items:[]}:{style:"OL"===(null===(n=t[0].closest("li"))||void 0===n||null===(i=n.parentElement)||void 0===i?void 0:i.tagName)?"ordered":"unordered",items:t.reduce((function(t,n){var i=[{content:n.innerHTML,items:[]}],a=n.closest(".".concat(e.Class.item));if(a&&a.classList.contains(e.Class.itemListClosed)){var r=a.querySelectorAll(".".concat(e.Class.itemContent));i.push.apply(i,Object(o.a)(Array.from(r).map((function(e){return{content:e.innerHTML,items:[]}}))))}return[].concat(Object(o.a)(t),i)}),[])}}},{key:"removeInputs",value:function(t){return t.forEach((function(t,n){if(0===n){t.innerHTML="";var o=t.closest(".".concat(e.Class.item));if(o&&o.classList.contains(e.Class.itemListClosed)){var i=o.querySelector(".".concat(e.Class.itemChildren));i&&i.remove()}}else{var a=t.closest("li");if(null===a||void 0===a?void 0:a.parentElement){var r=a.parentElement;if(r.removeChild(a),0==r.childNodes.length){var s=r.closest(".".concat(e.Class.item));r.remove(),null===s||void 0===s||s.classList.toggle(e.Class.itemList,!1),null===s||void 0===s||s.classList.toggle(e.Class.itemListClosed,!1)}}}})),t[0]}},{key:"onPaste",value:function(e){var t=e.detail.data;this.data=this.pasteHandler(t)}},{key:"destroy",value:function(){}},{key:"pasteHandler",value:function(e){var t=e.tagName,n="ordered";switch(t){case"OL":n="ordered";break;case"UL":case"LI":n="unordered"}var o={style:n,items:[]};if("LI"===t){var i=e.querySelector("ol")||e.querySelector("ul");i&&i.remove(),o.items=[{content:e.textContent||"",items:y(i)}]}else o.items=y(e);return o}},{key:"makeListWrapper",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.listStyle,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i="ordered"===(t=t||this.listStyle||this._data.style||this._defaultListStyle)?e.Class.targetOrdered:e.Class.targetUnordered,a="ordered"===t?"ol":"ul";return Object(u.make)(a,[e.Class.target,i].concat(Object(o.a)(n)))}},{key:"addChildrenList",value:function(t,n,o){var i=this.makeListWrapper(t,[e.Class.itemChildren]);this.appendItems(o,i),null===n||void 0===n||n.appendChild(i)}},{key:"appendItems",value:function(e,t){var n=this;e.forEach((function(e){var o=n.createItem(e.style||"",e.content,e.items,e.closed);t.appendChild(o)}))}},{key:"createItem",value:function(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Object(u.make)("li",e.Class.item),r=Object(u.make)("p",e.Class.itemContent,{contentEditable:!0});return r.innerHTML=n,a.appendChild(r),o&&o.length>0&&(this.addChildrenList(t,a,o),a.classList.add(e.Class.itemList),a.classList.toggle(e.Class.itemListClosed,i)),a}},{key:"make",value:function(){return this._nodes.target=this.makeListWrapper(this._data.style),this._data.items.length?this.appendItems(this._data.items,this._nodes.target):this.appendItems([{content:"",items:[]}],this._nodes.target),this.bindEvents(),this._nodes.target}},{key:"bindEvents",value:function(){var t=this;this._nodes.target.addEventListener("keydown",(function(e){switch(e.key){case"Enter":t.enterPressed(e);break;case"Backspace":t.backspace(e);break;case"Tab":e.shiftKey?t.shiftTab(e):t.addTab(e)}}),!1),this._nodes.target.addEventListener("paste",(function(n){var o=t.getListData(n.clipboardData);if(null===o||void 0===o?void 0:o.length){var i=t.currentItem;if(!i)return;n.stopPropagation(),n.preventDefault();var a=o.map((function(e){var n=e.data;return t.createItem(n.style,"",n.items)})),r=document.createDocumentFragment();a.forEach((function(t){var n=t.querySelector(".".concat(e.Class.itemChildren));if(n)for(;n.firstChild;)r.appendChild(n.firstChild)}));var s=i.querySelector(".".concat(e.Class.itemChildren)),l=s&&Array.from(s.querySelectorAll(".".concat(e.Class.item))).length>0,c=t._blockEditable.selection.getRangeAt(0);if(l)null===s||void 0===s||s.prepend(r),c.select(!0);else{var d=0===k(i).trim().length;i.after(r);var u=i.nextElementSibling;d&&u?u&&(i.remove(),t.focusItem(u)):c.select(!0)}n.stopPropagation(),n.preventDefault()}})),this._nodes.target.addEventListener("mousedown",(function(t){var n=t.target;n.classList.contains(e.Class.itemList)&&n.classList.toggle(e.Class.itemListClosed,!n.classList.contains(e.Class.itemListClosed))}))}},{key:"getListData",value:function(t){if(!t)return[];var n=t.getData("application/block-editable");if(n)try{return JSON.parse(n).filter((function(t){return t.key===e.key}))}catch(o){return[]}}},{key:"enterPressed",value:function(t){var n=this._blockEditable.state.ui;if(!n.someToolbarOpened||!n.someFlipperButtonFocused){var o=this.currentItem;if(o){t.stopPropagation(),t.preventDefault();var i=0===k(o).trim().length,a=o.parentNode===this._nodes.target,r=null===o.nextElementSibling;if(a&&r&&i)this.getOutOfList();else if(r&&i)this.unshiftItem();else{var s=Object(u.extractFragmentFromCaretPositionTillTheEnd)(this._blockEditable.selection);if(s){var l=Object(u.fragmentToString)(s),c=o.querySelector(".".concat(e.Class.itemChildren)),d=o.classList.contains(e.Class.itemListClosed),h=this.createItem(this.listStyle,l,void 0),p=c&&Array.from(c.querySelectorAll(".".concat(e.Class.item))).length>0;p&&!d?null===c||void 0===c||c.prepend(h):o.after(h),o.classList.toggle(e.Class.itemList,!!p),this.focusItem(h)}}}}}},{key:"unshiftItem",value:function(){var t=this.currentItem;if(t){var n=t.parentNode&&t.parentNode.closest(".".concat(e.Class.item));if(n){var o=this._blockEditable.selection.getRangeAt(0),i=o.createBookmark();n.after(t),o.moveToBookmark(i).select(!0);var a=n.querySelector(".".concat(e.Class.itemChildren)),r=0===(null===a||void 0===a?void 0:a.children.length);r&&a&&a.remove(),n.classList.toggle(e.Class.itemList,!r&&!!a)}}}},{key:"focusItem",value:function(t){var n=t.querySelector(".".concat(e.Class.itemContent)),o=this._blockEditable.selection;n&&Object(u.focus)(o,n)}},{key:"getOutOfList",value:function(){var e=this.currentItem;null===e||void 0===e||e.remove();var t=this._blockEditable.state,n=t.content,o=t.cursor,i=t.toolbar,a=n.insert();a&&o.setToBlock(a),i.move()}},{key:"backspace",value:function(t){if(Object(u.isAtStart)(this._blockEditable.selection)){var n=this.currentItem;if(n){var o=n.previousSibling,i=n&&n.parentNode.closest(".".concat(e.Class.item));if(o||i){var a;if(t.preventDefault(),t.stopPropagation(),o){var r=o.querySelectorAll(".".concat(e.Class.item));a=Array.from(r).pop()||o,o.classList.toggle(e.Class.itemListClosed,!1)}else a=i;var s=Object(u.extractFragmentFromCaretPositionTillTheEnd)(this._blockEditable.selection),l=s?Object(u.fragmentToString)(s):"",c=a.querySelector(".".concat(e.Class.itemContent));if(c){var d=this._blockEditable.selection;Object(u.focus)(d,c,!1);var h=d.getRangeAt(0),p=h.createBookmark();c.insertAdjacentHTML("beforeend",l);var f=n.querySelectorAll(".".concat(e.Class.itemChildren," > .").concat(e.Class.item)),v=Array.from(f);(v=v.filter((function(t){return t.parentNode.closest(".".concat(e.Class.item))===n}))).reverse().forEach((function(e){o?a.after(e):n.after(e)})),n.remove();var b=a.querySelector(".".concat(e.Class.itemChildren)),m=0===(null===b||void 0===b?void 0:b.children.length);m&&b&&b.remove(),a.classList.toggle(e.Class.itemList,!m&&!!b),h.moveToBookmark(p).select(!0)}}}}}},{key:"addTab",value:function(t){var n=this.currentItem;if(n){var o=n.previousSibling;if(o){t.stopPropagation(),t.preventDefault();var i=o.querySelector(".".concat(e.Class.itemChildren)),a=this._blockEditable.selection.getRangeAt(0),r=a.createBookmark();if(i)i.appendChild(n);else{var s=this.makeListWrapper(void 0,[e.Class.itemChildren]);s.appendChild(n),null===o||void 0===o||o.appendChild(s)}o.classList.toggle(e.Class.itemList,!!o.querySelector(".".concat(e.Class.itemChildren))),a.moveToBookmark(r).select(!0)}}}},{key:"shiftTab",value:function(e){e.stopPropagation(),e.preventDefault(),this.unshiftItem()}},{key:"data",get:function(){var e;return this._data.items=y(this._nodes.target),this._data.style="OL"===(null===(e=this._nodes.target)||void 0===e?void 0:e.tagName)?"ordered":"unordered",this._data},set:function(e){e||(e={}),this._data.style=e.style||this._defaultListStyle,this._data.items=e.items||[];var t=this._nodes.target;t&&t.parentNode&&t.parentNode.replaceChild(this.make(),t)}},{key:"listStyle",get:function(){var t=this.currentItem,n=(null===t||void 0===t?void 0:t.closest(".".concat(e.Class.itemChildren)))||this._nodes.target;return"OL"===(null===n||void 0===n?void 0:n.tagName)?"ordered":"unordered"},set:function(t){var n=this._blockEditable.selection.getRangeAt(0),o=n.createBookmark(),i=this._cacheCurrentItem||this.currentItem,a=null===i||void 0===i?void 0:i.closest(".".concat(e.Class.itemChildren)),r=this.makeListWrapper(t,a?[e.Class.itemChildren]:[]);r.classList.toggle(e.Class.targetUnordered,"unordered"===t),r.classList.toggle(e.Class.targetOrdered,"ordered"===t);var s=a||this._nodes.target;if(s){for(;s.firstChild;)r.appendChild(s.firstChild);var l=s.parentNode;null===l||void 0===l||l.replaceChild(r,s),a||(this._nodes.target=r,this._data.style=t,this.bindEvents())}n.moveToBookmark(o).select(!0),this._blockEditable.state.toolbar.close()}},{key:"currentItem",get:function(){var t=this._blockEditable.selection.anchorNode;return t&&t.nodeType!==Node.ELEMENT_NODE&&(t=t.parentNode),t&&t.closest(".".concat(e.Class.item))}}]),e}();E.key="list",d.a.regiester(E)},603:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return b}));var o=n(21),i=n.n(o),a=n(32),r=n(7),s=n(6),l=n(115),c=n(531),d=n(809),u=n(575),h=n(788),p=n(789),f=n(790),v=n(791).default,b=function(){function e(t){Object(r.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._editData=void 0,this._nodes={},this._mathInput=void 0,this._blockEditable=t.blockEditable,this._data=t.data||e.defaultData,this._mathInput=new d.a}return Object(s.a)(e,null,[{key:"toHtml",value:function(t,n){var o=n.type,i=t.html||"";return"zhihu"===o?i='<img class="Formula-image" data-eeimg="true" src="" alt="'.concat(t.tex,'">'):"juejin"===o&&(i='<img class="equation" src="https://juejin.im/equation?tex='.concat(t.tex,'" alt=""/>')),'<section class="'.concat(e.Class.target,'"><section class="').concat(e.Class.preview,'">').concat(i,"</section>")}},{key:"toMarkdown",value:function(e,t){return e.tex?"$$".concat(e.tex,"$$"):""}},{key:"toData",value:function(e){return{tex:"",html:e}}},{key:"toolbox",get:function(){return{icon:v,title:"Math",commands:[{regex:/^(\$\$)([^\$]*)?(\$\$)?/i,data:function(e,t){return{data:{tex:"",html:""}}}}]}}},{key:"Class",get:function(){return{target:"be-math",preview:"be-math__preview",input:"be-math__input"}}},{key:"sanitize",get:function(){return{tex:!0,html:!0}}},{key:"isLineBreaksEnabled",get:function(){return!1}},{key:"enabledInlineTools",get:function(){return!1}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{tex:"",html:""}}},{key:"builtinTypesets",get:function(){return{default:p,common:f}}},{key:"CSS",get:function(){return h}}]),Object(s.a)(e,[{key:"renderBlock",value:function(e){return this.make(e)}},{key:"renderSettings",value:function(e){return null}},{key:"save",value:function(){return this.data}},{key:"onEditFakeInput",value:function(e){if(e===this._nodes.preview){var t=this._blockEditable.state.content;t.stretchBlock(t.activeBlockIndex)}}},{key:"onAdded",value:function(){var e=this;setTimeout((function(){var t=e._blockEditable.state.content;t.stretchBlock(t.activeBlockIndex)}),200)}},{key:"onWillChangeStreched",value:function(){var e=Object(a.a)(i.a.mark((function e(t){var n=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t?this._mathInput.mount(this._nodes.input,this._data.tex,(function(e){var t=e.tex,o=e.html;n._editData={tex:t,html:o}})):(this._mathInput.unmount(),this._editData.tex!==this._data.tex&&(this.data={tex:this._editData.tex,html:Object(u.a)(this._editData.html)})),e.abrupt("return",!0);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){}},{key:"make",value:function(t){var n=Object(c.make)("div",["be-".concat(e.key)]),o=Object(c.make)("div",[e.Class.preview,t.fakeInput],{placeholder:"\u6309".concat(c.isMac?"Command":"Ctrl","+Enter\u952e\u6216\u53cc\u51fb\u9f20\u6807\u8fdb\u5165\u7f16\u8f91"),empty:"TeX \u516c\u5f0f"}),i=Object(c.make)("div",[e.Class.input]);return n.appendChild(i),n.appendChild(o),this._nodes.target=n,this._nodes.preview=o,this._nodes.input=i,this.renderTex(),n}},{key:"renderTex",value:function(){this._nodes.preview&&(this._nodes.preview.innerHTML=this._data.html||"")}},{key:"backspaceRemovable",get:function(){return!0}},{key:"data",get:function(){return this._data.html=this._nodes.preview.innerHTML,this._data},set:function(e){this._data={tex:e.tex||"",html:e.html||""},this.renderTex()}}]),e}();b.key="math",l.a.regiester(b)},604:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return b}));var o=n(21),i=n.n(o),a=n(32),r=n(7),s=n(6),l=n(115),c=n(531),d=n(562),u=n(792),h=n(793),p=n(794),f=n(795).default,v=n(796).default,b=function(){function e(t){Object(r.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._nodes={items:[]},this._imageEditor=void 0,this._blockEditable=t.blockEditable,this._data=t.data||e.defaultData,this._imageEditor=new d.default({editable:this._blockEditable.editable})}return Object(s.a)(e,null,[{key:"toHtml",value:function(t){return'<section class="be-'.concat(e.key,'">').concat(t.content,"</section>")}},{key:"toMarkdown",value:function(e,t){return""}},{key:"toData",value:function(e){return{content:e}}},{key:"Class",get:function(){return{target:"be-richtext",settingsWrapper:"beui-richtext-settings"}}},{key:"toolbox",get:function(){var t=/^`richtext\s*/;return{icon:f,title:"RichText",commands:[{regex:t,data:function(n,o){n.match(t);var i=e.defaultData;return{data:i}}}]}}},{key:"isLineBreaksEnabled",get:function(){return!0}},{key:"enabledInlineTools",get:function(){return!0}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{items:[]}}},{key:"sanitize",get:function(){return{content:!0}}},{key:"pasteConfig",get:function(){return{hookPaste:function(e){var t=e.getData("text/html")||e.getData("text/plain")||"";return/<section\sclass="(KolEditor|_135editor|_editor|xmyeditor|geekeditor)"/.test(t)||/<section\slabel=".*(playhudong|iPaiban).*?"/.test(t)||/<section\s.*\spowered-by="xiumi.us"/.test(t)}}}},{key:"builtinTypesets",get:function(){return{default:h,common:p}}},{key:"CSS",get:function(){return u}}]),Object(s.a)(e,[{key:"renderBlock",value:function(e){return this.make()}},{key:"renderSettings",value:function(t){var n=this,o=Object(c.make)("div",[e.Class.settingsWrapper],{}),i=Object(c.make)("div",[t.settingsButton],{});return i.innerHTML=v,i.addEventListener("click",(function(){var e=n._blockEditable.state,t=e.paste,o=e.content,i=e.toolbar,a=e.blockSettings;e.tooltip.hide(),o.setActiveBlockBy(n._nodes.target),t.replaceWithHTML(n._nodes.target.innerHTML),a.close(),i.close()})),this._blockEditable.state.tooltip.onHover(i,"\u62c6\u89e3\u5bcc\u6587\u672c",{placement:"top",hidingDelay:500}),o.appendChild(i),o}},{key:"save",value:function(){return this.data}},{key:"onPaste",value:function(){var e=Object(a.a)(i.a.mark((function e(t){var n,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next="hook"===e.t0?3:7;break;case 3:return n=t.detail.data,(o=this.getText(n))&&(o=this._blockEditable.editable.filterInputRule(o),this.data={content:o}),e.abrupt("break",7);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){}},{key:"getText",value:function(e){var t=null===e||void 0===e?void 0:e.types,n="";if(t){var o={};t.forEach((function(t){o[t]=(null===e||void 0===e?void 0:e.getData(t))||""})),n=o["text/html"]||o["text/plain"]}return n}},{key:"make",value:function(){var t=this,n=Object(c.make)("div",[e.Class.target]);return n.setAttribute("contenteditable","true"),n.innerHTML=this._data.content||"",n.addEventListener("paste",(function(e){var n=t.getRichText(e.clipboardData),o=t._blockEditable.editable;n&&(o.execCommand("inserthtml",{html:n}),e.stopPropagation(),e.preventDefault())})),n.addEventListener("dblclick",(function(e){var n=e.target;n&&"IMG"===n.nodeName&&n.src&&t._imageEditor.edit(n.getAttribute("src")||"",(function(e){e&&n.setAttribute("src",e)}))})),this._nodes.target=n,n}},{key:"getRichText",value:function(e){var t=null===e||void 0===e?void 0:e.types,n="";if(t){var o={};t.forEach((function(t){o[t]=(null===e||void 0===e?void 0:e.getData(t))||""})),n=o["text/html"]||o["text/plain"]}return n}},{key:"data",get:function(){return this._data={content:this._nodes.target.innerHTML},this._data},set:function(e){this._data={content:e.content||""},this._nodes.target.innerHTML=e.content}}]),e}();b.key="richtext",l.a.regiester(b)},605:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var o=n(11),i=n(7),a=n(6),r=n(115),s=n(665),l=n(606),c=n(799),d=n(800),u=n(801),h=n(802).default;function p(e){if(!e)return{};var t=[],n=[],o=e.tHead;if(o)for(var i=o.rows,a=0;a<i.length;a++){var r=i[a],s=Array.from(r.cells).map((function(e){var t=e.querySelector("."+v.Class.input);return t?t.innerHTML:e.innerText}));t.push(s)}for(var l=null===e||void 0===e?void 0:e.tBodies,c=0;c<l.length;c++)for(var d=l[c].rows,u=0;u<d.length;u++){var h=d[u],p=Array.from(h.cells).map((function(e){var t=e.querySelector("."+v.Class.input);return t?t.innerHTML:e.innerText}));n.push(p)}return{head:t,body:n}}function f(e,t){var n=e.head,o=e.body,i=(null===n||void 0===n?void 0:n.map((function(e){var n=e.map((function(e){return'<th class="'.concat(l.Class.cell,'">').concat(t?e:'<section class="'.concat(l.Class.inputField,'">').concat(e,"</section>"),"</th>")}));return"<tr>".concat(n.join(""),"</tr>")})))||[],a=(null===o||void 0===o?void 0:o.map((function(e){var n=e.map((function(e){return'<td class="'.concat(l.Class.cell,'">').concat(t?e:'<section class="'.concat(l.Class.inputField,'">').concat(e,"</section>"),"</td>")}));return"<tr>".concat(n.join(""),"</tr>")})))||[];return'<table class="'.concat(l.Class.table,'"><thead>').concat(i.join(""),"</thead><tbody>").concat(a.join(""),"</tbody></table>")}var v=function(){function e(t){Object(i.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._nodes={},this._tableContructor=void 0,this._blockEditable=t.blockEditable,this._data=t.data||e.defaultData}return Object(a.a)(e,null,[{key:"validData",value:function(e){return!!(e.body&&e.body.length&&e.body[0].length)||!!(e.head&&e.head.length&&e.head[0].length)}},{key:"toHtml",value:function(e){var t=f(e);return'<section class="'.concat(s.Class.editor,'"><section class="').concat(l.Class.wrapper,'">').concat(t,"</section></section>")}},{key:"toData",value:function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.querySelector("table");return{content:n?p(n):[]}}},{key:"toMarkdown",value:function(e,t){return t(f(e,!0))}},{key:"Class",get:function(){return{input:"be-table__inp"}}},{key:"toolbox",get:function(){return{icon:h,title:"Table",commands:[{regex:/^\|.*/,data:function(e,t){return{data:{}}}}]}}},{key:"acceptConversionComps",get:function(){return!1}},{key:"isLineBreaksEnabled",get:function(){return!0}},{key:"enabledInlineTools",get:function(){return!0}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{}}},{key:"builtinTypesets",get:function(){return{default:u,common:d}}},{key:"CSS",get:function(){return c}},{key:"pasteConfig",get:function(){return{tags:["TABLE","THEAD","TBODY","TR","TH","TD"]}}}]),Object(a.a)(e,[{key:"renderBlock",value:function(e){return this._tableContructor=new s.default(this._data,this._blockEditable),this._tableContructor.htmlElement}},{key:"renderSettings",value:function(e){return null}},{key:"save",value:function(){return this.data}},{key:"onPaste",value:function(e){var t=p(e.detail.data);this.data=Object(o.a)({},t)}},{key:"destroy",value:function(){}},{key:"isEmpty",value:function(e){return!e||!e.textContent||!e.textContent.trim()}},{key:"data",get:function(){var e=p(this._tableContructor.htmlElement.querySelector("table"));return this._data=Object(o.a)({},e),this._data},set:function(e){this._data=e;var t=this._tableContructor.htmlElement;t&&t.parentElement&&(this._tableContructor=new s.default(this._data,this._blockEditable),t.parentElement.replaceChild(this._tableContructor.htmlElement,t))}}]),e}();v.key="table",r.a.regiester(v)},606:function(e,t,n){"use strict";n.r(t),n.d(t,"Class",(function(){return r})),n.d(t,"Table",(function(){return s}));var o=n(7),i=n(6),a=n(570),r={table:"be-table",inputField:"be-table__inp",cell:"be-table__cell",wrapper:"be-table__wrap"},s=function(){function e(){Object(o.a)(this,e),this._numberOfColumns=void 0,this._numberOfRows=void 0,this._element=void 0,this._table=void 0,this._selectedCell=void 0,this._numberOfColumns=0,this._numberOfRows=0,this._element=this.createTableWrapper(),this._table=this._element.querySelector("table"),this.hangEvents()}return Object(i.a)(e,[{key:"addColumn",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._numberOfColumns++;for(var n=this.body.rows,o=0;o<n.length;o++){var i=n[o].insertCell(t);this.fillCell(i)}for(var r=(null===(e=this.head)||void 0===e?void 0:e.rows)||[],s=0;s<r.length;s++){var l=Object(a.create)("th"),c=r[s].insertCell(t);c.replaceWith(l),this.fillCell(l)}}},{key:"addRow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._numberOfRows++,e>=this.body.rows.length&&(e=-1);var t=this.body.insertRow(e);return this.fillRow(t),t}},{key:"addHead",value:function(){if(this.head){var e=this.head.insertRow(-1);return this.fillHead(e),e}}},{key:"deleteColumn",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._numberOfColumns--;for(var n=this.body.rows,o=0;o<n.length;o++){var i=n[o];t<i.cells.length&&i.deleteCell(t)}for(var a=(null===(e=this.head)||void 0===e?void 0:e.rows)||[],r=0;r<a.length;r++){var s=a[r];t<s.cells.length&&s.deleteCell(t)}}},{key:"deleteRow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._numberOfRows--,e<this.body.rows.length&&this.body.deleteRow(e)}},{key:"createTableWrapper",value:function(){return Object(a.create)("div",[r.wrapper],null,[Object(a.create)("table",[r.table],null,[Object(a.create)("thead"),Object(a.create)("tbody")])])}},{key:"createContenteditableArea",value:function(){return Object(a.create)("div",[r.inputField],{contenteditable:"true"})}},{key:"fillCell",value:function(e){e.classList.add(r.cell);var t=this.createContenteditableArea();e.appendChild(t)}},{key:"fillRow",value:function(e){for(var t=0;t<this._numberOfColumns;t++){var n=e.insertCell();this.fillCell(n)}}},{key:"fillHead",value:function(e){for(var t=0;t<this._numberOfColumns;t++){var n=Object(a.create)("th");e.appendChild(n),this.fillCell(n)}}},{key:"hangEvents",value:function(){var e=this;this._table.addEventListener("focus",(function(t){e.focusEditField(t)}),!0),this._table.addEventListener("blur",(function(t){e.blurEditField(t)}),!0),this._table.addEventListener("keydown",(function(t){e.pressedEnterInEditField(t)})),this._table.addEventListener("click",(function(t){e.clickedOnCell(t)})),this._table.addEventListener("mouseover",(function(t){e.mouseEnterInDetectArea(t),t.stopPropagation()}),!0)}},{key:"focusEditField",value:function(e){e.target&&e.target.classList.contains(r.inputField)&&(this._selectedCell=e.target.closest("."+r.cell))}},{key:"blurEditField",value:function(e){e.target&&e.target.classList.contains(r.inputField)&&(this._selectedCell=null)}},{key:"pressedEnterInEditField",value:function(e){e.target&&e.target.classList.contains(r.inputField)&&(13!==e.keyCode||e.shiftKey||e.preventDefault())}},{key:"clickedOnCell",value:function(e){if(e.target&&e.target.classList.contains(r.cell)){var t=e.target.querySelector("."+r.inputField);null===t||void 0===t||t.focus()}}},{key:"mouseEnterInDetectArea",value:function(e){if(e.target){var t=e.target.closest(".".concat(r.cell));if(t){var n=Object(a.getCoords)(t),o=Object(a.getSideByCoords)(n,e.pageX,e.pageY);e.target.dispatchEvent(new CustomEvent("mouseInActivatingArea",{detail:{side:o},bubbles:!0}))}}}},{key:"htmlElement",get:function(){return this._element}},{key:"body",get:function(){return this._table.tBodies[0]}},{key:"head",get:function(){return this._table.tHead}},{key:"selectedCell",get:function(){return this._selectedCell}}]),e}()},607:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return m}));var o=n(21),i=n.n(o),a=n(32),r=n(7),s=n(6),l=n(115),c=n(531),d=n(72),u=n(803),h=n(804),p=n(805),f=n(806).default;function v(e,t){e&&e.forEach((function(e){t.push({content:e.content,checked:!1}),v(e.items,t)}))}function b(e){var t=e.querySelectorAll(".".concat(m.Class.item,",li,taskli"));return{items:Array.from(t).map((function(e){var t=e.classList.contains("".concat(m.Class.itemChecked));if(!t){var n=e.querySelector('[type="checkbox"]');n&&(t=null!==n.getAttribute("checked"),n.remove())}return{checked:t,content:(e.querySelector(".".concat(m.Class.textField))||d.a.removeBlockChildren(e)).innerHTML||""}}))}}var m=function(){function e(t){Object(r.a)(this,e),this._blockEditable=void 0,this._data=void 0,this._nodes={items:[]},this._blockEditable=t.blockEditable,this._data=t.data||e.defaultData}return Object(s.a)(e,null,[{key:"convertData",value:function(e,t){var n=e.data;if("paragraph"===e.key||"header"===e.key)return[{items:[{content:n.content,checked:!1}]}];var o=[];return v(n.items,o),[{items:o}]}},{key:"toHtml",value:function(t){var n=t.items.map((function(t){return'<section class="'.concat(e.Class.item).concat(t.checked?" ".concat(e.Class.itemChecked):"",'"><span class="').concat(e.Class.checkbox,'"></span><section class="').concat(e.Class.textField,'">').concat(t.content,"</section></section>")}));return'<section class="be-'.concat(e.key,'">').concat(n.join("\n"),"</section>")}},{key:"toMarkdown",value:function(e,t){return e.items.map((function(e){return"- [".concat(e.checked?"x":" ","] ").concat(t(e.content))})).join("\n")}},{key:"toData",value:function(e){var t=document.createElement("div");return t.innerHTML=e,b(t)}},{key:"Class",get:function(){return{target:"be-todolist",item:"be-todolist__item",itemChecked:"be-todolist__item--checked",checkbox:"be-todolist__item-checkbox",textField:"be-todolist__item-text"}}},{key:"toolbox",get:function(){var e=/^(-)(\s*)\[([\sx]*)\](\s*)(.*)/i;return{icon:f,title:"TodoList",commands:[{regex:e,data:function(t,n){var o=t.match(e),i="",a=!1;if(o){i=n(o[5]),a=!!o[3]&&"x"===o[3].trim();var r=i.match(/<p>(.*)<\/p>/);r&&(i=r[1])}return{data:{items:[{checked:a,content:i}]}}}}]}}},{key:"acceptConversionComps",get:function(){return["paragraph","header","list"]}},{key:"isLineBreaksEnabled",get:function(){return!0}},{key:"enabledInlineTools",get:function(){return!0}},{key:"acceptTags",get:function(){return[]}},{key:"defaultData",get:function(){return{items:[]}}},{key:"builtinTypesets",get:function(){return{default:h,common:p}}},{key:"pasteConfig",get:function(){return{tags:["TASKLIST","TASKLI","TASKINPUT"]}}},{key:"CSS",get:function(){return u}}]),Object(s.a)(e,[{key:"renderBlock",value:function(t){return this._nodes.target=this.make(),this._nodes.items=Array.from(this._nodes.target.querySelectorAll(".".concat(e.Class.item))),this._nodes.target}},{key:"renderSettings",value:function(e){return null}},{key:"save",value:function(){return this.data}},{key:"merge",value:function(){var e=Object(a.a)(i.a.mark((function e(t){var n,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.data,o={items:n.items.concat(t.items)},this.data=o;case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"extractInputs",value:function(t){var n,o;if(0===t.length)return{items:[]};null===(n=t[0].closest("li"))||void 0===n||null===(o=n.parentElement)||void 0===o||o.tagName;return{items:t.map((function(t){return{content:t.innerHTML,checked:!!t.closest(".".concat(e.Class.itemChecked))}}))}}},{key:"removeInputs",value:function(t){return t.forEach((function(t,n){if(0===n)t.innerHTML="";else{var o=t.closest(".".concat(e.Class.item));if(null===o||void 0===o?void 0:o.parentElement)o.parentElement.removeChild(o)}})),t[0]}},{key:"onPaste",value:function(e){var t=e.detail.data;this.data=b(t)}},{key:"destroy",value:function(){}},{key:"make",value:function(){var t=this,n=Object(c.make)("div",[e.Class.target]);if(this._data.items.length)this._data.items.forEach((function(e){var o=t.createChecklistItem(e);n.appendChild(o)}));else{var o=this.createChecklistItem();n.appendChild(o)}return n.addEventListener("keydown",(function(e){switch(e.keyCode){case 13:t.appendNewElement(e);break;case 8:t.backspace(e)}}),!1),n.addEventListener("click",(function(e){t.toggleCheckbox(e)})),n.addEventListener("paste",(function(n){var o=t.getTodoListData(n.clipboardData);if(null===o||void 0===o?void 0:o.length){var i,a,r=t.currentItem;if(!r)return;n.stopPropagation(),n.preventDefault();var s=[],l=document.createDocumentFragment();o.map((function(e){e.data.items.forEach((function(e){var n=t.createChecklistItem(e);s.push(n),l.appendChild(n)}))}));var d=t._blockEditable.selection.getRangeAt(0),u=!(null===(i=r.querySelector(".".concat(e.Class.textField)))||void 0===i?void 0:i.innerHTML.replace("<br>"," ").trim());r.after(l);var h=r.nextElementSibling,p=t._nodes.items.indexOf(r),f=p+1;(a=t._nodes.items).splice.apply(a,[f,0].concat(s)),u&&h?h&&(r.remove(),t._nodes.items.splice(p,1),Object(c.moveCaretToStart)(h.querySelector(".".concat(e.Class.textField)),t._blockEditable.selection)):d.select(!0),n.stopPropagation(),n.preventDefault()}})),n}},{key:"getTodoListData",value:function(t){if(!t)return[];var n=t.getData("application/block-editable");if(n)try{return JSON.parse(n).filter((function(t){return t.key===e.key}))}catch(o){return[]}}},{key:"toggleCheckbox",value:function(t){var n,o=t.target.closest(".".concat(e.Class.item)),i=null===o||void 0===o?void 0:o.querySelector(".".concat(e.Class.checkbox));i&&t.target.closest(".".concat(e.Class.checkbox))===i&&(null===o||void 0===o||null===(n=o.classList)||void 0===n||n.toggle(e.Class.itemChecked))}},{key:"createChecklistItem",value:function(t){t=t||{content:"",checked:!1};var n=Object(c.make)("div",e.Class.item),o=Object(c.make)("span",e.Class.checkbox),i=Object(c.make)("div",e.Class.textField,{contentEditable:"true"});return i.innerHTML=t.content||"",t.checked&&n.classList.add(e.Class.itemChecked),n.appendChild(o),n.appendChild(i),n}},{key:"appendNewElement",value:function(t){var n=this._blockEditable.state.ui;if(!n.someToolbarOpened||!n.someFlipperButtonFocused){t.preventDefault();var o=this._blockEditable.selection,i=this._blockEditable.state,a=i.content,r=i.cursor,s=i.toolbar,l=o.anchorNode,d=this._nodes.items[this._nodes.items.length-1].querySelector(".".concat(e.Class.textField)),u=null===d||void 0===d?void 0:d.innerHTML.replace("<br>"," ").trim();if(l===d&&!u){var h=null===d||void 0===d?void 0:d.closest(".".concat(e.Class.item)),p=this._nodes.items.indexOf(h);h&&-1!==p&&(h.remove(),this._nodes.items.splice(p,1));var f=a.insert();return f&&r.setToBlock(f),s.move(),void t.stopPropagation()}if(l&&l.parentNode){var v=l.parentNode.closest(".".concat(e.Class.item));if(v){var b=Object(c.extractFragmentFromCaretPositionTillTheEnd)(this._blockEditable.selection);if(b){var m=Object(c.fragmentToString)(b),g=this.createChecklistItem({checked:!1,content:m});this._nodes.target.insertBefore(g,v.nextSibling);var k=this._nodes.items.indexOf(v)+1;this._nodes.items.splice(k,0,g),Object(c.moveCaretToStart)(g.querySelector(".".concat(e.Class.textField)),this._blockEditable.selection)}}}}}},{key:"backspace",value:function(t){if(t.target){var n=this._blockEditable.selection,o=t.target.closest(".".concat(e.Class.item));if(o&&Object(c.isAtStart)(this._blockEditable.selection)){var i=this._nodes.items.indexOf(o),a=o.previousSibling;if(a){var r;t.preventDefault();var s=a.querySelectorAll(".".concat(e.Class.textField));if(r=Array.from(s).pop()){var l=Object(c.extractFragmentFromCaretPositionTillTheEnd)(this._blockEditable.selection),d=l?Object(c.fragmentToString)(l):"";Object(c.focus)(n,r,!1);var u=n.getRangeAt(0),h=u.createBookmark();r.insertAdjacentHTML("beforeend",d),i&&(t.preventDefault(),this._nodes.items.splice(i,1)),o.remove(),u.moveToBookmark(h).select(!0)}}}}}},{key:"data",get:function(){this._data.items=[];for(var t=0;t<this._nodes.items.length;t++){var n=this._nodes.items[t].querySelector(".".concat(e.Class.textField));if(n){var o=n.innerHTML.replace("<br>"," ").trim();this._data.items.push({content:o,checked:this._nodes.items[t].classList.contains(e.Class.itemChecked)})}}return this._data},set:function(t){this._data.items=t.items||[];var n=this._nodes.target;if(n&&n.parentNode){var o=this.make();n.parentNode.replaceChild(o,n),this._nodes.target=o,this._nodes.items=Array.from(this._nodes.target.querySelectorAll(".".concat(e.Class.item)))}}},{key:"currentItem",get:function(){var t=this._blockEditable.selection.anchorNode;return t&&t.nodeType!==Node.ELEMENT_NODE&&(t=t.parentNode),t&&t.closest(".".concat(e.Class.item))}}]),e}();m.key="todolist",l.a.regiester(m)},608:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return d}));var o=n(11),i=n(7),a=n(6),r=n(115),s=n(527),l=n(809),c=(n(1143),n(807),n(575)),d=function(){function e(t){Object(i.a)(this,e),this.nodes={actions:void 0},this._mathInput=void 0,this._defaultTeX=void 0,this._target=void 0,this._cacheRange=void 0,this._editData=void 0,this._blockEditable=void 0,this._insertHTML=void 0,this._mathInput=new l.a,this._blockEditable=t.blockEditable,this._target=e.checkTarget(t.target),this._defaultTeX=this._target&&this._target.dataset.tex||"",this._insertHTML=t.insertHTML}return Object(a.a)(e,[{key:"Class",get:function(){return{editor:"beui-insert-math__editor",button:"beui-insert-math__button"}}}],[{key:"checkHTML",value:function(e,t){var n=/<span class="inline-math" data-tex="([^<>]*)?"><svg.*?<\/svg><\/span>/g;return"zhihu"===t.type?e&&e.replace(n,'<img class="Formula-image" data-eeimg="true" src="" alt="$1">'):"juejin"===t.type?e&&e.replace(n,'<img class="equation" src="https://juejin.im/equation?tex=$1" alt=""/>'):e}},{key:"checkMarkdown",value:function(e){return e&&e.replace(/<span class="inline-math" data-tex="([^<>]*)?"><svg.*?<\/svg><\/span>/g,"$$$1$$$")}},{key:"checkTarget",value:function(e){return e&&1===e.nodeType?e.closest(".inline-math"):e&&e.parentNode&&e.parentNode.closest(".inline-math")}},{key:"sanitize",get:function(){return{span:!0,svg:!0,defs:!0,g:!0,use:!0,path:!0}}}]),Object(a.a)(e,[{key:"renderActions",value:function(){var e=this;return this.nodes.actions=s.a.make("div"),this.nodes.editor=s.a.make("div",[this.Class.editor]),this.nodes.button=s.a.make("button",[this.Class.button]),s.a.append(this.nodes.actions,[this.nodes.editor,this.nodes.button]),this._mathInput.mount(this.nodes.editor,this._defaultTeX,(function(t){e._editData=Object(o.a)({},t)})),this.nodes.button.addEventListener("click",(function(){if(e._target)if(e._editData&&e._editData.tex){var t=document.createElement("div");t.innerHTML='<span class="inline-math" data-tex="'.concat(e._editData.tex,'">').concat(Object(c.a)(e._editData.html),"</span>"),e._target.replaceWith(t.childNodes[0])}else e._target.remove();else e._editData&&e._editData.tex?e._insertHTML("\u200b".concat('<span class="inline-math" data-tex="',e._editData.tex,'">').concat(Object(c.a)(e._editData.html),"</span>","\u200b")):e._insertHTML("");e._blockEditable.state.insertToolbar.close()})),this.nodes.actions}},{key:"destroy",value:function(){this._mathInput.unmount()}}]),e}();d.key="math",r.c.regiester(d)},609:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return p}));var o=n(7),i=n(573),a=n(160),r=n(6),s=n(10),l=n(9),c=n(552),d=n(115),u="default",h=["rgb(255, 241, 153)","rgb(233, 238, 181)","rgb(219, 243, 205)","rgb(200, 240, 215)","rgb(193, 245, 238)","rgb(212, 233, 255)","rgb(218, 219, 241)","rgb(255, 220, 235)","rgb(255, 220, 209)","rgb(255, 222, 189)","rgb(217, 217, 217)","transparent"],p=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){return Object(o.a)(this,n),t.call(this,{cmdName:"backcolor",shortcut:"",title:"BackgroundColor",blockEditable:e.blockEditable})}return Object(r.a)(n,null,[{key:"key",get:function(){return"backcolor"}},{key:"sanitize",get:function(){return{span:{}}}}]),Object(r.a)(n,[{key:"render",value:function(){var e=Object(i.a)(Object(a.a)(n.prototype),"render",this).call(this),t=document.createElement("div");return t.classList.add(this.Class.buttonBottomColor),t.style.backgroundColor="default"===u?"":u,this.nodes.bottomColor=t,e.appendChild(t),e}},{key:"renderActions",value:function(){var e=this,t=document.createElement("div");return t.classList.add(this.Class.actions,"beui-inline-tool-backcolor"),t.innerHTML=h.map((function(e){return'<span class="backcolor-item" data-color="'.concat(e,'" style="border-color: ').concat(e,";background-color: ").concat(e,'"></span>')})).join(""),this.nodes.actions=t,t.addEventListener("click",(function(t){if(t.stopPropagation(),t.target){var n=t.target.closest(".backcolor-item");if(n){var o=e.blockEditable.editable,i=n.dataset.color;e.nodes.bottomColor&&i&&(u="transparent"===i?"default":i,e.nodes.bottomColor.style.backgroundColor=i),o.execCommand(e.cmdName,u)}}})),t}},{key:"selectionChange",value:function(e,t){var n=e.getRangeAt(0).startContainer;if(n&&1!==n.nodeType&&(n=n.parentNode),n){var o=n.style.backgroundColor;o&&(u=o)}return this.nodes.bottomColor&&(this.nodes.bottomColor.style.backgroundColor=u),!1}},{key:"surround",value:function(e,t){t.execCommand(this.cmdName,u)}}]),n}(c.default);d.b.regiester(p)},610:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var o=n(7),i=n(6),a=n(10),r=n(9),s=n(534),l=n(115),c=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){return Object(o.a)(this,n),t.call(this,{cmdName:"bold",shortcut:"Ctrl+B",title:"Blod",blockEditable:e.blockEditable})}return Object(i.a)(n,null,[{key:"key",get:function(){return"bold"}},{key:"sanitize",get:function(){return{b:!0,strong:!0}}}]),n}(s.default);l.b.regiester(c)},611:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return p}));var o=n(7),i=n(573),a=n(160),r=n(6),s=n(10),l=n(9),c=n(552),d=n(115),u="default",h=["rgb(163, 0, 0)","rgb(161, 103, 0)","rgb(177, 150, 0)","rgb(96, 159, 0)","rgb(0, 122, 5)","rgb(0, 159, 115)","rgb(0, 140, 183)","rgb(0, 60, 179)","rgb(84, 0, 139)","rgb(0, 0, 0)","rgb(255, 0, 0)","rgb(255, 163, 0)","rgb(255, 216, 0)","rgb(140, 232, 0)","rgb(0, 210, 8)","rgb(0, 237, 161)","rgb(0, 195, 255)","rgb(0, 86, 255)","rgb(155, 0, 255)","rgb(77, 77, 77)","rgb(255, 152, 140)","rgb(255, 210, 133)","rgb(255, 244, 89)","rgb(209, 255, 85)","rgb(146, 255, 150)","rgb(168, 255, 225)","rgb(143, 229, 255)","rgb(90, 146, 255)","rgb(214, 150, 255)","rgb(168, 168, 168)","rgb(255, 229, 226)","rgb(255, 244, 215)","rgb(255, 250, 186)","rgb(239, 255, 195)","rgb(220, 255, 221)","rgb(222, 252, 242)","rgb(210, 245, 255)","rgb(196, 216, 255)","rgb(246, 216, 255)","rgb(255, 255, 255)"],p=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){return Object(o.a)(this,n),t.call(this,{cmdName:"fontcolor",shortcut:"",title:"FontColor",blockEditable:e.blockEditable})}return Object(r.a)(n,null,[{key:"key",get:function(){return"fontcolor"}},{key:"sanitize",get:function(){return{span:{}}}}]),Object(r.a)(n,[{key:"render",value:function(){var e=Object(i.a)(Object(a.a)(n.prototype),"render",this).call(this),t=document.createElement("div");return t.classList.add(this.Class.buttonBottomColor),t.style.backgroundColor="default"===u?"":u,this.nodes.bottomColor=t,e.appendChild(t),e}},{key:"renderActions",value:function(){var e=this,t=document.createElement("div");return t.classList.add(this.Class.actions,"beui-inline-tool-fontcolor"),t.innerHTML=h.map((function(e){return'<span class="fontcolor-item" data-color="'.concat(e,'" style="border-color: ').concat(e,";background-color: ").concat(e,'"></span>')})).join(""),this.nodes.actions=t,t.addEventListener("click",(function(t){if(t.stopPropagation(),t.target){var n=t.target.closest(".fontcolor-item");if(n){var o=e.blockEditable.editable,i=n.dataset.color;e.nodes.bottomColor&&i&&(u=i,e.nodes.bottomColor.style.backgroundColor=i),o.execCommand(e.cmdName,n.dataset.color)}}})),t}},{key:"selectionChange",value:function(e,t){var n=e.getRangeAt(0).startContainer;if(n&&1!==n.nodeType&&(n=n.parentNode),n){var o=n.style.color;o&&(u=o)}return this.nodes.bottomColor&&(this.nodes.bottomColor.style.backgroundColor=u),!1}},{key:"surround",value:function(e,t){t.execCommand(this.cmdName,u)}}]),n}(c.default);d.b.regiester(p)},612:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return h}));var o=n(7),i=n(573),a=n(160),r=n(6),s=n(10),l=n(9),c=n(552),d=n(115),u=[12,13,14,15,16,17,18,20,22,24,28,36,48,60,72],h=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){return Object(o.a)(this,n),t.call(this,{cmdName:"fontsize",shortcut:"",title:"FontSize",blockEditable:e.blockEditable})}return Object(r.a)(n,null,[{key:"key",get:function(){return"fontsize"}},{key:"sanitize",get:function(){return{span:{}}}}]),Object(r.a)(n,[{key:"render",value:function(){var e=Object(i.a)(Object(a.a)(n.prototype),"render",this).call(this);if(this.nodes.icon){var t=document.createElement("span");t.innerText="14",this.nodes.icon.replaceWith(t),this.nodes.icon=t}return e}},{key:"renderActions",value:function(){var e=this,t=document.createElement("div");return t.classList.add(this.Class.actions,"beui-inline-tool-fontsize"),t.innerHTML=u.map((function(e){return'<span class="fontsize-item" data-size="'.concat(e,'">').concat(e,"</span>")})).join(""),this.nodes.actions=t,t.addEventListener("click",(function(t){if(t.stopPropagation(),t.target){var n=t.target.closest(".fontsize-item");if(n)e.blockEditable.editable.execCommand(e.cmdName,n.innerText+"px")}})),t}},{key:"selectionChange",value:function(e,t){var n=t.queryCommandValue(this.cmdName);if(this.nodes.icon&&n){var o=n.replace(/[^\d]*/gi,"");this.nodes.icon.innerText=o;var i=this.nodes.actions;if(i){var a=i.querySelector(".fontsize-item--active");a&&a.dataset.size!==o&&a.classList.remove("fontsize-item--active");var r=i.querySelector('[data-size="'.concat(o,'"]'));r&&r.classList.add("fontsize-item--active")}}return!1}},{key:"surround",value:function(e,t){this.toggleActions()}}]),n}(c.default);d.b.regiester(h)},613:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var o=n(7),i=n(6),a=n(10),r=n(9),s=n(527),l=n(115),c=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){var i;return Object(o.a)(this,n),(i=t.call(this,{cmdName:"footnote",shortcut:"",title:"FootNote",blockEditable:e.blockEditable})).footnoteNodes={},i}return Object(i.a)(n,null,[{key:"key",get:function(){return"footnote"}},{key:"sanitize",get:function(){return{footnote:{"data-note":!0,"data-title":!0}}}}]),Object(i.a)(n,[{key:"render",value:function(){var e=this;this.nodes.button=document.createElement("button"),this.nodes.button.type="button",this.nodes.button.classList.add(this.Class.button,this.Class.buttonModifier),this.nodes.button.appendChild(s.a.icon(this.cmdName,12,14));var t=s.a.icon("arrow",12,14);return this.nodes.toggler=t,t.addEventListener("click",(function(t){t.stopPropagation(),t.preventDefault(),e.toggleActions()})),this.nodes.button.appendChild(t),this.nodes.button}},{key:"renderActions",value:function(){var e=this;this.nodes.actions=document.createElement("div");var t=document.createElement("input");t.setAttribute("placeholder",this.blockEditable.getLang("toolbar.inline.footnoteContentPlaceholder")),t.classList.add(this.linkClass.link);var n=document.createElement("input");return n.setAttribute("placeholder",this.blockEditable.getLang("toolbar.inline.footnoteTitlePlaceholder")),n.classList.add(this.linkClass.link),t.addEventListener("keydown",(function(t){t.keyCode===e.ENTER_KEY?e.enterPressed(t):40===t.keyCode&&n.focus(),t.stopPropagation()})),t.addEventListener("focus",(function(){e.setHighlightRange()})),n.addEventListener("keydown",(function(n){n.keyCode===e.ENTER_KEY?e.enterPressed(n):38===n.keyCode&&t.focus(),n.stopPropagation()})),n.addEventListener("focus",(function(){e.setHighlightRange()})),this.nodes.actions.appendChild(t),this.nodes.actions.appendChild(n),this.footnoteNodes.content=t,this.footnoteNodes.title=n,this.nodes.actions.classList.add(this.Class.actions),this.nodes.actions.classList.add(this.footnoteClass.footnote),this.nodes.actions}},{key:"surround",value:function(e,t){t.selection;if(e&&t.queryCommandValue(this.cmdName))return t.execCommand(this.cmdName),void this.closeActions();this.cacheRange=e?e.cloneRange():null,this.toggleActions()}},{key:"selectionChange",value:function(e,t){var n=t.queryCommandValue(this.cmdName);if(n){var o;null===(o=this.nodes.button)||void 0===o||o.classList.add(this.Class.buttonActive);var i=n.getAttribute("data-title");this.footnoteNodes.title&&(this.footnoteNodes.title.value="null"!==i?i:"");var a=n.getAttribute("data-note");this.footnoteNodes.content&&(this.footnoteNodes.content.value="null"!==a?a:"")}else{var r;null===(r=this.nodes.button)||void 0===r||r.classList.remove(this.Class.buttonActive)}return this.removeHighlightRange(),this.cacheRange=e.getRangeAt(0).cloneRange(),!!n}},{key:"toggleActions",value:function(){var e;(null===(e=this.nodes.actions)||void 0===e?void 0:e.classList.contains(this.Class.actionsShowed))?this.closeActions(!1):(this.hideActions(),this.openActions(!0))}},{key:"openActions",value:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.blockEditable.editable.selection;null===(e=this.nodes.actions)||void 0===e||e.classList.add(this.Class.actionsShowed),n&&setTimeout((function(){var e;null===(e=t.footnoteNodes.content)||void 0===e||e.focus()}),300)}},{key:"closeActions",value:function(){this.blockEditable.editable.selection;this.nodes.actions&&this.nodes.actions.classList.remove(this.Class.actionsShowed),this.removeHighlightRange()}},{key:"enterPressed",value:function(e){var t,n,o=this.blockEditable.editable,i=(null===(t=this.footnoteNodes.content)||void 0===t?void 0:t.value)||"",a=(null===(n=this.footnoteNodes.title)||void 0===n?void 0:n.value)||"";this.cacheRange&&this.cacheRange.select(!0),this.removeHighlightRange(),o.execCommand(this.cmdName,{"data-note":i,"data-title":a}),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),this.blockEditable.state.inlineToolbar.close()}},{key:"footnoteClass",get:function(){return{footnote:"beui-inline-tool-footnote"}}}]),n}(n(571).default);l.b.regiester(c)},614:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var o=n(7),i=n(6),a=n(10),r=n(9),s=n(534),l=n(115),c=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){return Object(o.a)(this,n),t.call(this,{cmdName:"inlinecode",shortcut:"Ctrl+Shift+C",title:"Inline Code",blockEditable:e.blockEditable})}return Object(i.a)(n,null,[{key:"key",get:function(){return"inlinecode"}},{key:"sanitize",get:function(){return{code:{}}}}]),n}(s.default);l.b.regiester(c)},615:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var o=n(7),i=n(6),a=n(10),r=n(9),s=n(534),l=n(115),c=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){return Object(o.a)(this,n),t.call(this,{cmdName:"italic",shortcut:"CMD+I",title:"Italic",blockEditable:e.blockEditable})}return Object(i.a)(n,null,[{key:"key",get:function(){return"italic"}},{key:"sanitize",get:function(){return{i:{},em:{}}}}]),n}(s.default);l.b.regiester(c)},616:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var o=n(7),i=n(6),a=n(10),r=n(9),s=n(534),l=n(115),c=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){return Object(o.a)(this,n),t.call(this,{cmdName:"kbd",shortcut:"Ctrl+'",title:"Keyboard",blockEditable:e.blockEditable})}return Object(i.a)(n,null,[{key:"key",get:function(){return"kbd"}},{key:"sanitize",get:function(){return{kbd:!0}}}]),n}(s.default);l.b.regiester(c)},617:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var o=n(7),i=n(6),a=n(10),r=n(9),s=n(534),l=n(115),c=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){return Object(o.a)(this,n),t.call(this,{cmdName:"mark",shortcut:"Ctrl+M",title:"Mark",blockEditable:e.blockEditable})}return Object(i.a)(n,null,[{key:"key",get:function(){return"mark"}},{key:"sanitize",get:function(){return{mark:{}}}}]),n}(s.default);l.b.regiester(c)},618:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var o=n(7),i=n(6),a=n(10),r=n(9),s=n(534),l=n(115),c=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){return Object(o.a)(this,n),t.call(this,{cmdName:"math",shortcut:"CMD+M",title:"Math",blockEditable:e.blockEditable})}return Object(i.a)(n,null,[{key:"key",get:function(){return"math"}},{key:"sanitize",get:function(){return{i:{}}}}]),n}(s.default);l.b.regiester(c)},619:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var o=n(7),i=n(6),a=n(10),r=n(9),s=n(534),l=n(115),c=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){return Object(o.a)(this,n),t.call(this,{cmdName:"removeformat",shortcut:"CMD+R",title:"RemoveFormat",blockEditable:e.blockEditable})}return Object(i.a)(n,null,[{key:"key",get:function(){return"removeformat"}},{key:"sanitize",get:function(){return{i:{}}}}]),n}(s.default);l.b.regiester(c)},620:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var o=n(7),i=n(6),a=n(10),r=n(9),s=n(534),l=n(115),c=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){return Object(o.a)(this,n),t.call(this,{cmdName:"strikethrough",shortcut:"Ctrl+D",title:"Strikethrough",blockEditable:e.blockEditable})}return Object(i.a)(n,null,[{key:"key",get:function(){return"strikethrough"}},{key:"sanitize",get:function(){return{s:{},del:{}}}}]),n}(s.default);l.b.regiester(c)},621:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var o=n(7),i=n(6),a=n(10),r=n(9),s=n(534),l=n(115),c=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){return Object(o.a)(this,n),t.call(this,{cmdName:"subscript",shortcut:"Ctrl+Shift+,",title:"Subscript",blockEditable:e.blockEditable})}return Object(i.a)(n,null,[{key:"key",get:function(){return"subscript"}},{key:"sanitize",get:function(){return{sub:{}}}}]),n}(s.default);l.b.regiester(c)},622:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var o=n(7),i=n(6),a=n(10),r=n(9),s=n(534),l=n(115),c=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){return Object(o.a)(this,n),t.call(this,{cmdName:"superscript",shortcut:"Ctrl+Shift+.",title:"Superscript",blockEditable:e.blockEditable})}return Object(i.a)(n,null,[{key:"key",get:function(){return"superscript"}},{key:"sanitize",get:function(){return{sup:{}}}}]),n}(s.default);l.b.regiester(c)},623:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var o=n(7),i=n(6),a=n(10),r=n(9),s=n(534),l=n(115),c=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){return Object(o.a)(this,n),t.call(this,{cmdName:"underline",shortcut:"Ctrl+U",title:"Underline",blockEditable:e.blockEditable})}return Object(i.a)(n,null,[{key:"key",get:function(){return"underline"}},{key:"sanitize",get:function(){return{u:{}}}}]),n}(s.default);l.b.regiester(c)},624:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return p}));var o=n(7),i=n(573),a=n(160),r=n(6),s=n(10),l=n(9),c=n(552),d=n(115),u=0,h=[["\uff08","\uff09"],["\u3010","\u3011"],["\u201c","\u201d"],["\u2018","\u2019"],["\u300a","\u300b"],["(",")"],["[","]"],['"','"'],["'","'"],["\xab","\xbb"],["\ufe5d","\ufe5e"],["\uff1c","\uff1e"],["\u3016","\u3017"],["{","}"],["\u3008","\u3009"],["\u3014","\u3015"],["<",">"],["\u2039","\u203a"],["\uff3b","\uff3d"],["\u300c","\u300d"],["\u300e","\u300f"]],p=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){return Object(o.a)(this,n),t.call(this,{cmdName:"wrap",shortcut:"",title:"Wrap",blockEditable:e.blockEditable})}return Object(r.a)(n,null,[{key:"key",get:function(){return"wrap"}},{key:"sanitize",get:function(){return{span:{}}}}]),Object(r.a)(n,[{key:"render",value:function(){var e=Object(i.a)(Object(a.a)(n.prototype),"render",this).call(this);if(this.nodes.icon){var t=document.createElement("span");t.style.fontSize="12px";var o=h[u];t.innerText="".concat(o[0]).concat(o[1]),this.nodes.icon.replaceWith(t),this.nodes.icon=t}return e}},{key:"renderActions",value:function(){var e=this,t=document.createElement("div");return t.classList.add(this.Class.actions,"beui-inline-tool-wrap"),t.innerHTML=h.map((function(e,t){return'<span class="wrap-item" data-index="'.concat(t,'">').concat(e[0]).concat(e[1],"</span>")})).join(""),this.nodes.actions=t,t.addEventListener("click",(function(t){if(t.stopPropagation(),t.target){var n=t.target.closest(".wrap-item");if(n){var o=e.blockEditable.editable,i=parseInt(n.dataset.index||"0"),a=h[u=i];e.nodes.icon&&(e.nodes.icon.innerText="".concat(a[0]).concat(a[1])),o.execCommand(e.cmdName,{left:a[0],right:a[1]})}}})),t}},{key:"selectionChange",value:function(e,t){return!1}},{key:"surround",value:function(e,t){var n=h[u];t.execCommand(this.cmdName,{left:n[0],right:n[1]})}}]),n}(c.default);d.b.regiester(p)},625:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var o=n(7),i=n(6),a=n(10),r=n(9),s=n(553),l=n(115),c=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){var i=e.blockEditable;return Object(o.a)(this,n),t.call(this,{blockEditable:i,cmdName:n.key})}return Object(i.a)(n,null,[{key:"key",get:function(){return"align-center"}}]),n}(s.default);l.d.regiester(c)},626:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var o=n(7),i=n(6),a=n(10),r=n(9),s=n(553),l=n(115),c=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){var i=e.blockEditable;return Object(o.a)(this,n),t.call(this,{blockEditable:i,cmdName:n.key})}return Object(i.a)(n,null,[{key:"key",get:function(){return"align-justify"}}]),n}(s.default);l.d.regiester(c)},627:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var o=n(7),i=n(6),a=n(10),r=n(9),s=n(553),l=n(115),c=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){var i=e.blockEditable;return Object(o.a)(this,n),t.call(this,{blockEditable:i,cmdName:n.key})}return Object(i.a)(n,null,[{key:"key",get:function(){return"align-right"}}]),n}(s.default);l.d.regiester(c)},628:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var o=n(7),i=n(6),a=n(527),r=n(115),s=function(){function e(t){var n=this,i=t.blockEditable;Object(o.a)(this,e),this._blockEditable=void 0,this._needConfirmation=void 0,this.resetConfirmation=void 0,this._nodes={},this._blockEditable=i,this.resetConfirmation=function(){return n.setConfirmation(!1),{}},this._blockEditable.editable.registerCommand((function(){return{cmdName:"delete",execCommand:function(e){n.delete()},queryCommandState:function(){return n.api.content.activeBlock?0:-1}}}))}return Object(i.a)(e,null,[{key:"key",get:function(){return"delete"}}]),Object(i.a)(e,[{key:"render",value:function(){var t=this;this._nodes.button=a.a.make("div",[e.Class.button,e.Class.buttonDelete],{}),this._nodes.button.appendChild(a.a.icon("bin",12,12)),this.api.content.readOnlyMutableListeners.on(this._nodes.button,"click",(function(e){return t.handleClick(e)}),!1);var n=this._blockEditable.getLang("toolbar.settings.delete");return this.api.tooltip.onHover(this._nodes.button,n),this._nodes.button}},{key:"handleClick",value:function(e){this._needConfirmation?(this._blockEditable.eventsDispatcher.off("block-settings-closed",this.resetConfirmation),this._blockEditable.editable.execCommand("delete"),this.api.toolbar.close(),this.api.tooltip.hide(),e.stopPropagation()):(this.setConfirmation(!0),this._blockEditable.eventsDispatcher.on("block-settings-closed",this.resetConfirmation))}},{key:"setConfirmation",value:function(t){this._needConfirmation=t,this._nodes.button.classList.add(e.Class.buttonConfirm)}},{key:"delete",value:function(){this.api.content.delete()}},{key:"api",get:function(){return this._blockEditable.state}}]),e}();s.Class={button:"beui-settings__button",buttonDelete:"beui-settings__button--delete",buttonConfirm:"beui-settings__button--confirm"},r.d.regiester(s)},629:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return l}));var o=n(7),i=n(6),a=n(10),r=n(9),s=n(115),l=function(e){Object(a.a)(n,e);var t=Object(r.a)(n);function n(e){var i=e.blockEditable;return Object(o.a)(this,n),t.call(this,{blockEditable:i,cmdName:"insert-line-before",insertOffset:0})}return Object(i.a)(n,null,[{key:"key",get:function(){return"insert-line-before"}}]),n}(n(572).default);s.d.regiester(l)},630:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var o=n(7),i=n(6),a=n(527),r=n(115),s=function(){function e(t){var n=this,i=t.blockEditable;Object(o.a)(this,e),this._blockEditable=void 0,this._blockEditable=i,this._blockEditable.editable.registerCommand((function(){return{cmdName:"movedown",execCommand:function(e){n.moveDown()},queryCommandState:function(){var e=n.api.content.activeBlockIndex,t=n.api.content.getBlockByIndex(e);return n.api.content.getBlockByIndex(e+1)&&t?0:-1}}}))}return Object(i.a)(e,null,[{key:"key",get:function(){return"movedown"}}]),Object(i.a)(e,[{key:"render",value:function(){var t=this,n=a.a.make("div",[e.Class.button,e.Class.wrapper],{});n.appendChild(a.a.icon("arrow-down",14,14)),this.api.content.readOnlyMutableListeners.on(n,"click",(function(e){return t.handleClick(e,n)}),!1);var o=this._blockEditable.getLang("toolbar.settings.moveDown");return this.api.tooltip.onHover(n,o),n}},{key:"handleClick",value:function(t,n){var o=this.api.content.activeBlockIndex;if(!this.api.content.getBlockByIndex(o+1))return n.classList.add(e.Class.animation),void window.setTimeout((function(){n.classList.remove(e.Class.animation)}),500);this._blockEditable.editable.execCommand("movedown")}},{key:"moveDown",value:function(){var e=this._blockEditable.editable.window,t=this.api.content.activeBlockIndex,n=this.api.content.getBlockByIndex(t+1);if(n){var o=n.holder,i=o.getBoundingClientRect(),a=Math.abs(e.innerHeight-o.offsetHeight);i.top<e.innerHeight&&(a=e.scrollY+o.offsetHeight),e.scrollTo(0,a),this.api.content.move(t+1),this.api.toolbar.move(!1),this.api.tooltip.hide()}}},{key:"api",get:function(){return this._blockEditable.state}}]),e}();s.Class={button:"beui-settings__button",wrapper:"beui-tune-move-down",animation:"wobble"},r.d.regiester(s)},631:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var o=n(7),i=n(6),a=n(527),r=n(115),s=function(){function e(t){var n=this,i=t.blockEditable;Object(o.a)(this,e),this._blockEditable=void 0,this._blockEditable=i,this._blockEditable.editable.registerCommand((function(){return{cmdName:"moveup",execCommand:function(e){n.moveUp()},queryCommandState:function(){var e=n.api.content.activeBlockIndex,t=n.api.content.getBlockByIndex(e);return n.api.content.getBlockByIndex(e-1)&&t?0:-1}}}))}return Object(i.a)(e,null,[{key:"key",get:function(){return"moveup"}}]),Object(i.a)(e,[{key:"render",value:function(){var t=this,n=a.a.make("div",[e.Class.button,e.Class.wrapper],{});n.appendChild(a.a.icon("arrow-up",14,14)),this.api.content.readOnlyMutableListeners.on(n,"click",(function(e){return t.handleClick(e,n)}),!1);var o=this._blockEditable.getLang("toolbar.settings.moveUp");return this.api.tooltip.onHover(n,o),n}},{key:"handleClick",value:function(t,n){var o=this.api.content.activeBlockIndex,i=this.api.content.getBlockByIndex(o),a=this.api.content.getBlockByIndex(o-1);if(0===o||!i||!a)return n.classList.add(e.Class.animation),void setTimeout((function(){n.classList.remove(e.Class.animation)}),500);this._blockEditable.editable.execCommand("moveup")}},{key:"moveUp",value:function(){var e=this._blockEditable.editable.window,t=this.api.content.activeBlockIndex,n=this.api.content.getBlockByIndex(t),o=this.api.content.getBlockByIndex(t-1);if(0!==t&&n&&o){var i,a=n.holder,r=o.holder,s=a.getBoundingClientRect(),l=r.getBoundingClientRect();i=l.top>0?Math.abs(s.top)-Math.abs(l.top):e.innerHeight-Math.abs(s.top)+Math.abs(l.top),e.scrollBy(0,-1*i),this.api.content.move(t-1),this.api.toolbar.move(!1),this.api.tooltip.hide()}}},{key:"api",get:function(){return this._blockEditable.state}}]),e}();s.Class={button:"beui-settings__button",wrapper:"beui-tune-move-up",animation:"wobble"},r.d.regiester(s)},632:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var o=n(7),i=n(6),a=n(527),r=n(115),s=function(){function e(t){var n=this,i=t.blockEditable;Object(o.a)(this,e),this._blockEditable=void 0,this._nodes={},this._settingsButtonActive="",this._blockEditable=i,this._blockEditable.editable.registerCommand((function(){return{cmdName:"quote",execCommand:function(e){n.quote()},queryCommandState:function(){var e=n.api.content.activeBlock;return e&&e.quoted?1:0}}})),this._blockEditable.editable.on("selectionchange",(function(){}))}return Object(i.a)(e,null,[{key:"key",get:function(){return"quote"}}]),Object(i.a)(e,[{key:"render",value:function(t){var n=this,o=a.a.make("div",[e.Class.button,e.Class.wrapper],{});o.appendChild(a.a.icon("quote",14,14)),this.api.content.readOnlyMutableListeners.on(o,"click",(function(e){return n.handleClick(e,o)}),!1),this._settingsButtonActive=t.settingsButtonActive;var i=this._blockEditable.getLang("toolbar.settings.quote");return this.api.tooltip.onHover(o,i),this._nodes.button=o,this.updateQuateButtonState(),o}},{key:"handleClick",value:function(e,t){this._blockEditable.editable.execCommand("quote")}},{key:"quote",value:function(){this._blockEditable.editable.window;var e=this.api.content.activeBlock;e&&(e.quoted=!e.quoted,this.updateQuateButtonState())}},{key:"updateQuateButtonState",value:function(){var e=this.api.content.activeBlock;this._nodes.button.classList.toggle(this._settingsButtonActive,e&&e.quoted)}},{key:"api",get:function(){return this._blockEditable.state}}]),e}();s.Class={button:"beui-settings__button",wrapper:"beui-tune-quote"},r.d.regiester(s)},633:function(e,t,n){"use strict";function o(e,t){var n=this;this.done=e,this.error=t,this.handleMessageEvent=function(e){if(null!=n.frame&&e.source==n.frame.contentWindow&&e.data)try{var t=e.data;null!=t&&n.handleMessage(t)}catch(o){console.error(o)}}}n.r(t),o.prototype.drawDomain="./image.html",o.prototype.frameStyle="position:absolute;border:0;width:100%;height:100%;z-index:100",o.prototype.startEditing=function(e){var t=this;return new Promise((function(n,o){null==t.frame&&(window.addEventListener("message",t.handleMessageEvent),t.frame=t.createFrame(t.getFrameUrl(e),t.getFrameStyle()),document.body.appendChild(t.frame),t.frame.onload=function(){n()},t.frame.onerror=function(){o()})}))},o.prototype.setWaiting=function(e){if(null!=this.startElement){var t=this.startElement,n=t.nodeName.toLowerCase();"svg"!=n&&"object"!=n||(t=t.parentNode),null!=t&&(e?(this.frame.style.pointerEvents="none",this.previousCursor=t.style.cursor,t.style.cursor="wait"):(t.style.cursor=this.previousCursor,this.frame.style.pointerEvents=""))}},o.prototype.setActive=function(e){e?(this.previousOverflow=document.body.style.overflow,document.body.style.overflow="hidden"):document.body.style.overflow=this.previousOverflow},o.prototype.stopEditing=function(){null!=this.frame&&(window.removeEventListener("message",this.handleMessageEvent),document.body.removeChild(this.frame),this.setActive(!1),this.frame=null)},o.prototype.postMessage=function(e){null!=this.frame&&this.frame.contentWindow.postMessage(JSON.stringify(e),"*")},o.prototype.getData=function(){return this.data},o.prototype.getTitle=function(){return this.title},o.prototype.getFrameStyle=function(){return this.frameStyle+";left:"+document.body.scrollLeft+"px;top:"+document.body.scrollTop+"px;"},o.prototype.getFrameUrl=function(e){return this.drawDomain+"?url="+encodeURIComponent(e)},o.prototype.createFrame=function(e,t){var n=document.createElement("iframe");return n.setAttribute("frameborder","0"),n.setAttribute("style",t),n.setAttribute("src",e),n},o.prototype.handleMessage=function(e){"image-save"==e.event?this.done(e.data.blob):"image-exit"==e.event?this.stopEditing(e):"image-error"===e.event&&this.error(e)},o.prototype.done=function(){},o.prototype.initialized=function(){},t.default=o},634:function(e,t,n){"use strict";n.r(t),n.d(t,"Constant",(function(){return c})),n.d(t,"unhtml",(function(){return v})),n.d(t,"default",(function(){return b}));var o=n(11),i=n(7),a=n(6),r=n(635),s=n(878),l=n.n(s),c={block:"be-code",line:"be-code__line",text:"be-code__line-text",langAttr:"data-lang",codeBlockTagName:"pre",lineTagName:"code",lineTextTagName:"span",tabSize:"  ",classPrefix:"be-code__"};for(var d in r.Languages)if(Object.prototype.hasOwnProperty.call(r.Languages,d)){var u=r.Languages[d];l.a.registerLanguage(d,u),l.a.configure({classPrefix:c.classPrefix})}function h(e){return e&&e.parentNode&&e.parentNode.closest(".".concat(c.line))}function p(e){return e&&e.parentNode&&e.parentNode.closest("".concat(c.codeBlockTagName))}function f(e,t){e=e||"";var n=(t=t||document).createElement(c.codeBlockTagName);n.innerHTML=e;for(var o=t.createDocumentFragment();n.firstChild;)o.appendChild(n.firstChild);return o}function v(e,t){return e?e.replace(t||/[&<">'](?:(amp|lt|ldquo|rdquo|quot|gt|#39|nbsp|middot|#\d+);)?/g,(function(e,t){return t?e:{"<":"&lt;","&":"&amp;",'"':"&quot;","\u201c":"&ldquo;","\u201d":"&rdquo;",">":"&gt;","'":"&#39;","\xb7":"&middot;"}[e]})):""}var b=function(){function e(t){Object(i.a)(this,e),this._blockEditable=void 0,this._blockEditable=t}return Object(a.a)(e,[{key:"highlightCurrentLine",value:function(){var e=this._blockEditable.editable.selection,t=e.anchorNode||e.focusNode,n=e.getRangeAt(0);this.highlightLine(t,n)}},{key:"highlightLine",value:function(e,t){var n=h(e);if(n){var o=p(e);if(o){var i=this._blockEditable.editable,a=i.document,r=i.$dom;if(n.textContent){var s=h(t.startContainer),l=h(t.endContainer),d={id:void 0,start:"",end:""},u=!1;n===s&&n===l&&(d=t.createBookmark(),u=!0);var f=this.getCommentSibling(n),v=o.getAttribute(c.langAttr)||"",b=this.highlightText(f.nodeText,v,u);b.result.language&&!v&&o.setAttribute(c.langAttr,b.result.language);var m=a.createElement(c.codeBlockTagName);m.innerHTML=b.result.value;for(var g=[],k=0,y=m.children.length;k<y;k++)g.push(m.children[k]);var C=g[f.pre.length].firstElementChild,_=((null===C||void 0===C?void 0:C.textContent)||"").replace(r.fillCharReg,"");if(u&&!_&&(!b.bookmark||!b.bookmark.startid)){var x=r.createBookmarkNode(a,Math.random());null===C||void 0===C||C.appendChild(x),null===C||void 0===C||C.appendChild(a.createTextNode(r.fillChar)),d.id=x.id,d.start=x.id}return this.updateLines(f.nodeList,g),u&&(!d.id&&b.bookmark&&b.bookmark.startid&&(d.id=d.start=b.bookmark.startid),!d.id&&b.bookmark&&b.bookmark.endid&&(d.end=b.bookmark.endid),t.moveToBookmark(d).select()),b}}}}},{key:"updateLines",value:function(e,t){if(e&&t&&e.length===t.length)for(var n=0,o=e.length;n<o;n++){var i,a,r=e[n],s=t[n];if(r.innerHTML!==s.innerHTML)null===(i=r.parentNode)||void 0===i||i.insertBefore(s,r),null===(a=r.parentNode)||void 0===a||a.removeChild(r)}}},{key:"blur",value:function(e){var t=p(e.target);if(t){var n=this._blockEditable.editable,o=n.$dom,i=n.document,a=t.getAttribute(c.langAttr);if(a){for(var r=[],s=[],l=0,d=t.children.length;l<d;l++){var u=t.children[l];r.push(u),s.push(u.textContent||"")}var h=s.join("\n").replace(/\n/g,"").replace(o.fillCharReg,"").replace(o.bookmarkFillCharReg,"");if(h){var f=this.highlightText(h,a,!1),v=i.createElement(c.codeBlockTagName);v.innerHTML=f.result.value;for(var b=[],m=0,g=v.children.length;m<g;m++){var k=t.children[m];b.push(k)}this.updateLines(r,b)}}}}},{key:"backspace",value:function(e){var t=this._blockEditable.editable,n=t.$dom,o=t.document,i=!1,a=t.selection.getRangeAt(0);if(a.collapsed){var r=h(a.startContainer);if(!r)return i;var s=a.createBookmark(),l=r.textContent||"";a.moveToBookmark(s);var d=r.parentNode;if(!d)return i;if(1===d.childNodes.length&&!l.replace(n.fillCharReg,"").replace(n.bookmarkFillCharReg,""))return i;var u=n.createBookmarkNode(o,Math.random()),p=o.createElement(c.codeBlockTagName);p.innerHTML=this.getCodeLineHtml(n.fillChar+u.outerHTML);var f={id:u.id,start:u.id,end:null},b=p.firstElementChild,m=new RegExp("[^"+n.fillChar+"]["+n.fillChar+"]*"+n.bookmarkFillChar,"m"),g="##__insertcode_tmp_char__##";if(m.test(l))r.innerHTML=v(l.replace(m,g)).replace(g,b.innerHTML),a.moveToBookmark(f),this.resetLanguage(d),this.highlightLine(a.startContainer,a),i=!0;else{var k=r.previousSibling;k&&(l=(k.textContent||"")+"\n"+l,k.remove(),r.innerHTML=v(l.replace(m,g)).replace(g,b.innerHTML),a.moveToBookmark(f),this.resetLanguage(d),this.highlightLine(a.startContainer,a),i=!0)}}else this.deleteRangeContents(a),this.highlightLine(a.startContainer,a),i=!0;return i&&e.preventDefault(),i}},{key:"del",value:function(e){var t=this._blockEditable.editable,n=t.$dom,o=t.document,i=!1,a=t.selection.getRangeAt(0);if(a.collapsed){var r=h(a.startContainer);if(!r)return i;var s=a.createBookmark(),l=r.textContent||"";a.moveToBookmark(s);var d=r.parentNode;if(!d)return i;var u=n.createBookmarkNode(o,Math.random()),p=o.createElement(c.codeBlockTagName);p.innerHTML=this.getCodeLineHtml(n.fillChar+u.outerHTML);var f={id:u.id,start:u.id,end:null},b=p.firstElementChild,m=new RegExp("[^"+n.fillChar+"]["+n.fillChar+"]*"+n.bookmarkFillChar,"m"),g="##__insertcode_tmp_char__##";if(m.test(l))r.innerHTML=v(l.replace(m,g)).replace(g,b.innerHTML),a.moveToBookmark(f),this.resetLanguage(d),this.highlightLine(a.startContainer,a),i=!0;else{var k=r.nextSibling;k&&(l=l+0+(k.textContent||""),k.remove(),r.innerHTML=v(l.replace(m,g)).replace(g,b.innerHTML),a.moveToBookmark(f),this.resetLanguage(d),this.highlightLine(a.startContainer,a),i=!0)}i=!0}else this.deleteRangeContents(a),this.highlightLine(a.startContainer,a),i=!0;return i&&e.preventDefault(),i}},{key:"tab",value:function(e){var t=this._blockEditable.editable,n=t.selection,o=t.document,i=n.getRangeAt(0);if(this.getCurrentBlock(i.startContainer))if(e.shiftKey){var a=this.getLinesInRange(i);if(a.length>0){for(var r=i.createBookmark(),s=0,l=a.length;s<l;s++)this.deletePreviousTab(a[s]);i.moveToBookmark(r).select()}}else if(i.collapsed)this.insertTabInCollapseRange(i);else{var d=this.getLinesInRange(i);if(1===d.length)this.deleteRangeContents(i),this.insertTabInCollapseRange(i);else if(d.length>1){for(var u=i.createBookmark(),h=o.createTextNode(c.tabSize),p=0,f=d.length;p<f;p++){var v=d[p];if(v.firstChild)v.firstChild.insertBefore(h.cloneNode(!0),v.firstChild.firstChild);else{var b=o.createElement(c.lineTextTagName);b.className=c.text,b.appendChild(h.cloneNode(!0)),v.appendChild(b)}}i.moveToBookmark(u).select()}}}},{key:"getCurrentLine",value:function(){var e=this._blockEditable.editable.selection;return h(e.anchorNode||e.focusNode)}},{key:"getCurrentBlock",value:function(e){var t=this._blockEditable.editable.selection;return p(e=e||t.anchorNode||t.focusNode)}},{key:"mergeCommentLine",value:function(e){var t=e.firstChild;if(!t||t.nodeName.toLowerCase()!==c.lineTextTagName)return!1;if(t.childNodes.length<=1)return!1;var n=this._blockEditable.editable,o=n.document,i=n.$dom,a=o.createElement(c.lineTagName);a.innerHTML=t.innerHTML;for(var r=a.firstChild,s=!1;r;){if(this.isCommentNode(r))for(var l=void 0;l=r.nextSibling;)if(i.isBookmarkNode(l)||i.isFillChar(l))r.appendChild(l),l=r,s=!0;else{if(!this.isCommentNode(l))break;var d=f(l.innerHTML,o);r.appendChild(d),l.remove(),l=r,s=!0}r=r.nextSibling}return s&&(e.innerHTML=a.innerHTML),s}},{key:"splitCodeLine",value:function(){var e=this._blockEditable.editable,t=e.selection,n=(e.document,e.$dom),o=t.anchorNode||t.focusNode,i=t.getRangeAt(0),a=h(o),r="";if(a){var s,l=i.createBookmark();r=(null===(s=a.textContent)||void 0===s?void 0:s.split(n.bookmarkFillChar)[0])||"";var d=new RegExp("^([\\s"+n.fillChar+"]+)([^\\s"+n.fillChar+"]|$)"),u=r.match(d);r=u&&u[0]?u[0].replace(d,"$1").replace(/\t/g,c.tabSize).replace(n.fillCharReg,""):"",i.moveToBookmark(l)}this.insertHighlight2Range("\n"+r,i)}},{key:"insertHighlight2Range",value:function(e,t){if(e){var n=this._blockEditable.editable,o=n.selection,i=n.document,a=n.$dom,r=n.holder,s=o.anchorNode||o.focusNode,l=p(s);if(!l)return;this.deleteRangeContents(t);var d=l.getAttribute(c.langAttr)||"",u=this.highlightText(e,d);u.result.language&&(d=u.result.language,l.setAttribute(c.langAttr,d));var v=u.result.value,b=h(s),m=null===b||void 0===b?void 0:b.firstElementChild;if(b&&10===a.getPosition(b,r)&&m){var g,k,y,C,_,x,E,O=f(v,i),T=O.firstElementChild,w=null===(g=T)||void 0===g?void 0:g.firstElementChild;(null===w||void 0===w?void 0:w.firstChild)||null===w||void 0===w||w.appendChild(i.createTextNode(a.fillChar));var S,j=O.lastElementChild,B=null===(k=j)||void 0===k?void 0:k.lastElementChild,N=null===(y=B)||void 0===y?void 0:y.lastChild;if(!N)N=i.createTextNode(a.fillChar),null===(S=B)||void 0===S||S.appendChild(N);var L,I=t.createBookmark();if(this.mergeFromStart2End(I.start,m,w,"pre"),this.mergeFromStart2End(I.end||I.start,m,B,"next"),T!==j)null===(L=B)||void 0===L||L.insertBefore(a.createBookmarkNode(i,Math.random()),N.nextSibling);var A,R,M=this.highlightText((null===(C=j)||void 0===C?void 0:C.textContent)||"",d,!0),D=M.bookmark,H=f(M.result.value,i);if(O.appendChild(H),O.removeChild(j),!D||!D.startid)A=a.createBookmarkNode(i,Math.random()),null===(R=B)||void 0===R||R.insertBefore(A,N.nextSibling);(M=this.highlightText((null===(_=T)||void 0===_?void 0:_.textContent)||"",d,!!A)).bookmark&&M.bookmark.startid&&(D=M.bookmark),H=f(M.result.value,i),O.insertBefore(H,T),O.removeChild(T),B=null===(x=j=O.lastElementChild)||void 0===x?void 0:x.lastElementChild,T=O.firstElementChild,null===(E=b.parentNode)||void 0===E||E.insertBefore(O,b),b.remove();var P={id:D&&D.startid?D.startid:"",start:D&&D.startid?D.startid:"",end:D&&D.endid?D.endid:""};return P.start?t.moveToBookmark(P):t.selectNodeContents(B).collapse(!1),t.select(),T}}}},{key:"highlightText",value:function(e,t,n){var i=this,a=this._blockEditable.editable,r=a.document,s=a.$dom,d=r.createElement("pre");d.classList.add("lang-".concat(t)),e=e.replace(/\r/g,"").replace(s.fillCharReg,"").replace(/\t/g,c.tabSize);var u=null;n&&(u=function(t){if(!e)return null;for(var n,o=s.bookmarkFillCharReg,i=[];(n=o.exec(e))&&i.length<2;)i.push(n.index);return{startPos:i[0],endPos:i[1]}}()),e=e.replace(s.bookmarkFillCharReg,""),d.textContent=e,l.a.highlightBlock(d);var h={};n&&u&&(h=function(e,t){var n=void 0===t.startPos,o=void 0===t.endPos;if(n&&o)return{};for(var i,a,l=e.ownerDocument.createTreeWalker(e,window.NodeFilter.SHOW_TEXT,{acceptNode:function(e){return e.nodeValue?window.NodeFilter.FILTER_ACCEPT:window.NodeFilter.FILTER_REJECT}}),c=0,d={start:{node:null},end:{node:null}},u=function(e){var t=e.node.ownerDocument||r,n=e.node.cloneNode(),o=n.splitText(e.pos+1),i=null===t||void 0===t?void 0:t.createDocumentFragment();null===i||void 0===i||i.appendChild(n);var a=s.createBookmarkNode(t,Math.random());null===i||void 0===i||i.appendChild(a),null===i||void 0===i||i.appendChild(t.createTextNode(s.fillChar)),i.appendChild(o);var l=e.node.parentNode;return null===l||void 0===l||l.insertBefore(i,e.node),null===l||void 0===l||l.removeChild(e.node),a};l.nextNode()&&(!n||!o);){var h,p=c+((null===(h=l.currentNode.nodeValue)||void 0===h?void 0:h.length)||0);!n&&c<=t.startPos&&t.startPos<=p&&(d.start.node=l.currentNode,d.start.pos=t.startPos-c-1,c++,p++,n=!0),!o&&c<=t.endPos&&t.endPos<=p&&(d.end.node=l.currentNode,d.end.pos=t.endPos-c-1,o=!0),c=p}if(d.start.node&&d.start.node!==d.end.node)i=u(d.start),d.end.node&&(a=u(d.end));else if(d.start.node&&d.start.node===d.end.node){var f=d.start.node.cloneNode(!0),v=f.splitText((d.start.pos||0)+1),b=(d.end.pos||0)-f.nodeValue.length+1,m=void 0;b<=v.nodeValue.length&&(m=v.splitText(b)),i=s.createBookmarkNode(r,Math.random()),a=s.createBookmarkNode(r,Math.random());var g=r.createDocumentFragment();g.appendChild(f),g.appendChild(i),g.appendChild(r.createTextNode(s.fillChar)),g.appendChild(v),g.appendChild(a),m&&g.appendChild(m);var k=d.start.node.parentNode;null===k||void 0===k||k.insertBefore(g,d.start.node),null===k||void 0===k||k.removeChild(d.start.node)}return a&&(a.id=a.id.replace("start","end")),{startid:i?i.id:"",endid:a?a.id:""}}(d,u));!function(e){var t=e.ownerDocument||r,n=".".concat(c.classPrefix,"comment"),o=[];e.querySelectorAll(n).forEach((function(e){if(e.innerHTML.indexOf("\n")>=0){var n="</"+e.nodeName.toLowerCase()+">",i=e.cloneNode(!1).outerHTML.replace(n,""),a=i+e.innerHTML.replace(/\n/g,n+"\n"+i)+n,r=t.createElement(c.codeBlockTagName);r.innerHTML=a;for(var s=t.createDocumentFragment();r.firstChild;)s.appendChild(r.firstChild);o.push([e,s])}}));for(var i=0;i<o.length;i++){var a=o[i],s=a[0].parentNode;s&&(s.insertBefore(a[1],a[0]),s.removeChild(a[0]))}}(d);return Object(o.a)(Object(o.a)({},function(e){for(var t=e.innerHTML,n=new RegExp("\\n[\\s]*(<\\/[^>]*>)","g");n.test(t);)t=t.replace(n,"$1\n");for(var a=t.split("\n"),r=0;r<a.length;r++)a[r]=i.getCodeLineHtml(a[r]);return{result:{language:e.result.language||"",relevance:e.result.relevance,value:a.join("")},second_best:e.second_best?Object(o.a)({},e.second_best):{language:"",relevance:0}}}(d)),{},{bookmark:h})}},{key:"getCodeLineHtml",value:function(e){var t=this._blockEditable.editable.$dom;return e=e||t.fillChar,'<code class="'.concat(c.line,'"><span class="').concat(c.text,'">').concat(e,"</span></code>")}},{key:"getCommentSibling",value:function(e){var t={cur:e,pre:[],next:[],nodeText:"",nodeList:[]};if(!e||e.nodeName.toLowerCase()!==c.lineTagName)return t;for(var n=e;n=n.previousSibling;){var o=n.firstChild;if(!(o&&o.childNodes&&1===o.childNodes.length&&this.isCommentNode(o.firstChild)))break;t.pre.push(n),t.nodeList.push(n)}for(t.nodeList.reverse(),t.nodeList.push(e),n=e;n=n.nextSibling;){var i=n.firstChild;if(!(i&&i.childNodes&&1===i.childNodes.length&&this.isCommentNode(i.firstChild)))break;t.next.push(n),t.nodeList.push(n)}for(var a=[],r=0;r<t.nodeList.length;r++){var s=t.nodeList[r];a.push(s.textContent||"")}return t.nodeText=a.join("\n"),t}},{key:"isCommentNode",value:function(e){return!!(e&&"span"===e.nodeName.toLowerCase()&&0<=e.className.indexOf(c.classPrefix+"comment"))}},{key:"insertTabInCollapseRange",value:function(e){var t=this,n=this._blockEditable.editable,o=n.document,i=n.$dom,a=o.createTextNode(c.tabSize);e.insertNode(a).setStartAfter(a).collapse(),i.findParent(a,(function(e){if(t.isCommentNode(e))return!0}))?e.select():this.highlightLine(a,e)}},{key:"deletePreviousTab",value:function(e){for(var t=this._blockEditable.editable,n=t.document,o=t.$dom,i=n.createTreeWalker(e,window.NodeFilter.SHOW_TEXT,{acceptNode:function(e){return e.nodeValue&&0<e.nodeValue.replace(o.fillCharReg,"").replace(o.bookmarkFillCharReg,"").length?window.NodeFilter.FILTER_ACCEPT:window.NodeFilter.FILTER_REJECT}},!1),a=new RegExp("^["+o.fillChar+"]* ["+o.fillChar+"]*"),r=[],s=0;i.nextNode()&&s<2;){var l="";for(l=i.currentNode.nodeValue||"";a.test(l)&&s<2;)l=l.replace(a,""),s++;if(l!==i.currentNode.nodeValue&&r.push({node:i.currentNode,text:l}),0===r.length)break}for(var c=[],d=0,u=r.length;d<u;d++){var h=r[d];if(h.node&&h.node.parentNode){var p=n.createTextNode(h.text),f=h.node.parentNode;f.insertBefore(p,h.node),f.removeChild(h.node),c.push(p)}}return c}},{key:"getLinesInRange",value:function(e){var t=[],n=h(e.startContainer),o=h(e.endContainer);if(!n||!o)return t;if(t.push(n),n===o)return t;for(var i=n;(i=i.nextSibling)&&1===i.nodeType&&i!==o;)t.push(i);return t.push(o),t}},{key:"resetLanguage",value:function(e){var t;if(e){var n=this._blockEditable.editable.$dom;(null===(t=e.textContent)||void 0===t?void 0:t.replace(/\s/g,"").replace(n.fillCharReg,"").replace(n.bookmarkFillCharReg,""))||e.setAttribute(n.languageAttr,"")}}},{key:"deleteRangeContents",value:function(e){if(!e.collapsed){var t=this._blockEditable.editable,n=t.document,o=t.$dom,i=e.createBookmark();e.deleteContents();var a=this.getCurrentBlock(i.start||i.end);a&&this.resetLanguage(a);var r=h(i.start),s=h(i.end),l=null===r||void 0===r?void 0:r.firstElementChild,c=null===s||void 0===s?void 0:s.firstElementChild,d={id:"",start:"",end:""};if(r||s){var u=f(this.getCodeLineHtml(),n),p=u.firstElementChild,v=null===p||void 0===p?void 0:p.firstElementChild;if(r&&l){var b;this.mergeFromStart2End(i.start,l,v,"pre");var m=o.createBookmarkNode(n,Math.random());null===v||void 0===v||v.appendChild(m),d.start=m.id,d.end=null,d.id=m.id,s&&c&&this.mergeFromStart2End(i.end,c,v,"next"),this.mergeCommentLine(p),null===(b=r.parentNode)||void 0===b||b.insertBefore(u,r)}else if(s&&c){var g;this.mergeFromStart2End(i.end,c,v,"next");var k=o.createBookmarkNode(n,Math.random());null===v||void 0===v||v.appendChild(k),d.start=k.id,d.end=null,d.id=k.id,this.mergeCommentLine(p),null===(g=s.parentNode)||void 0===g||g.insertBefore(u,s)}}r&&r.remove(),s&&s.remove(),d.id&&e.moveToBookmark(d)}}},{key:"mergeFromStart2End",value:function(e,t,n,o){var i=this._blockEditable.editable,a=i.document,r=i.$dom,s=new RegExp("[^>]*(<\\/?(\\w+)\\s*(?:[^>]*)>)[^<]*","g"),l=new RegExp("<(\\w+)\\s*(?:[^>]*)>[^<]*<\\/\\1>","g"),d=t.innerHTML.split(e.outerHTML);d[0]=(d[0]||"").replace(r.getBookmarkReg(),""),d[1]=(d[1]||"").replace(r.getBookmarkReg(),"");var u="";if("pre"===o)if(s.test(d[1])){for(d[1]=d[1].replace(s,"$1");l.test(d[1]);)d[1]=d[1].replace(l,"");u=d[0]+d[1]}else u=d[0];else if(s.test(d[0])){for(d[0]=d[0].replace(s,"$1");l.test(d[0]);)d[0]=d[0].replace(l,"");u=d[0]+d[1]}else u=d[1];var h=e.ownerDocument||a,p=h.createElement(c.codeBlockTagName);p.innerHTML=u;for(var f=h.createDocumentFragment();p.firstChild;)f.appendChild(p.firstChild);"pre"===o?n.insertBefore(f,n.firstChild):n.appendChild(f)}}]),e}()},635:function(e,t,n){"use strict";n.r(t),n.d(t,"Languages",(function(){return ae}));var o=n(849),i=n.n(o),a=n(850),r=n.n(a),s=n(851),l=n.n(s),c=n(852),d=n.n(c),u=n(853),h=n.n(u),p=n(854),f=n.n(p),v=n(855),b=n.n(v),m=n(856),g=n.n(m),k=n(857),y=n.n(k),C=n(858),_=n.n(C),x=n(859),E=n.n(x),O=n(860),T=n.n(O),w=n(861),S=n.n(w),j=n(862),B=n.n(j),N=n(863),L=n.n(N),I=n(864),A=n.n(I),R=n(865),M=n.n(R),D=n(866),H=n.n(D),P=n(867),F=n.n(P),z=n(868),q=n.n(z),$=n(869),V=n.n($),U=n(870),W=n.n(U),K=n(871),X=n.n(K),Y=n(872),G=n.n(Y),Z=n(873),J=n.n(Z),Q=n(874),ee=n.n(Q),te=n(876),ne=n.n(te),oe=n(877),ie=n.n(oe),ae={javascript:i.a,apache:r.a,bash:l.a,shell:d.a,csharp:h.a,cpp:f.a,css:b.a,typescript:g.a,diff:y.a,xml:_.a,http:E.a,ini:T.a,json:S.a,java:B.a,makefile:L.a,markdown:A.a,nginx:M.a,objectivec:H.a,php:F.a,perl:q.a,properties:V.a,python:W.a,ruby:X.a,sql:G.a,powershell:J.a,swift:ee.a,kotlin:ne.a,go:ie.a}},636:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return k}));var o=n(21),i=n.n(o),a=n(32),r=n(1),s=n(7),l=n(6),c=n(10),d=n(9),u=n(0),h=n.n(u),p=n(35),f=n.n(p),v=n(889),b=n.n(v),m=n(251);b.a.mermaidAPI.initialize({startOnLoad:!1});var g=function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i)))._textInput=void 0,e._preview=void 0,e.onSelect=function(t){e.insertText(t),e.onMermaidChange()},e.onMermaidChange=function(){var t=e.props.onMermaidChange,n=e._textInput,o=e._preview;if(n&&o)try{b.a.mermaidAPI.render("__ge_graph_render",n.value,(function(e,i){o.innerHTML=e,t({mermaid:n.value,html:e})}))}catch(i){o.innerHTML=""}},e}return Object(l.a)(n,[{key:"getMermaid",value:function(){var e=this._textInput,t=this._preview;if(e&&t)return{mermaid:e.value,html:t.innerHTML}}},{key:"insertText",value:function(e){var t=this._textInput;if(t)if(t.selectionStart||0===t.selectionStart){var n=t.selectionStart,o=t.selectionEnd;t.value=t.value.substring(0,n)+e+t.value.substring(o,t.value.length),t.focus(),t.selectionStart=n+e.length,t.selectionEnd=n+e.length}else t.value+=e,t.focus()}},{key:"componentDidMount",value:function(){if(this._textInput){var e=this.props.mermaid;e&&(this._textInput.value=e),this.onMermaidChange(),0===this._textInput.selectionStart&&(this._textInput.selectionStart=this._textInput.value.length)}}},{key:"render",value:function(){var e=this;return Object(r.jsxs)("div",{className:"beui-diagram-editor",children:[Object(r.jsx)("textarea",{onPaste:function(e){e.stopPropagation()},placeholder:"\u8f93\u5165 Mermaid \u8bed\u6cd5\u683c\u5f0f",onChange:this.onMermaidChange,ref:function(t){e._textInput=t},autoFocus:!0,suppressContentEditableWarning:!0,className:"beui-diagram-editor__input",contentEditable:!0}),Object(r.jsx)("div",{className:"beui-diagram-editor__preview",ref:function(t){return e._preview=t}})]})}}]),n}(u.Component),k=function(){function e(t){Object(s.a)(this,e),this._unmount=void 0,this._upload=void 0,this._blockEditable=void 0,this._blockEditable=t}return Object(l.a)(e,[{key:"mount",value:function(e,t,n){var o=this,r=f.a.render(h.a.createElement(g,{mermaid:t,onMermaidChange:n}),e);this._unmount=function(){f.a.unmountComponentAtNode(e)},this._upload=Object(a.a)(i.a.mark((function e(){var t,n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.getMermaid(),n=o._blockEditable.editable.getOpt("uploadImage"),a=o._blockEditable.utils.svgToBlob,!t||!n){e.next=5;break}return e.abrupt("return",a(t.html).then((function(e){return e?n(e):void 0})));case 5:case"end":return e.stop()}}),e)})))}},{key:"unmount",value:function(){var e=Object(a.a)(i.a.mark((function e(t){var n,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._upload||!t){e.next=9;break}return o="".concat(Date.now()),m.b.loading({content:"\u4fdd\u5b58\u56fe\u7247\u4e2d...",duration:0,key:o}),e.next=5,this._upload();case 5:n=e.sent,m.b.destroy(o),n||m.b.error("\u4fdd\u5b58\u56fe\u7247\u5931\u8d25"),this._upload=null;case 9:return this._unmount&&(this._unmount(),this._unmount=null),e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}()},660:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var o=n(7),i=n(6),a=n(251),r=n(661),s=function(){function e(t){Object(o.a)(this,e),this._blockEditable=void 0,this._diagramEditor=void 0,this._blockEditable=t}return Object(i.a)(e,[{key:"edit",value:function(e,t){var n=this,o=this._blockEditable.editable.getOpt("uploadImage"),i=this._blockEditable.utils,s=i.svgToBlob,l=i.Base64;this._diagramEditor=new r.default(null,null,(function(e){var i=e.split(",").pop()||"",r=l.decode(i),c="".concat(Date.now());a.b.loading({content:"\u4fdd\u5b58\u56fe\u7247\u4e2d...",duration:0,key:c}),s(r).then((function(e){return e?o(e):void 0})).then((function(e){a.b.destroy(c),e?(t({html:r,url:e.url}),n._diagramEditor.stopEditing()):a.b.error("\u4fdd\u5b58\u56fe\u7247\u5931\u8d25")}))})),this._diagramEditor.startEditing("data:image/svg+xml;base64,".concat(l.encode(e)),"xmlsvg")}}]),e}()},661:function(e,t,n){"use strict";function o(e,t,n,o){this.config=null!=e?e:this.config,this.ui=null!=t?t:this.ui,this.done=null!=n?n:this.done,this.initialized=null!=o?o:this.initialized;var i=this;this.handleMessageEvent=function(e){if(null!=i.frame&&e.source==i.frame.contentWindow&&e.data.length>0)try{var t=JSON.parse(e.data);null!=t&&i.handleMessage(t)}catch(n){console.error(n)}}}n.r(t),o.prototype.config=null,o.prototype.drawDomain="https://embed.diagrams.net/",o.prototype.ui="min",o.prototype.xml=null,o.prototype.format="xml",o.prototype.libraries=!0,o.prototype.frameStyle="position:absolute;border:0;width:100%;height:100%;z-index:100",o.prototype.startEditing=function(e,t,n){null==this.frame&&(window.addEventListener("message",this.handleMessageEvent),this.format=null!=t?t:this.format,this.title=null!=n?n:this.title,this.data=e,this.frame=this.createFrame(this.getFrameUrl(),this.getFrameStyle()),document.body.appendChild(this.frame),this.setWaiting(!0))},o.prototype.setWaiting=function(e){if(null!=this.startElement){var t=this.startElement,n=t.nodeName.toLowerCase();"svg"!=n&&"object"!=n||(t=t.parentNode),null!=t&&(e?(this.frame.style.pointerEvents="none",this.previousCursor=t.style.cursor,t.style.cursor="wait"):(t.style.cursor=this.previousCursor,this.frame.style.pointerEvents=""))}},o.prototype.setActive=function(e){e?(this.previousOverflow=document.body.style.overflow,document.body.style.overflow="hidden"):document.body.style.overflow=this.previousOverflow},o.prototype.stopEditing=function(){null!=this.frame&&(window.removeEventListener("message",this.handleMessageEvent),document.body.removeChild(this.frame),this.setActive(!1),this.frame=null)},o.prototype.postMessage=function(e){null!=this.frame&&this.frame.contentWindow.postMessage(JSON.stringify(e),"*")},o.prototype.getData=function(){return this.data},o.prototype.getTitle=function(){return this.title},o.prototype.getFrameStyle=function(){return this.frameStyle+";left:"+document.body.scrollLeft+"px;top:"+document.body.scrollTop+"px;"},o.prototype.getFrameUrl=function(){var e=this.drawDomain+"?proto=json&spin=1";return null!=this.ui&&(e+="&ui="+this.ui),null!=this.libraries&&(e+="&libraries=1"),null!=this.config&&(e+="&configure=1"),e},o.prototype.createFrame=function(e,t){var n=document.createElement("iframe");return n.setAttribute("frameborder","0"),n.setAttribute("style",t),n.setAttribute("src",e),n},o.prototype.setStatus=function(e,t){this.postMessage({action:"status",messageKey:e,modified:t})},o.prototype.handleMessage=function(e){"configure"==e.event?this.configureEditor():"init"==e.event?this.initializeEditor():"autosave"==e.event||("export"==e.event?(this.done(e.data),this.xml=null):"save"==e.event&&(this.xml=e.xml,e.exit?e.event="exit":this.setStatus("allChangesSaved",!1))),"exit"==e.event&&("xml"!=this.format?null!=this.xml?this.postMessage({action:"export",format:this.format,xml:this.xml,spinKey:"export"}):this.stopEditing(e):((null==e.modified||e.modified)&&this.save(e.xml,!1,this.startElement),this.stopEditing(e)))},o.prototype.configureEditor=function(){this.postMessage({action:"configure",config:this.config})},o.prototype.initializeEditor=function(){this.postMessage({action:"load",autosave:1,save:0,saveAndExit:"1",modified:"unsavedChanges",xml:this.getData(),title:this.getTitle()}),this.setWaiting(!1),this.setActive(!0),this.initialized()},o.prototype.done=function(){},o.prototype.initialized=function(){},t.default=o},662:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var o=n(7),i=n(6),a=n(531),r=n(775).default,s=function(){function e(t){Object(o.a)(this,e),this.nodes={},this._blockEditable=void 0,this._onSelectFile=void 0,this._blockClass=void 0,this._blockEditable=t.blockEditable,this._onSelectFile=t.onSelectFile,this.make()}return Object(i.a)(e,[{key:"render",value:function(t,n){return this._blockClass=n,this.nodes.fileButton.classList.toggle(this._blockClass.button,!0),this.nodes.fileButton.classList.toggle(n.fakeInput,!0),this.nodes.imageContainer.classList.toggle(n.fakeInput,!0),t.image&&0!==Object.keys(t.image).length?this.toggleStatus(e.status.FILLED):this.toggleStatus(e.status.EMPTY),this.nodes.target}},{key:"createFileButton",value:function(){var e=this,t=Object(a.make)("div",[]);return t.innerHTML="".concat(r),t.addEventListener("click",(function(){e._onSelectFile()})),t}},{key:"showPreloader",value:function(t){this.nodes.imagePreloader.style.backgroundImage="url(".concat(t,")"),this.toggleStatus(e.status.UPLOADING)}},{key:"hidePreloader",value:function(){this.nodes.imagePreloader.style.backgroundImage="",this.toggleStatus(e.status.EMPTY)}},{key:"fillImage",value:function(t,n){var o=this,i=/\.mp4$/.test(t)?"VIDEO":"IMG",r={src:t},s="load";"VIDEO"===i&&(r.autoplay=!0,r.loop=!0,r.muted=!0,r.playsinline=!0,s="loadeddata"),this.nodes.image&&this.nodes.image.remove(),this.nodes.image=Object(a.make)(i,e.Class.image,r),n&&this.showPreloader(r.src),this.nodes.image.addEventListener(s,(function(){o.toggleStatus(e.status.FILLED),o.nodes.imagePreloader&&(o.nodes.imagePreloader.style.backgroundImage="")})),this.nodes.imageContainer.appendChild(this.nodes.image)}},{key:"fillCaption",value:function(e){this.nodes.caption&&(this.nodes.caption.innerHTML=e)}},{key:"toggleStatus",value:function(t){for(var n in e.status)Object.prototype.hasOwnProperty.call(e.status,n)&&this.nodes.target.classList.toggle("".concat(e.Class.target,"--").concat(e.status[n]),t===e.status[n])}},{key:"applySetting",value:function(t,n){this.nodes.target.classList.toggle("".concat(e.Class.target,"--").concat(t),n)}},{key:"make",value:function(){this.nodes.target=Object(a.make)("figure",[e.Class.target]),this.nodes.imageLoader=Object(a.make)("div",[e.Class.imageLoader]),this.nodes.fileButton=this.createFileButton(),this.nodes.imagePreloader=Object(a.make)("div",e.Class.imagePreloader),this.nodes.imageContainer=Object(a.make)("div",e.Class.imageContainer),this.nodes.imageEditor=Object(a.make)("div",[e.Class.imageEditor]),this.nodes.caption=Object(a.make)("figcaption",[e.Class.caption],{contentEditable:!0,placeholder:"\u8f93\u5165\u56fe\u7247\u63cf\u8ff0"}),this.nodes.imageLoader.appendChild(this.nodes.imagePreloader),this.nodes.target.appendChild(this.nodes.imageLoader),this.nodes.target.appendChild(this.nodes.imageContainer),this.nodes.target.appendChild(this.nodes.imageEditor),this.nodes.target.appendChild(this.nodes.fileButton),this.nodes.target.appendChild(this.nodes.caption)}}],[{key:"Class",get:function(){return{target:"be-image",imageLoader:"beui-image__loader",imageContainer:"beui-image__container",imageEditor:"beui-image__editor",imagePreloader:"beui-image__preloader",image:"be-image__img",caption:"be-image__caption"}}},{key:"status",get:function(){return{EMPTY:"empty",UPLOADING:"loading",FILLED:"filled"}}}]),e}()},663:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var o=n(7),i=n(6),a=n(531),r=n(776).default,s=(n(777).default,n(778).default,n(779).default,function(){function e(t){Object(o.a)(this,e),this._blockEditable=void 0,this._buttons=void 0,this._onChange=void 0,this._settingsClass=void 0,this._blockEditable=t.blockEditable,this._onChange=t.onChange,this._buttons=[]}return Object(i.a)(e,[{key:"render",value:function(t,n){var o=this;this._settingsClass=n;var i=Object(a.make)("div",e.Class.wrapper);return this._buttons=[],e.settings.forEach((function(n){var r=n.title,s=Object(a.make)("div",[o._settingsClass.settingsButton,e.Class.button],{title:r});s.innerHTML=n.icon,s.addEventListener("click",(function(){o.settingClicked(n.name,n.action)})),s.dataset.setting=n.name,s.classList.toggle(o._settingsClass.settingsButtonActive,t[n.name]),o._buttons.push(s),o.api.tooltip.onHover(s,r,{placement:"top"}),i.appendChild(s)})),i}},{key:"settingClicked",value:function(e,t){if("function"===typeof t&&!t(e))return!1;var n=this._buttons.find((function(t){return t.dataset.setting===e}));n&&(n.classList.toggle(this._settingsClass.settingsButtonActive,!n.classList.contains(this._settingsClass.settingsButtonActive)),this._onChange(e))}},{key:"api",get:function(){return this._blockEditable.state}}],[{key:"settings",get:function(){return[{name:"withCaption",icon:r,title:"With caption"}]}},{key:"Class",get:function(){return{wrapper:"",button:"be-image__setting"}}}]),e}())},664:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var o=n(7),i=n(6),a=n(574),r=function(){function e(t){var n=t.config,i=t.onUpload,a=t.onError;Object(o.a)(this,e),this._config=void 0,this._onUpload=void 0,this._onError=void 0,this._config=n,this._onUpload=i,this._onError=a}return Object(i.a)(e,[{key:"uploadSelectedFile",value:function(e){var t=this,n=e.onPreview;Object(a.selectFiles)({accept:this._config.types}).then((function(e){t.uploadByFile(e[0],{onPreview:n})}))}},{key:"uploadByUrl",value:function(e){var t=this;return Promise.resolve().then((function(){t._onUpload({success:!0,file:{url:e}})}))}},{key:"uploadByFile",value:function(e,t){var n,o=this,i=t.onPreview,a=new FileReader;if(a.readAsDataURL(e),a.onload=function(e){var t;(null===(t=e.target)||void 0===t?void 0:t.result)&&i(e.target.result)},this._config.uploadImage){var r=this._config.uploadImage(e);n=r,Promise.resolve(n)===n&&r.then((function(t){o._onUpload({success:!!t,file:{url:t?t.url:"",name:e.name||""}})})).catch((function(e){o._onError()}))}}}]),e}()},665:function(e,t,n){"use strict";n.r(t),n.d(t,"Class",(function(){return l})),n.d(t,"default",(function(){return c}));var o=n(7),i=n(6),a=n(570),r=n(666),s=n(606),l={editor:"beui-table-editor",toolBarHor:"beui-table-toolbar--hor",toolBarVer:"beui-table-toolbar--ver",plusButton:"beui-table-toolbar__plus",minusButton:"beui-table-toolbar__minus",inputField:"be-table__inp"},c=function(){function e(t,n,i){Object(o.a)(this,e),this._table=void 0,this._container=void 0,this._verticalToolBar=void 0,this._horizontalToolBar=void 0,this._hoveredCell=void 0,this._activatedToolBar=void 0,this._hoveredCellSide=void 0,this._plusButDelay=void 0,this._toolbarShowDelay=void 0,this._blockEditable=void 0,this._blockEditable=n,this._table=new s.Table;var c=this.resizeTable(t,i||{rows:2,cols:2});this.fillTable(t,c),this._container=Object(a.create)("div",[l.editor],null,[this._table.htmlElement]),this._verticalToolBar=new r.VerticalBorderToolBar,this._horizontalToolBar=new r.HorizontalBorderToolBar,this._table.htmlElement.appendChild(this._horizontalToolBar.htmlElement),this._table.htmlElement.appendChild(this._verticalToolBar.htmlElement),this._hoveredCell=null,this._activatedToolBar=null,this._hoveredCellSide=null,this.hangEvents()}return Object(i.a)(e,[{key:"fillTable",value:function(e,t){if(void 0!==e.head&&this._table.head)for(var n=t.rows+1,o=0;o<n&&o<e.head.length;o++)for(var i=0;i<t.cols&&i<e.head[o].length;i++){var a=this._table.head.rows[o].cells[i].querySelector("."+l.inputField);a&&(a.innerHTML=e.head[o][i])}if(void 0!==e.body)for(var r=0;r<t.rows&&r<e.body.length;r++)for(var s=0;s<t.cols&&s<e.body[r].length;s++){var c=this._table.body.rows[r].cells[s].querySelector("."+l.inputField);c&&(c.innerHTML=e.body[r][s])}}},{key:"resizeTable",value:function(e,t){var n=Array.isArray(e.body),o=Array.isArray(e.head),i=e.head||[],a=!!o&&i.length?i[0].length:void 0,r=e.body||[],s=!!n&&r.length,l=n?r.length:void 0,c=s?r[0].length:void 0,d=t.rows,u=t.cols,h=(isNaN(d),!isNaN(u)&&u>0?u:void 0),p=l||0,f=c||a||h||2;this._table.addHead();for(var v=0;v<p;v++)this._table.addRow();for(var b=0;b<f;b++)this._table.addColumn();return{rows:p,cols:f}}},{key:"showToolBar",value:function(e,t){this.hideToolBar(),this._activatedToolBar=e,null===e||void 0===e||e.showIn(t)}},{key:"hideToolBar",value:function(){null!==this._activatedToolBar&&this._activatedToolBar.hide()}},{key:"hangEvents",value:function(){var e=this;this._container.addEventListener("mouseInActivatingArea",(function(t){e.toolbarCalling(t)})),this._container.addEventListener("click",(function(t){e.clickToolbar(t)})),this._container.addEventListener("input",(function(){e.hideToolBar()})),this._container.addEventListener("keydown",(function(t){e.containerKeydown(t)})),this._container.addEventListener("mouseout",(function(t){e.leaveDetectArea(t)})),this._container.addEventListener("mouseover",(function(t){e.mouseEnterInDetectArea(t)}))}},{key:"mouseInActivatingAreaListener",value:function(e,t){if(e){this._hoveredCellSide=t.side;var n=Object(a.getCoords)(this._container);if(this._hoveredCell=e.closest("TD,TH"),null!==this._hoveredCell&&("TH"!==this._hoveredCell.tagName||"top"!==this._hoveredCellSide&&"bottom"!==this._hoveredCellSide)){var o=Object(a.getCoords)(this._hoveredCell);"top"===this._hoveredCellSide&&this.showToolBar(this._horizontalToolBar,o.y1-n.y1),"bottom"===this._hoveredCellSide&&this.showToolBar(this._horizontalToolBar,o.y2-n.y1),"left"===this._hoveredCellSide&&this.showToolBar(this._verticalToolBar,o.x1-n.x1),"right"===this._hoveredCellSide&&this.showToolBar(this._verticalToolBar,o.x2-n.x1)}}}},{key:"isToolbar",value:function(e){return!(!e.closest("."+l.toolBarHor)&&!e.closest("."+l.toolBarVer))}},{key:"isToolbarButton",value:function(e){return!(!e.closest(".".concat(l.plusButton))&&!e.closest(".".concat(l.minusButton)))}},{key:"isToolbarPlusButton",value:function(e){return!!e.closest(".".concat(l.plusButton))}},{key:"isToolbarMinusButton",value:function(e){return!!e.closest(".".concat(l.minusButton))}},{key:"leaveDetectArea",value:function(e){e.relatedTarget&&!this.isToolbar(e.relatedTarget)&&(clearTimeout(this._toolbarShowDelay),this.hideToolBar())}},{key:"toolbarCalling",value:function(e){var t=this;if(e.target&&!this.isToolbar(e.target)){var n=e.target,o=e.detail;clearTimeout(this._toolbarShowDelay),this._toolbarShowDelay=window.setTimeout((function(){t.mouseInActivatingAreaListener(n,o)}),100)}}},{key:"clickToolbar",value:function(e){var t;if(e.target&&this.isToolbarButton(e.target))if(this._activatedToolBar===this._horizontalToolBar?(this.isToolbarPlusButton(e.target)?this.addRow():this.deleteRow(),t="y"):(this.isToolbarPlusButton(e.target)?this.addColumn():this.deleteColumn(),t="x"),isNaN(e.detail)&&null!==e.detail){var n,o=e.detail,i=Object(a.getCoords)(this._table.htmlElement);n="x"===t?o.x-i.x1:o.y-i.y1,this.delayAddButtonForMultiClickingNearMouse(n)}else this.hideToolBar()}},{key:"containerKeydown",value:function(e){if(13===e.keyCode){var t=this._blockEditable.state.ui;if(t.someToolbarOpened&&t.someFlipperButtonFocused)return;e.shiftKey?this.addColumn(!0):this.containerEnterPressed(e),e.preventDefault()}}},{key:"delayAddButtonForMultiClickingNearMouse",value:function(e){var t,n=this;this.showToolBar(this._activatedToolBar,e),null===(t=this._activatedToolBar)||void 0===t||t.hideLine(),clearTimeout(this._plusButDelay),this._plusButDelay=window.setTimeout((function(){n.hideToolBar()}),500)}},{key:"getHoveredSideOfContainer",value:function(){return this._hoveredCell===this._container?this.isBottomOrRight()?0:-1:1}},{key:"isBottomOrRight",value:function(){return"bottom"===this._hoveredCellSide||"right"===this._hoveredCellSide}},{key:"addRow",value:function(){var e,t=null===(e=this._hoveredCell)||void 0===e?void 0:e.closest("TR"),n=this.getHoveredSideOfContainer();1===n&&t&&(n=t.sectionRowIndex,n+=this.isBottomOrRight()?1:0),this._table.addRow(n)}},{key:"addColumn",value:function(e){var t=this.getHoveredSideOfContainer();1===t&&this._hoveredCell&&(t=this._hoveredCell.cellIndex,t+=e||this.isBottomOrRight()?1:0),this._table.addColumn(t)}},{key:"deleteRow",value:function(){var e,t=null===(e=this._hoveredCell)||void 0===e?void 0:e.closest("TR"),n=this.getHoveredSideOfContainer();1===n&&t&&(n=t.sectionRowIndex,n+=this.isBottomOrRight()?1:0),this._table.deleteRow(n)}},{key:"deleteColumn",value:function(){var e=this.getHoveredSideOfContainer();1===e&&this._hoveredCell&&(e=this._hoveredCell.cellIndex,e+=this.isBottomOrRight()?1:0),this._table.deleteColumn(e)}},{key:"containerEnterPressed",value:function(e){if(null!==this._table.selectedCell&&!e.shiftKey){var t=this._table.selectedCell.closest("TR"),n=this.getHoveredSideOfContainer();this._table.selectedCell.closest("THEAD")?n=0:1===n&&(n=t.sectionRowIndex+1),this._table.addRow(n).cells[0].click()}}},{key:"mouseEnterInDetectArea",value:function(e){var t=Object(a.getCoords)(this._container),n=Object(a.getSideByCoords)(t,e.pageX,e.pageY);e.target.dispatchEvent(new CustomEvent("mouseInActivatingArea",{detail:{side:n},bubbles:!0}))}},{key:"htmlElement",get:function(){return this._container}}]),e}()},666:function(e,t,n){"use strict";n.r(t),n.d(t,"HorizontalBorderToolBar",(function(){return _})),n.d(t,"VerticalBorderToolBar",(function(){return x}));var o=n(10),i=n(9),a=n(7),r=n(6),s=n(570),l=n(797).default,c=n(798).default,d="beui-table-toolbar",u="beui-table-toolbar--hidden",h="beui-table-toolbar--hor",p="beui-table-toolbar__shine-line--hor",f="beui-table-toolbar--ver",v="beui-table-toolbar__shine-line--ver",b="beui-table-toolbar__plus",m="beui-table-toolbar__plus--add",g="beui-table-toolbar__plus--ver",k="beui-table-toolbar__minus",y="tc-table__area",C=function(){function e(){Object(a.a)(this,e),this._plusButton=void 0,this._minusButton=void 0,this._highlightingLine=void 0,this._toolbar=void 0,this._plusButton=this.generatePlusButton(),this._minusButton=this.generateMinusButton(),this._highlightingLine=this.generateHighlightingLine(),this._toolbar=this.generateToolBar([this._plusButton,this._highlightingLine,this._minusButton])}return Object(r.a)(e,[{key:"hide",value:function(){this._toolbar.classList.add(u)}},{key:"show",value:function(){this._toolbar.classList.remove(u),this._highlightingLine.classList.remove(u)}},{key:"hideLine",value:function(){this._highlightingLine.classList.add(u)}},{key:"generatePlusButton",value:function(){var e=Object(s.create)("div",[b]);return e.innerHTML=l,e}},{key:"generateMinusButton",value:function(){var e=Object(s.create)("div",[k]);return e.innerHTML=c,e}},{key:"generateHighlightingLine",value:function(){var e=this,t=Object(s.create)("div",[d]);return t.addEventListener("click",(function(t){t.stopPropagation();var n=new CustomEvent("click",{bubbles:!0});e._toolbar.dispatchEvent(n)})),t}},{key:"generateToolBar",value:function(e){var t=this,n=Object(s.create)("div",[u],null,e);return n.addEventListener("mouseleave",(function(e){t.recalcMousePos(e)})),n}},{key:"recalcMousePos",value:function(e){this.hide();var t=document.elementFromPoint(e.pageX,e.pageY);if(null!==t&&t.classList.contains(y)){var n=new MouseEvent("mouseover",{clientX:e.pageX,clientY:e.pageY});t.dispatchEvent(n)}}},{key:"htmlElement",get:function(){return this._toolbar}}]),e}(),_=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.call(this))._toolbar.classList.add(h),e._plusButton.classList.add(m),e._highlightingLine.classList.add(p),e}return Object(r.a)(n,[{key:"showIn",value:function(e){var t=Math.floor(Number.parseInt(window.getComputedStyle(this._toolbar).height)/2);this._toolbar.style.top=e-t+"px",this.show()}}]),n}(C),x=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.call(this))._toolbar.classList.add(f),e._plusButton.classList.add(g),e._highlightingLine.classList.add(v),e}return Object(r.a)(n,[{key:"showIn",value:function(e){var t=Math.floor(Number.parseInt(window.getComputedStyle(this._toolbar).width)/2);this._toolbar.style.left=e-t+"px",this.show()}}]),n}(C)},667:function(e,t,n){},669:function(e,t,n){var o=n(843);e.exports="string"===typeof o?o:o.toString()},670:function(e,t,n){var o=n(844);e.exports="string"===typeof o?o:o.toString()},671:function(e,t,n){"use strict";n.r(t),t.default='<svg width="10" height="14" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 14">\n  <path d="M7.6 8.15H2.25v4.525a1.125 1.125 0 0 1-2.25 0V1.125a1.125 1.125 0 1 1 2.25 0V5.9H7.6V1.125a1.125 1.125 0 0 1 2.25 0v11.55a1.125 1.125 0 0 1-2.25 0V8.15z"/>\n</svg>\n'},672:function(e,t,n){"use strict";n.r(t),t.default='<svg width="16" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.14 1.494V4.98h4.62V1.494c0-.498.098-.871.293-1.12A.927.927 0 0 1 7.82 0c.322 0 .583.123.782.37.2.246.3.62.3 1.124v9.588c0 .503-.101.88-.303 1.128a.957.957 0 0 1-.779.374.921.921 0 0 1-.77-.378c-.193-.251-.29-.626-.29-1.124V6.989H2.14v4.093c0 .503-.1.88-.302 1.128a.957.957 0 0 1-.778.374.921.921 0 0 1-.772-.378C.096 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.285.374A.922.922 0 0 1 1.06 0c.321 0 .582.123.782.37.199.246.299.62.299 1.124zm11.653 9.985V5.27c-1.279.887-2.14 1.33-2.583 1.33a.802.802 0 0 1-.563-.228.703.703 0 0 1-.245-.529c0-.232.08-.402.241-.511.161-.11.446-.25.854-.424.61-.259 1.096-.532 1.462-.818a5.84 5.84 0 0 0 .97-.962c.282-.355.466-.573.552-.655.085-.082.246-.123.483-.123.267 0 .481.093.642.28.161.186.242.443.242.77v7.813c0 .914-.345 1.371-1.035 1.371-.307 0-.554-.093-.74-.28-.187-.186-.28-.461-.28-.825z"/></svg>'},673:function(e,t,n){"use strict";n.r(t),t.default='<svg width="18" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.152 1.494V4.98h4.646V1.494c0-.498.097-.871.293-1.12A.934.934 0 0 1 7.863 0c.324 0 .586.123.786.37.2.246.301.62.301 1.124v9.588c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378c-.194-.251-.29-.626-.29-1.124V6.989H2.152v4.093c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378C.097 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.286.374A.929.929 0 0 1 1.066 0c.323 0 .585.123.786.37.2.246.3.62.3 1.124zm10.99 9.288h3.527c.351 0 .62.072.804.216.185.144.277.34.277.588 0 .22-.073.408-.22.56-.146.154-.368.23-.665.23h-4.972c-.338 0-.601-.093-.79-.28a.896.896 0 0 1-.284-.659c0-.162.06-.377.182-.645s.255-.478.399-.631a38.617 38.617 0 0 1 1.621-1.598c.482-.444.827-.735 1.034-.875.369-.261.676-.523.922-.787.245-.263.432-.534.56-.81.129-.278.193-.549.193-.815 0-.288-.069-.546-.206-.773a1.428 1.428 0 0 0-.56-.53 1.618 1.618 0 0 0-.774-.19c-.59 0-1.054.26-1.392.777-.045.068-.12.252-.226.554-.106.302-.225.534-.358.696-.133.162-.328.243-.585.243a.76.76 0 0 1-.56-.223c-.149-.148-.223-.351-.223-.608 0-.31.07-.635.21-.972.139-.338.347-.645.624-.92a3.093 3.093 0 0 1 1.054-.665c.426-.169.924-.253 1.496-.253.69 0 1.277.108 1.764.324.315.144.592.343.83.595.24.252.425.544.558.875.133.33.2.674.2 1.03 0 .558-.14 1.066-.416 1.523-.277.457-.56.815-.848 1.074-.288.26-.771.666-1.45 1.22-.677.554-1.142.984-1.394 1.29a3.836 3.836 0 0 0-.331.44z"/></svg>'},674:function(e,t,n){"use strict";n.r(t),t.default='<svg width="18" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.152 1.494V4.98h4.646V1.494c0-.498.097-.871.293-1.12A.934.934 0 0 1 7.863 0c.324 0 .586.123.786.37.2.246.301.62.301 1.124v9.588c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378c-.194-.251-.29-.626-.29-1.124V6.989H2.152v4.093c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378C.097 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.286.374A.929.929 0 0 1 1.066 0c.323 0 .585.123.786.37.2.246.3.62.3 1.124zm11.61 4.919c.418 0 .778-.123 1.08-.368.301-.245.452-.597.452-1.055 0-.35-.12-.65-.36-.902-.241-.252-.566-.378-.974-.378-.277 0-.505.038-.684.116a1.1 1.1 0 0 0-.426.306 2.31 2.31 0 0 0-.296.49c-.093.2-.178.388-.255.565a.479.479 0 0 1-.245.225.965.965 0 0 1-.409.081.706.706 0 0 1-.5-.22c-.152-.148-.228-.345-.228-.59 0-.236.071-.484.214-.745a2.72 2.72 0 0 1 .627-.746 3.149 3.149 0 0 1 1.024-.568 4.122 4.122 0 0 1 1.368-.214c.44 0 .842.06 1.205.18.364.12.679.294.947.52.267.228.47.49.606.79.136.3.204.622.204.967 0 .454-.099.843-.296 1.168-.198.324-.48.64-.848.95.354.19.653.408.895.653.243.245.426.516.548.813.123.298.184.619.184.964 0 .413-.083.812-.248 1.198-.166.386-.41.73-.732 1.031a3.49 3.49 0 0 1-1.147.708c-.443.17-.932.256-1.467.256a3.512 3.512 0 0 1-1.464-.293 3.332 3.332 0 0 1-1.699-1.64c-.142-.314-.214-.573-.214-.777 0-.263.085-.475.255-.636a.89.89 0 0 1 .637-.242c.127 0 .25.037.367.112a.53.53 0 0 1 .232.27c.236.63.489 1.099.759 1.405.27.306.65.46 1.14.46a1.714 1.714 0 0 0 1.46-.824c.17-.273.256-.588.256-.947 0-.53-.145-.947-.436-1.249-.29-.302-.694-.453-1.212-.453-.09 0-.231.01-.422.028-.19.018-.313.027-.367.027-.25 0-.443-.062-.579-.187-.136-.125-.204-.299-.204-.521 0-.218.081-.394.245-.528.163-.134.406-.2.728-.2h.28z"/></svg>'},675:function(e,t,n){"use strict";n.r(t),t.default='<svg width="20" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.152 1.494V4.98h4.646V1.494c0-.498.097-.871.293-1.12A.934.934 0 0 1 7.863 0c.324 0 .586.123.786.37.2.246.301.62.301 1.124v9.588c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378c-.194-.251-.29-.626-.29-1.124V6.989H2.152v4.093c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378C.097 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.286.374A.929.929 0 0 1 1.066 0c.323 0 .585.123.786.37.2.246.3.62.3 1.124zm13.003 10.09v-1.252h-3.38c-.427 0-.746-.097-.96-.29-.213-.193-.32-.456-.32-.788 0-.085.016-.171.048-.259.031-.088.078-.18.141-.276.063-.097.128-.19.195-.28.068-.09.15-.2.25-.33l3.568-4.774a5.44 5.44 0 0 1 .576-.683.763.763 0 0 1 .542-.212c.682 0 1.023.39 1.023 1.171v5.212h.29c.346 0 .623.047.832.142.208.094.313.3.313.62 0 .26-.086.45-.256.568-.17.12-.427.179-.768.179h-.41v1.252c0 .346-.077.603-.23.771-.152.168-.356.253-.612.253a.78.78 0 0 1-.61-.26c-.154-.173-.232-.427-.232-.764zm-2.895-2.76h2.895V4.91L12.26 8.823z"/></svg>'},676:function(e,t,n){"use strict";n.r(t),t.default='<svg width="18" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.152 1.494V4.98h4.646V1.494c0-.498.097-.871.293-1.12A.934.934 0 0 1 7.863 0c.324 0 .586.123.786.37.2.246.301.62.301 1.124v9.588c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378c-.194-.251-.29-.626-.29-1.124V6.989H2.152v4.093c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378C.097 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.286.374A.929.929 0 0 1 1.066 0c.323 0 .585.123.786.37.2.246.3.62.3 1.124zm14.16 2.645h-3.234l-.388 2.205c.644-.344 1.239-.517 1.783-.517.436 0 .843.082 1.222.245.38.164.712.39.998.677.286.289.51.63.674 1.025.163.395.245.82.245 1.273 0 .658-.148 1.257-.443 1.797-.295.54-.72.97-1.276 1.287-.556.318-1.197.477-1.923.477-.813 0-1.472-.15-1.978-.45-.506-.3-.865-.643-1.076-1.031-.21-.388-.316-.727-.316-1.018 0-.177.073-.345.22-.504a.725.725 0 0 1 .556-.238c.381 0 .665.22.85.66.182.404.427.719.736.943.309.225.654.337 1.035.337.35 0 .656-.09.919-.272.263-.182.466-.431.61-.749.142-.318.214-.678.214-1.082 0-.436-.078-.808-.232-1.117a1.607 1.607 0 0 0-.62-.69 1.674 1.674 0 0 0-.864-.229c-.39 0-.67.048-.837.143-.168.095-.41.262-.725.5-.316.239-.576.358-.78.358a.843.843 0 0 1-.592-.242c-.173-.16-.259-.344-.259-.548 0-.022.025-.177.075-.463l.572-3.26c.063-.39.181-.675.354-.852.172-.177.454-.265.844-.265h3.595c.708 0 1.062.27 1.062.81a.711.711 0 0 1-.26.572c-.172.145-.426.218-.762.218z"/></svg>'},677:function(e,t,n){"use strict";n.r(t),t.default='<svg width="18" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.152 1.494V4.98h4.646V1.494c0-.498.097-.871.293-1.12A.934.934 0 0 1 7.863 0c.324 0 .586.123.786.37.2.246.301.62.301 1.124v9.588c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378c-.194-.251-.29-.626-.29-1.124V6.989H2.152v4.093c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378C.097 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.286.374A.929.929 0 0 1 1.066 0c.323 0 .585.123.786.37.2.246.3.62.3 1.124zM12.53 7.058a3.093 3.093 0 0 1 1.004-.814 2.734 2.734 0 0 1 1.214-.264c.43 0 .827.08 1.19.24.365.161.684.39.957.686.274.296.485.645.635 1.048a3.6 3.6 0 0 1 .223 1.262c0 .637-.145 1.216-.437 1.736-.292.52-.699.926-1.221 1.218-.522.292-1.114.438-1.774.438-.76 0-1.416-.186-1.967-.557-.552-.37-.974-.919-1.265-1.645-.292-.726-.438-1.613-.438-2.662 0-.855.088-1.62.265-2.293.176-.674.43-1.233.76-1.676.33-.443.73-.778 1.2-1.004.47-.226 1.006-.339 1.608-.339.579 0 1.089.113 1.53.34.44.225.773.506.997.84.224.335.335.656.335.964 0 .185-.07.354-.21.505a.698.698 0 0 1-.536.227.874.874 0 0 1-.529-.18 1.039 1.039 0 0 1-.36-.498 1.42 1.42 0 0 0-.495-.655 1.3 1.3 0 0 0-.786-.247c-.24 0-.479.069-.716.207a1.863 1.863 0 0 0-.6.56c-.33.479-.525 1.333-.584 2.563zm1.832 4.213c.456 0 .834-.186 1.133-.56.298-.373.447-.862.447-1.468 0-.412-.07-.766-.21-1.062a1.584 1.584 0 0 0-.577-.678 1.47 1.47 0 0 0-.807-.234c-.28 0-.548.074-.804.224-.255.149-.461.365-.617.647a2.024 2.024 0 0 0-.234.994c0 .61.158 1.12.475 1.527.316.407.714.61 1.194.61z"/></svg>'},678:function(e,t,n){var o=n(846);e.exports="string"===typeof o?o:o.toString()},679:function(e,t,n){var o=n(847);e.exports="string"===typeof o?o:o.toString()},680:function(e,t,n){"use strict";n.r(t),t.default='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0.2 -0.3 9 11.4" width="12" height="14">\n    <path d="M0 2.77V.92A1 1 0 01.2.28C.35.1.56 0 .83 0h7.66c.28.01.48.1.63.28.14.17.21.38.21.64v1.85c0 .26-.08.48-.23.66-.15.17-.37.26-.66.26-.28 0-.5-.09-.64-.26a1 1 0 01-.21-.66V1.69H5.6v7.58h.5c.25 0 .45.08.6.23.17.16.25.35.25.6s-.08.45-.24.6a.87.87 0 01-.62.22H3.21a.87.87 0 01-.61-.22.78.78 0 01-.24-.6c0-.25.08-.44.24-.6a.85.85 0 01.61-.23h.5V1.7H1.73v1.08c0 .26-.08.48-.23.66-.15.17-.37.26-.66.26-.28 0-.5-.09-.64-.26A1 1 0 010 2.77z"/>\n</svg>'},681:function(e,t,n){var o=n(883);e.exports="string"===typeof o?o:o.toString()},682:function(e,t,n){var o=n(884);e.exports="string"===typeof o?o:o.toString()},683:function(e,t,n){var o=n(885);e.exports="string"===typeof o?o:o.toString()},684:function(e,t,n){"use strict";n.r(t),t.default='<svg width="14" height="14" viewBox="0 -1 14 14" xmlns="http://www.w3.org/2000/svg" ><path d="M3.177 6.852c.205.253.347.572.427.954.078.372.117.844.117 1.417 0 .418.01.725.03.92.02.18.057.314.107.396.046.075.093.117.14.134.075.027.218.056.42.083a.855.855 0 0 1 .56.297c.145.167.215.38.215.636 0 .612-.432.934-1.216.934-.457 0-.87-.087-1.233-.262a1.995 1.995 0 0 1-.853-.751 2.09 2.09 0 0 1-.305-1.097c-.014-.648-.029-1.168-.043-1.56-.013-.383-.034-.631-.06-.733-.064-.263-.158-.455-.276-.578a2.163 2.163 0 0 0-.505-.376c-.238-.134-.41-.256-.519-.371C.058 6.76 0 6.567 0 6.315c0-.37.166-.657.493-.846.329-.186.56-.342.693-.466a.942.942 0 0 0 .26-.447c.056-.2.088-.42.097-.658.01-.25.024-.85.043-1.802.015-.629.239-1.14.672-1.522C2.691.19 3.268 0 3.977 0c.783 0 1.216.317 1.216.921 0 .264-.069.48-.211.643a.858.858 0 0 1-.563.29c-.249.03-.417.076-.498.126-.062.04-.112.134-.139.291-.031.187-.052.562-.061 1.119a8.828 8.828 0 0 1-.112 1.378 2.24 2.24 0 0 1-.404.963c-.159.212-.373.406-.64.583.25.163.454.342.612.538zm7.34 0c.157-.196.362-.375.612-.538a2.544 2.544 0 0 1-.641-.583 2.24 2.24 0 0 1-.404-.963 8.828 8.828 0 0 1-.112-1.378c-.009-.557-.03-.932-.061-1.119-.027-.157-.077-.251-.14-.29-.08-.051-.248-.096-.496-.127a.858.858 0 0 1-.564-.29C8.57 1.401 8.5 1.185 8.5.921 8.5.317 8.933 0 9.716 0c.71 0 1.286.19 1.72.574.432.382.656.893.671 1.522.02.952.033 1.553.043 1.802.009.238.041.458.097.658a.942.942 0 0 0 .26.447c.133.124.364.28.693.466a.926.926 0 0 1 .493.846c0 .252-.058.446-.183.58-.109.115-.281.237-.52.371-.21.118-.377.244-.504.376-.118.123-.212.315-.277.578-.025.102-.045.35-.06.733-.013.392-.027.912-.042 1.56a2.09 2.09 0 0 1-.305 1.097c-.2.323-.486.574-.853.75a2.811 2.811 0 0 1-1.233.263c-.784 0-1.216-.322-1.216-.934 0-.256.07-.47.214-.636a.855.855 0 0 1 .562-.297c.201-.027.344-.056.418-.083.048-.017.096-.06.14-.134a.996.996 0 0 0 .107-.396c.02-.195.031-.502.031-.92 0-.573.039-1.045.117-1.417.08-.382.222-.701.427-.954z" /></svg>'},685:function(e,t,n){"use strict";n.r(t),t.default={}},686:function(e,t){},687:function(e,t,n){var o=n(886);e.exports="string"===typeof o?o:o.toString()},688:function(e,t,n){var o=n(887);e.exports="string"===typeof o?o:o.toString()},689:function(e,t,n){var o=n(888);e.exports="string"===typeof o?o:o.toString()},690:function(e,t,n){"use strict";n.r(t),t.default='<svg width="19" height="4" viewBox="0 0 19 4" xmlns="http://www.w3.org/2000/svg"><path d="M1.25 0H7a1.25 1.25 0 1 1 0 2.5H1.25a1.25 1.25 0 1 1 0-2.5zM11 0h5.75a1.25 1.25 0 0 1 0 2.5H11A1.25 1.25 0 0 1 11 0z"/></svg>'},763:function(e,t,n){var o=n(1114);e.exports="string"===typeof o?o:o.toString()},764:function(e,t,n){var o=n(1115);e.exports="string"===typeof o?o:o.toString()},765:function(e,t,n){var o=n(1116);e.exports="string"===typeof o?o:o.toString()},766:function(e,t,n){"use strict";n.r(t),t.default='<svg viewBox="0 0 1024 1024" width="14" height="14"><path d="M165.25687 0C74.615623 0 0 74.615623 0 165.25687c0 71.189998 46.462499 131.906246 110.171247 154.94062v230.619368h110.171246V320.11874c63.708748-22.916249 110.131872-83.671872 110.131872-154.86187C330.474365 74.615623 255.858742 0 165.25687 0z m660.94873 0a165.25687 165.25687 0 0 0-155.531245 110.171247H440.606237v110.171246h229.949993a165.25687 165.25687 0 0 0 272.474991 61.739998A165.25687 165.25687 0 0 0 826.166225 0zM165.25687 110.171247c31.066874 0 55.085623 24.018749 55.085623 55.085623s-24.018749 55.085623-55.124998 55.085623c-31.027499 0-55.046248-24.018749-55.046248-55.124998 0-31.027499 24.018749-55.046248 55.085623-55.046248z m605.863106 330.474365v220.342493l-126.275621 126.275621a55.085623 55.085623 0 0 0 0 77.883748l142.419371 142.458745a55.006873 55.006873 0 0 0 77.883748 0l142.458745-142.458745a55.006873 55.006873 0 0 0 0-77.883748l-126.314996-126.275621V440.606237h-110.171247zM55.124998 660.988105c-30.436874 0-55.085623 24.648749-55.085623 55.085623v220.303118c0 30.436874 24.648749 55.085623 55.085623 55.085624h220.303119c30.436874 0 55.124998-24.648749 55.124998-55.085624v-220.303118c0-30.436874-24.688124-55.124998-55.124998-55.124998H55.124998z" fill="currentColor" ></path></svg>'},767:function(e,t,n){var o=n(1118);e.exports="string"===typeof o?o:o.toString()},768:function(e,t,n){var o=n(1119);e.exports="string"===typeof o?o:o.toString()},769:function(e,t,n){var o=n(1120);e.exports="string"===typeof o?o:o.toString()},770:function(e,t,n){"use strict";n.r(t),t.default='<svg fill="currentColor" viewBox="0 0 1024 1024" width="24" height="24"><path d="M807.68 574.72h-105.408l-98.272-170.24h6.4a35.808 35.808 0 0 0 35.84-35.84V216.32a35.808 35.808 0 0 0-35.84-35.84H413.44a35.808 35.808 0 0 0-35.84 35.84v152.32a35.808 35.808 0 0 0 35.84 35.84h6.56l-98.272 170.24H216.32a35.808 35.808 0 0 0-35.84 35.84v152.32a35.808 35.808 0 0 0 35.84 35.84h197.12a35.808 35.808 0 0 0 35.84-35.84v-152.32a35.808 35.808 0 0 0-35.84-35.84h-29.664l98.304-170.24h59.84l98.272 170.24h-29.632a35.808 35.808 0 0 0-35.84 35.84v152.32a35.808 35.808 0 0 0 35.84 35.84h197.12a35.808 35.808 0 0 0 35.84-35.84v-152.32a35.808 35.808 0 0 0-35.84-35.84z" fill="currentColor"></path></svg>'},771:function(e,t,n){var o=n(1122);e.exports="string"===typeof o?o:o.toString()},772:function(e,t,n){var o=n(1123);e.exports="string"===typeof o?o:o.toString()},773:function(e,t,n){var o=n(1124);e.exports="string"===typeof o?o:o.toString()},774:function(e,t,n){"use strict";n.r(t),t.default='<svg  viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="15" height="15"><path d="M924.736 733.792l-361.088 200.448c-28.416 15.84-74.688 15.84-103.104 0l-361.28-200.448c-28.416-15.808-28.416-41.504 0-57.152l48-26.72 278.048 154.336c31.136 17.344 64.32 20.928 86.784 20.928 22.272 0 55.456-3.584 86.784-20.928l277.856-154.336 48 26.56c28.416 16 28.416 41.504 0 57.312zM99.264 347.36l361.088 200.448c28.416 15.84 74.72 15.84 103.136 0l361.056-200.448c28.416-15.808 28.416-41.504 0-57.152L563.648 89.76c-28.416-15.84-74.72-15.84-103.136 0L99.264 290.208c-28.576 15.808-28.576 41.344 0 57.152z m825.472 135.968l-48-26.56-278.048 154.336c-31.136 17.376-64.32 20.96-86.784 20.96-22.272 0-55.456-3.584-86.784-20.96l-277.856-154.336-48 26.56c-28.416 15.84-28.416 41.504 0 57.184l361.088 200.448c28.416 15.808 74.72 15.808 103.136 0l361.056-200.448c28.608-15.68 28.608-41.344 0.192-57.184z" fill="currentColor" p-id="8253"></path></svg>'},775:function(e,t,n){"use strict";n.r(t),t.default='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1625210778645" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3827" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32"><defs><style type="text/css"></style></defs><path d="M883.6 926.7H140.4c-42.1 0-76.4-35.9-76.4-80V577.8c0-22.1 17.9-40 40-40s40 17.9 40 40v268.9h736V577.8c0-22.1 17.9-40 40-40s40 17.9 40 40v268.9c0 44.1-34.3 80-76.4 80z" fill="currentColor" p-id="3828"></path><path d="M512 744.2c-22.1 0-40-17.9-40-40V104.6c0-22.1 17.9-40 40-40s40 17.9 40 40v599.6c0 22.1-17.9 40-40 40z" fill="currentColor" p-id="3829"></path><path d="M320 335.9c-10.2 0-20.5-3.9-28.3-11.7-15.6-15.6-15.6-40.9 0-56.6L481.6 77.8c4.5-4.5 13.9-13.9 30.4-13.9 10.6 0 20.8 4.2 28.3 11.7l192 192c15.6 15.6 15.6 40.9 0 56.6s-40.9 15.6-56.6 0L512 160.5 348.3 324.2c-7.8 7.8-18.1 11.7-28.3 11.7z" fill="currentColor" p-id="3830"></path></svg>'},776:function(e,t,n){"use strict";n.r(t),t.default='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1624683024317" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1825" xmlns:xlink="http://www.w3.org/1999/xlink" width="128" height="128"><defs><style type="text/css"></style></defs><path d="M641.365333 536.576v-142.336h-142.336V249.856a313.685333 313.685333 0 1 0 252.586667 307.2v-20.821333z m-69.973333 144.042667H304.128v-55.637334h267.264z m0-156.330667H304.128v-55.637333h267.264z" p-id="1826"></path><path d="M751.616 284.330667V141.994667h-68.608v142.336h-142.336v68.266666h142.336v142.336h68.608v-142.336h142.336v-68.266666h-142.336z" p-id="1827"></path></svg>'},777:function(e,t,n){"use strict";n.r(t),t.default='<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.043 8.265l3.183-3.183h-2.924L4.75 10.636v2.923l4.15-4.15v2.351l-2.158 2.159H8.9v2.137H4.7c-1.215 0-2.2-.936-2.2-2.09v-8.93c0-1.154.985-2.09 2.2-2.09h10.663l.033-.033.034.034c1.178.04 2.12.96 2.12 2.089v3.23H15.3V5.359l-2.906 2.906h-2.35zM7.951 5.082H4.75v3.201l3.201-3.2zm5.099 7.078v3.04h4.15v-3.04h-4.15zm-1.1-2.137h6.35c.635 0 1.15.489 1.15 1.092v5.13c0 .603-.515 1.092-1.15 1.092h-6.35c-.635 0-1.15-.489-1.15-1.092v-5.13c0-.603.515-1.092 1.15-1.092z"/></svg>'},778:function(e,t,n){"use strict";n.r(t),t.default='<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M15.8 10.592v2.043h2.35v2.138H15.8v2.232h-2.25v-2.232h-2.4v-2.138h2.4v-2.28h2.25v.237h1.15-1.15zM1.9 8.455v-3.42c0-1.154.985-2.09 2.2-2.09h4.2v2.137H4.15v3.373H1.9zm0 2.137h2.25v3.325H8.3v2.138H4.1c-1.215 0-2.2-.936-2.2-2.09v-3.373zm15.05-2.137H14.7V5.082h-4.15V2.945h4.2c1.215 0 2.2.936 2.2 2.09v3.42z"/></svg>'},779:function(e,t,n){"use strict";n.r(t),t.default='<svg width="17" height="10" viewBox="0 0 17 10" xmlns="http://www.w3.org/2000/svg"><path d="M13.568 5.925H4.056l1.703 1.703a1.125 1.125 0 0 1-1.59 1.591L.962 6.014A1.069 1.069 0 0 1 .588 4.26L4.38.469a1.069 1.069 0 0 1 1.512 1.511L4.084 3.787h9.606l-1.85-1.85a1.069 1.069 0 1 1 1.512-1.51l3.792 3.791a1.069 1.069 0 0 1-.475 1.788L13.514 9.16a1.125 1.125 0 0 1-1.59-1.591l1.644-1.644z"/></svg>'},780:function(e,t,n){var o=n(1125);e.exports="string"===typeof o?o:o.toString()},781:function(e,t,n){var o=n(1126);e.exports="string"===typeof o?o:o.toString()},782:function(e,t,n){"use strict";n.r(t),t.default='<svg width="17" height="15" viewBox="0 0 336 276" xmlns="http://www.w3.org/2000/svg"><path d="M291 150.242V79c0-18.778-15.222-34-34-34H79c-18.778 0-34 15.222-34 34v42.264l67.179-44.192 80.398 71.614 56.686-29.14L291 150.242zm-.345 51.622l-42.3-30.246-56.3 29.884-80.773-66.925L45 174.187V197c0 18.778 15.222 34 34 34h178c17.126 0 31.295-12.663 33.655-29.136zM79 0h178c43.63 0 79 35.37 79 79v118c0 43.63-35.37 79-79 79H79c-43.63 0-79-35.37-79-79V79C0 35.37 35.37 0 79 0z"/></svg>'},783:function(e,t,n){var o=n(1127);e.exports="string"===typeof o?o:o.toString()},784:function(e,t,n){var o=n(1128);e.exports="string"===typeof o?o:o.toString()},785:function(e,t,n){"use strict";n.r(t),t.default='<svg width="17" height="13" viewBox="0 0 17 13" xmlns="http://www.w3.org/2000/svg"><path d="M5.625 4.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm0-4.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm0 9.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm-4.5-5a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25zm0-4.85a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25zm0 9.85a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25z"/></svg>'},786:function(e,t,n){"use strict";n.r(t),t.default='<svg width="17" height="13" viewBox="0 0 17 13" xmlns="http://www.w3.org/2000/svg"> <path d="M5.625 4.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm0-4.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm0 9.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm-4.5-5a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25zm0-4.85a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25zm0 9.85a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25z"/></svg>'},787:function(e,t,n){"use strict";n.r(t),t.default='<svg width="17" height="13" viewBox="0 0 17 13" xmlns="http://www.w3.org/2000/svg"><path d="M5.819 4.607h9.362a1.069 1.069 0 0 1 0 2.138H5.82a1.069 1.069 0 1 1 0-2.138zm0-4.607h9.362a1.069 1.069 0 0 1 0 2.138H5.82a1.069 1.069 0 1 1 0-2.138zm0 9.357h9.362a1.069 1.069 0 0 1 0 2.138H5.82a1.069 1.069 0 0 1 0-2.137zM1.468 4.155V1.33c-.554.404-.926.606-1.118.606a.338.338 0 0 1-.244-.104A.327.327 0 0 1 0 1.59c0-.107.035-.184.105-.234.07-.05.192-.114.369-.192.264-.118.475-.243.633-.373.158-.13.298-.276.42-.438a3.94 3.94 0 0 1 .238-.298C1.802.019 1.872 0 1.975 0c.115 0 .208.042.277.127.07.085.105.202.105.351v3.556c0 .416-.15.624-.448.624a.421.421 0 0 1-.32-.127c-.08-.085-.121-.21-.121-.376zm-.283 6.664h1.572c.156 0 .275.03.358.091a.294.294 0 0 1 .123.25.323.323 0 0 1-.098.238c-.065.065-.164.097-.296.097H.629a.494.494 0 0 1-.353-.119.372.372 0 0 1-.126-.28c0-.068.027-.16.081-.273a.977.977 0 0 1 .178-.268c.267-.264.507-.49.722-.678.215-.188.368-.312.46-.371.165-.11.302-.222.412-.334.109-.112.192-.226.25-.344a.786.786 0 0 0 .085-.345.6.6 0 0 0-.341-.553.75.75 0 0 0-.345-.08c-.263 0-.47.11-.62.329-.02.029-.054.107-.101.235a.966.966 0 0 1-.16.295c-.059.069-.145.103-.26.103a.348.348 0 0 1-.25-.094.34.34 0 0 1-.099-.258c0-.132.031-.27.093-.413.063-.143.155-.273.279-.39.123-.116.28-.21.47-.282.189-.072.411-.107.666-.107.307 0 .569.045.786.137a1.182 1.182 0 0 1 .618.623 1.18 1.18 0 0 1-.096 1.083 2.03 2.03 0 0 1-.378.457c-.128.11-.344.282-.646.517-.302.235-.509.417-.621.547a1.637 1.637 0 0 0-.148.187z"/></svg>'},788:function(e,t,n){var o=n(1131);e.exports="string"===typeof o?o:o.toString()},789:function(e,t,n){var o=n(1132);e.exports="string"===typeof o?o:o.toString()},790:function(e,t,n){var o=n(1133);e.exports="string"===typeof o?o:o.toString()},791:function(e,t,n){"use strict";n.r(t),t.default='<svg viewBox="0 0 1088 1024" width="16" height="14"><path d="M829.508267 999.424c50.107733 0 82.5344-30.993067 82.5344-78.165333 0-47.172267-32.426667-78.848-81.851734-78.848H367.547733v-8.465067l169.301334-240.8448c26.760533-38.024533 35.2256-58.436267 35.2256-83.080533 0-25.326933-9.8304-47.854933-40.209067-89.429334L374.5792 203.025067V195.242667h453.495467c47.3088 0 80.418133-31.675733 80.418133-78.165334 0-46.421333-33.109333-78.848-80.418133-78.848H231.424C167.936 38.229333 130.525867 70.587733 130.525867 126.293333c0 28.125867 12.6976 55.569067 43.690666 97.826134l210.944 292.181333-212.309333 300.714667c-40.891733 59.1872-47.240533 73.250133-47.240533 100.693333 0 50.722133 38.775467 81.7152 103.0144 81.7152h600.8832z"></path></svg>'},792:function(e,t,n){var o=n(1134);e.exports="string"===typeof o?o:o.toString()},793:function(e,t,n){var o=n(1135);e.exports="string"===typeof o?o:o.toString()},794:function(e,t,n){var o=n(1136);e.exports="string"===typeof o?o:o.toString()},795:function(e,t,n){"use strict";n.r(t),t.default='<svg viewBox="0 0 1055 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="15" height="15"><path d="M34.929778 639.993679h571.891358c17.540741 0 31.769284-14.329679 31.769284-32.00316s-14.222222-31.99684-31.769284-31.99684H34.929778C17.382716 575.993679 3.160494 590.317037 3.160494 607.990519c0 17.673481 14.222222 32.00316 31.769284 32.00316z m444.807901 128H34.923457C17.382716 767.987358 3.160494 782.310716 3.160494 799.984198c0 17.673481 14.222222 31.99684 31.769284 31.996839h444.807901c17.540741 0 31.762963-14.323358 31.762963-31.996839 0-17.673481-14.222222-32.00316-31.769284-32.003161z m445.623309-186.051951l-110.440297 154.04247h110.440297v-154.04247zM1052.444444 384v575.993679c0 35.346963-28.444444 64-63.544888 64-35.094123 0-63.538568-28.653037-63.538568-64v-95.996839h-202.195753l-95.762963 133.499259c-20.562173 28.646716-60.28958 35.081481-88.734025 14.367605-28.444444-20.713877-34.828642-60.725728-14.266469-89.378766l413.032296-575.924148c0.948148-1.40958 2.541037-2.11121 3.558716-3.39437 2.844444-3.286914 6.042864-6.245136 9.525729-8.83042a58.437531 58.437531 0 0 1 9.854419-6.71921 57.432494 57.432494 0 0 1 10.802568-3.96958 60.428642 60.428642 0 0 1 13.021235-2.68642c1.592889-0.12642 3.053037-0.96079 4.702815-0.96079 2.351407 0 4.323556 1.08721 6.611753 1.34637a59.689086 59.689086 0 0 1 24.335802 7.93284c2.098568 1.156741 4.386765 1.40958 6.289383 2.81916 1.396938 1.08721 2.035358 2.56 3.369086 3.71042 3.369086 2.88237 6.099753 6.08079 8.83042 9.53837 2.414617 3.19842 4.766025 6.27042 6.548543 9.85442 1.776198 3.52079 2.920296 7.23121 4.064395 11.13758 1.207309 4.28563 2.224988 8.31842 2.541037 12.736791 0.12642 1.72563 0.954469 3.19842 0.954469 4.93037zM352.647901 959.987358H34.929778c-17.547062 0-31.769284 14.323358-31.769284 31.99684 0 17.673481 14.222222 32.00316 31.769284 32.00316H352.647901c17.547062 0 31.769284-14.329679 31.769284-32.00316s-14.222222-31.99684-31.769284-31.99684zM546.063802 255.993679H1018.311111c18.627951 0 33.72879-14.323358 33.72879-31.996839 0-17.673481-15.10716-31.99684-33.72879-31.99684H546.063802c-18.634272 0-33.735111 14.323358-33.735111 31.99684 0 17.673481 15.10716 31.99684 33.735111 31.996839z m0-191.993679H1018.311111c18.627951 0 33.72879-14.329679 33.72879-32.00316 0-17.66716-15.10716-31.99684-33.72879-31.99684H546.063802c-18.634272 0-33.735111 14.329679-33.735111 31.99684 0 17.673481 15.10716 32.00316 33.735111 32.00316zM35.757827 447.993679h349.487408c17.547062 0 31.769284-14.329679 31.769284-31.996839V31.99684c0-17.66716-14.222222-31.99684-31.769284-31.99684H35.757827C18.210765 0 3.988543 14.329679 3.988543 31.99684v384c0 17.66716 14.222222 31.99684 31.769284 31.996839z m476.570864-31.996839c0-17.673481 14.222222-32.00316 31.775605-32.003161h190.628346c17.547062 0 31.769284 14.329679 31.769284 32.003161 0 17.66716-14.222222 31.99684-31.769284 31.996839H544.104296c-17.547062 0-31.775605-14.329679-31.775605-31.996839z" p-id="4446"></path></svg>'},796:function(e,t,n){"use strict";n.r(t),t.default='<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2626" width="15" height="15"><path d="M85.333333 597.333333V85.333333h512v170.666667h85.333334V85.333333a85.333333 85.333333 0 0 0-85.333334-85.333333H85.333333a85.333333 85.333333 0 0 0-85.333333 85.333333v512a85.333333 85.333333 0 0 0 85.333333 85.333334h170.666667V597.333333zM938.666667 341.333333H768v85.333334h170.666667v512H426.666667V768H341.333333v170.666667a85.333333 85.333333 0 0 0 85.333334 85.333333h512a85.333333 85.333333 0 0 0 85.333333-85.333333V426.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z" p-id="2627"></path><path d="M682.666667 597.333333V426.666667H597.333333v170.666666H426.666667v85.333334h170.666666a85.333333 85.333333 0 0 0 85.333334-85.333334z" p-id="2628"></path><path d="M426.666667 426.666667h170.666666V341.333333H426.666667a85.333333 85.333333 0 0 0-85.333334 85.333334v170.666666h85.333334zM341.333333 597.333333h85.333334v85.333334H341.333333zM597.333333 341.333333h85.333334v85.333334H597.333333z" p-id="2629"></path></svg>'},797:function(e,t,n){"use strict";n.r(t),t.default='<svg viewBox="0 0 20 20"><circle cx="10" cy="10" r="10" fill="#388AE5"/><path fill="#FFF" d="M10.9 9.1h3.7a.9.9 0 1 1 0 1.8h-3.7v3.7a.9.9 0 1 1-1.8 0v-3.7H5.4a.9.9 0 0 1 0-1.8h3.7V5.4a.9.9 0 0 1 1.8 0v3.7z"/></svg>'},798:function(e,t,n){"use strict";n.r(t),t.default='<svg viewBox="0 0 1024 1024" width="20" height="20" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M496.008533 112.008533c-229.751467 0-416 186.248533-416 416s186.248533 416 416 416S912.008533 757.76 912.008533 528.008533 725.76 112.008533 496.008533 112.008533zM704 540.0064c0 17.698133-14.336 32-32 32H320a31.965867 31.965867 0 0 1-32-32v-32c0-17.664 14.301867-32 32-32h352c17.664 0 32 14.336 32 32v32z" p-id="3903" fill="#d81e06"></path></svg>'},799:function(e,t,n){var o=n(1137);e.exports="string"===typeof o?o:o.toString()},800:function(e,t,n){var o=n(1138);e.exports="string"===typeof o?o:o.toString()},801:function(e,t,n){var o=n(1139);e.exports="string"===typeof o?o:o.toString()},802:function(e,t,n){"use strict";n.r(t),t.default='<svg width="18" height="14"><path d="M2.833 8v1.95a1.7 1.7 0 0 0 1.7 1.7h3.45V8h-5.15zm0-2h5.15V2.35h-3.45a1.7 1.7 0 0 0-1.7 1.7V6zm12.3 2h-5.15v3.65h3.45a1.7 1.7 0 0 0 1.7-1.7V8zm0-2V4.05a1.7 1.7 0 0 0-1.7-1.7h-3.45V6h5.15zM4.533.1h8.9a3.95 3.95 0 0 1 3.95 3.95v5.9a3.95 3.95 0 0 1-3.95 3.95h-8.9a3.95 3.95 0 0 1-3.95-3.95v-5.9A3.95 3.95 0 0 1 4.533.1z"/></svg>'},803:function(e,t,n){var o=n(1140);e.exports="string"===typeof o?o:o.toString()},804:function(e,t,n){var o=n(1141);e.exports="string"===typeof o?o:o.toString()},805:function(e,t,n){var o=n(1142);e.exports="string"===typeof o?o:o.toString()},806:function(e,t,n){"use strict";n.r(t),t.default='<svg width="15" height="15" viewBox="0 0 15 15" xmlns="http://www.w3.org/2000/svg"><path d="M7.5 15a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15zm0-2.394a5.106 5.106 0 1 0 0-10.212 5.106 5.106 0 0 0 0 10.212zm-.675-4.665l2.708-2.708 1.392 1.392-2.708 2.708-1.392 1.391-2.971-2.971L5.245 6.36l1.58 1.58z"/></svg>'},807:function(e,t,n){},809:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var o=n(7),i=n(6),a=n(0),r=n.n(a),s=n(35),l=n.n(s),c=n(1),d=n(10),u=n(9),h=n(496),p=(n(1129),n(1130),n(34)),f=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props,t=e.item,n=e.onSelect;return Object(c.jsx)(p.a,{wrapClassName:"math-toolbar__item",icon:Object(c.jsx)("i",{className:"gem-".concat(t.id)}),onClick:function(){n(t.tex)}})}}]),n}(a.Component);function v(e,t){return function(n){Object(d.a)(r,n);var a=Object(u.a)(r);function r(){return Object(o.a)(this,r),a.apply(this,arguments)}return Object(i.a)(r,[{key:"render",value:function(){var n=this.props.onSelect,o=e.map((function(e){return Object(c.jsx)(f,{item:e,onSelect:n},e.id)}));return Object(c.jsx)("div",{className:"math-toolbar math-toolbar--".concat(t),children:o})}}]),r}(a.Component)}var b=v([{id:"alpha_1318469421",tex:"\\alpha"},{id:"beta_170234155",tex:"\\beta"},{id:"gamma_1311936542",tex:"\\gamma"},{id:"delta_1323077121",tex:"\\delta"},{id:"epsilon_3526400827",tex:"\\epsilon"},{id:"varepsilon_960150590",tex:"\\varepsilon"},{id:"zeta_170233907",tex:"\\zeta"},{id:"eta_2087567017",tex:"\\eta"},{id:"theta_1322769205",tex:"\\theta"},{id:"vartheta_3952813808",tex:"\\vartheta"},{id:"iota_170249034",tex:"\\iota"},{id:"kappa_1326819122",tex:"\\kappa"},{id:"lambda_79015454",tex:"\\lambda"},{id:"mu_193423105",tex:"\\mu"},{id:"nu_193423138",tex:"\\nu"},{id:"xi_193418728",tex:"\\xi"},{id:"pi_193418976",tex:"\\pi"},{id:"varpi_1640113541",tex:"\\varpi"},{id:"rho_2087900556",tex:"\\rho"},{id:"varrho_4099271785",tex:"\\varrho"},{id:"sigma_1312148424",tex:"\\sigma"},{id:"varsigma_233085869",tex:"\\varsigma"},{id:"tau_2087983641",tex:"\\tau"},{id:"upsilon_3526401323",tex:"\\upsilon"},{id:"phi_2087833096",tex:"\\phi"},{id:"varphi_1675249005",tex:"\\varphi"},{id:"chi_2087832827",tex:"\\chi"},{id:"psi_2087863571",tex:"\\psi"},{id:"omega_1309716888",tex:"\\omega"},{id:"gamma_1311937598",tex:"\\Gamma"},{id:"delta_1323076193",tex:"\\Delta"},{id:"theta_1322770389",tex:"\\Theta"},{id:"lambda_79016510",tex:"\\Lambda"},{id:"xi_193417672",tex:"\\Xi"},{id:"pi_193417920",tex:"\\Pi"},{id:"sigma_1312149480",tex:"\\Sigma"},{id:"upsilon_3526402507",tex:"\\Upsilon"},{id:"phi_2087834152",tex:"\\Phi"},{id:"psi_2087862643",tex:"\\Psi"},{id:"omega_1309717944",tex:"\\Omega"}],"greek"),m=v([{id:"times_2159110463",tex:"\\times"},{id:"div_2088172514",tex:"\\div"},{id:"cdot_183307621",tex:"\\cdot"},{id:"pm_193414628",tex:"\\pm"},{id:"mp_193426244",tex:"\\mp"},{id:"ast_2087933023",tex:"\\ast"},{id:"star_194646573",tex:"\\star"},{id:"circ_177147074",tex:"\\circ"},{id:"bullet_1823366303",tex:"\\bullet"},{id:"oplus_2140408172",tex:"\\oplus"},{id:"ominus_1906208922",tex:"\\ominus"},{id:"oslash_1351473011",tex:"\\oslash"},{id:"otimes_2531166928",tex:"\\otimes"},{id:"odot_183307497",tex:"\\odot"},{id:"dagger_1389219435",tex:"\\dagger"},{id:"ddagger_2894567663",tex:"\\ddagger"},{id:"vee_2087413967",tex:"\\vee"},{id:"wedge_1162335725",tex:"\\wedge"},{id:"cap_2088096139",tex:"\\cap"},{id:"cup_2088074399",tex:"\\cup"},{id:"aleph_1603530409",tex:"\\aleph"},{id:"re_193404814",tex:"\\Re"},{id:"im_193412861",tex:"\\Im"},{id:"top_2088097970",tex:"\\top"},{id:"bot_2087963360",tex:"\\bot"},{id:"infty_2224287093",tex:"\\infty"},{id:"partial_1646186250",tex:"\\partial"},{id:"forall_4023651683",tex:"\\forall"},{id:"exists_1947215609",tex:"\\exists"},{id:"neg_2087624725",tex:"\\neg"},{id:"angle_1166132696",tex:"\\angle"},{id:"triangle_1315666263",tex:"\\triangle"},{id:"diamond_2948158269",tex:"\\diamond"}],"symbol"),g=v([{id:"leq_2088123777",tex:"\\leq"},{id:"geq_2088123562",tex:"\\geq"},{id:"prec_176608541",tex:"\\prec"},{id:"succ_176814527",tex:"\\succ"},{id:"preceq_3517413801",tex:"\\preceq"},{id:"succeq_3517341131",tex:"\\succeq"},{id:"ll_193412985",tex:"\\ll"},{id:"gg_193411929",tex:"\\gg"},{id:"equiv_1981568039",tex:"\\equiv"},{id:"sim_2087688366",tex:"\\sim"},{id:"simeq_1929181338",tex:"\\simeq"},{id:"asymp_1903012079",tex:"\\asymp"},{id:"approx_3715476797",tex:"\\approx"},{id:"ne_193405746",tex:"\\ne"},{id:"subset_1805468287",tex:"\\subset"},{id:"supset_1806220461",tex:"\\supset"},{id:"subseteq_2051895947",tex:"\\subseteq"},{id:"supseteq_2051566041",tex:"\\supseteq"},{id:"in_193419230",tex:"\\in"},{id:"ni_193418046",tex:"\\ni"},{id:"notin_1650680875",tex:"\\notin"}],"comparison"),k=v([{id:"x_a_193458981",tex:"x_{a}"},{id:"xb_193427367",tex:"x^{b}"},{id:"x_ab_3953731551",tex:"x_{a}^{b}"},{id:"barx_3677001718",tex:"\\bar{x}"},{id:"tildex_2388847703",tex:"\\tilde{x}"},{id:"fracab_2392580300",tex:"\\frac{a}{b}"},{id:"sqrtx_1093998339",tex:"\\sqrt{x}\\sqrt{x}"},{id:"sqrtnx_3625618123",tex:"\\sqrt[n]{x}"},{id:"bigcap_ab_1527652773",tex:"\\bigcap_{a}^{b}"},{id:"bigcup_ab_745232433",tex:"\\bigcup_{a}^{b}"},{id:"prod_ab_1740866194",tex:"\\prod_{a}^{b}"},{id:"coprod_ab_1722723006",tex:"\\coprod_{a}^{b}"},{id:"leftxright_308942087",tex:"\\left( x \\right)"},{id:"leftxright_1060968992",tex:"\\left[ x \\right]"},{id:"leftxright_1282332352",tex:"\\left\\{ x \\right\\}"},{id:"leftxright_791668582",tex:"\\left| x \\right|"},{id:"int_ab_3437240392",tex:"\\int_{a}^{b}"},{id:"oint_ab_1759784839",tex:"\\oint_{a}^{b}"},{id:"sum_abx_3782346798",tex:"\\sum_{a}^{b}{x}"},{id:"lim_arightarrowbx_3542561616",tex:"\\lim_{a \\rightarrow b}{x}"}],"math"),y=v([{id:"leftarrow_2463726907",tex:"\\leftarrow"},{id:"rightarrow_3982089376",tex:"\\rightarrow"},{id:"leftrightarrow_2294107771",tex:"\\leftrightarrow"},{id:"leftarrow_2463728091",tex:"\\Leftarrow"},{id:"rightarrow_3982088320",tex:"\\Rightarrow"},{id:"leftrightarrow_2294108699",tex:"\\Leftrightarrow"},{id:"uparrow_3989605765",tex:"\\uparrow"},{id:"downarrow_2479725650",tex:"\\downarrow"},{id:"updownarrow_3181819383",tex:"\\updownarrow"},{id:"uparrow_3989604837",tex:"\\Uparrow"},{id:"downarrow_2479726706",tex:"\\Downarrow"},{id:"updownarrow_3181820311",tex:"\\Updownarrow"}],"arrow"),C=n(575),_=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a)))._textInput=void 0,e._preview=void 0,e.onSelect=function(t){e.insertText(t),e.onTexChange()},e.onTexChange=function(){var t=e.props.onTeXChange,n=e._textInput,o=e._preview;n&&o&&Object(C.b)(n.value).then((function(e){e&&(o.innerHTML=e,t({tex:n.value,html:e}))}))},e}return Object(i.a)(n,[{key:"getMath",value:function(){var e=this._textInput,t=this._preview;return e&&t?{tex:e.value,html:t.innerHTML}:""}},{key:"insertText",value:function(e){var t=this._textInput;if(t)if(t.selectionStart||0===t.selectionStart){var n=t.selectionStart,o=t.selectionEnd;t.value=t.value.substring(0,n)+e+t.value.substring(o,t.value.length),t.focus(),t.selectionStart=n+e.length,t.selectionEnd=n+e.length}else t.value+=e,t.focus()}},{key:"componentDidMount",value:function(){if(this._textInput){var e=this.props.tex;e&&(this._textInput.value=e),0===this._textInput.selectionStart&&(this._textInput.selectionStart=this._textInput.value.length),this.onTexChange()}}},{key:"render",value:function(){var e=this;this.props.tex;return Object(c.jsxs)("div",{className:"beui-math-editor",children:[Object(c.jsxs)("div",{className:"beui-math-editor__toolbar",children:[Object(c.jsx)(h.a,{placement:"top",title:null,content:Object(c.jsx)(b,{onSelect:this.onSelect}),trigger:"hover",children:Object(c.jsx)("button",{className:"beui-math-editor__button",children:Object(c.jsx)("svg",{width:"46",height:"24",viewBox:"0 0 46 24",fill:"#8590a6",children:Object(c.jsxs)("g",{fillRule:"evenodd",children:[Object(c.jsx)("path",{fillRule:"nonzero",d:"M27.21 6.302L33 16.344H21.42l5.79-10.042zm-3.623 8.79h7.247L27.21 8.806l-3.623 6.286zM6.655 17.258C4.457 17.258 3 15.48 3 12.71c0-2.764 1.465-4.55 3.655-4.55 1.32 0 2.214.62 2.662 1.786h.13v-1.63H10.8v6.595c0 .81.227 1.05.73 1.05.14 0 .262-.01.4-.03v1.18c-.203.06-.407.08-.708.08-1.034 0-1.66-.51-1.766-1.55l-.01-.08h-.13c-.47 1.12-1.375 1.7-2.66 1.7zm7.93.325C14.52 17.91 14.29 18 14 18c-.327 0-.63-.242-.526-.655l2.135-8.483C16.12 6.785 17.48 5 19.21 5c1.36 0 2.336.942 2.336 2.082 0 1.013-.466 1.868-1.295 2.47.09.1.17.205.24.318.32.485.48 1.07.48 1.69 0 2.19-1.946 3.95-4.174 3.95-.58 0-1.132-.26-1.53-.665l-.682 2.738zm5.43-10.623c0-.55-.237-.855-.826-.855-1 0-2.05 1.303-2.49 3.053l-.88 3.566c-.04.12-.04.217-.04.393 0 .782.41 1.288 1.08 1.288.8 0 1.682-.584 2.05-1.402.3-.673.44-1.212.44-1.835 0-.466-.1-.778-.32-1.023-.34.09-.588.128-.877.128h-.07c-.175.003-.29 0-.42-.012-.527-.04-.9-.23-.9-.73 0-.52.4-.74.967-.8.156-.01.285-.02.495-.02h.05c.267 0 .574.05.845.13.55-.4.887-1.17.887-1.87zM6.762 15.995c1.637 0 2.663-1.296 2.663-3.285 0-1.957-.96-3.285-2.475-3.285-1.538 0-2.5 1.23-2.5 3.285 0 2.013.913 3.285 2.313 3.285z"}),Object(c.jsx)("path",{d:"M39.914 10l2.914 3.416H37"})]})})})}),Object(c.jsx)(h.a,{placement:"top",title:null,content:Object(c.jsx)(m,{onSelect:this.onSelect}),trigger:"hover",children:Object(c.jsx)("button",{className:"beui-math-editor__button",children:Object(c.jsx)("svg",{width:"46",height:"24",viewBox:"0 0 46 24",fill:"#8590a6",children:Object(c.jsx)("path",{d:"M39.914 10l2.914 3.416H37m-25.02 2.062l-.984.98-3.507-3.493-3.51 3.492-.98-.98 3.504-3.49L3 8.494l.982-.98L7.49 11.01l3.506-3.492.983.98-3.51 3.49 3.506 3.492zm6.25-6.902c0-.64.53-1.182 1.186-1.182.655 0 1.187.543 1.187 1.182 0 .652-.532 1.182-1.187 1.182s-1.187-.53-1.187-1.182zm-3.658 2.73h9.688v1.387h-9.688v-1.386zm3.657 4.118c0-.652.53-1.182 1.183-1.182s1.187.53 1.187 1.182c0 .64-.53 1.182-1.186 1.182s-1.187-.544-1.187-1.182zM26.26 7H33v10h-6.74v-1.372h5.348v-2.95h-5.35v-1.385h5.35v-2.92h-5.35V7z",fillRule:"evenodd"})})})}),Object(c.jsx)(h.a,{placement:"top",title:null,content:Object(c.jsx)(g,{onSelect:this.onSelect}),trigger:"hover",children:Object(c.jsx)("button",{className:"beui-math-editor__button",children:Object(c.jsx)("svg",{width:"46",height:"24",viewBox:"0 0 46 24",fill:"#8590a6",children:Object(c.jsx)("path",{d:"M31.265 8.03c2.66 0 4.735 1.946 4.735 4.526s-2.076 4.527-4.735 4.527h-5.93V15.66h5.93c1.863 0 3.285-1.327 3.285-3.104 0-1.777-1.422-3.102-3.285-3.102h-5.93V8.03h5.93zm-7.102 3.567H20.21l-.668 1.82h4.62v1.438h-5.147l-.938 2.595-1.365-.494.782-2.1h-3.427v-1.44h3.94l.667-1.82h-4.607v-1.423H19.2l.953-2.623 1.365.494-.782 2.13h3.427v1.423zM11.523 7l.682 1.27-8.148 4.202v.056l8.148 4.203-.683 1.27L1 12.53v-.056L11.522 7zm29.39 3l2.915 3.416H38",fillRule:"evenodd"})})})}),Object(c.jsx)(h.a,{placement:"top",title:null,content:Object(c.jsx)(k,{onSelect:this.onSelect}),trigger:"hover",children:Object(c.jsx)("button",{className:"beui-math-editor__button",children:Object(c.jsx)("svg",{width:"46",height:"24",viewBox:"0 0 46 24",fill:"#8590a6",children:Object(c.jsx)("path",{d:"M1 12.18h1.583l1.496 5.235h.12l2.87-10.79h3.65v1.47H8.19L5.17 18.988H3.12L1 12.18zm13.708 7.174c-1.222-1.993-1.945-4.104-1.945-6.713 0-2.58.723-4.72 1.945-6.7l.946.41C14.524 8.24 14 10.45 14 12.64c0 2.203.524 4.42 1.654 6.294l-.946.42zm3.1 0l-.945-.42c1.13-1.875 1.656-4.09 1.656-6.293 0-2.19-.53-4.4-1.66-6.29l.94-.4c1.23 1.98 1.95 4.12 1.95 6.7 0 2.61-.73 4.72-1.96 6.72zm13.738-4.91c-.103.618-.502 1.332-1.197 2.142-.7.81-1.56 1.22-2.58 1.236-.52 0-.99-.133-1.42-.398-.43-.265-.75-.596-.96-.993-.62.93-1.37 1.4-2.24 1.4-.55 0-1.02-.16-1.42-.48-.4-.32-.61-.76-.62-1.3 0-.42.1-.77.31-1.03.2-.266.4-.43.6-.486.19-.06.36-.09.51-.09.28 0 .51.08.68.245.18.16.263.375.263.64 0 .677-.37 1.14-1.11 1.39.165.19.46.29.89.29.19 0 .33-.016.42-.045.56-.236.975-.72 1.24-1.457.89-3.253 1.33-5.15 1.33-5.696 0-.41-.117-.707-.354-.884-.235-.173-.494-.262-.775-.262-.545 0-1.085.24-1.617.73s-.895 1.08-1.087 1.79c-.043.146-.087.227-.13.24-.045.016-.16.03-.355.046h-.09c-.22 0-.33-.06-.33-.18 0-.017.016-.1.046-.245.234-.84.69-1.583 1.37-2.23.68-.648 1.47-.97 2.374-.97 1.032 0 1.815.462 2.35 1.39.603-.913 1.3-1.37 2.08-1.37h.136c.724 0 1.24.19 1.55.575.31.38.474.79.49 1.216 0 .47-.14.85-.42 1.146-.28.294-.615.44-1 .44-.636 0-.954-.31-.954-.926 0-.297.09-.554.267-.775.18-.22.35-.365.51-.44.165-.072.26-.11.29-.11l.067-.02c0-.013-.043-.043-.13-.087-.09-.046-.21-.1-.357-.157-.15-.057-.29-.08-.42-.065-.537 0-.99.33-1.38.996-.134.24-.304.74-.51 1.5-.21.77-.415 1.56-.622 2.39-.205.825-.323 1.31-.352 1.458-.075.4-.11.685-.11.86 0 .414.11.71.33.885.222.18.473.268.754.268.59 0 1.14-.233 1.66-.704.51-.47.88-1.07 1.08-1.81.03-.13.066-.203.11-.22.045-.012.163-.03.355-.04h.31c.09.09.13.17.13.24zm.736-5.734V5H36v3.71h-3.718zm.93-.955h1.836V5.933h-1.836v1.822zM32.282 20v-3.71H36V20h-3.718zm.93-.955h1.836v-1.82h-1.836v1.82zM41.914 10l2.914 3.416H39",fillRule:"evenodd"})})})}),Object(c.jsx)(h.a,{placement:"top",title:null,content:Object(c.jsx)(y,{onSelect:this.onSelect}),trigger:"hover",children:Object(c.jsx)("button",{className:"beui-math-editor__button",children:Object(c.jsx)("svg",{width:"46",height:"24",viewBox:"0 0 46 24",fill:"#8590a6",children:Object(c.jsx)("path",{d:"M22.448 10.226h8.53c-.36-.486-.612-.918-1.062-1.746l1.476-.828c.684 1.458 1.08 2.124 1.8 3.006.666.81 1.17 1.278 2.34 2.142-1.17.864-1.674 1.332-2.34 2.142-.72.882-1.116 1.548-1.8 3.006l-1.476-.81c.594-1.08.648-1.188 1.026-1.746h-8.494V13.79h9.592c.27-.306.486-.522 1.008-.99-.216-.198-.774-.738-.99-.972h-9.61v-1.602zM17.326 7l3.092 3.092H17.9l-.014 7.56h-1.133l.006-7.56h-2.527L17.323 7zM2 12.326l3.092-3.09v2.517l7.56.013V12.9l-7.56-.007v2.525L2 12.326zM41.914 10l2.914 3.416H39",fillRule:"evenodd"})})})})]}),Object(c.jsx)("textarea",{onPaste:function(e){e.stopPropagation()},placeholder:"\u8f93\u5165 Tex \u8bed\u6cd5\u683c\u5f0f",onChange:this.onTexChange,ref:function(t){e._textInput=t},autoFocus:!0,suppressContentEditableWarning:!0,className:"beui-math-editor__input",contentEditable:!0}),Object(c.jsx)("div",{className:"beui-math-editor__preview",ref:function(t){return e._preview=t}})]})}}]),n}(a.Component),x=function(){function e(){Object(o.a)(this,e),this._unmount=void 0}return Object(i.a)(e,[{key:"mount",value:function(e,t,n){l.a.render(r.a.createElement(_,{tex:t,onTeXChange:n}),e);this._unmount=function(){l.a.unmountComponentAtNode(e)}}},{key:"unmount",value:function(){this._unmount&&(this._unmount(),this._unmount=null)}}]),e}()},810:function(e,t,n){},811:function(e,t,n){},812:function(e,t,n){},813:function(e,t,n){},814:function(e,t,n){},815:function(e,t,n){},816:function(e,t,n){},817:function(e,t,n){},829:function(e,t,n){},830:function(e,t,n){},831:function(e,t,n){},832:function(e,t,n){},833:function(e,t,n){},834:function(e,t,n){},835:function(e,t,n){},837:function(e,t,n){var o=n(838);e.exports="string"===typeof o?o:o.toString()},838:function(e,t,n){var o=n(88)(!1);o.push([e.i,".be-paragraph[placeholder]:empty:focus::before {\n  content: attr(placeholder);\n  color: #70768433;\n  font-weight: normal;\n}\n",""]),e.exports=o},839:function(e,t,n){"use strict";n.r(t),t.default='<svg xmlns="http://www.w3.org/2000/svg" width="52" height="52" viewBox="0 0 52 52">\n    <path fill="#D76B6B" fill-rule="nonzero" d="M26 52C11.64 52 0 40.36 0 26S11.64 0 26 0s26 11.64 26 26-11.64 26-26 26zm0-3.25c12.564 0 22.75-10.186 22.75-22.75S38.564 3.25 26 3.25 3.25 13.436 3.25 26 13.436 48.75 26 48.75zM15.708 33.042a2.167 2.167 0 1 1 0-4.334 2.167 2.167 0 0 1 0 4.334zm23.834 0a2.167 2.167 0 1 1 0-4.334 2.167 2.167 0 0 1 0 4.334zm-15.875 5.452a1.083 1.083 0 1 1-1.834-1.155c1.331-2.114 3.49-3.179 6.334-3.179 2.844 0 5.002 1.065 6.333 3.18a1.083 1.083 0 1 1-1.833 1.154c-.913-1.45-2.366-2.167-4.5-2.167s-3.587.717-4.5 2.167z"/>\n</svg>'},840:function(e,t,n){},841:function(e,t,n){},843:function(e,t,n){var o=n(88)(!1);o.push([e.i,"/**\n * Plugin styles\n */\n.beui-block--header {\n  position: relative;\n}\n.beui-block--header::before {\n  content: attr(data-key);\n  position: absolute;\n  left: -25px;\n  color: var(--placeholder-color);\n  height: 100%;\n  display: flex;\n  align-items: center;\n  font-size: 12px;\n}\n",""]),e.exports=o},844:function(e,t,n){var o=n(88)(!1);o.push([e.i,".be-header {\n  padding: 1em 0;\n  margin: 0;\n  margin-bottom: -0.9em;\n  line-height: 1.5em;\n}\n",""]),e.exports=o},846:function(e,t,n){var o=n(88)(!1);o.push([e.i,".be-paragraph[placeholder]:empty:focus::before {\n  content: attr(placeholder);\n  color: rgba(112, 118, 132, 0.2);\n  font-weight: normal;\n  display: inline-block;\n}\n.be-paragraph[placeholder]:empty::before {\n  display: none;\n}\n",""]),e.exports=o},847:function(e,t,n){var o=n(88)(!1);o.push([e.i,".be-paragraph {\n  line-height: 1.6em;\n  margin: 0px;\n}\n",""]),e.exports=o},848:function(e,t,n){var o={"./components/code":576,"./components/code/":576,"./components/code/highlight":634,"./components/code/highlight.ts":634,"./components/code/icon.svg.xml":684,"./components/code/index":576,"./components/code/index.text.less":681,"./components/code/index.ts":576,"./components/code/languages":635,"./components/code/languages.ts":635,"./components/code/typesets/common.text.less":683,"./components/code/typesets/default.text.less":682,"./components/code/utils":685,"./components/code/utils.ts":685,"./components/data.d":686,"./components/data.d.ts":686,"./components/delimiter":577,"./components/delimiter/":577,"./components/delimiter/icon.svg.xml":690,"./components/delimiter/index":577,"./components/delimiter/index.text.less":687,"./components/delimiter/index.ts":577,"./components/delimiter/typesets/common.text.less":689,"./components/delimiter/typesets/default.text.less":688,"./components/diagram":578,"./components/diagram/":578,"./components/diagram/DiagramInput":636,"./components/diagram/DiagramInput.less":1117,"./components/diagram/DiagramInput.tsx":636,"./components/diagram/icon.svg.xml":766,"./components/diagram/index":578,"./components/diagram/index.text.less":763,"./components/diagram/index.ts":578,"./components/diagram/typesets/common.text.less":765,"./components/diagram/typesets/default.text.less":764,"./components/drawio":599,"./components/drawio/":599,"./components/drawio/DiagramEditor":661,"./components/drawio/DiagramEditor.js":661,"./components/drawio/DrawioInput":660,"./components/drawio/DrawioInput.less":1121,"./components/drawio/DrawioInput.tsx":660,"./components/drawio/icon.svg.xml":770,"./components/drawio/index":599,"./components/drawio/index.text.less":767,"./components/drawio/index.ts":599,"./components/drawio/typesets/common.text.less":769,"./components/drawio/typesets/default.text.less":768,"./components/footnote":600,"./components/footnote/":600,"./components/footnote/icon.svg.xml":774,"./components/footnote/index":600,"./components/footnote/index.text.less":771,"./components/footnote/index.ts":600,"./components/footnote/typesets/common.text.less":773,"./components/footnote/typesets/default.text.less":772,"./components/header":563,"./components/header/":563,"./components/header/h1.svg.xml":672,"./components/header/h2.svg.xml":673,"./components/header/h3.svg.xml":674,"./components/header/h4.svg.xml":675,"./components/header/h5.svg.xml":676,"./components/header/h6.svg.xml":677,"./components/header/icon.svg.xml":671,"./components/header/index":563,"./components/header/index.text.less":669,"./components/header/index.ts":563,"./components/header/typesets/default.text.less":670,"./components/image":601,"./components/image/":601,"./components/image/ImageEditor":633,"./components/image/ImageEditor.js":633,"./components/image/ImageInput":562,"./components/image/ImageInput.tsx":562,"./components/image/assets/add-title.svg.xml":776,"./components/image/assets/background.svg.xml":777,"./components/image/assets/border.svg.xml":778,"./components/image/assets/button-icon.svg.xml":775,"./components/image/assets/stretched.svg.xml":779,"./components/image/assets/toolbox.svg.xml":782,"./components/image/editor":263,"./components/image/editor/":263,"./components/image/editor/App":183,"./components/image/editor/App.less":264,"./components/image/editor/App.tsx":183,"./components/image/editor/index":263,"./components/image/editor/index.tsx":263,"./components/image/index":601,"./components/image/index.text.less":780,"./components/image/index.ts":601,"./components/image/settings":663,"./components/image/settings.ts":663,"./components/image/typesets/default.text.less":781,"./components/image/ui":662,"./components/image/ui.ts":662,"./components/image/uploader":664,"./components/image/uploader.ts":664,"./components/image/utils":574,"./components/image/utils.ts":574,"./components/list":602,"./components/list/":602,"./components/list/icon.svg.xml":785,"./components/list/index":602,"./components/list/index.text.less":783,"./components/list/index.ts":602,"./components/list/ordered.svg.xml":787,"./components/list/typesets/default.text.less":784,"./components/list/unordered.svg.xml":786,"./components/math":603,"./components/math/":603,"./components/math/icon.svg.xml":791,"./components/math/index":603,"./components/math/index.text.less":788,"./components/math/index.ts":603,"./components/math/typesets/common.text.less":790,"./components/math/typesets/default.text.less":789,"./components/paragraph":564,"./components/paragraph/":564,"./components/paragraph/icon.svg.xml":680,"./components/paragraph/index":564,"./components/paragraph/index.text.less":678,"./components/paragraph/index.ts":564,"./components/paragraph/typesets/default.text.less":679,"./components/richtext":604,"./components/richtext/":604,"./components/richtext/break.svg.xml":796,"./components/richtext/icon.svg.xml":795,"./components/richtext/index":604,"./components/richtext/index.text.less":792,"./components/richtext/index.ts":604,"./components/richtext/typesets/common.text.less":794,"./components/richtext/typesets/default.text.less":793,"./components/table":605,"./components/table/":605,"./components/table/borderToolBar":666,"./components/table/borderToolBar.ts":666,"./components/table/documentUtils":570,"./components/table/documentUtils.ts":570,"./components/table/icon.svg.xml":802,"./components/table/index":605,"./components/table/index.text.less":799,"./components/table/index.ts":605,"./components/table/minus.svg.xml":798,"./components/table/plus.svg.xml":797,"./components/table/table":606,"./components/table/table.ts":606,"./components/table/tableConstructor":665,"./components/table/tableConstructor.ts":665,"./components/table/typesets/common.text.less":800,"./components/table/typesets/default.text.less":801,"./components/todolist":607,"./components/todolist/":607,"./components/todolist/icon.svg.xml":806,"./components/todolist/index":607,"./components/todolist/index.text.less":803,"./components/todolist/index.ts":607,"./components/todolist/typesets/common.text.less":805,"./components/todolist/typesets/default.text.less":804,"./components/utils":531,"./components/utils.ts":531,"./inserts/math":608,"./inserts/math/":608,"./inserts/math/index":608,"./inserts/math/index.less":807,"./inserts/math/index.ts":608,"./tools/backcolor":609,"./tools/backcolor/":609,"./tools/backcolor/index":609,"./tools/backcolor/index.ts":609,"./tools/bold":610,"./tools/bold/":610,"./tools/bold/index":610,"./tools/bold/index.ts":610,"./tools/fontcolor":611,"./tools/fontcolor/":611,"./tools/fontcolor/index":611,"./tools/fontcolor/index.ts":611,"./tools/fontsize":612,"./tools/fontsize/":612,"./tools/fontsize/index":612,"./tools/fontsize/index.ts":612,"./tools/footnote":613,"./tools/footnote/":613,"./tools/footnote/index":613,"./tools/footnote/index.ts":613,"./tools/inlinecode":614,"./tools/inlinecode/":614,"./tools/inlinecode/index":614,"./tools/inlinecode/index.ts":614,"./tools/italic":615,"./tools/italic/":615,"./tools/italic/index":615,"./tools/italic/index.ts":615,"./tools/kbd":616,"./tools/kbd/":616,"./tools/kbd/index":616,"./tools/kbd/index.ts":616,"./tools/link":571,"./tools/link/":571,"./tools/link/index":571,"./tools/link/index.ts":571,"./tools/mark":617,"./tools/mark/":617,"./tools/mark/index":617,"./tools/mark/index.ts":617,"./tools/math":618,"./tools/math/":618,"./tools/math/index":618,"./tools/math/index.ts":618,"./tools/removeformat":619,"./tools/removeformat/":619,"./tools/removeformat/index":619,"./tools/removeformat/index.ts":619,"./tools/strikethrough":620,"./tools/strikethrough/":620,"./tools/strikethrough/index":620,"./tools/strikethrough/index.ts":620,"./tools/sub":621,"./tools/sub/":621,"./tools/sub/index":621,"./tools/sub/index.ts":621,"./tools/sup":622,"./tools/sup/":622,"./tools/sup/index":622,"./tools/sup/index.ts":622,"./tools/tool":534,"./tools/tool.ts":534,"./tools/toolActions":552,"./tools/toolActions.ts":552,"./tools/underline":623,"./tools/underline/":623,"./tools/underline/index":623,"./tools/underline/index.ts":623,"./tools/wrap":624,"./tools/wrap/":624,"./tools/wrap/index":624,"./tools/wrap/index.ts":624,"./tunes/align-center":625,"./tunes/align-center/":625,"./tunes/align-center/index":625,"./tunes/align-center/index.ts":625,"./tunes/align-justify":626,"./tunes/align-justify/":626,"./tunes/align-justify/index":626,"./tunes/align-justify/index.ts":626,"./tunes/align-left":553,"./tunes/align-left/":553,"./tunes/align-left/index":553,"./tunes/align-left/index.ts":553,"./tunes/align-right":627,"./tunes/align-right/":627,"./tunes/align-right/index":627,"./tunes/align-right/index.ts":627,"./tunes/delete":628,"./tunes/delete/":628,"./tunes/delete/index":628,"./tunes/delete/index.ts":628,"./tunes/insert-line-after":572,"./tunes/insert-line-after/":572,"./tunes/insert-line-after/index":572,"./tunes/insert-line-after/index.ts":572,"./tunes/insert-line-before":629,"./tunes/insert-line-before/":629,"./tunes/insert-line-before/index":629,"./tunes/insert-line-before/index.ts":629,"./tunes/move-down":630,"./tunes/move-down/":630,"./tunes/move-down/index":630,"./tunes/move-down/index.ts":630,"./tunes/move-up":631,"./tunes/move-up/":631,"./tunes/move-up/index":631,"./tunes/move-up/index.ts":631,"./tunes/quote":632,"./tunes/quote/":632,"./tunes/quote/index":632,"./tunes/quote/index.ts":632};function i(e){var t=a(e);return n(t)}function a(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}i.keys=function(){return Object.keys(o)},i.resolve=a,e.exports=i,i.id=848},883:function(e,t,n){var o=n(88)(!1);o.push([e.i,'.be-code__line-text {\n  white-space: pre;\n}\n.be-code__line-text::after {\n  content: " ";\n}\n',""]),e.exports=o},884:function(e,t,n){var o=n(88)(!1);o.push([e.i,".be-code__content {\n  line-height: 1.6em;\n  outline: none;\n  margin: 0px;\n  display: block;\n}\n",""]),e.exports=o},885:function(e,t,n){var o=n(88)(!1);o.push([e.i,'.be-code pre {\n  font-size: 14px;\n  margin: 10px 0;\n  display: block;\n  overflow-x: auto;\n  padding: 1em 1em 1em 0.5em;\n  color: #333;\n  position: relative;\n  background-color: rgba(0, 0, 0, 0.03);\n  border: 1px solid #f0f0f0;\n  border-radius: 2px;\n  counter-reset: line;\n  line-height: 26px;\n  white-space: normal;\n}\n.be-code pre .be-code__line {\n  text-align: left;\n  font-size: 14px;\n  display: flex;\n  white-space: nowrap;\n  position: relative;\n  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;\n  background-color: transparent;\n  color: #333;\n}\n.be-code pre .be-code__line::before {\n  min-width: 1.5em;\n  text-align: right;\n  counter-increment: line;\n  content: counter(line);\n  display: inline;\n  margin-right: 12px;\n  color: rgba(0, 0, 0, 0.15);\n}\n.be-code__comment,\n.be-code__quote {\n  color: #afafaf;\n  font-style: italic;\n}\n.be-code__keyword,\n.be-code__selector-tag,\n.be-code__subst {\n  color: #ca7d37;\n}\n.be-code__number,\n.be-code__literal,\n.be-code__variable,\n.be-code__template-variable,\n.be-code__tag .be-code__attr {\n  color: #0e9ce5;\n}\n.be-code__string,\n.be-code__doctag {\n  color: #d14;\n}\n.be-code__title,\n.be-code__section,\n.be-code__selector-id {\n  color: #d14;\n}\n.be-code__subst {\n  font-weight: normal;\n}\n.be-code__type,\n.be-code__class .be-code__title {\n  color: #0e9ce5;\n}\n.be-code__tag,\n.be-code__name,\n.be-code__attribute {\n  color: #0e9ce5;\n  font-weight: normal;\n}\n.be-code__regexp,\n.be-code__link {\n  color: #ca7d37;\n}\n.be-code__symbol,\n.be-code__bullet {\n  color: #d14;\n}\n.be-code__built_in,\n.be-code__builtin-name {\n  color: #ca7d37;\n}\n.be-code__meta {\n  color: #afafaf;\n}\n.be-code__deletion {\n  background: #fdd;\n}\n.be-code__addition {\n  background: #dfd;\n}\n.be-code__emphasis {\n  font-style: italic;\n}\n.be-code__strong {\n  font-weight: bold;\n}\n',""]),e.exports=o},886:function(e,t,n){var o=n(88)(!1);o.push([e.i,"/*\n.be-delimiter {\n    margin: 0px;\n    border: none;\n}\n*/\n",""]),e.exports=o},887:function(e,t,n){var o=n(88)(!1);o.push([e.i,'/*\n.be-delimiter {\n    line-height: 1.6em;\n    width: 100%;\n    text-align: center;\n}\n\n.be-delimiter:before {\n    display: inline-block;\n    content: "***";\n    font-size: 30px;\n    line-height: 65px;\n    height: 30px;\n    letter-spacing: 0.2em;\n}\n*/\n',""]),e.exports=o},888:function(e,t,n){var o=n(88)(!1);o.push([e.i,".be-delimiter {\n  display: inline-block;\n  width: 100%;\n}\n",""]),e.exports=o}}]);